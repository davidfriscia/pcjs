(function(){/*
 https://www.pcjs.org/machines/modules/v3/defines.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/message.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/format.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/stdlib.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/stdio.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/webio.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/device.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/input.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/led.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/monitor.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/time.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/bus.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/memory.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/ports.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/ram.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/rom.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/cpu.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/debugger.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/modules/v3/cpux80.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/modules/v3/dbgx80.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/vt100/modules/v3/chips.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/vt100/modules/v3/keyboard.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/vt100/modules/v3/serial.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/vt100/modules/v3/video.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/machine.js (C) 2012-2025 Jeff Parsons
*/
var f,aa=typeof Object.create=="function"?Object.create:function(a){function b(){}b.prototype=a;return new b},ba=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};
function ca(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var da=ca(this),ea="Int8 Uint8 Uint8Clamped Int16 Uint16 Int32 Uint32 Float32 Float64".split(" ");da.BigInt64Array&&(ea.push("BigInt64"),ea.push("BigUint64"));
function fa(a,b){if(b)for(var c=0;c<ea.length;c++)ha(ea[c]+"Array.prototype."+a,b)}function ia(a,b){b&&ha(a,b)}function ha(a,b){var c=da;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))return;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&b!=null&&ba(c,a,{configurable:!0,writable:!0,value:b})}var ja;
if(typeof Object.setPrototypeOf=="function")ja=Object.setPrototypeOf;else{var ka;a:{var la={a:!0},oa={};try{oa.__proto__=la;ka=oa.a;break a}catch(a){}ka=!1}ja=ka?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var pa=ja;
function m(a,b){a.prototype=aa(b.prototype);a.prototype.constructor=a;if(pa)pa(a,b);else for(var c in b)if(c!="prototype")if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.ql=b.prototype}function qa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}
function ra(a){if(!(a instanceof Array)){var b=typeof Symbol!="undefined"&&Symbol.iterator&&a[Symbol.iterator];if(b)a=b.call(a);else if(typeof a.length=="number")a={next:qa(a)};else throw Error(String(a)+" is not an iterable or ArrayLike");for(var c=[];!(b=a.next()).done;)c.push(b.value);a=c}return a}function sa(){for(var a=Number(this),b=[],c=a;c<arguments.length;c++)b[c-a]=arguments[c];return b}
ia("String.prototype.replaceAll",function(a){return a?a:function(b,c){if(b instanceof RegExp&&!b.global)throw new TypeError("String.prototype.replaceAll called with a non-global RegExp argument.");return b instanceof RegExp?this.replace(b,c):this.replace(new RegExp(String(b).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"),"g"),c)}});
ia("Math.trunc",function(a){return a?a:function(b){b=Number(b);if(isNaN(b)||b===Infinity||b===-Infinity||b===0)return b;var c=Math.floor(Math.abs(b));return b<0?-c:c}});ia("String.prototype.repeat",function(a){return a?a:function(b){if(this==null)throw new TypeError("The 'this' value for String.prototype.repeat must not be null or undefined");var c=this;if(b<0||b>1342177279)throw new RangeError("Invalid count value");b|=0;for(var d="";b;)if(b&1&&(d+=c),b>>>=1)c+=c;return d}});
ia("Number.isNaN",function(a){return a?a:function(b){return typeof b==="number"&&isNaN(b)}});ia("Math.log2",function(a){return a?a:function(b){return Math.log(b)/Math.LN2}});
ia("Symbol",function(a){function b(g){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c(d+(g||"")+"_"+e++,g)}function c(g,h){this.g=g;ba(this,"description",{configurable:!0,writable:!0,value:h})}if(a)return a;c.prototype.toString=function(){return this.g};var d="jscomp_symbol_"+(Math.random()*1E9>>>0)+"_",e=0;return b});
ia("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");ba(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return ta(qa(this))}});return a});function ta(a){a={next:a};a[Symbol.iterator]=function(){return this};return a}function va(a,b){a instanceof String&&(a+="");var c=0,d=!1,e={next:function(){if(!d&&c<a.length){var g=c++;return{value:b(g,a[g]),done:!1}}d=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e}
ia("Array.prototype.keys",function(a){return a?a:function(){return va(this,function(b){return b})}});ia("Array.prototype.fill",function(a){return a?a:function(b,c,d){var e=this.length||0;c<0&&(c=Math.max(0,e+c));if(d==null||d>e)d=e;d=Number(d);d<0&&(d=Math.max(0,e+d));for(c=Number(c||0);c<d;c++)this[c]=b;return this}});fa("fill",function(a){return a?a:Array.prototype.fill});ia("Number.parseInt",function(a){return a||parseInt});
ia("Array.prototype.values",function(a){return a?a:function(){return va(this,function(b,c){return c})}});function wa(){this.U=""}var xa,ya=new ArrayBuffer(2);(new DataView(ya)).setUint16(0,256,!0);xa=(new Uint16Array(ya))[0]===256;
var za={Ge:{bb:4,Ba:16},Pd:{bb:5,Ba:32},Tc:{bb:6,Ba:64},Ld:{bb:8,Ba:256},Rd:{bb:20,Ba:1048576},dl:{bb:22,Ba:4194304}},Aa={fl:typeof window!="undefined",node:typeof window!="undefined"?{}:global,process:typeof process!="undefined"?process:{},window:typeof window!="undefined"?window:global,document:typeof document!="undefined"?document:{},Lb:{machines:{},components:[],commands:{},files:null}};Aa.window.PCjs?Aa.Lb=Aa.window.PCjs:Aa.window.PCjs=Aa.Lb;
var Ba=Aa.process,Ca=Aa.Lb.machines,Da=Aa.Lb.components,n={};n.Defines=wa;var Ea={all:0xffffffffffff,addr:1,bus:2,fault:4,memory:8,ports:16,chips:32,kbd:64,serial:128,misc:256,cpu:512,mmu:2048,"int":1024,trap:4096,video:8192,monitor:16384,screen:32768,disk:131072,file:65536,time:262144,timer:524288,event:1048576,input:2097152,key:4194304,mouse:8388608,touch:16777216,info:274877906944,warn:549755813888,error:1099511627776,halt:70368744177664,buffer:0x800000000000};
function Fa(){this.g={};for(var a=0;a<23;a++)this.g["ACDFGHMNSTWYBbdfjcsoXx%"[a]]=null}Fa.prototype.O=function(a,b){return this.g[a]?!1:(this.g[a]=b,!0)};
function Ga(){var a=sa.apply(0,arguments);if(a[0]===void 0)a=new Date(Date.now());else if(typeof a[0]==="string"){var b=a[0];b.indexOf(":")<0?b+=" "+(a[1]||"00:00:00 UTC"):b.match(/^[0-9][0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9] [0-9][0-9]:[0-9][0-9]:[0-9][0-9]$/)&&(a[1]||(b+=" UTC"));a=new Date(b)}else a=a[1]===void 0?new Date(a[0]):new Date(Date.UTC.apply(Date,ra(a)));return a}
Fa.prototype.h=function(a){var b=sa.apply(1,arguments);if(!b||!b.length)return a;var c="",d=a.split(/%([-+ 0#]*)([0-9]*|\*)(\.[0-9]+|)([bwhlL]?)([A-Za-z%])/),e=0,g;for(g=0;g<d.length-6;g+=6){c+=d[g];var h=d[g+5];if(this.g[h]===void 0)c+="%"+d[g+1]+d[g+2]+d[g+3]+d[g+4]+h;else{if(e<b.length){var k=b[e];h!="%"&&e++}else k=b[b.length-1];var l=!1,u=d[g+1],p=u.indexOf("#")>=0,w=u.indexOf("0")>=0,r=d[g+2];r=="*"?(r=k,k=e<b.length?b[e++]:b[b.length-1]):r=+r||0;var q=d[g+3];q=q?+q.substr(1):-1;var y=d[g+4],
x=null,B=0,z="",A="ACDFGHMNSTWY".indexOf(h)>=0&&typeof k!="object"?Ga(k):k;switch(h){case "C":c+=isNaN(A.getTime())?void 0:this.h("%#W, %#F %#D, %#Y".replaceAll("#",p?"#":""),A);continue;case "D":k=p?A.getUTCDate():A.getDate();h="d";break;case "A":case "G":case "H":k=p?A.getUTCHours():A.getHours();h=="A"?(k=k<12?"am":"pm",h="s"):(h=="G"&&(k=k?k>12?k-12:k:12),h="d");break;case "F":case "M":k=p?A.getUTCMonth():A.getMonth();h=="F"?(k=Ha[k],h="s"):(k++,h="d");break;case "N":k=p?A.getUTCMinutes():A.getMinutes();
h="d";break;case "S":k=p?A.getUTCSeconds():A.getSeconds();h="d";break;case "T":c+=isNaN(A.getTime())?void 0:this.h("%#Y-%#02M-%#02D %#02H:%#02N:%#02S".replaceAll("#",p?"#":""),A);continue;case "W":k=Ja[p?A.getUTCDay():A.getDay()];h="s";break;case "Y":k=p?A.getUTCFullYear():A.getFullYear(),q>0&&(k%=Math.pow(10,q)),h="d"}switch(h){case "b":c+=k?"true":"false";break;case "d":k=Math.trunc(k),q>=0&&(w=!0,r<q&&(r=q),q=-1);case "f":k=+k;h=k+"";q>=0&&(h=k.toFixed(q));h.length<r&&(w?(k<0&&(r--,h=h.substr(1)),
h=("0".repeat(r)+h).slice(-r),k<0&&(h="-"+h)):h=(" ".repeat(r)+h).slice(-r));c+=h;break;case "j":c+=JSON.stringify(k,null,r||void 0);break;case "c":k=typeof k=="string"?k[0]:String.fromCharCode(k);case "s":if(k!=void 0)for(typeof k!="string"&&(k=k.toString()),q>=0&&(k=k.substr(0,q));k.length<r;)k=u.indexOf("-")>=0?k+" ":" "+k;c+=k;break;case "B":B=2,p&&(z="0b");case "o":B||(B=8),!z&&p&&(z="0o");case "X":x=Ka;case "x":h="";B||(B=16);!z&&p&&(z="0x");x||(x=La);typeof k=="string"&&k[0]=="-"&&(l=!0,k=
k.slice(1));k=Math.trunc(k);l&&(k=-k);k<0&&((k|0)==k?k>>>=0:Math.abs(k)<=9007199254740992&&(k+=9007199254740992));q>=0&&(w=!0,r<q&&(r=q));w&&!r&&(y=="b"?r=2:y=="h"||y=="w"?r=4:y=="l"?r=8:(r=Math.abs(k),r=r<=255?2:r<=65535?4:r<=4294967295?8:9),r+=z.length);r-=z.length;do l=16,Number.isNaN(k)||(l=k&B-1,k=Math.trunc(k/B)),w||!h||l||k?h=x[l]+h:(z&&(h=z+h,z=""),r>0&&(h=" "+h));while(--r>0||k);c+=z+h;break;case "%":c+="%";break;default:c=this.g[h]?c+this.g[h](h,u,r,q,k):c+("(unimplemented sprintf type: %"+
h+")")}}}return c+=d[g]};var Ja="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Ha="January February March April May June July August September October November December".split(" "),La="0123456789abcdef?",Ka="0123456789ABCDEF?";function Ma(){wa.apply(this,arguments)}m(Ma,wa);
function Na(a,b){if(a){b||(b=10);var c,d=a.indexOf(",")>0;d&&(a=a.replace(/,/g,""));var e=c=a.charAt(0);c=="#"?(b=8,c=""):c=="$"&&(b=16,c="");e!=c?a=a.substr(1):(e=c=a.substr(0,2),c=="0b"&&d||c=="^B"?(b=2,c=""):c=="0o"||c=="^O"?(b=8,c=""):c=="^D"?(b=10,c=""):c=="0x"&&(b=16,c=""),e!=c&&(a=a.substr(2)));e=c=a.slice(-1);c=="Y"||c=="y"?(b=2,c=""):c=="."?(b=10,c=""):c=="H"||c=="h"?(b=16,c=""):c=="K"?c="000":c=="M"?c="000000":c=="G"&&(c="000000000");e!=c&&(a=a.slice(0,-1)+c);var g;e=0;b<=10&&(c=a.match(/(-?[0-9]+)B([0-9]*)$/))&&
(a=c[1],e=35-((c[2]||35)&255));if((b&&b!=10?b==16?a.match(/^-?[0-9a-f]+$/i)!==null:b==8?a.match(/^-?[0-7]+$/)!==null:b==2&&a.match(/^-?[01]+$/)!==null:a.match(/^[+-]?[0-9]+$/)!==null)&&!isNaN(g=parseInt(a,b))){e&&(g<0&&(g+=68719476736),g=e>0?g*Math.pow(2,e):Math.trunc(g/Math.pow(2,-e)));var h=g}}return h}
function Oa(a,b,c,d,e){d=d===void 0?0:d;var g=g===void 0?0:g;var h="",k="",l=-1;c||(c=a.ka||10);d&&(l=Math.ceil(d/Math.log2(c)));if(e==void 0)switch(c){case 8:e="0o";break;case 16:e="0x";break;case 10:k=".";default:e=""}isNaN(b)||typeof b!="number"?(b=void 0,e=k=""):(b<0&&b>-1&&(b=-1),d&&(b<0&&(b+=Math.pow(2,d)),b>=Math.pow(2,d)&&(l=Math.ceil(Math.log(b)/Math.log(c)))));for(a=g||-1;l--;){a||(h=","+h,a=g);if(b==void 0){if(h="?"+h,l<0)break}else if(d=b%c,b=Math.trunc(b/c),d+=d>=0&&d<=9?48:55,h=String.fromCharCode(d)+
h,!b&&l<0)break;a--}return e+h+k}function Pa(a,b){var c=a/t|0,d=b/t|0;return(a&b)==(b|0)&&(c&d)==d}var t=4294967296;n.StdLib=Ma;function Qa(){Ma.call(this);this.format=new Fa;this.gd=this.format.O.bind(this.format);this.O=this.format.h.bind(this.format)}m(Qa,Ma);Qa.prototype.flush=function(){var a=Ra;Ra="";this.Na(a)};function Sa(a){var b=a,c=a.lastIndexOf("/");c>=0&&(b=a.substr(c+1));c=b.indexOf("&");c>0&&(b=b.substr(0,c));c=b.lastIndexOf(".");c>0&&(b=b.substring(0,c));return b}
Qa.prototype.Na=function(a,b){var c=a.length,d=a.lastIndexOf("\n");b?d>=0&&(b=Date.now(),Ta||(Ta=b),a=((b-Ta)/1E3).toFixed(3)+": "+a,c=a.length):this.U=="node"?(Ba.pl.write(a),a=""):(d>=0&&(console.log(Ra+a.slice(0,d)),Ra="",a=a.slice(d+1)),Ta=null);Ra+=a;return c};Qa.prototype.I=function(a){return this.Na(this.O.apply(this,[a].concat(ra(sa.apply(1,arguments)))))};var Ra="",Ta=null;n.StdIO=Qa;
function Ua(a){Qa.call(this);this.ea={};this.ua=0;this.W=this;a&&(this.W.ua=0,this.W.Ma=[],this.W.Fa=0,this.W.tb={},this.W.pb=!1)}var Va;m(Ua,Qa);f=Ua.prototype;f.Pa=function(a,b){var c=this,d=this;this.ea[a]=b;switch(a){case Wa.Md:b.onclick=function(){var e=c.Ha(Wa.ub,!0);e&&(e.value="")};break;case Wa.ub:Xa(b),b.addEventListener("keydown",function(e){Ya(d,e,!0)}),b.addEventListener("keypress",function(e){Ya(d,e)})}};function Za(a,b){var c=$a.Pc;a.W.tb[c]||(a.W.tb[c]=[]);a.W.tb[c].push(b)}
function Xa(a){a.setAttribute("autocapitalize","off");a.setAttribute("autocomplete","off");a.setAttribute("autocorrect","off");a.setAttribute("spellcheck","false");a.value=""}f.error=function(a,b){b=this.O.apply(this,[a].concat(ra(b)));var c="%s";a=!1;typeof c=="boolean"&&(a=c,c=b.shift());if(b=this.O.apply(this,[c].concat(ra(b))))this.I("%s\n",b),a||alert(b)};f.Ha=function(a){return this.ea[a]};
function ab(a,b,c){if(a){do{for(var d=0;d<bb.length;d++){var e=bb[d];if(c){if(e+=c,b+e in a)return e}else if(e=e?e+b[0].toUpperCase():b[0],e+=b.substr(1),e in a)return e}if(b.indexOf("screen")<0)break;b=b.replace("screen","Screen")}while(1)}return null}function cb(a,b){return a.config.bindings&&a.config.bindings[b]}function db(a){if(a=a.ea[eb])var b=a.textContent;return b}function fb(a,b,c){a=+a||0;a<b&&(a=b);a>c&&(a=c);return a}
function v(a,b,c,d){a=a.config[b];a===void 0?a=c:(d&&d[a]!==void 0&&(a=d[a]),d=typeof c,typeof a!=d&&(d=="boolean"?a=!!a:typeof c=="number"&&(a=+a)));return a}
function gb(a,b){var c=0,d=null,e=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");e.onreadystatechange=function(){e.readyState!==4?b(a,d,e.readyState,c):(d=e.responseText,e.status==200||!e.status&&d.length&&(window?window.location.protocol:"file:")=="file:"||(c=e.status||-1),b(a,d,e.readyState,c))};e.open("GET",a,!0);e.send()}
function hb(){var a,b=Va;if(!b){b={};if(window){a||(a=window.location.search.slice(1));for(var c,d=/\+/g,e=/([^&=]+)=?([^&]*)/g;c=e.exec(a);)b[decodeURIComponent(c[1].replace(d," ")).trim()]=decodeURIComponent(c[2].replace(d," ")).trim()}Va=b}return b}function ib(a){if(jb.Qb===void 0){var b=!1;if(window)try{window.localStorage.setItem(jb.hb,jb.hb),b=window.localStorage.getItem(jb.hb)==jb.hb,window.localStorage.removeItem(jb.hb)}catch(c){a.I("%s\n",c.message),b=!1}jb.Qb=b}return!!jb.Qb}
function kb(a,b){b=b===void 0?0:b;b>1&&b%2&&b--;b=b||a.ua;return(b|1)==-1||Pa(a.W.ua,b)?!0:!1}function lb(a){if(window){var b=window.navigator.userAgent;return a=="iOS"&&(!!b.match(/(iPod|iPhone|iPad)/)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1)||a=="MSIE"&&!!b.match(/(MSIE|Trident)/)||b.indexOf(a)>=0}return!1}function mb(a){var b=null;if(ib(a)){var c;if(window)try{(c=window.localStorage.getItem(a.$))&&(b=JSON.parse(c))}catch(d){a.I("%s\n",d.message)}}return b}
function Ya(a,b,c){b=b||window.event;var d=b.which||b.keyCode;if(d){var e=a.W,g=b.target;if(c){a=!1;var h;c=g.value;var k=c.lastIndexOf("\n");d==C.Sb&&g.selectionStart<=k+1&&(a=!0);d==C.rd?(a=!0,e.Fa>0&&(h=e.Ma[--e.Fa])):d==C.Sc&&(a=!0,e.Fa<e.Ma.length&&(h=e.Ma[++e.Fa]||""));a&&b.preventDefault();h!=void 0&&(g.value=c.substr(0,k+1)+h)}else d=String.fromCharCode(d),h=g.value,c=h.lastIndexOf("\n"),g.selectionStart<=c&&g.setSelectionRange(h.length,h.length),b.stopPropagation(),d=="@"&&e.Fa>0&&c+1==h.length&&
(g.value+=e.Ma[--e.Fa],d="\r"),d=="\r"&&(b.preventDefault(),h=g.value+="\n",g.blur(),g.focus(),(b=nb(a,h.slice(h.lastIndexOf("\n",h.length-2)+1,-1)||""))&&a.I("%s\n",b.replace(/\n$/,"")))}}function ob(a){window&&window.addEventListener("resize",a)}function pb(a){return a=="true"||a=="on"?!0:a=="false"||a=="off"?!1:void 0}
function qb(a,b){if(b!=void 0){var c=a.W;try{if(b=b.trim())c.Fa<c.Ma.length&&b==c.Ma[c.Fa]?c.Fa++:(c.Ma.push(b),c.Fa=c.Ma.length);var d=b.split(" "),e=d[0],g=a.W.tb[$a.Pc];switch(e[0]){case "m":if(e[1]=="?"){var h="";rb.forEach(function(w){h+=w+"\n"});h&&(h="message commands:\n"+h);break}h="";var k=void 0;e=d[d.length-1].toLowerCase();var l=pb(e);l!=void 0&&d.pop();d.length<=1&&(l!=void 0&&(k=l,l=void 0),d[1]="all");d[1]=="all"&&(d=Object.keys(Ea));for(g=1;g<d.length;g++){e=d[g];var u=Ea[e];if(!u){h+=
"unrecognized message: "+e+"\n";break}l!=void 0&&sb(a,u,l);if(k==void 0||k==kb(a,u))h+=a.O("%8s: %b\n",e,kb(a,u))}kb(a,0x800000000000)&&(h+="all messages will be buffered until buffer is turned off\n");h||(h="no messages\n");break;case "?":h="",tb.forEach(function(w){h+=w+"\n"}),h&&(h="default commands:\n"+h);default:if(d.unshift(b),g)for(a=0;a<g.length;a++){var p=g[a](d);if(p!=void 0){h=h?h+p:p;break}}}}catch(w){h="error: "+w.message+"\n"}}return h}
function nb(a,b){b=b===void 0?"?":b;if(b){var c="";b=b.split(/(?:\n|;\s*)/);for(var d=0;d<b.length;d++)c+=qb(a,b[d])}return c}
f.Na=function(a,b){b==void 0&&(b=kb(this,0x800000000000));if(!b){var c=this.Ha(Wa.ub,!0);if(c){b=c.selectionStart;for(var d=a.split(/([\n\r\b])/),e=0;e<d.length;e++){var g=d[e];if(g)if(g=="\b"||g=="\r")for(;b>0&&c.value.slice(b-1,b)!="\n"&&(b--,g!="\b"););else if(g=="\n"){for(g="";b<c.value.length&&(g=c.value[b],b++,g!="\n"););g!="\n"&&(c.value+="\r\n",b=c.value.length)}else c.value=c.value.slice(0,b)+g+c.value.slice(b+g.length),b+=g.length}c.focus();c.setSelectionRange(b,b);c.value.length>=8192&&
(c.value=c.value.slice(c.value.length-8192+4096));c.scrollTop=c.scrollHeight;return a.length}}return Qa.prototype.Na.call(this,a,b)};f.I=function(a){var b=sa.apply(1,arguments),c=0;typeof a=="number"&&(c=a,a=b.shift());return kb(this,c)?(Pa(c,1099511627776)&&(a="error: "+a),Pa(c,549755813888)&&(a="warning: "+a),Qa.prototype.I.call.apply(Qa.prototype.I,[this,a].concat(ra(b)))):0};
function ub(a,b){if(ib(a)){b=JSON.stringify(b);try{window.localStorage.setItem(a.$,b)}catch(c){a.I("%s\n",c.message)}}}function vb(a,b,c){(a=a.ea[b])&&a.textContent!=c&&(a.textContent=c)}function sb(a,b,c){var d=!1;c?(c=a.W.ua,a.W.ua=(c|b)+(c/t|0|b/t|0)*t):(d=Pa(a.W.ua,0x800000000000)&&Pa(b,0x800000000000),c=a.W.ua,a.W.ua=(c&~b)+((c/t|0)&~(b/t|0))*t);d&&a.flush()}
var Wa={Md:"clear",ub:"print"},tb=["\u2191 \u2193\t\trecall commands","@\t\trepeat last command","m?\t\tmessage commands"],rb=["m\t\tdisplay all messages","m on\t\tdisplay all active messages","m off\t\tdisplay all inactive messages","m all [on|off]\tturn all messages on or off","m ... [on|off]\tturn selected messages on or off"],$a={Pc:"command"},wb={rb:13,qb:65,Rb:66,Tb:67,Ub:68,E:69,Vb:70,Wb:71,Xb:72,Yb:73,Zb:74,bc:75,cc:76,fc:77,hc:78,jc:79,kc:80,Q:81,lc:82,mc:83,oc:84,rc:85,sc:86,tc:87,uc:88,
vc:89,Ab:90,a:97,b:98,c:99,d:100,e:101,f:102,hl:103,il:104,jl:105,kl:106,k:107,ll:108,ml:109,n:110,nl:111,p:112,q:113,r:114,s:115,t:116,rl:117,sl:118,w:119,x:120,y:121,z:122},C={Sb:8,qc:9,ie:10,rb:13,nc:16,sb:17,Id:18,Yk:19,Sa:20,Wc:27,nd:32,$k:33,Zk:34,wk:35,Ik:36,dc:37,rd:38,wb:39,Fk:39,Sc:40,Ck:44,al:44,Jk:45,Qd:46,Ek:46,Hk:47,ZERO:48,ONE:49,qd:50,pd:51,Yc:52,Xc:53,md:54,ld:55,Uc:56,fd:57,de:59,ce:61,qb:65,Rb:66,Tb:67,Ub:68,E:69,Vb:70,Wb:71,Xb:72,Yb:73,Zb:74,bc:75,cc:76,fc:77,hc:78,jc:79,kc:80,
Q:81,lc:82,mc:83,oc:84,rc:85,sc:86,tc:87,uc:88,vc:89,Ab:90,Oc:91,Dk:91,Bk:92,bl:93,Gk:93,je:96,Rk:96,Ak:96,ke:97,Pk:97,le:98,Ok:98,me:99,Uk:99,ne:100,Sk:100,oe:101,Mk:101,pe:102,Wk:102,qe:103,Qk:103,re:104,Xk:104,se:105,Vk:105,Tk:106,Lk:107,ve:109,te:110,Nk:111,Sd:112,Td:113,Ud:114,Vd:115,Wd:116,Xd:117,Yd:118,Zd:119,$d:120,xk:121,yk:122,zk:123,ue:144,He:145,be:173,kd:186,Vc:187,Nd:188,Rc:189,ze:190,Ie:191,Jd:192,he:219,Kd:220,Ee:221,De:222,ae:224,ec:901,Va:1E3},xb={},yb=(xb[C.de]=C.kd,xb[C.ce]=C.Vc,
xb[C.be]=C.Rc,xb[C.ae]=C.Oc,xb),zb={dc:1,wb:2,Kk:3},D={},Ab=(D[C.Sb]="\b",D[C.qc]="\t",D[C.ie]="\n",D[C.rb]="\r",D[C.nd]=" ",D[C.ZERO]="0",D[C.ONE]="1",D[C.qd]="2",D[C.pd]="3",D[C.Yc]="4",D[C.Xc]="5",D[C.md]="6",D[C.ld]="7",D[C.Uc]="8",D[C.fd]="9",D[C.qb]="A",D[C.Rb]="B",D[C.Tb]="C",D[C.Ub]="D",D[C.E]="E",D[C.Vb]="F",D[C.Wb]="G",D[C.Xb]="H",D[C.Yb]="I",D[C.Zb]="J",D[C.bc]="K",D[C.cc]="L",D[C.fc]="M",D[C.hc]="N",D[C.jc]="O",D[C.kc]="P",D[C.Q]="Q",D[C.lc]="R",D[C.mc]="S",D[C.oc]="T",D[C.rc]="U",D[C.sc]=
"V",D[C.tc]="W",D[C.uc]="X",D[C.vc]="Y",D[C.Ab]="Z",D[C.dc]="Left",D[C.wb]="Right",D),bb=["","moz","ms","webkit"],Bb={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",
darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",
fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",
lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",
navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",
seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},jb={Qb:void 0,hb:"PCjs.localStorage"};n.WebIO=Ua;
function E(a,b,c,d){a=a===void 0?"default":a;b=b===void 0?a:b;c=c===void 0?{}:c;d=d===void 0?[]:d;Ua.call(this,a==b);this.$=a;this.U=b;Ca[this.$]||(Ca[this.$]={});Ca[this.$][this.U]&&this.I("warning: machine configuration contains multiple '%s' devices\n",this.U);Ca[this.$][this.U]=this;this.id=this.$==this.U?this.$:this.$+"."+this.U;Da.push(this);this.W=Cb(this,this.$);this.ready=!0;Db(this,c,d);this.Za={};this.hd=[]}m(E,Ua);f=E.prototype;f.Bb=function(){};f.wc=function(){};
function Db(a,b,c){c=b.overrides||c;if(c.length){var d=hb();for(k in d)if(c.indexOf(k)>=0){var e=d[k],g=Na(e,10);g==void 0&&(e=="true"?g=!0:e=="false"?g=!1:(g=e,e='"'+e+'"'));b[k]=g;a.I("overriding %s property '%s' with %s\n",a.U,k,e)}}a.config=b;c=b.bindings;c=c===void 0?{}:c;if(typeof document!="undefined"){a.config.ea||(a.config.ea=c);(d=Array.isArray(c))?c.indexOf("container")<0&&c.push("container"):c.container||(c.container=a.U);for(var h in c){e=c[h];if(d)h=e;else if(e.match(/^[0-9]+$/)){var k=
+e;a.ea[h]=[];do{e=h+k++;e=document.getElementById(e);if(!e)break;a.ea[h].push(e)}while(1);continue}(k=document.getElementById(e))&&a.Pa(h,k)}}b=b===void 0?{}:b;a.version=3;if(a.version){h="";var l;a.$!=a.U&&(l=Cb(a,a.$).version)&&l!=a.version&&(h="Machine");h||(l=b.version)&&l>a.version&&(h="Config");h&&(l=a.O("%s Device version (%3.2f) incompatible with %s version (%3.2f)",b.gl,a.version,h,l),a.error("%s\n\nClearing your browser's cache may resolve the issue.",l))}}
function Eb(a,b,c,d){a.Za[b]={get:c.bind(a),set:d?d.bind(a):null}}function Fb(a,b){var c;try{var d=Ca[a.$];if(d)for(c in d){var e=d[c];if(e.U!=e.$&&!b(e))return!1}return!0}catch(g){a.I("error while enumerating device '%s': %s\n",c,g.message)}return!1}f.Ha=function(a,b){b=b===void 0?!1:b;if(a){var c=Ua.prototype.Ha.call(this,a,b);if(c===void 0&&b){b=Ca[this.$];for(var d in b)if(c=b[d].ea[a])break;c||(c=null);this.ea[a]=c}}return c};
function Cb(a,b,c){var d=b,e=a.$,g=e.indexOf(".");g>0&&(e=e.substr(0,g),b=b.substr(g+1));b=(g=Ca[e])&&g[b]||null;if(!b){for(g=0;g<Da.length;g++)if(Da[g].id===d){b=Da[g];break}if(!b&&(c===void 0||c))throw Error(a.O('no "%s" device',d));}return b}function F(a,b,c){var d=null,e=Ca[a.$];if(e)for(var g in e)if(e[g].config["class"]==b){if(d){d=null;break}d=e[g]}if(!d&&(c===void 0||c))throw Error(a.O("no %s device",b));return d}
function Gb(a,b){var c=Cb(a,a.$);return c&&c.config&&c.config[b]||a.config[b]}function Hb(a,b){return(a=a.Za[b])&&a.get()}function Ib(a){return a==a.W&&a.ready?Fb(a,function(b){return Ib(b)}):a.ready}function Jb(a,b){b=b===void 0?a.ready:b;a.ready=b;if(Ib(a)){for(;b=a.hd.pop();)b();a!=a.W&&Jb(a.W)}}function Kb(a,b){if(Ib(a))return b(),!0;a.hd.push(b);return!1}f.Cd=function(){};
f.I=function(a){var b=sa.apply(1,arguments);return typeof a=="number"&&kb(this,a)&&(this.aa===void 0&&(this.aa=F(this,"Debugger",!1)),this.aa&&this.aa.Cd(a),this.W.ua&1&&(this.X===void 0&&(this.X=F(this,"CPU")),this.X))?(a=b.shift(),Ua.prototype.I.call(this,"%#06x: %s.%s\n",this.X.mb,this.U,this.O.apply(this,[a].concat(ra(b))).trim())):Ua.prototype.I.call.apply(Ua.prototype.I,[this,a].concat(ra(b)))};function Lb(a,b){(a=Ca[a.$])&&delete a[b]}function Mb(a,b,c){(a=a.Za[b])&&a.set&&a.set(c)}
n.Device=E;
function Nb(a,b,c){E.call(this,a,b,c);this.ua=2097152;this.Z=this.T=null;this.time=F(this,"Time");this.W=F(this,"Machine");this.ma=v(this,"drag",!1);this.Y=v(this,"scroll",!1);this.ja=v(this,"hexagonal",!1);this.l=v(this,"releaseDelay",0);this.o=!1;a=this.config.map;this.j=this.h=this.u=null;if(a)if(a.length)this.j=a;else{this.h={};b=Object.keys(a);for(var d=0;d<b.length;d++){var e=[],g=b[d],h=a[g];typeof h=="string"?h=[h]:h.length==void 0&&(e=h.grid,h=h.keys,typeof h=="string"&&(h=[h]));this.h[g]=
{keys:h,grid:e,state:0}}}this.H=[];this.M=[];this.J=!1;this.m=this.K=null;(a=this.ea[Ob])&&Pb(this,a,this.Ha(c.focusBinding,!0),this.config.location);this.la()}m(Nb,E);function Qb(a,b){a.T=b}
function Rb(a,b){var c=Sb,d=C.Sa;if(c==Sb)a.H.push({id:d,Qa:b});else if(c==Tb&&a.h){if(c=a.h[d]){var e=c.keys;e&&e.length&&a.H.push({id:d,Qa:b});(c=c.grid)&&c.length&&a.M.push({id:d,Te:c[0],We:c[1],sk:c[2],uk:c[3],Qa:b})}}else if(c==Ub){var g=a.Ha(d,!0);g&&b&&g.addEventListener("click",function(){var h=(g.getAttribute("class")||"").slice(-3)!="-on",k=(g.getAttribute("class")||"").replace(/(-on|-off)$/,h?"-on":"-off");g.setAttribute("class",k);b(d,h)})}}
function Vb(a,b){var c=Wb,d=Xb;if(!a.u&&(a.u=c,a.oa=Yb(a.time,"timerAutoRelease",function(){Zb(a)}),d)){c={};for(var e in d)c={Db:c.Db,Wa:void 0},c.Db=e,c.Wa=b.ea[c.Db],c.Wa&&c.Wa.addEventListener("click",function(g){return function(){var h=d[g.Db],k=!0,l=!0;if(typeof h=="number")var u=h;else if(u=h[0],u==C.ec){var p=+g.Wa.getAttribute("data-value")||0;u=h[1];k=!p;l=!1;g.Wa.setAttribute("data-value",1-p);g.Wa.style.fontWeight=k?"bold":"normal"}$b(a,u,k,l);ac(a)}}(c))}}
function bc(a,b,c){for(var d=0;d<a.H.length;d++){var e=a.H[d];e.id===b&&e.Qa(b,c)}}
function Pb(a,b,c,d){d=d===void 0?[]:d;if(d.length||a.j||a.h){var e={};e.tk=d[0]||0;e.vk=d[1]||0;e.kb=d[2]||b.clientWidth;e.Eb=d[3]||b.clientHeight;e.Gb=d[4]||1;e.Ob=d[5]||1;e.Ve=d[6]||b.naturalWidth||e.kb;e.Ye=d[7]||b.naturalHeight||e.Eb;e.Gd=d[8]||0;e.Hd=d[9]||0;e.Ue=d[10]||0;e.Xe=d[11]||0;a.j?(e.Ib=a.j.length,e.lb=a.j[0].length):(e.lb=e.Gb,e.Ib=e.Ob,e.Gb=e.Ob=0);e.wd=e.kb/(e.lb+e.lb*e.Gb)|0;e.xd=e.Eb/(e.Ib+e.Ib*e.Ob)|0;e.Se=e.wd*e.Gb|0;e.yd=e.xd*e.Ob|0;e.ob=e.Pb=-1;cc(a,b,e);dc(a,b,e);a.time&&
a.l&&(a.da=Yb(a.time,"timerInputRelease",function(){e.ob<0&&e.Pb<0&&ec(a,-1,-1)}))}if(a.j||a.h||a.u)a.time&&a.l&&(a.pa=Yb(a.time,"timerKeyRelease",function(){fc(a)})),a.v=0,a.N="",a.L=[],d=b,c&&(d=c,a.m||c.nodeName!="BUTTON"||(d=document,a.m=c,hc(a,b),a.K=b)),hc(a,d),a.m||(a.m=d)}function ic(a){a.l?jc(a.time,a.pa,a.l):fc(a)}
function hc(a,b){function c(e,g,h){var k=document.activeElement;a.I(5242880,"%s.onKey%s(%d): %5.2f (%s)\n",k.id||k.nodeName,e,g,Date.now()/1E3%60,h!=void 0?h?"used":"unused":"ignored")}function d(e,g){e=document.activeElement;return a.m&&e!=a.m&&e!=a.K?null:g||window.event}b.addEventListener("keydown",function(e){if(e=d(this,e)){var g=e.which||e.keyCode,h=$b(a,g,!0,!1,e);c("Down",g,h);h&&e.preventDefault()}});b.addEventListener("keypress",function(e){if(e=d(this,e)){var g=e.which||e.charCode,h=$b(a,
g);c("Press",g,h);h&&e.preventDefault()}});b.addEventListener("keyup",function(e){if(e=d(this,e)){var g=e.which||e.keyCode,h=$b(a,g,!1,!1,e);c("Up",g);h&&e.preventDefault();b.nodeName=="TEXTAREA"&&(b.value="")}})}
function cc(a,b,c){b.addEventListener("mousedown",function(d){if(!a.o){var e=a.J?a.K:a.m;if(e){var g=window.scrollX,h=window.scrollY;e.focus();window.scrollTo(g,h)}d.button||kc(a,b,lc,d,c)}});b.addEventListener("mousemove",function(d){a.o||kc(a,b,mc,d,c)});b.addEventListener("mouseup",function(d){a.o||d.button||kc(a,b,nc,d,c)});b.addEventListener("mouseout",function(d){a.o||(c.ob<0?kc(a,b,mc,d,c):kc(a,b,nc,d,c))})}
function dc(a,b,c){b.addEventListener("touchstart",function(d){a.Y&&(a.o=!0);kc(a,b,lc,d,c)});b.addEventListener("touchmove",function(d){kc(a,b,mc,d,c)});b.addEventListener("touchend",function(d){kc(a,b,nc,d,c)})}function Zb(a){for(var b=0,c=-1;b<a.g.length;){var d=a.g[b];if(d.Cb){var e=d.Ac;d=a.l-(Date.now()-d.Bc);if(d>0){if(c<0||c>d)c=d}else{oc(a,e);b=0;continue}}b++}c>=0&&jc(a.time,a.oa,c)}
function pc(a,b,c){c=c===void 0?!1:c;if(typeof b!="number")for(var d=0;d<b.length;d++)pc(a,b[d],c);else{d=qc(a,b);var e=Date.now();d<0?(a.g.push({Ac:b,Bc:e,Cb:c}),a.I(6291456,"addActiveKey(keyNum=%d,autoRelease=%b)\n",b,c)):(a.g[d].Bc=e,a.g[d].Cb=c);c&&Zb(a)}}function qc(a,b){for(var c=0;c<a.g.length;c++)if(a.g[c].Ac==b)return c;return-1}
function oc(a,b){if(typeof b!="number")for(var c=0;c<b.length;c++)oc(a,b[c]);else if(c=qc(a,b),c>=0){var d=a.g[c],e=Date.now()-d.Bc;e<a.l?(d.Cb=!0,Zb(a)):(a.I(6291456,"removeActiveKey(keyNum=%d,duration=%dms,autoRelease=%b)\n",b,e,d.Cb),a.g.splice(c,1))}else a.I(6291456,"removeActiveKey(keyNum=%d): up without down?\n",b)}
function $b(a,b,c,d,e){if(c!=void 0){var g=yb[b]||b;var h=Ab[b];var k=rc[g];e=e&&e.location==zb.wb;k&sc&&e&&(k>>=1);k&&(k&tc&&(c=!(a.i&k)),a.i=c?a.i|k:a.i&~k,bc(a,g,c))}else g=0,h=String.fromCharCode(b).toUpperCase(),b>=wb.qb&&b<=wb.Ab?a.i&(uc|vc)||(a.i|=vc,bc(a,C.Sa,!0)):b>=wb.a&&b<=wb.z&&a.i&vc&&(a.i&=~vc,bc(a,C.Sa,!1));if(a.j){if(c!=void 0)return!1;for(k=0;k<a.j.length;k++){e=a.j[k];for(var l=0;l<e.length;l++)if(e[l].split("|").indexOf(h)>=0)return a.v?a.L.length<16&&a.L.push(b):(a.v=1,a.N=h,ec(a,
l,k),bc(a,h,!0),ic(a)),!0}}if(a.h){if(c==void 0)return!0;b=Object.keys(a.h);for(k=0;k<b.length;k++)if(e=b[k],a.h[e].keys.indexOf(h)>=0)return bc(a,e,c),a.h[e].state=c?1:0,!0}if(a.u){if(!g)return!0;(g=a.u[g])&&(c?pc(a,g,d):oc(a,g))}return!1}function fc(a){a.v==1?(a.v++,bc(a,a.N,!1),a.N="",ec(a,-1,-1),ic(a)):(a.v=0,a.L.length&&$b(a,a.L.shift()))}Nb.prototype.la=function(){this.g=[];this.i=0;this.V=this.ba=-1};
function kc(a,b,c,d,e){var g=-1,h=-1,k=!1,l=-1,u=-1;if(c<nc){d=d||window.event;d.targetTouches&&d.targetTouches.length?(l=d.targetTouches[0].clientX,u=d.targetTouches[0].clientY,k=d.targetTouches.length>1):(l=d.clientX,u=d.clientY);var p=d.target.getBoundingClientRect();l-=p.left;u-=p.top;l=e.Ve/b.offsetWidth*l|0;u=e.Ye/b.offsetHeight*u|0;var w=l-e.tk;var r=u-e.vk;var q=p=!1;var y=l>=e.Gd&&l<e.Gd+e.Ue&&u>=e.Hd&&u<e.Hd+e.Xe;if(w>=0&&w<e.kb&&r+e.yd>=0||y)if(k||a.Y||d.preventDefault(),w>=0&&w<e.kb&&
r>=0&&r<e.Eb){q=!0;d=e.kb/e.lb|0;var x=e.Eb/e.Ib|0,B=w/d|0,z=r/x|0;!a.ja||z&1||(w-=d>>1,B=w/d|0,B==e.lb-1&&(w=-1));x=z*x+(e.yd>>1);w-=B*d+(e.Se>>1);r-=x;w>=0&&w<e.wd&&r>=0&&r<e.xd&&(g=B,h=z,p=!0)}}w=w||0;r=r||0;d=b.offsetWidth;b=b.offsetHeight;if(c==lc||c==nc)for(B=0;B<a.M.length;B++)z=a.M[B],c==nc?z.Qa(z.id,!1):(x=r/(b/z.We|0)|0,(w/(d/z.Te|0)|0)==z.sk&&x==z.uk&&z.Qa(z.id,!0));if(!k)if(c==lc)e.ob=l,e.Pb=u,q?(ec(a,g,h),p&&a.l&&jc(a.time,a.da,a.l,!0)):y&&a.W.qa();else if(c==mc)e.ob>=0&&e.Pb>=0&&a.ma?
ec(a,g,h):a.T&&a.T(g,h);else if(c==nc){if(c=a.l)c=a.time,g=a.da,c=c.g&&g>0&&g<=c.h.length?c.h[g-1].Ca>=0:!1;c||ec(a,-1,-1);e.ob=e.Pb=-1}else a.I("unrecognized action: %d\n",c)}function ac(a){var b=a.J?a.K:a.m;b&&Ib(a.W)&&(a.I(2097152,'setFocus("%s")\n',b.id||b.nodeName),b.focus(),b.scrollIntoView())}function ec(a,b,c){if(b!=a.V||c!=a.ba)a.V=b,a.ba=c,a.Z&&a.Z(b,c)}
var lc=1,mc=2,nc=3,Ob="surface",Sb="keyCode",Tb="idMap",Ub="switch",uc=3,sc=170,vc=512,tc=3584,wc={},rc=(wc[C.nc]=2,wc[C.sb]=8,wc[C.Id]=32,wc[C.Oc]=128,wc[C.Sa]=vc,wc[C.ue]=1024,wc[C.He]=2048,wc);n.Input=Nb;
function xc(a,b,c){E.call(this,a,b,c,["color","backgroundColor"]);a=this.ea[yc];if(!a)throw Error("LED "+this.config.ea[yc]+" binding for '"+yc+"' missing");b=document.createElement("canvas");if(!b||!b.getContext)throw a.innerHTML="LED device requires HTML5 canvas support",Error("LED device requires HTML5 canvas support");this.Aa=cb(this,yc)+".canvas";b.setAttribute("id",this.Aa);this.type=fb(v(this,"type",zc,Ac),Bc,Cc);this.i=Dc[this.type][0];this.o=Dc[this.type][1];this.width=v(this,"width",this.i);
this.height=v(this,"height",this.o);this.j=v(this,"cols",1);this.J=this.j+v(this,"colsExtra",0);this.Z=v(this,"rows",1);this.M=this.Z+v(this,"rowsExtra",0);this.da=this.width*this.j;this.T=this.height*this.Z;this.m=Ec("black",0);this.h=Fc(this.config.color)||this.m;this.pa=Ec(this.h,1,.25);this.oa=Ec(this.h,1,2);this.l=Fc(this.config.backgroundColor);this.va=v(this,"fixed",!1);this.va||(b.style.width="100%",b.style.height="auto");this.ma=v(this,"hexagonal",!1);this.ya=v(this,"highlight",!0);this.N=
v(this,"persistent",this.type<Cc);b.setAttribute("width",this.da.toString());b.setAttribute("height",this.T.toString());b.style.backgroundColor=this.m;a.appendChild(b);this.ja=b.getContext("2d");if(this.u=document.createElement("canvas"))this.u.width=this.ba=this.i*this.j,this.u.height=this.v=this.o*this.Z,this.g=this.u.getContext("2d");this.Da=(this.M+1)*this.J*4;this.buffer=Array(this.Da);this.Oa=this.j<this.J?(this.J-this.j)*4:0;this.K=this.L=!1;this.H=this.Y=0;this.V=-1;var d=this;this.time=F(this,
"Time");Gc(this.time,function(e,g){Hc(d,!1,e,g)});Ic(d)}m(xc,E);function Ic(a){for(var b=a.buffer,c=0;c<b.length;c+=4){var d=a,e=b,g=c;e[g]=d.type<Cc?Jc:" ";e[g+1]=d.h==d.m?null:d.h;e[g+2]=0;e[g+3]=Kc}a.K=a.L=!0;Hc(a,!0)}function Lc(a){a.l?(a.g.fillStyle=a.l,a.g.fillRect(0,0,a.ba,a.v)):a.g.clearRect(0,0,a.ba,a.v)}
function Hc(a,b,c,d){b=b===void 0?!1:b;c=c===void 0?0:c;d=d===void 0?60:d;if(a.K||b){if(a.type<Cc){d=0;if(!a.N||b)Lc(a);else if(a.H){d=a.j-a.H;var e=a.i*d;a.g.drawImage(a.u,a.i*a.H,0,e,a.v,0,0,e,a.v)}for(var g=e=0;g<a.M;g++){for(var h=0;h<a.j;h++){var k=a.buffer[e],l=a.buffer[e+1]||a.m,u=a.ya&&e==a.V;if(a.buffer[e+3]&Kc||u||b){if(h>=d)a:{var p=a,w=k;k=l;var r=h;l=g;var q=u;r=r===void 0?0:r;l=l===void 0?0:l;q=q===void 0?!1:q;var y=0;if(p.ma&&!(l&1)&&(y=p.i>>1,r==p.j-1))break a;if(k&&k!=p.h){q=q?Ec(k,
1,2):k;var x=Ec(k,1,.25)}else q=q?p.oa:p.h,x=p.pa;k=!1;w=w?q:x;q==p.m&&(w=p.l,k=!0);q=r*p.i+y;x=l*p.o;p.N&&(r=r*p.i+y,l*=p.o,p.l?(p.g.fillStyle=p.l,p.g.fillRect(r,l,p.i,p.o)):p.g.clearRect(r,l,p.i,p.o));p.g.fillStyle=w;l=Mc[p.type];l.length==3?(p.g.beginPath(),p.g.arc(q+l[0],x+l[1],l[2],0,Math.PI*2),k?(p.g.globalCompositeOperation="destination-out",p.g.fill(),p.g.globalCompositeOperation="source-over"):p.g.fill()):p.g.fillRect(q+l[0],x+l[1],l[2],l[3])}a.buffer[e+3]=u?a.buffer[e+3]|Kc:a.buffer[e+3]&
~Kc}e+=4}e+=a.Oa}a.H=0}else{b="";for(d=0;d<a.buffer.length;d+=4)b+=a.buffer[d]||" ",a.buffer[d+3]&Nc&&(b+=".");Lc(a);for(g=e=d=0;d<b.length;d++){u=b[d];u=="."&&e&&e--;h=a;l=u;u=e;p=g;u=u===void 0?0:u;p=p===void 0?0:p;if(l=Oc[l])for(k=0;k<l.length;k++)if(r=h,y=Pc[l[k]]){w=(u===void 0?0:u)*r.i;q=(p===void 0?0:p)*r.o;r.g.fillStyle=r.h;r.g.beginPath();if(y.length==3)r.g.arc(w+y[0],q+y[1],y[2],0,Math.PI*2);else for(x=0;x<y.length;x+=2)x?r.g.lineTo(w+y[x],q+y[x+1]):r.g.moveTo(w+y[x],q+y[x+1]);r.g.closePath();
r.g.fill()}if(++e==a.j&&(e=0,++g==a.M))break}}a.ja.globalCompositeOperation=a.l&&a.h!=a.m?"source-over":"copy";a.ja.drawImage(a.u,0,0,a.ba,a.v,0,0,a.da,a.T);a.K=!1;a.V=-1}else a.N||a.L||(!c||!a.Y||c-a.Y>=(1E3/d|0))&&Ic(a);a.L=!1;c&&(a.Y=c)}function Fc(a){return(a=a||void 0)&&Bb[a]||a}
function Ec(a,b,c){b=b===void 0?1:b;c=c===void 0?1:c;if(a){var d=[];a=Bb[a]||a;var e=a;var g=16;var h=e.match(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i);h||(g=10,h=e.match(/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,?\s*(\d+|)\)$/i));if(h){for(e=1;e<h.length;e++)d[e-1]=Number.parseInt(h[e],g);d.length=e-1;g=!0}else g=!1;if(g){a="rgba(";for(g=0;g<3;g++)h=Math.round(d[g]*c),h=h<0?0:h>255?255:h,a+=h+",";a+=(g<d.length?d[g]:b)+")"}}return a}
xc.prototype.wa=function(a){var b=a.shift(),c=a.shift();a=a.shift();if(b==this.h&&c==this.l&&a&&a.length==this.buffer.length){this.buffer=a;for(b=0;b<=this.buffer.length-4;b+=4)this.buffer[b+1]==this.m&&(this.buffer[b+1]=null);Hc(this,!0);return!0}return!1};xc.prototype.xa=function(a){this.buffer&&(a.push(this.h),a.push(this.l),a.push(this.buffer))};
function Qc(a,b,c,d,e){e=(e===void 0?0:e)&Rc;b=(c*a.J+b)*4;if(b<=a.buffer.length-4){if(a.buffer[b]!==d||(a.buffer[b+3]&Rc)!==e)a.buffer[b]=d,a.buffer[b+3]=a.buffer[b+3]&~Rc|e|Kc,a.K=!0;a.V=b;a.L=!0;a.H=0}}
var Bc=0,zc=1,Cc=3,Ac={small:Bc,round:zc,square:2,digit:Cc},yc="container",Jc=0,Rc=129,Nc=1,Kc=128,Sc={},Mc=(Sc[Bc]=[4,4,4],Sc[zc]=[16,16,14],Sc[2]=[2,2,28,28],Sc),Dc=[[8,8],[32,32],[32,32],[96,128]],Pc={A:[30,8,79,8,67,19,37,19],B:[83,10,77,52,67,46,70,22],C:[77,59,71,100,61,89,64,64],D:[28,91,58,91,69,104,15,104],E:[18,59,28,64,25,88,12,100],F:[24,10,34,21,31,47,18,52],G:[24,56,34,50,60,50,71,56,61,61,33,61],P:[80,102,8]},Oc={" ":[],0:"ABCDEF".split(""),1:["B","C"],2:["A","B","D","E","G"],3:["A",
"B","C","D","G"],4:["B","C","F","G"],5:["A","C","D","F","G"],6:"ACDEFG".split(""),7:["A","B","C"],8:"ABCDEFG".split(""),9:"ABCDFG".split(""),A:"ABCEFG".split(""),B:["C","D","E","F","G"],C:["A","D","E","F"],D:["B","C","D","E","G"],E:["A","D","E","F","G"],F:["A","E","F","G"],"-":["G"],".":["P"]};n.LED=xc;
function Tc(a,b,c){E.call(this,a,b,c);var d=this;this.touchType=this.config.touchType;this.Ne=this.config.diagnostics;this.J=this.config.monitorWidth||640;this.o=this.config.monitorHeight||480;this.i=this.ea[Uc.ed];if(!this.i)throw Error("unable to find binding: "+Uc.ed);this.g=this.Ha(Uc.Od)||this.i;b=this.ea[Uc.od];if(!b){b=document.createElement("canvas");if(a=cb(this,Uc.od))this.ea[a]=b,b.setAttribute("id",a);b.setAttribute("class","pcjs-surface");b.setAttribute("width",this.config.monitorWidth);
b.setAttribute("height",this.config.monitorHeight);b.style.backgroundColor=this.config.monitorColor||"black";this.i.appendChild(b)}this.j=b;this.m=a=b.getContext("2d");lb("MSIE")&&(this.i.onresize=function(h,k,l,u){return function(){k.style.height=(h.clientWidth*u/l|0)+"px"}}(this.i,b,this.config.monitorWidth,this.config.monitorHeight),this.i.onresize());(c=+(this.config.aspect||hb().aspect))&&c>=.3&&c<=3.33&&(ob(function(h,k,l){return function(){k.style.height=(h.clientWidth/l|0)+"px"}}(this.i,b,
c)),window.onresize());this.ya=this.pa=this.W.pb=!1;if(c=this.ea[Uc.Zc])if(b=ab(this.g,"requestFullscreen")){this.g.Fb=this.g[b];this.ya=!0;this.pa=document.fullscreenEnabled||lb("Edge/");if(b=ab(document,"on","fullscreenchange")){var e=ab(document,"fullscreenElement");document.addEventListener(b,function(){Vc(d,document[e]!=null)},!1)}(b=ab(document,"on","fullscreenerror"))&&document.addEventListener(b,function(){Vc(d)},!1)}else this.I("Full-screen API not available\n"),c.parentNode.removeChild(c);
if(this.touchType||this.Ne||this.ya&&!lb("iOS")){var g=document.createElement("textarea");if(b=cb(this,Uc.we))this.ea[b]=g,g.setAttribute("id",b);g.setAttribute("class","pcjs-overlay");lb("iOS")&&(Xa(g),g.style.fontSize="16px");this.i.appendChild(g)}(this.input=F(this,"Input",!1))&&Pb(this.input,g||this.i,this.Ha(this.config.focusBinding,!0));this.Ke=this.J;this.Le=this.o;g=this.config.smoothing;(b=hb().smoothing)&&(g=b=="true");this.fb=g;this.sd=ab(a,"imageSmoothingEnabled");if(this.h=this.config.monitorRotate)this.h=
this.h%360,this.h>0&&(this.h-=360),this.h!=-90?(this.I("unsupported monitor rotation: %d\n",this.h),this.h=0):(a.translate(0,this.o),a.rotate(this.h*Math.PI/180),a.scale(this.o/this.J,this.J/this.o))}m(Tc,E);Tc.prototype.Pa=function(a,b){var c=this;switch(a){case Uc.Zc:b.onclick=function(){c.W.pb=window.outerHeight-window.innerHeight<=1;c.W.pb||c.Fb()}}E.prototype.Pa.call(this,a,b)};function Wc(a){a.m&&(a.m.fillStyle="black",a.m.fillRect(0,0,a.j.width,a.j.height))}
Tc.prototype.Fb=function(){var a=!1;if(this.g&&this.g.Fb){a="100%";if(screen&&screen.width&&screen.height){var b=screen.width/screen.height,c=this.J/this.o;b>c&&(a=Math.round(c/b*100)+"%")}this.pa?(this.j.style.width=a,this.j.style.height="auto",this.j.style.display="block",this.j.style.margin="auto"):(this.g.style.width=a,this.g.style.height="auto");this.xb=this.g.style.backgroundColor;this.g.style.backgroundColor="black";this.g.Fb();this.input&&(a=this.input,a.J=!0,ac(a));a=!0}return a};
function Vc(a,b){a.W.pb=!0;b||(a.g&&(a.pa?a.j.style.width=a.j.style.height="":a.g.style.width=a.g.style.height="",a.xb&&(a.g.style.backgroundColor=a.xb)),a.W.pb=!1);a.input&&!b&&(a=a.input,a.J=!1,ac(a))}Tc.prototype.qa=function(a){a?(Xc(this),Yc(this)):Wc(this)};Tc.prototype.la=function(){Wc(this)};var Uc={Od:"container",od:"surface",ed:"monitor",we:"overlay",Zc:"fullScreen"};n.Monitor=Tc;
function Zc(a,b,c){E.call(this,a,b,c);this.Da=v(this,"cyclesMinimum",1E5);this.fb=v(this,"cyclesMaximum",1E9);this.ma=fb(v(this,"cyclesPerSecond",1E6),this.Da,this.fb);this.da=60;this.Y=0;this.Z=1E3/this.da;this.gb=v(this,"updatesPerSecond",2)||2;this.yb=1E3/this.gb;this.eb=0;this.zb=v(this,"timeLock",!0);this.ya=this.K=0;this.va=this.m=1;this.cb=this.u=this.ma/1E4/100;this.oa=[];this.o=[];this.h=[];this.T=[];this.Oa=this.g=this.V=this.H=!1;this.J=this.j=0;a=ab(window,"requestAnimationFrame");if(!a){a=
"setTimeout";var d=this.Z}this.ib=window[a].bind(window,this.jk.bind(this),d);this.xb=window[ab(window,"cancelAnimationFrame")||"clearTimeout"].bind(window);this.ba=this.N=this.l=this.i=this.ja=this.Aa=0;$c(this)||ad(this,this.va)}m(Zc,E);function Gc(a,b){a.oa.push(b)}f=Zc.prototype;
f.Pa=function(a,b){var c=this;switch(a){case bd:b.onclick=function(){cd(c)&&(c.g?dd(c):c.start())};break;case ed:b.onclick=function(){ad(c,c.m<<1);fd(c,gd(c.u))};break;case hd:b.onclick=function(){id(c)};break;case jd:b.addEventListener("mousedown",function(){c.H=!0}),b.addEventListener("mouseup",function(){$c(c);c.H=!1}),b.addEventListener("mousemove",function(){c.H&&$c(c)}),b.addEventListener("change",function(){c.H=!0;$c(c);c.H=!1})}E.prototype.Pa.call(this,a,b)};
function Yb(a,b,c){var d=d===void 0?-1:d;var e=a.h.length+1;a.h.push({id:b,Me:c,Hb:d,Ca:-1});d>=0&&jc(a,e,d);return e}
function kd(a,b,c,d){var e=0,g=a.u,h=g*1E6;b&&c&&(g=b/(c*10)/100,a.I(262144,"calcSpeed(%d cycles, %5.3fms): %5.3fMhz\n",b,c,g),d>a.Z&&(a.m>1&&(a.m>>=1,a.I(549755813888,"frame time (%5.3fms) exceeded maximum (%5.3fms), target multiplier now %d\n",d,a.Z,a.m)),e=d));a.K=g;a.ya=g/a.cb;b=a.ya/a.m;a.ja=h/b/a.da+1E-8;a.I(262144,"nCyclesDepositPerFrame(%5.3f) = nCyclesPerSecond(%d) / nDivisor(%5.3f) / nFramesPerSecond(%d)\n",a.ja,h,b,a.da);return e}
function ld(a,b){a.N=a.l=b;if(!a.o.length)return a.l=0,a.N;for(var c=0;a.l>0;){if(c<a.o.length){var d=a.o[c++];b=d.kk.call(d,b)||1}else c=b=0;a.l-=b}return a.N-a.l}function md(a,b){b=b===void 0?a.N-a.l:b;if(!a.g){if(a.i)for(var c=0;c<a.o.length;c++){var d=a.o[c];d.lk.call(d)}a.i=b}a.i-=b;a.i<1&&(a.V=!0);a.Aa+=b;a.ba+=b;a.N=a.l=0;a.g||(a.ba=0);return b}function nd(a){for(var b=0,c=0;c<a.o.length;c++){var d=a.o[c];b+=d.Ad.call(d)}return a.Aa+(a.N-a.l)+b}
function od(a,b){return Math.ceil(a.ma*(a.zb?a.va:a.ya)/1E3*(b===void 0?1E3:b))}function pd(a,b){b=b===void 0?0:b;if(b){var c=b;a.i+=b}else for(c=a.i,c<1&&(c=a.i+=a.ja),c<0&&(a.I(262144,"warning: cycle count dropped below zero: %f\n",c),c=a.i=0),c|=0,b=a.h.length;b>0;b--){var d=a.h[b-1];!(d.Ca<0)&&c>d.Ca&&(c=d.Ca)}return c}function gd(a){a>=1?a=a.toFixed(2)+"Mhz":(a=Math.round(a*1E6),a=a<=999?a+"Hz":Math.ceil(a/1E3)+"Khz");return a}
function qd(a){a.I(262144,"getSpeedCurrent(%5.3fhz)\n",a.K*1E6);return a.g&&a.K?gd(a.K):"Stopped"}function cd(a){return a.Oa?!0:(a.I("not powered\n"),!1)}function rd(a,b){if(b>=1)for(var c=a.h.length;c>0;c--){var d=a.h[c-1];d.Ca<0||(d.Ca-=b,d.Ca<=0&&(d.Ca=-1,d.Me(),d.Hb>=0&&jc(a,c,d.Hb)))}}f.qa=function(a){this.Oa=a;this.aa===void 0&&(this.aa=F(this,"Debugger",!1))&&this.aa.Bb(this,"time","dump time state",this.cf)};function id(a,b){cd(a)&&(a.g?a.I("already running\n"):a.j?dd(a):sd(a,b))}
f.jk=function(a){a=a===void 0?Date.now():a;this.J=0;if(this.g){if(this.Y){var b=a-this.Y;b<1&&(b=16.67);this.da=1E3/b}this.Y=a;a=Date.now();this.L&&(b=a-this.M-this.Z,b>this.Z&&(this.v+=b,this.I(549755813888,"browser throttling detected, compensating by %5.3fms\n",b)));this.M=a;this.v||(this.v=a);this.pa=0;try{this.V=!1;do rd(this,md(this,ld(this,pd(this))));while(this.g&&!this.V)}catch(c){this.I("%s\n",c.message),dd(this)}this.L=Date.now();this.pa&&(this.v+=this.pa,this.M+=this.pa);this.M+=kd(this,
this.ba,this.L-this.v,this.L-this.M);this.L-this.eb>=this.yb&&this.update();for(a=0;a<this.oa.length;a++)this.oa[a](this.Y,this.da);this.J=this.ib()}};function ad(a,b){if(b!==void 0){if(b<1||!a.H&&a.K>0&&a.K<a.u*.9)b=a.va;a.m=b;b=a.cb*a.m;a.u!=b&&(a.u=b,fd(a,gd(a.u)))}a.v=a.L=0;a.i=a.ba=0;kd(a);for(b=a.h.length;b>0;b--){var c=a.h[b-1];c.Hb>=0&&jc(a,b,c.Hb,!0)}}function $c(a){var b=a.ea[jd];return b?(ad(a,Math.floor((b.value-b.min)/(b.max-b.min)*(a.fb-a.Da)+a.Da)/a.ma|0),!0):!1}
function jc(a,b,c,d){b>0&&b<=a.h.length&&(b=a.h[b-1],d||b.Ca<0)&&(c=od(a,c),a.g&&(c+=md(a)),b.Ca=c)}f.start=function(){if(this.g||this.j)return!1;this.g=!0;this.v=this.L=this.Y=0;this.update(!0);this.J=this.ib();return!0};function sd(a,b){b=b===void 0?1:b;a.g||(b&&!a.j&&(a.j=b),a.j&&(a.j--,rd(a,md(a,ld(a,pd(a,1)))),a.update(!1),a.j&&setTimeout(function(){sd(a,0)},0)))}function dd(a){return a.g?(a.g=!1,md(a),a.J&&(a.xb(a.J),a.J=0),a.update(!0),!0):a.j?(a.j=0,a.update(!0),!0):!1}
f.update=function(a){a&&this.I(this.g?"started with %s target\n":"stopped\n",gd(this.u));vb(this,bd,this.g?"Halt":"Run");vb(this,hd,this.j?"Stop":"Step");this.H||fd(this,qd(this));for(var b=0;b<this.T.length;b++){var c=this.T[b];c.Cc.call(c,a!=void 0)}this.eb=Date.now();this.V=!0};function fd(a,b){vb(a,td,b);vb(a,ed,b)}
f.cf=function(){var a=this.O("nCyclesPerSecond: %f\n",this.ma);a+=this.O("nUpdatesPerSecond: %f\n",this.gb);a+=this.O("nTargetMultiplier: %f\n",this.m);return a+=this.O("nCyclesDepositPerFrame: %f\n",this.ja)};var bd="run",ed="setSpeed",td="speed",hd="step",jd="throttle";n.Time=Zc;
function ud(a,b,c){E.call(this,a,b,c);this.type=this.config.type=="static"?vd:wd;this.ga=this.config.addrWidth||16;this.m=Math.pow(2,this.ga);this.l=this.m-1|0;this.blockSize=this.config.blockSize||(this.ga>16?4096:1024);this.blockSize>this.m&&(this.blockSize=this.m);this.H=this.m/this.blockSize|0;this.h=Math.log2(this.blockSize)|0;this.i=(1<<this.h)-1;this.j=this.config.dataWidth||8;this.v=Math.pow(2,this.j)-1;this.o=this.config.littleEndian!==!1;this.g=Array(this.H);this.u=0;a=new xd(a,b+"[NONE]",
{size:this.blockSize,bus:this.U});for(b=0;b<this.m;b+=this.blockSize)yd(this,b,this.blockSize,zd.NONE,a);Ad(this,this.type)}m(ud,E);function yd(a,b,c,d,e){for(var g=b>>>a.h;c>0&&g<a.g.length;){var h=g*a.blockSize,k=a.blockSize-(b-h);k>c&&(k=c);var l=a.g[g];if(b!=h||k!=a.blockSize||l&&l.type!=zd.NONE)return!1;l=a.U+"["+Oa(a,b,16,a.ga)+"]";b=e?e.size==a.blockSize?e:new xd(a.$,l,{type:d,sa:b,size:k,bus:a.U}):new xd(a.$,l,{type:d,sa:b,size:k,bus:a.U});a.g[g]=b;b=h+a.blockSize;c-=k;g++}return!0}
function Bd(a,b){for(var c=zd.Fe,d=0,e=0;e<a.g.length;e++){var g=a.g[e];g&&g.type&c&&(b(g),d++)}return d}function Cd(a,b,c){a.aa&&a.aa.I(4,"bus fault (%d) at %n\n",c,b)}f=ud.prototype;f.qa=function(){this.aa===void 0&&(this.aa=F(this,"Debugger",!1))};f.la=function(){};f.Jb=function(a){return a&&this.wa(a)?!0:!1};f.Xa=function(a){this.xa(a)};f.wa=function(a){for(var b=0;b<this.g.length;b++){var c=this.g[b];if((this.type==wd||c.type&zd.Ua)&&c.wa){var d=a.shift();if(!c.wa(d))return!1}}return!0};
f.xa=function(a){for(var b=0;b<this.g.length;b++){var c=this.g[b];if((this.type==wd||c.type&zd.Ua)&&c.xa){var d=[];c.xa(d);a.push(d)}}};f.Dc=function(a){return this.g[a>>>this.h].Dc(a&this.i)};f.ee=function(a){return this.g[a>>>this.h].na(a&this.i)};f.Ic=function(a,b){this.g[a>>>this.h].Ic(a&this.i,b)};f.Ga=function(a,b){this.g[a>>>this.h].ra(a&this.i,b)};f.$c=function(a){return a&1?this.na(a+1&this.l)|this.na(a)<<this.j:this.g[a>>>this.h].ta(a&this.i)};
f.ad=function(a){return a&1?this.na(a)|this.na(a+1&this.l)<<this.j:this.g[a>>>this.h].ta(a&this.i)};f.ck=function(a){return(a&this.i)==this.i?this.o?this.ad(a):this.$c(a):this.g[a>>>this.h].ta(a&this.i)};f.bd=function(a,b){a&1?(this.ra(a,b>>this.j),this.ra(a+1&this.l,b&this.v)):this.g[a>>>this.h].ia(a&this.i,b)};f.cd=function(a,b){a&1?(this.ra(a,b&this.v),this.ra(a+1&this.l,b>>this.j)):this.g[a>>>this.h].ia(a&this.i,b)};
f.nk=function(a,b){(a&this.i)==this.i?this.o?this.cd(a,b):this.bd(a,b):this.g[a>>>this.h].ia(a&this.i,b)};function Ad(a,b){var c=a.u;a.u+=b;c&&a.u||(a.na=a.ee,a.ra=a.Ga,a.type==wd?(a.ta=a.ck,a.ia=a.nk):a.o?(a.ta=a.ad,a.ia=a.cd):(a.ta=a.$c,a.ia=a.bd))}f.Mb=function(a,b){return this.g[a>>>this.h].Mb(b)?(Ad(this,1),!0):!1};f.Fc=function(a,b){return this.g[a>>>this.h].Fc(b)?(Ad(this,1),!0):!1};f.Nb=function(a,b){return this.g[a>>>this.h].Nb(b)?(Ad(this,-1),!0):!1};
f.Hc=function(a,b){return this.g[a>>>this.h].Hc(b)?(Ad(this,-1),!0):!1};var vd=0,wd=1;n.Bus=ud;
function xd(a,b,c){E.call(this,a,b,c);this.sa=this.config.addr;this.size=this.config.size;this.type=this.config.type||zd.NONE;this.j=(a=this.config.bus)?Cb(this,a):F(this,a="Bus");if(!this.j)throw Error(this.O("unable to find bus '%s'",a));this.g=this.j.j;this.i=Math.pow(2,this.g)-1;this.K=this.ba=!1;this.m=this.j.o!==!1;this.values=this.Z=this.buffer=this.Y=null;a=this.Ta;b=this.Ga;c=this.m?this.ek:this.dk;var d=this.m?this.qk:this.pk;this.j.type==vd&&(b=this.Jc,c=this.m?this.ge:this.fe,d=this.Mc,
this.g==8&&Gb(this,"ArrayBuffer")!==!1&&(this.ba=!0,c=this.m==xa?this.gk:this.hk));switch(this.type){case zd.NONE:this.na=this.Ra;this.ra=this.Ja;this.ta=this.fk;this.ia=this.rk;break;case zd.jd:this.na=a;this.ra=this.Ja;this.ta=c;this.ia=this.Ja;break;case zd.Ua:this.na=a,this.ra=b,this.ta=c,this.ia=d}this.L=this.l=0;this.V=this.o=this.T=this.J=this.u=this.v=null;Dd(this,this.config.values);Ed(this)}m(xd,E);
function Dd(a,b){typeof b=="string"?(Jb(a,!1),gb(b,function(c,d,e,g){if(e==4)if(!g&&d){try{var h=JSON.parse(d);Dd(a,h.values)}catch(k){a.I("error (%s) parsing resource: %s\n",k.message,c)}Jb(a,!0)}else a.I("error (%d) loading resource: %s\n",g,c)})):a.config.values=b}
function Ed(a,b){if(a.type>zd.NONE&&(a.ba?(a.buffer=new ArrayBuffer(a.size),a.Y=new DataView(a.buffer,0,a.size),a.values=new Uint8Array(a.buffer,0,a.size),a.Z=new Uint16Array(a.buffer,0,a.size>>1),new Int32Array(a.buffer,0,a.size>>2)):a.values=Array(a.size).fill(0),b))for(var c=0;c<b.length;c++)a.values[c]=b[c]}f=xd.prototype;
f.la=function(){if(this.config.values)a:{var a=this.j,b=this.sa,c=this.size,d=this.config.values,e=0,g=b&a.i;b>>>=a.h;c>d.length&&(c=d.length);for(;c>0&&b<a.g.length;){var h=a.g[b++];if(!h)break a;for(;c>0&&g<h.size;)h.Ga(g++,d[e++]),c--;g=0}}else this.type&zd.Ua&&this.values&&this.values.fill(0)};f.Ra=function(){return this.i};f.fk=function(a){return this.m?this.Ra(a)|this.Ra(a+1)<<this.g:this.Ra(a+1)|this.Ra(a)<<this.g};f.Dc=function(a){return this.values?this.values[a]:0};f.Ta=function(a){return this.values[a]};
f.fe=function(a){return this.values[a+1]|this.values[a]<<this.g};f.ge=function(a){return this.values[a]|this.values[a+1]<<this.g};f.gk=function(a){return this.Z[a>>>1]};f.hk=function(a){return this.Y.getUint16(a,this.m)};f.dk=function(a){return this.Ta(a+1)|this.Ta(a)<<this.g};f.ek=function(a){return this.Ta(a)|this.Ta(a+1)<<this.g};f.Ja=function(){};f.rk=function(a,b){this.m?(this.Ja(a,b&this.i),this.Ja(a+1,b>>this.g)):(this.Ja(a,b>>this.g),this.Ja(a+1,b&this.i))};
f.Ic=function(a,b){this.values&&(this.values[a]=b)};f.Ga=function(a,b){this.values[a]=b};f.Jc=function(a,b){this.values[a]=b;this.K=!0;this.l?this.J=this.Ga:this.ra=this.Ga};f.$b=function(a,b){this.values[a]=b>>this.g;this.values[a+1]=b&this.i};f.ac=function(a,b){this.values[a]=b&this.i;this.values[a+1]=b>>this.g};f.Kc=function(a,b){this.Z[a>>>1]=b};f.Lc=function(a,b){this.Y.setUint16(a,b,this.m)};f.pk=function(a,b){this.Ga(a,b>>this.g);this.Ga(a+1,b&this.i)};
f.qk=function(a,b){this.Ga(a,b&this.i);this.Ga(a+1,b>>this.g)};f.Mc=function(a,b){this.buffer?this.m==xa?(this.Kc(a,b),this.l?this.o=this.Kc:this.ia=this.Kc):(this.Lc(a,b),this.l?this.o=this.Lc:this.ia=this.Lc):this.m?(this.ac(a,b),this.l?this.o=this.ac:this.ia=this.ac):(this.$b(a,b),this.l?this.o=this.$b:this.ia=this.$b)};
f.Mb=function(a){if(!this.L){var b=this;this.L++;this.u=a;this.T=this.na;this.V=this.ta;this.na=function(c){var d=b.T(c);b.u(b.sa,c,d);return d};this.ta=function(c){var d=b.V(c);b.u(b.sa,c,d);b.u(b.sa,c+1,d);return d};return!0}return this.u==a?(this.L++,!0):!1};f.Fc=function(a){if(!this.l){var b=this;this.l++;this.v=a;this.J=this.ra;this.o=this.ia;this.ra=function(c,d){b.v(b.sa,c,d);b.J(c,d)};this.ia=function(c,d){b.v(b.sa,c,d);b.v(b.sa,c+1,d);b.o(c,d)};return!0}return this.v==a?(this.l++,!0):!1};
f.Nb=function(a){return this.L&&this.u==a?(--this.L||(this.na=this.T,this.ta=this.V,this.T=this.V=this.u=null),!0):!1};f.Hc=function(a){return this.l&&this.v==a?(--this.l||(this.ra=this.J,this.ia=this.o,this.J=this.o=this.v=null),!0):!1};f.wa=function(a){if(a){var b=a.shift();if(this.U==b){this.K=a.shift();a.shift();if(a=a.shift()){var c=this.size;c=c===void 0?0:c;if(a.length!=c){b=0;c=c?Array(c):[];for(var d=0;d<a.length-1;)for(var e=a[d++],g=a[d++];e--;)c[b++]=g;a=c}Ed(this,a)}return!0}}return!1};
f.xa=function(a){a.push(this.U);a.push(this.K);a.push(!1);if(this.values){var b=this.values;for(var c=0,d=0,e=[];c<b.length;){for(var g=b[c],h=c+1;h<b.length&&b[h]===g;)h++;e[d++]=h-c;e[d++]=g;c=h}b=e.length>=b.length?b:e}else b=this.values;a.push(b)};var zd={NONE:1,jd:2,Ua:4,Fe:14,el:12};n.Memory=xd;function Fd(a,b,c){xd.call(this,a,b,c);this.H=[];this.M=[];this.h=[];this.N=[];this.config.addr!=void 0&&yd(this.j,this.config.addr,this.config.size,zd.NONE,this)}m(Fd,xd);
function Gd(a,b,c,d){d=d===void 0?0:d;for(var e in c){var g=c[e],h=void 0,k=a,l=b,u=+e+d,p=g[0],w=g[1],r=g[2],q=g[3];for(g=+e+d;g<=u;g++){h=!1;if(p){if(k.H[g])break;k.H[g]=p.bind(l)}if(w){if(k.M[g])break;k.M[g]=w.bind(l)}if(r){if(k.h[g])break;k.h[g]=r.bind(l)}if(q){if(k.N[g])break;k.N[g]=q.bind(l)}h=!0}if(!h)throw Error(k.O("handler for port %#0x already exists",g));}}
Fd.prototype.Ra=function(a){var b,c=this.sa+a;if(b=this.H[c]){var d=b(c);var e=!0}else if(b=this.h[c])d=c&1?b(c&-2)>>this.g:b(c)&this.i,e=!0;else if(c&1)if(c&=-2,b=this.h[c])d=b(c)>>this.g,e=!0;else if(b=this.H[c])d=b(c),e=!0;e||(Cd(this.j,c,0),this.I(272,"readNone(%#04x): unknown port\n",c),d=xd.prototype.Ra.call(this,a));return d};
Fd.prototype.Ja=function(a,b){var c,d=this.sa+a;if(c=this.M[d]){c(d,b);var e=!0}else if(c=this.N[d])e=this.h[d]?this.h[d](d,!0):0,d&1?c(d,e&this.i|b<<this.g):c(d,e&~this.i|b),e=!0;else if(d&1)if(d&=-2,c=this.N[d])e=this.h[d]?this.h[d](d,!0):0,c(d,e&this.i|b<<this.g),e=!0;else if(c=this.M[d])c(d,b),e=!0;e||(Cd(this.j,d,1),this.I(272,"writeNone(%#04x,%#04x): unknown port\n",d,b),xd.prototype.Ja.call(this,a,b))};n.Ports=Fd;
function Hd(a,b,c){c.type=zd.NONE;xd.call(this,a,b,c);yd(this.j,this.config.addr,this.config.size,zd.Ua);Kb(this,this.la.bind(this))}m(Hd,xd);n.RAM=Hd;
function Id(a,b,c){c.type=zd.jd;xd.call(this,a,b,c);yd(this.j,this.config.addr,this.config.size,this.config.type,this);Kb(this,this.la.bind(this));this.X=this.aa=void 0;if(n.LED&&this.ea[Jd]){var d=this;this.H=Math.pow(2,Math.ceil(Math.log2(this.values.length)/2));this.M=this.values.length/this.H|0;this.h=new xc(a,b+"LEDs",{"class":"LED",bindings:{container:cb(this,Jd)},type:zc,cols:this.H,rows:this.M,color:v(this,"colorROM","green"),backgroundColor:v(this,"backgroundColorROM","black"),persistent:!0}),
Ic(this.h);this.N=new Nb(a,b+"Input",{"class":"Input",location:[0,0,this.h.da,this.h.T,this.H,this.M],bindings:{surface:cb(this,Jd)}});this.da=db(this)||"";Qb(this.N,function(e,g){if(d.X){var h=d.da;e>=0&&g>=0&&(e=g*d.H+e,g=d.X,h=g.aa&&Kd(g.aa,d.sa+e,1)||"");vb(d,eb,h)}})}}m(Id,xd);
Id.prototype.wa=function(a){var b=!0,c=a.shift();if(c&&this.h){var d=c.length;this.h.buffer.length==d?(this.h.buffer=c,Hc(this.h,!0)):(this.I("inconsistent saved LED state (%d), unable to load\n",d),b=!1)}a.length&&(d=(a=a.shift())&&a.length||-1,this.values.length==d?this.values=a:(this.I("inconsistent saved ROM state (%d), unable to load\n",d),b=!1));return b};Id.prototype.qa=function(){this.X===void 0&&(this.X=F(this,"CPU"));this.aa===void 0&&(this.aa=F(this,"Debugger",!1))&&this.aa.wc&&this.aa.wc(this.config.symbols)};
Id.prototype.Ta=function(a){this.h&&Qc(this.h,a%this.H,a/this.H|0,1,Kc);return this.values[a]};Id.prototype.xa=function(a){this.h&&(a.push(this.h.buffer),a.push(this.values))};var Jd="array",eb="cellDesc";n.ROM=Id;function Ld(a,b,c){c["class"]="CPU";E.call(this,a,b,c);this.aa=void 0;this.v=this.mb=0;this.ba=this.config.addrReset||0;this.time=F(this,"Time");this.time.o.push(this);this.time.T.push(this);this.V=this.g=0}m(Ld,E);f=Ld.prototype;
f.abort=function(a){this.v=this.mb;this.I("%s\n",a.message);dd(this.time)};function Md(a,b){a.aa=b;return a.Za}f.zd=function(){};f.kk=function(a){this.V=this.g=a===void 0?0:a;try{this.zd()}catch(b){this.abort(b)}return this.Ad()};f.lk=function(){this.V-=this.g;this.g=0};f.Ad=function(){return this.V-this.g};
function Nd(a,b,c){c["class"]="Debugger";E.call(this,a,b,c);var d=this;this.ka=this.config.defaultRadix||16;this.ma=1;this.V=["(",")"];this.gd("a",function(g,h,k,l,u){return Oa(d,u.ca,d.ka,k)});this.gd("n",function(g,h,k,l,u){return Oa(d,u,d.ka,k,h.indexOf("#")<0?"":void 0)});this.oa=this.H=0;this.K={};this.va=[];this.ya=[];this.X=F(this,"CPU");this.Za=Md(this.X,this);this.input=F(this,"Input",!1);if(a=this.X.config.busMemory||this.config.busMemory){this.g=Cb(this,a);if(a=this.X.config.busIO||this.config.busIO)this.j=
Cb(this,a,!1);this.j||(this.j=this.g)}else this.g=this.j=F(this,"Bus");this.J=this.g.ga;this.Da=Math.pow(2,this.J)-1|0;this.u=this.da=0;this.o=[];for(var e in G)this.o[G[e]]=[];this.m=[];this.m[G.Ea]=this.g;this.m[G.jb]=this.g;this.m[G.$a]=this.j;this.m[G.ab]=this.j;this.l=[];this.l[G.Ea]=this.Qe.bind(this);this.l[G.jb]=this.Re.bind(this);this.l[G.$a]=this.Oe.bind(this);this.l[G.ab]=this.Pe.bind(this);this.i=[];this.L=void 0;this.T=null;this.Y=0;this.time=F(this,"Time");this.time.T.push(this);this.Z=
0;this.v=[];this.N="";this.Bb(this,"state","dump machine state",this.bf);this.ba=Od();this.Aa=Od();this.ja=!1;this.M=0;this.h=[];Za(this,this.mf.bind(this));(e=Gb(this,"commands"))&&nb(this,e)}m(Nd,E);f=Nd.prototype;f.Bb=function(a,b,c,d){this.v.push({$e:a,name:b,Ze:c,Qa:d})};function Pd(a,b,c){for(var d,e=0;e<a.v.length;e++){var g=a.v[e];if(g.name==b){d=g.Qa.call(g.$e,c);break}}return d}
f.wc=function(a){if(a&&a.length)for(var b=0;b<a.length-2;b+=3){var c=Qd(this,a[b]);if(c){var d=Rd[a[b+1]];if(d){c={address:c,type:d,name:a[b+2]};d=this.va;var e=c,g=Sd(d,e,this.ud);g<0&&d.splice(-(g+1),0,e);d=this.ya;e=Sd(d,c,this.vd);e<0&&d.splice(-(e+1),0,c)}}}};function Sd(a,b,c){var d=0,e=a.length,g=0;for(c===void 0&&(c=function(l,u){return l>u?1:l<u?-1:0});d<e;){var h=d+e>>1,k=void 0;k=c(b,a[h]);k>0?d=h+1:(e=h,g=!k)}return g?d:~d}f.ud=function(a,b){return a.name>b.name?1:a.name<b.name?-1:0};
f.vd=function(a,b){return a.address.ca>b.address.ca?1:a.address.ca<b.address.ca?-1:0};function Td(a,b,c){b=Sd(a.ya,{address:b,type:0,name:void 0},a.vd);if(b>=0&&(a=a.ya[b],!c||a.type==c))var d=a.name;return d}function Ud(a,b,c,d){d=d===void 0?a.g:d;b.ca=b.ca+c&d.l}function Od(a){a=a===void 0?0:a;var b=Vd.Ae;return typeof a=="number"?{ca:a,Ec:-1,type:b}:{ca:a.ca,Ec:a.Ec,type:a.type}}
function Qd(a,b,c){if(b){var d=Od();var e=0,g=b.charAt(e);switch(g){case "&":e++;break;case "#":e++;d.type=Vd.Be;break;case "%":e++,g=b.charAt(e),g=="%"?e++:d.type=Vd.Va}g=b.indexOf(":",e);if(g>=0){var h=Wd(a,b.substring(e,g),c);h==void 0?d=null:(d.Ec=h,e=g+1)}d&&(b=Wd(a,b.substring(e),c),b==void 0?d=null:d.ca=b&a.Da)}return d}function Xd(a,b,c,d){d=d===void 0?a.g:d;a.u++;var e=d.Dc(b.ca);c&&Ud(a,b,c,d);a.u--;return e}
function Yd(a,b,c){if(a.J<=32)return b&c;b=Zd(a,b,0,!0);c=Zd(a,c,0,!0);return((b/t|0)&(c/t|0))*t+((b&c)>>>0)}function $d(a,b,c){if(a.J<=32)return b^c;b=Zd(a,b,0,!0);c=Zd(a,c,0,!0);return((b/t|0)^(c/t|0))*t+((b^c)>>>0)}
function ae(a,b,c,d){for(d=d===void 0?-1:d;d--&&c.length;){var e=c.pop();if(b.length<2)return!1;var g=b.pop();var h=b.pop();switch(e){case "*":h*=g;break;case "/":if(!g)return!1;h=Math.trunc(h/g);break;case "^/":if(!g)return!1;h%=g;break;case "+":h+=g;break;case "-":h-=g;break;case "<<":h<<=g;break;case ">>":h>>=g;break;case ">>>":h>>>=g;break;case "<":h=h<g?1:0;break;case "<=":h=h<=g?1:0;break;case ">":h=h>g?1:0;break;case ">=":h=h>=g?1:0;break;case "==":h=h==g?1:0;break;case "!=":h=h!=g?1:0;break;
case "&":h=Yd(a,h,g);break;case "!":case "|":e=a;e.J<=32?h|=g:(h=Zd(e,h,0,!0),g=Zd(e,g,0,!0),h=(h/t|0|g/t|0)*t+((h|g)>>>0));break;case "^!":h=$d(a,h,g);break;case "&&":h=h&&g?1:0;break;case "||":h=h||g?1:0;break;case ",,":h=Zd(a,h,18,!0)*262144+Zd(a,g,18,!0);break;case "_":case "^_":e=="^_"&&(g=35-(g&255));g&&(h=Zd(a,h,0,!0),h=g>0?h*Math.pow(2,g):Math.trunc(h/Math.pow(2,-g)));break;default:return!1}b.push(Zd(a,h))}return!0}
function be(a,b,c,d,e,g){var h,k=!1,l=0,u=[],p=[],w=a.ka;for(a.ka=e;c<d;){var r=b[c++].trim();var q=c<d?b[c++]:"";if(r){var y=void 0;var x=a;var B=r,z=g;l=l===void 0?0:l;if(B!=void 0){y=Hb(x,B.toUpperCase());if(y==void 0){y=void 0;var A=x,V=Sd(A.va,{address:null,type:0,name:B},A.ud);V>=0&&(y=A.va[V].address.ca);if(y==void 0)if(y=x,A=B,y.K[A]?y=y.K[A].value:(A=A.substr(0,6),y=y.K[A]&&y.K[A].value),y==void 0)y=Na(B,B.length>1||x.ka>10?x.ka:10);else if(B=x.K[B]&&x.K[B].ol)z?z.push(B):(z=Wd(x,B,z),z!==
void 0?y+=z:y=void 0)}y!=void 0&&(y=Zd(x,ce(x,y,l)))}x=y}else if(q=="{"){r=1;for(x=c;c<d;)if(c++,q=c<b.length?b[c++]:"",q=="{")r++;else if(q=="}"&&!--r)break;x=be(a,b,x,c-1,a.ka,g);x!=null&&l&&(x=ce(a,x,l));r=c<d?b[c++].trim():"";q=c<d?b[c++]:""}else{if(q==" ")continue;if(q=="^B"){a.ka=2;continue}if(q=="^O"){a.ka=8;continue}if(q=="^D"){a.ka=10;continue}if(!(l&-1073741824)){if(q=="+")continue;if(q=="-"){l=l<<2|1;continue}if(q=="~"||q=="^-"){l=l<<2|2;continue}if(q=="^L"){l=l<<2|3;continue}}k=!0;break}if(x===
void 0)if(g)g.push(r),x=0;else{k=!0;break}u.push(Zd(a,x));if(q==" ")if(c<b.length-1&&!b[c])c++,q=b[c++];else{k=!0;break}if(!q)break;x=a.V[0]=="<"?de:ee;if(!x[q]){k=!0;break}p.length&&x[q]<=x[p[p.length-1]]&&ae(a,u,p,1);p.push(q);a.ka=q=="^_"?10:e;l=0}if(k||!ae(a,u,p)||u.length!=1)k=!0;k?g||a.I("parse error (%s)\n",r||q):h=u.pop();a.ka=w;return h}
function fe(a,b,c,d){for(var e,g=a.J/d|0;(e=b.indexOf(c))>=0;){for(var h=0,k=e+1,l=g;k<b.length;){var u=b[k++];if(u==c){l=-1;break}if(!l)break;l--;u=u.charCodeAt(0);d==6&&(u-=32);u&=(1<<d)-1;h=Zd(a,h*Math.pow(2,d)+u,d*g,!0)}if(l>=0){a.I("parse error (%c%s%c)\n",c,b,c);return}b=b.substr(0,e)+Oa(a,h)+b.substr(k)}return b}
function Wd(a,b,c){if(b){a.V[0]!="{"&&(b=b.split(a.V[0]).join("{").split(a.V[1]).join("}"));b=fe(a,b,'"',8);if(!b)return d;b=fe(a,b,"'",6);if(!b)return d;a.ka!=16&&(b=b.replace(/(^|[^A-Z0-9$%.])([0-9]+)B/,"$1$2^_").replace(/\s+/g," "));b=b.split(/({|}|\|\||&&|\||\^!|\^B|\^O|\^D|\^L|\^-|~|\^_|_|&|!=|!|==|>=|>>>|>>|>|<=|<<|<|-|\+|\^\/|\/|\*|,,| )/);var d=be(a,b,0,b.length,a.ka,c)}return d}
function ce(a,b,c){for(;c;){var d;switch(c&3){case 1:b=-Zd(a,b);break;case 2:b=$d(a,b,-1);break;case 3:for(d=35;d>=0&&!Yd(a,b,Math.pow(2,d));)d--;b=35-d}c>>>=2}return b}function Zd(a,b,c,d){var e=b;c=c||a.J;if(d)if(c==32)e=b>>>0;else if(c<32)e=b&(1<<c)-1;else{if(a=Math.pow(2,c),b<0||b>=a)e=b%a,e<0&&(e+=a)}else c<=32?e=b<<32-c>>32-c:(a=Math.pow(2,c-1),b>=a?(e=b%a,(b/a|0)&1&&(e-=a)):b<-a&&(e=b%a,((-b-1)/a|0)&1?e&&(e+=a):e||(e-=a)));b!=e&&(b=e);return b}
f.xc=function(a){function b(k){for(var l=0;l<k.length;l++)if(k[l]!=void 0)return!1;return!0}if(a<-1)return ge(this,this.xc);var c="";if(a>=0){var d=this.i[a];if(d!=void 0){c=d>>8;d&=255;var e=this.m[c];if(e){var g=this.o[c],h=g[d];(c&1?e.Hc(h.ca,this.l[c]):e.Nb(h.ca,this.l[c]))?(g[d]=void 0,this.i[a]=void 0,b(g)&&(g.length=0,b(this.i)&&(this.i.length=0)),c=this.O("%2d: %s %*a cleared\n",a,he[c],e.ga,h),--this.da||this.ja||(c+=ie(this,!1))):c=this.O("invalid break address: %*a\n",e.ga,h)}else c="invalid bus"}else c=
this.O("invalid break index: %d\n",a)}else c="missing break index\n";return c};function je(a,b){if(a.T&&(b==void 0||a.T.ca==b)){var c=c===void 0?G.Ea:c;b=-1;var d=ke(a.T,a.o[c]);if(d>=0)for(var e=0;e<a.i.length;e++){var g=a.i[e];if(g!=void 0&&c==g>>8&&d==(g&255)){b=e;break}}c=b;c>=0&&a.xc(c);a.T=null}}
f.yc=function(a,b){b=b===void 0?!1:b;if(a<-1)return ge(this,this.yc,b);if(a>=0){var c=this.i[a];if(c!=void 0){var d=c>>8;c=this.o[d][c&255];if(c!=void 0){var e=b?"enabled":"disabled",g=this.m[d];!c.disabled==!b?(c.disabled=!b,a=this.O("%2d: %s %*a %s\n",a,he[d],g.ga,c,e)):a=this.O("%2d: %s %*a already %s\n",a,he[d],g.ga,c,e)}else a=this.O("no break address at index: %d\n",a)}else a=this.O("invalid break index: %d\n",a)}else a="missing break index\n";return a};
function ge(a,b,c){for(var d="",e=0;e<a.i.length;e++)a.i[e]!=void 0&&(d+=b.call(a,e,c));d||(d="no break addresses found");return d}function le(a,b,c){c=c===void 0?G.Ea:c;a=a.o[c];for(c=0;c<a.length;c++){var d=a[c];if(d.ca==b)return d}}function ke(a,b){for(var c=0;c<b.length;c++)if(b[c].ca==a.ca)return c;return-1}
function me(a,b){b=b===void 0?!1:b;for(var c="",d=0;d<a.i.length;d++){var e=a.i[d];if(e!=void 0){var g=e>>8;e=a.o[g][e&255];g=a.O("%s %*a",he[g],a.m[g].ga,e);b?(c&&(c+=";"),c+=g,e.disabled&&(c+=";bd "+d)):c+=a.O("%2d: %s %s\n",d,g,e.disabled?"disabled":"enabled")}}c||b||(c="no break addresses found\n");return c}
function ne(a,b,c){c=c===void 0?G.Ea:c;if(b){var d=a.m[c];if(d){var e=a.o[c];var g=ke(b,e);if(g>=0)g=-(g+1);else{for(g=0;g<e.length&&e[g]!=void 0;g++);e[g]=b}e=g;if(e>=0)if(g=c&1?d.Fc(b.ca,a.l[c]):d.Mb(b.ca,a.l[c])){for(g=0;g<a.i.length&&a.i[g]!=void 0;g++);a.i[g]=c<<8|e;b=a.O("%2d: %s %*a set\n",g,he[c],d.ga,b);a.da++||a.h.length||(b+=ie(a,!0))}else b=a.O("invalid break address: %*a\n",d.ga,b),a.o[c][e]=void 0;else b=a.O("%s %*a already set\n",he[c],d.ga,b)}else b="invalid bus"}else b="missing break address\n";
return b}function oe(a,b){b>=0&&(a.H=b);var c="instruction break count: "+(a.H>0?a.H:"disabled")+"\n";b>0&&(a.h.length||(c+=ie(a,!0)),a.ja=!0);return c}function pe(a,b){var c;if(b){var d=pb(b);d!=void 0?a.oa=d?0xffffffffffff:0:c=a.O("unrecognized message option: %s\n",b)}c||(c=a.O("break on message: %b\n",!!a.oa));return c}f.Oe=function(a,b){this.u||(a==void 0?qe(this,"break on unknown input %#0x: %#0x",b):(a=le(this,a+b,G.$a))&&!a.disabled&&qe(this,"break on input %*a: %#0x",this.j.ga))};
f.Pe=function(a,b){this.u||(a==void 0?qe(this,"break on unknown output %#0x: %#0x",b):(a=le(this,a+b,G.ab))&&!a.disabled&&qe(this,"break on output %*a: %#0x",this.j.ga))};
f.Qe=function(a,b){this.u||(a==void 0?qe(this,"break on unknown read %#0x: %#0x",b):(a+=b,this.h.length&&a==this.X.mb&&(this.Y++,this.H>0&&(--this.H||qe(this,"break on instruction count")),this.h[this.M++]=a,this.M==this.h.length&&(this.M=0)),(b=le(this,a,G.Ea))&&!b.disabled&&(qe(this,"break on read %*a: %#0x",this.g.ga),je(this,a))))};f.Re=function(a,b){this.u||(a==void 0?qe(this,"break on unknown write %#0x: %#0x",b):(a=le(this,a+b,G.jb))&&!a.disabled&&qe(this,"break on write %*a: %#0x",this.g.ga))};
function qe(a,b,c){b=a.O.apply(a,[b].concat(ra(c)));a.I("%s\n",b);dd(a.time)}function re(a,b,c){c=c===void 0?a.g:c;return Oa(a,b.ca,a.ka,c.ga,"")}
function se(a,b,c){c=c===void 0?10:c;var d="";if(a.h.length){var e,g=[];c>a.h.length&&(c=a.h.length);b<0&&(b=c);var h=a.M-b;for(h<0&&(h+=a.h.length);h>=0&&h<a.h.length&&c>0;){var k=a.h[h++];if(k==void 0)break;h==a.h.length&&(h=0);e?e.ca=k:e=Od(k);for(k=0;k<a.ma;k++)g[k]=Xd(a,e,1);Ud(a,e,-g.length);d+=a.Gc(e,g,a.O("[%6d]",b--));c--}}return d||"no history"}
function Kd(a,b,c){var d=[],e="";for(b=typeof b=="number"?Od(b):b;c--;){for(Ud(a,b,d.length);d.length<a.ma;)d.push(Xd(a,b,1));Ud(a,b,-d.length);e+=a.Gc(b,d)}return e}
function te(a,b,c,d,e,g){var h="";g=g?a.j:a.g;c||(c=g.j);var k=c>>3;d||(d=128);var l=0,u=d+15>>4||1,p=k==4?16:a.ka;e=="y"&&(p=k,u=d,l=k*8);b||(b=a.Aa);for(;u--&&d>0;){var w=e=0,r,q="",y="",x=re(a,b,g);for(r=p;r>0&&d>0;r--){var B=Xd(a,b,1,g);e|=B<<(w++<<3);w==k&&(q+=Oa(a,e,0,c,""),q+=k==1?r==9?"-":" ":" ",l&&(y+=Oa(a,e,2,c,"")),e=w=0);l||(y+=B>=32&&B<127?String.fromCharCode(B):".");d--}h&&(h+="\n");h+=x+"  "+q+" "+y}a.Aa=b;return h}
f.bf=function(){var a=[];Fb(this,function(b){b.Xa&&b.Xa(a);return!0});return JSON.stringify(a,null,2)};function ue(a,b,c,d){var e=0,g="";d=d?a.j:a.g;for(var h=0;b!=void 0&&h<c.length;h++){var k=Xd(a,b,0,d);if(k==void 0)break;var l=a,u=b,p=c[h],w=d;w=w===void 0?l.g:w;l.u++;w.Ic(u.ca,p);l.u--;g+=a.O("%*a: %#*n changed to %#*n\n",a.g.ga,b,a.g.j,k,a.g.j,c[h]);Ud(a,b,1,d);e++}e||(g+=a.O("%d locations updated\n",e));a.time.update();return g}
function ie(a,b){var c="";b!=void 0&&b==!a.h.length&&Bd(a.g,function(d){b?a.g.Mb(d.sa,a.l[G.Ea]):a.g.Nb(d.sa,a.l[G.Ea])})&&(b?(a.M=0,a.h=Array(ve)):a.h=[]);return c+=a.O("instruction history %s\n",a.h.length?"enabled":"disabled")}f.wa=function(a){var b=a.shift();return this.U==b?(nb(this,a.shift()),this.W.ua=a.shift(),!0):!1};f.Cd=function(a){Pa(this.oa,a)?qe(this,"break on message"):this.time.V=!0};
f.mf=function(a){var b=a[1],c=a[2],d=[],e=[],g=!1,h="";this.L=void 0;if(c=="*")var k=-2;else{k=Na(c);k==void 0&&(k=-1);var l=Qd(this,c,e);if(l===null)return}var u=0;a[3]&&(u=Na(a[3].substr(a[3][0]=="l"?1:0))||8);for(var p=3;p<a.length;p++)d.push(Na(a[p],16));if(b=="d"){p=Pd(this,c,d);if(p!=void 0)return p;b=this.N||b}if(b[0]!="s"&&e.length)return"unrecognized symbol(s): "+e;switch(b[0]){case "b":b[1]=="c"?h=this.xc(k):b[1]=="d"?h=this.yc(k):b[1]=="e"?h=this.yc(k,!0):b[1]=="i"?h=ne(this,l,G.$a):b[1]==
"l"?h=me(this):b[1]=="m"?h=pe(this,c):b[1]=="n"?h=oe(this,k):b[1]=="o"?h=ne(this,l,G.ab):b[1]=="r"?h=ne(this,l,G.Ea):b[1]=="w"?h=ne(this,l,G.jb):b[1]=="?"?(h="break commands:\n",we.forEach(function(w){h+=w+"\n"})):b[1]&&(h=void 0);break;case "d":this.N=b;if(b[1]!="b"&&b[1])if(b[1]=="w")c=16;else if(b[1]=="d")c=32;else if(b[1]=="i"){if(!this.j){h="invalid bus";break}c=this.j.j;u=u||1;g=!0}else{if(b[1]=="h")this.N="",h=se(this,k,u);else if(b[1]=="?"){if(this.N="",h="dump commands:\n",xe.forEach(function(w){h+=
w+"\n"}),this.v.length)for(h+="dump extensions:\n",b=0;b<this.v.length;b++)l=this.v[b],h+=this.O("d   %-12s%s\n",l.name,l.Ze)}else this.N="",h=void 0;break}else c=8;h=te(this,l,c,u,b[2],g);break;case "e":if(b[1]=="o"){if(!this.j){h="invalid bus";break}g=!0}else if(b[1]){h=void 0;break}h=ue(this,l,d,g);break;case "g":if(this.time.start()){if(l!=void 0){je(this);h=ne(this,l);if(h.indexOf(":")!=2)break;this.T=l;h=""}break}h="already started\n";break;case "h":dd(this.time)||(h="already stopped\n");break;
case "p":a.shift();a.shift();b=a.join(" ");h+=this.O("%s = %s\n",b,Oa(this,Wd(this,b)));break;case "r":if(b=b.substr(1).toUpperCase()){if(Hb(this.X,b)==void 0){h+=this.O("unrecognized register: %s\n",b);break}l!=void 0&&Mb(this.X,b,l.ca)}this.ba.ca=this.X.v;h+=this.X.toString();break;case "s":l=pb(c);if(b[1]=="h"){if(this.da||this.H>0)l=void 0;h=ie(this,l);l!=void 0&&(this.ja=l)}else b[1]=="p"?k>0?(ad(this.time,k),h="target speed:  "+gd(this.time.u)):h="current speed: "+qd(this.time):b[1]=="s"&&this.pa?
(k=this.pa.indexOf(c),k>=0&&(this.style=this.pa[k]),h="style: "+this.style):b[1]=="?"?(h="set commands:\n",ye.forEach(function(w){h+=w+"\n"})):h=void 0;break;case "t":u=Na(c,10)||1;this.L=!0;if(b[1]){if(b[1]!="r"){h=void 0;break}this.L=!1}id(this.time,u);break;case "u":if(b[1]){h=void 0;break}u||(u=8);l||(l=this.ba);h+=Kd(this,l,u);this.ba=l;break;case "?":h="debugger commands:\n";ze.forEach(function(w){h+=w+"\n"});break;default:h=void 0}h==void 0&&a[0]&&(h="unrecognized command '"+a[0]+"' (try '?')\n");
return h};f.Jb=function(a){return a&&this.wa(a[0])?(a.shift(),!0):!1};f.Xa=function(a){var b=[];this.xa(b);a.push(b);this.Z=0};f.Cc=function(a){a&&(this.time.g?this.Z&&this.input&&ac(this.input):this.L?this.Na(Kd(this,this.X.v,1)):(this.Y&&(this.X.I("%d instructions executed\n",this.Y),this.Y=0),this.X.Na(this.X.toString()),this.L==void 0&&this.Z&&(a=this.Ha(Wa.ub,!0))&&a.focus()),this.Z++)};f.xa=function(a){a.push(this.U);a.push(me(this,!0));a.push(this.W.ua)};
f.Gc=function(a,b,c){var d=this.O,e=re(this,a);b=b.shift();Ud(this,a,1);return d.call(this,"%s %02x       unsupported       ; %s\n",e,b,c||"")};
var ze="b?\t\tbreak commands;d?\t\tdump commands;e[o] [addr] ...\tedit memory/ports;g    [addr]\trun (to addr);h\t\thalt;p    [expr]\tparse expression;r?   [value]\tdisplay/set registers;s?\t\tset commands;t[r] [n]\tstep (n instructions);u    [addr] [n]\tunassemble (at addr)".split(";"),we="bc [n|*]\tclear break address;bd [n|*]\tdisable break address;be [n|*]\tenable break address;bl [n]\t\tlist break addresses;bi [addr]\tbreak on input;bo [addr]\tbreak on output;br [addr]\tbreak on read;bw [addr]\tbreak on write;bm [on|off]\tbreak on message;bn [count]\tbreak on instruction count".split(";"),xe=
"db  [addr]\tdump bytes (8 bits);dw  [addr]\tdump words (16 bits);dd  [addr]\tdump dwords (32 bits);di  [addr]\tdump input ports;d*y [addr]\tdump values in binary;dh  [n] [l]\tdump instruction history buffer;ds\t\tdump machine state".split(";"),ye=["sh [on|off]\tset instruction history","sp [n]\t\tset speed multiplier","ss\t\tset debugger style"],Vd={Va:1,Ae:0,Be:2,cl:0},G={Ea:0,jb:1,$a:2,ab:3},Ae={},he=(Ae[G.Ea]="br",Ae[G.jb]="bw",Ae[G.$a]="bi",Ae[G.ab]="bo",Ae),Be={ye:"PC"},Ce={BYTE:1,xe:2,Ce:4,
dd:5,Qc:6,Je:7},Rd={"=":Ce.Je,1:Ce.BYTE,2:Ce.xe,4:Ce.Ce,"@":Ce.dd,";":Ce.Qc},ve=1E5,ee={"||":5,"&&":6,"!":7,"|":7,"^!":8,"&":9,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,_:19,"^_":19,"{":20,"}":20},de={",,":1,"||":5,"&&":6,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,"!":15,"|":15,"^!":15,"&":15,_:19,"^_":19,"{":20,"}":20};
function De(a,b,c){Ld.call(this,a,b,c);Ee(this);this.Y=Cb(this,this.config.busIO);this.T=Cb(this,this.config.busMemory);this.input=F(this,"Input",!1)}m(De,Ld);f=De.prototype;f.zd=function(){if(Fe(this))for(;this.g>0;)this.mb=this.v,this.Z[H(this)].call(this)};
function Ee(a){Ge(a);Eb(a,"A",function(){return a.h},function(b){return a.h=b&255});Eb(a,"B",function(){return a.i},function(b){return a.i=b&255});Eb(a,"C",function(){return a.j},function(b){return a.j=b&255});Eb(a,"D",function(){return a.l},function(b){return a.l=b&255});Eb(a,"E",function(){return a.m},function(b){return a.m=b&255});Eb(a,"H",function(){return a.o},function(b){return a.o=b&255});Eb(a,"L",function(){return a.u},function(b){return a.u=b&255});Eb(a,"CF",function(){return He(a)?1:0},
function(b){a.H=b?a.H|256:a.H&255});Eb(a,"PF",function(){return Ie(a)?1:0},function(b){b?Ie(a)||(a.J^=1):Ie(a)&&(a.J^=1)});Eb(a,"AF",function(){return Je(a)?1:0},function(b){a.L=b?~a.J&16|a.L&-17:a.J&16|a.L&-17});Eb(a,"ZF",function(){return Ke(a)?1:0},function(b){a.H=b?a.H&-256:a.H|255});Eb(a,"SF",function(){return Le(a)?1:0},function(b){b?Le(a)||(a.J^=192):Le(a)&&(a.J^=192)});Eb(a,"IF",function(){return a.K&Me?1:0},function(b){a.K=b?a.K|Me:a.K&~Me});Eb(a,"BC",a.Ka,a.nb);Eb(a,"DE",a.Ia,a.Ya);Eb(a,
"HL",a.S,a.za);Eb(a,Be.ye,a.ff,a.R);a.Z=[a.La,a.$g,a.yj,a.Kg,a.Dg,a.ng,a.si,a.Wi,a.La,a.ig,a.Xg,a.ug,a.Eg,a.og,a.ti,a.cj,a.La,a.ah,a.zj,a.Lg,a.Fg,a.pg,a.ui,a.Ti,a.La,a.jg,a.Yg,a.vg,a.Gg,a.qg,a.wi,a.Ui,a.La,a.bh,a.vj,a.Mg,a.Hg,a.rg,a.xi,a.hg,a.La,a.kg,a.Zg,a.wg,a.Ig,a.sg,a.yi,a.Rf,a.La,a.dh,a.xj,a.Ng,a.Jg,a.tg,a.zi,a.Aj,a.La,a.lg,a.Wg,a.xg,a.Cg,a.mg,a.ri,a.Sf,a.oh,a.ph,a.qh,a.rh,a.sh,a.th,a.uh,a.nh,a.xh,a.yh,a.zh,a.Ah,a.Bh,a.Ch,a.Dh,a.wh,a.Fh,a.Gh,a.Hh,a.Ih,a.Jh,a.Kh,a.Lh,a.Eh,a.Nh,a.Oh,a.Ph,a.Qh,
a.Rh,a.Sh,a.Th,a.Mh,a.Vh,a.Wh,a.Xh,a.Yh,a.Zh,a.$h,a.ai,a.Uh,a.ci,a.di,a.ei,a.fi,a.gi,a.hi,a.ii,a.bi,a.ki,a.li,a.mi,a.ni,a.oi,a.pi,a.Ag,a.ji,a.fh,a.gh,a.hh,a.ih,a.jh,a.kh,a.mh,a.eh,a.yf,a.zf,a.Af,a.Bf,a.Cf,a.Df,a.Ef,a.xf,a.qf,a.rf,a.sf,a.tf,a.uf,a.vf,a.wf,a.pf,a.Cj,a.Dj,a.Ej,a.Fj,a.Gj,a.Hj,a.Ij,a.Bj,a.nj,a.oj,a.pj,a.qj,a.rj,a.sj,a.tj,a.mj,a.Hf,a.If,a.Jf,a.Kf,a.Lf,a.Mf,a.Nf,a.Gf,a.Mj,a.Nj,a.Oj,a.Pj,a.Qj,a.Rj,a.Sj,a.Lj,a.Bi,a.Ci,a.Di,a.Ei,a.Fi,a.Gi,a.Hi,a.Ai,a.Uf,a.Vf,a.Wf,a.Xf,a.Yf,a.Zf,a.$f,a.Tf,a.Zi,
a.Li,a.Rg,a.Dd,a.bg,a.Qi,a.Ff,a.dj,a.lj,a.Ed,a.Vg,a.Dd,a.gg,a.Kb,a.nf,a.ej,a.Yi,a.Mi,a.Qg,a.Ji,a.ag,a.Ri,a.Jj,a.fj,a.Vi,a.Ed,a.Og,a.Bg,a.Pf,a.Kb,a.uj,a.gj,a.bj,a.Ni,a.Ug,a.Uj,a.fg,a.Si,a.Of,a.hj,a.aj,a.Ki,a.Tg,a.Kj,a.dg,a.Kb,a.Tj,a.ij,a.$i,a.Oi,a.Sg,a.yg,a.cg,a.Pi,a.Ii,a.jj,a.Xi,a.wj,a.Pg,a.zg,a.Qf,a.Kb,a.eg,a.kj]}
f.wa=function(a){if(!a||!a.length)return this.I("invalid saved state\n"),!1;var b=a.shift(),c=a.shift();if(b!=this.U||(c|0)!==3)return this.I("CPU state mismatch (%s %3.2f)\n",b,c),!1;try{this.h=a.shift(),this.i=a.shift(),this.j=a.shift(),this.l=a.shift(),this.m=a.shift(),this.o=a.shift(),this.u=a.shift(),this.R(a.shift()),this.M=a.shift()&65535,Ne(this,a.shift()),this.N=a.shift()}catch(d){return this.I("CPU state error: %s\n",d.message),!1}return!0};
f.xa=function(a){a.push(this.U);a.push(3);a.push(this.h);a.push(this.i);a.push(this.j);a.push(this.l);a.push(this.m);a.push(this.o);a.push(this.u);a.push(this.v);a.push(this.M);a.push(Oe(this));a.push(this.N)};f.Jb=function(a){return a&&this.wa(a[0])?(a.shift(),!0):!1};f.qa=function(a){a?(this.time.start(),this.input&&ac(this.input)):dd(this.time)};f.la=function(){this.I("reset\n");Ge(this);this.time.g||this.Na(this.toString())};f.Xa=function(a){var b=[];this.xa(b);a.push(b)};f.Cc=function(){};
f.La=function(){this.g-=4};f.$g=function(){this.nb(I(this));this.g-=10};f.yj=function(){Pe(this,this.Ka(),this.h);this.g-=7};f.Kg=function(){this.nb(this.Ka()+1);this.g-=5};f.Dg=function(){this.i=Qe(this,this.i);this.g-=5};f.ng=function(){this.i=Re(this,this.i);this.g-=5};f.si=function(){this.i=H(this);this.g-=7};f.Wi=function(){var a=this.h<<1;this.h=a&255|a>>8;Se(this,a&256);this.g-=4};f.ig=function(){var a;this.za(a=this.S()+this.Ka());Se(this,a>>8&256);this.g-=10};
f.Xg=function(){this.h=J(this,this.Ka());this.g-=7};f.ug=function(){this.nb(this.Ka()-1);this.g-=5};f.Eg=function(){this.j=Qe(this,this.j);this.g-=5};f.og=function(){this.j=Re(this,this.j);this.g-=5};f.ti=function(){this.j=H(this);this.g-=7};f.cj=function(){var a=this.h<<8&256;this.h=(a|this.h)>>1;Se(this,a);this.g-=4};f.ah=function(){this.Ya(I(this));this.g-=10};f.zj=function(){Pe(this,this.Ia(),this.h);this.g-=7};f.Lg=function(){this.Ya(this.Ia()+1);this.g-=5};
f.Fg=function(){this.l=Qe(this,this.l);this.g-=5};f.pg=function(){this.l=Re(this,this.l);this.g-=5};f.ui=function(){this.l=H(this);this.g-=7};f.Ti=function(){var a=this.h<<1;this.h=a&255|He(this);Se(this,a&256);this.g-=4};f.jg=function(){var a;this.za(a=this.S()+this.Ia());Se(this,a>>8&256);this.g-=10};f.Yg=function(){this.h=J(this,this.Ia());this.g-=7};f.vg=function(){this.Ya(this.Ia()-1);this.g-=5};f.Gg=function(){this.m=Qe(this,this.m);this.g-=5};
f.qg=function(){this.m=Re(this,this.m);this.g-=5};f.wi=function(){this.m=H(this);this.g-=7};f.Ui=function(){var a=this.h<<8;this.h=(He(this)<<8|this.h)>>1;Se(this,a&256);this.g-=4};f.bh=function(){this.za(I(this));this.g-=10};f.vj=function(){var a=I(this);this.T.ia(a,this.S()&65535);this.g-=16};f.Mg=function(){this.za(this.S()+1);this.g-=5};f.Hg=function(){this.o=Qe(this,this.o);this.g-=5};f.rg=function(){this.o=Re(this,this.o);this.g-=5};f.xi=function(){this.o=H(this);this.g-=7};
f.hg=function(){var a=0,b=He(this);if(Je(this)||(this.h&15)>9)a|=6;if(b||this.h>=154)a|=96,b=Te;this.h=Ue(this,a);Se(this,b?256:0);this.g-=4};f.kg=function(){var a;this.za(a=this.S()+this.S());Se(this,a>>8&256);this.g-=10};f.Zg=function(){var a=this.za;var b=I(this);b=this.T.ta(b);a.call(this,b);this.g-=16};f.wg=function(){this.za(this.S()-1);this.g-=5};f.Ig=function(){this.u=Qe(this,this.u);this.g-=5};f.sg=function(){this.u=Re(this,this.u);this.g-=5};f.yi=function(){this.u=H(this);this.g-=7};
f.Rf=function(){this.h=~this.h&255;this.g-=4};f.dh=function(){this.M=I(this)&65535;this.g-=10};f.xj=function(){Pe(this,I(this),this.h);this.g-=13};f.Ng=function(){this.M=this.M+1&65535;this.g-=5};f.Jg=function(){var a=this.S();Pe(this,a,Qe(this,J(this,a)));this.g-=10};f.tg=function(){var a=this.S();Pe(this,a,Re(this,J(this,a)));this.g-=10};f.zi=function(){Pe(this,this.S(),H(this));this.g-=10};f.Aj=function(){this.H|=256;this.g-=4};
f.lg=function(){var a;this.za(a=this.S()+this.M);Se(this,a>>8&256);this.g-=10};f.Wg=function(){this.h=J(this,I(this));this.g-=13};f.xg=function(){this.M=this.M-1&65535;this.g-=5};f.Cg=function(){this.h=Qe(this,this.h);this.g-=5};f.mg=function(){this.h=Re(this,this.h);this.g-=5};f.ri=function(){this.h=H(this);this.g-=7};f.Sf=function(){Se(this,He(this)?0:256);this.g-=4};f.oh=function(){this.g-=5};f.ph=function(){this.i=this.j;this.g-=5};f.qh=function(){this.i=this.l;this.g-=5};
f.rh=function(){this.i=this.m;this.g-=5};f.sh=function(){this.i=this.o;this.g-=5};f.th=function(){this.i=this.u;this.g-=5};f.uh=function(){this.i=J(this,this.S());this.g-=7};f.nh=function(){this.i=this.h;this.g-=5};f.xh=function(){this.j=this.i;this.g-=5};f.yh=function(){this.g-=5};f.zh=function(){this.j=this.l;this.g-=5};f.Ah=function(){this.j=this.m;this.g-=5};f.Bh=function(){this.j=this.o;this.g-=5};f.Ch=function(){this.j=this.u;this.g-=5};f.Dh=function(){this.j=J(this,this.S());this.g-=7};
f.wh=function(){this.j=this.h;this.g-=5};f.Fh=function(){this.l=this.i;this.g-=5};f.Gh=function(){this.l=this.j;this.g-=5};f.Hh=function(){this.g-=5};f.Ih=function(){this.l=this.m;this.g-=5};f.Jh=function(){this.l=this.o;this.g-=5};f.Kh=function(){this.l=this.u;this.g-=5};f.Lh=function(){this.l=J(this,this.S());this.g-=7};f.Eh=function(){this.l=this.h;this.g-=5};f.Nh=function(){this.m=this.i;this.g-=5};f.Oh=function(){this.m=this.j;this.g-=5};f.Ph=function(){this.m=this.l;this.g-=5};
f.Qh=function(){this.g-=5};f.Rh=function(){this.m=this.o;this.g-=5};f.Sh=function(){this.m=this.u;this.g-=5};f.Th=function(){this.m=J(this,this.S());this.g-=7};f.Mh=function(){this.m=this.h;this.g-=5};f.Vh=function(){this.o=this.i;this.g-=5};f.Wh=function(){this.o=this.j;this.g-=5};f.Xh=function(){this.o=this.l;this.g-=5};f.Yh=function(){this.o=this.m;this.g-=5};f.Zh=function(){this.g-=5};f.$h=function(){this.o=this.u;this.g-=5};f.ai=function(){this.o=J(this,this.S());this.g-=7};
f.Uh=function(){this.o=this.h;this.g-=5};f.ci=function(){this.u=this.i;this.g-=5};f.di=function(){this.u=this.j;this.g-=5};f.ei=function(){this.u=this.l;this.g-=5};f.fi=function(){this.u=this.m;this.g-=5};f.gi=function(){this.u=this.o;this.g-=5};f.hi=function(){this.g-=5};f.ii=function(){this.u=J(this,this.S());this.g-=7};f.bi=function(){this.u=this.h;this.g-=5};f.ki=function(){Pe(this,this.S(),this.i);this.g-=7};f.li=function(){Pe(this,this.S(),this.j);this.g-=7};
f.mi=function(){Pe(this,this.S(),this.l);this.g-=7};f.ni=function(){Pe(this,this.S(),this.m);this.g-=7};f.oi=function(){Pe(this,this.S(),this.o);this.g-=7};f.pi=function(){Pe(this,this.S(),this.u);this.g-=7};f.Ag=function(){this.g-=7;this.N|=Ve;md(this.time);this.K&Me&&!kb(this,70368744177664)||(this.R(this.v-1),dd(this.time))};f.ji=function(){Pe(this,this.S(),this.h);this.g-=7};f.fh=function(){this.h=this.i;this.g-=5};f.gh=function(){this.h=this.j;this.g-=5};
f.hh=function(){this.h=this.l;this.g-=5};f.ih=function(){this.h=this.m;this.g-=5};f.jh=function(){this.h=this.o;this.g-=5};f.kh=function(){this.h=this.u;this.g-=5};f.mh=function(){this.h=J(this,this.S());this.g-=7};f.eh=function(){this.g-=5};f.yf=function(){this.h=Ue(this,this.i);this.g-=4};f.zf=function(){this.h=Ue(this,this.j);this.g-=4};f.Af=function(){this.h=Ue(this,this.l);this.g-=4};f.Bf=function(){this.h=Ue(this,this.m);this.g-=4};f.Cf=function(){this.h=Ue(this,this.o);this.g-=4};
f.Df=function(){this.h=Ue(this,this.u);this.g-=4};f.Ef=function(){this.h=Ue(this,J(this,this.S()));this.g-=7};f.xf=function(){this.h=Ue(this,this.h);this.g-=4};f.qf=function(){this.h=We(this,this.i);this.g-=4};f.rf=function(){this.h=We(this,this.j);this.g-=4};f.sf=function(){this.h=We(this,this.l);this.g-=4};f.tf=function(){this.h=We(this,this.m);this.g-=4};f.uf=function(){this.h=We(this,this.o);this.g-=4};f.vf=function(){this.h=We(this,this.u);this.g-=4};
f.wf=function(){this.h=We(this,J(this,this.S()));this.g-=7};f.pf=function(){this.h=We(this,this.h);this.g-=4};f.Cj=function(){this.h=K(this,this.i);this.g-=4};f.Dj=function(){this.h=K(this,this.j);this.g-=4};f.Ej=function(){this.h=K(this,this.l);this.g-=4};f.Fj=function(){this.h=K(this,this.m);this.g-=4};f.Gj=function(){this.h=K(this,this.o);this.g-=4};f.Hj=function(){this.h=K(this,this.u);this.g-=4};f.Ij=function(){this.h=K(this,J(this,this.S()));this.g-=7};
f.Bj=function(){this.h=K(this,this.h);this.g-=4};f.nj=function(){this.h=Xe(this,this.i);this.g-=4};f.oj=function(){this.h=Xe(this,this.j);this.g-=4};f.pj=function(){this.h=Xe(this,this.l);this.g-=4};f.qj=function(){this.h=Xe(this,this.m);this.g-=4};f.rj=function(){this.h=Xe(this,this.o);this.g-=4};f.sj=function(){this.h=Xe(this,this.u);this.g-=4};f.tj=function(){this.h=Xe(this,J(this,this.S()));this.g-=7};f.mj=function(){this.h=Xe(this,this.h);this.g-=4};
f.Hf=function(){this.h=Ye(this,this.i);this.g-=4};f.If=function(){this.h=Ye(this,this.j);this.g-=4};f.Jf=function(){this.h=Ye(this,this.l);this.g-=4};f.Kf=function(){this.h=Ye(this,this.m);this.g-=4};f.Lf=function(){this.h=Ye(this,this.o);this.g-=4};f.Mf=function(){this.h=Ye(this,this.u);this.g-=4};f.Nf=function(){this.h=Ye(this,J(this,this.S()));this.g-=7};f.Gf=function(){this.h=Ye(this,this.h);this.g-=4};f.Mj=function(){this.h=Ze(this,this.i);this.g-=4};
f.Nj=function(){this.h=Ze(this,this.j);this.g-=4};f.Oj=function(){this.h=Ze(this,this.l);this.g-=4};f.Pj=function(){this.h=Ze(this,this.m);this.g-=4};f.Qj=function(){this.h=Ze(this,this.o);this.g-=4};f.Rj=function(){this.h=Ze(this,this.u);this.g-=4};f.Sj=function(){this.h=Ze(this,J(this,this.S()));this.g-=7};f.Lj=function(){this.h=Ze(this,this.h);this.g-=4};f.Bi=function(){this.h=$e(this,this.i);this.g-=4};f.Ci=function(){this.h=$e(this,this.j);this.g-=4};
f.Di=function(){this.h=$e(this,this.l);this.g-=4};f.Ei=function(){this.h=$e(this,this.m);this.g-=4};f.Fi=function(){this.h=$e(this,this.o);this.g-=4};f.Gi=function(){this.h=$e(this,this.u);this.g-=4};f.Hi=function(){this.h=$e(this,J(this,this.S()));this.g-=7};f.Ai=function(){this.h=$e(this,this.h);this.g-=4};f.Uf=function(){K(this,this.i);this.g-=4};f.Vf=function(){K(this,this.j);this.g-=4};f.Wf=function(){K(this,this.l);this.g-=4};f.Xf=function(){K(this,this.m);this.g-=4};
f.Yf=function(){K(this,this.o);this.g-=4};f.Zf=function(){K(this,this.u);this.g-=4};f.$f=function(){K(this,J(this,this.S()));this.g-=7};f.Tf=function(){K(this,this.h);this.g-=4};f.Zi=function(){Ke(this)||(this.R(af(this)),this.g-=6);this.g-=5};f.Li=function(){this.nb(af(this));this.g-=10};f.Rg=function(){var a=I(this);Ke(this)||this.R(a);this.g-=10};f.Dd=function(){this.R(I(this));this.g-=10};f.bg=function(){var a=I(this);Ke(this)||(L(this,this.v),this.R(a),this.g-=6);this.g-=11};
f.Qi=function(){L(this,this.Ka());this.g-=11};f.Ff=function(){this.h=Ue(this,H(this));this.g-=7};f.dj=function(){L(this,this.v);this.R(0);this.g-=11};f.lj=function(){Ke(this)&&(this.R(af(this)),this.g-=6);this.g-=5};f.Ed=function(){this.R(af(this));this.g-=10};f.Vg=function(){var a=I(this);Ke(this)&&this.R(a);this.g-=10};f.gg=function(){var a=I(this);Ke(this)&&(L(this,this.v),this.R(a),this.g-=6);this.g-=11};f.Kb=function(){var a=I(this);L(this,this.v);this.R(a);this.g-=17};
f.nf=function(){this.h=We(this,H(this));this.g-=7};f.ej=function(){L(this,this.v);this.R(8);this.g-=11};f.Yi=function(){He(this)||(this.R(af(this)),this.g-=6);this.g-=5};f.Mi=function(){this.Ya(af(this));this.g-=10};f.Qg=function(){var a=I(this);He(this)||this.R(a);this.g-=10};f.Ji=function(){var a=H(this);this.Y.ra(a,this.h);this.g-=10};f.ag=function(){var a=I(this);He(this)||(L(this,this.v),this.R(a),this.g-=6);this.g-=11};f.Ri=function(){L(this,this.Ia());this.g-=11};
f.Jj=function(){this.h=K(this,H(this));this.g-=7};f.fj=function(){L(this,this.v);this.R(16);this.g-=11};f.Vi=function(){He(this)&&(this.R(af(this)),this.g-=6);this.g-=5};f.Og=function(){var a=I(this);He(this)&&this.R(a);this.g-=10};f.Bg=function(){var a=H(this);this.h=this.Y.na(a)&255;this.g-=10};f.Pf=function(){var a=I(this);He(this)&&(L(this,this.v),this.R(a),this.g-=6);this.g-=11};f.uj=function(){this.h=Xe(this,H(this));this.g-=7};f.gj=function(){L(this,this.v);this.R(24);this.g-=11};
f.bj=function(){Ie(this)||(this.R(af(this)),this.g-=6);this.g-=5};f.Ni=function(){this.za(af(this));this.g-=10};f.Ug=function(){var a=I(this);Ie(this)||this.R(a);this.g-=10};f.Uj=function(){var a=af(this);L(this,this.S());this.za(a);this.g-=18};f.fg=function(){var a=I(this);Ie(this)||(L(this,this.v),this.R(a),this.g-=6);this.g-=11};f.Si=function(){L(this,this.S());this.g-=11};f.Of=function(){this.h=Ye(this,H(this));this.g-=7};f.hj=function(){L(this,this.v);this.R(32);this.g-=11};
f.aj=function(){Ie(this)&&(this.R(af(this)),this.g-=6);this.g-=5};f.Ki=function(){this.R(this.S());this.g-=5};f.Tg=function(){var a=I(this);Ie(this)&&this.R(a);this.g-=10};f.Kj=function(){var a=this.S();this.za(this.Ia());this.Ya(a);this.g-=5};f.dg=function(){var a=I(this);Ie(this)&&(L(this,this.v),this.R(a),this.g-=6);this.g-=11};f.Tj=function(){this.h=Ze(this,H(this));this.g-=7};f.ij=function(){L(this,this.v);this.R(40);this.g-=11};
f.$i=function(){Le(this)||(this.R(af(this)),this.g-=6);this.g-=5};f.Oi=function(){var a=af(this);Ne(this,a&bf|this.K&~bf);this.h=a>>8;this.g-=10};f.Sg=function(){var a=I(this);Le(this)||this.R(a);this.g-=10};f.yg=function(){this.K&=~Me;this.g-=4};f.cg=function(){var a=I(this);Le(this)||(L(this,this.v),this.R(a),this.g-=6);this.g-=11};f.Pi=function(){L(this,Oe(this)&bf|this.h<<8);this.g-=11};f.Ii=function(){this.h=$e(this,H(this));this.g-=7};f.jj=function(){L(this,this.v);this.R(48);this.g-=11};
f.Xi=function(){Le(this)&&(this.R(af(this)),this.g-=6);this.g-=5};f.wj=function(){this.M=this.S()&65535;this.g-=5};f.Pg=function(){var a=I(this);Le(this)&&this.R(a);this.g-=10};f.zg=function(){this.K|=Me;this.g-=4;Fe(this)};f.Qf=function(){var a=I(this);Le(this)&&(L(this,this.v),this.R(a),this.g-=6);this.g-=11};f.eg=function(){K(this,H(this));this.g-=7};f.kj=function(){L(this,this.v);this.R(56);this.g-=11};
function Ge(a){a.h=0;a.i=0;a.j=0;a.l=0;a.m=0;a.o=0;a.u=0;a.M=0;a.R(a.ba);a.mb=a.v;Ne(a,0);a.N=cf}f.Ka=function(){return this.i<<8|this.j};f.nb=function(a){this.i=a>>8&255;this.j=a&255};f.Ia=function(){return this.l<<8|this.m};f.Ya=function(a){this.l=a>>8&255;this.m=a&255};f.S=function(){return this.o<<8|this.u};f.za=function(a){this.o=a>>8&255;this.u=a&255};f.ff=function(){return this.v};f.R=function(a){this.v=a&65535};function He(a){return a.H&256?Te:0}function Se(a,b){a.H=a.H&255|b}
function Ie(a){return df[a.J&255]?ef:0}function Je(a){return(a.J^a.L)&16?ff:0}function Ke(a){return a.H&255?0:gf}function Le(a){return a.J&128?hf:0}function Oe(a){return a.K&~jf|Le(a)|Ke(a)|Je(a)|Ie(a)|He(a)}function Ne(a,b){a.H=a.J=a.L=0;b&Te&&(a.H|=256);b&ef||(a.J|=1);b&ff&&(a.L|=16);b&gf||(a.H|=255);b&hf&&(a.J^=192);a.K=a.K&~(jf|Me)|b&Me|kf}function Ue(a,b){a.L=a.h^b;return a.J=(a.H=a.h+b)&255}function We(a,b){a.L=a.h^b;return a.J=(a.H=a.h+b+(a.H&256?1:0))&255}
function Ye(a,b){a.H=a.J=a.L=a.h&b;(a.h|b)&8&&(a.L^=16);return a.H}function Re(a,b){a.L=b^255;b=a.J=b+255&255;a.H=a.H&-256|b;return b}function Qe(a,b){a.L=b;b=a.J=b+1&255;a.H=a.H&-256|b;return b}function $e(a,b){return a.J=a.H=a.L=a.h|b}function K(a,b){b^=255;a.L=a.h^b;return a.J=(a.H=a.h+b+1^256)&255}function Xe(a,b){b^=255;a.L=a.h^b;return a.J=(a.H=a.h+b+(a.H&256?0:1)^256)&255}function Ze(a,b){return a.J=a.H=a.L=a.h^b}function J(a,b){return a.T.na(b)|0}function Pe(a,b,c){a.T.ra(b,c&255)}
function H(a){var b=J(a,a.v);a.R(a.v+1);return b}function I(a){var b=a.T.ta(a.v);a.R(a.v+2);return b}function af(a){var b=a.T.ta(a.M);a.M=a.M+2&65535;return b}function L(a,b){a.M=a.M-2&65535;a.T.ia(a.M,b&65535)}function Fe(a){if(a.time.g&&a.N&lf&&a.K&Me){var b;for(b=0;b<8&&!(a.N&1<<b);b++);var c=b;c=c===void 0?-1:c;a.N&=~(c<0?255:1<<c);a.K&=~Me;a.N&=~Ve;a.Z[mf|b<<3].call(a)}return a.N&Ve?(md(a.time),!1):!0}function nf(a,b){a.N|=1<<b;a.K&Me&&md(a.time)}
f.toString=function(){return this.O("A=%02X BC=%04X DE=%04X HL=%04X SP=%04X I%d S%d Z%d A%d P%d C%d\n%s",this.h,this.Ka(),this.Ia(),this.S(),this.M,this.K&Me?1:0,Le(this)?1:0,Ke(this)?1:0,Je(this)?1:0,Ie(this)?1:0,He(this)?1:0,this.aa&&Kd(this.aa,this.v,1)||"")};
var Te=1,kf=2,ef=4,ff=16,gf=64,hf=128,bf=255,Me=512,jf=Te|ef|ff|gf|hf,df=[1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,
0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1],cf=0,lf=255,Ve=256,mf=199;n.CPUx80=De;function of(a,b,c){Nd.call(this,a,b,c);this.pa=[pf,qf];this.style=qf;this.ma=3}m(of,Nd);
of.prototype.Gc=function(a,b,c){function d(U,ma){var Ia=rf[U];h.style==qf&&ma&sf&&(U==tf&&(Ia="HL"),Ia="["+Ia+"]");return Ia}function e(U){switch(U&uf){case M:var ma=Oa(h,g(),16,8,"");break;case vf:ma=Oa(h,(g()|g()<<8)<<24>>24,16,16,"");break;case wf:ma=Oa(h,g()|g()<<8,16,16,"");break;default:return"imm("+Oa(h,U,16,16,"")+")"}h.style==qf&&U&sf?ma="["+ma+"]":U&xf||(ma=(h.style==pf?"$":"0x")+ma);return ma}function g(){var U=b.shift();l+=Oa(h,U,16,8,"");Ud(h,a,1);return U}for(var h=this,k=re(this,a),
l="",u=Td(this,a,Ce.dd),p=Td(this,a,Ce.Qc),w=g(),r=yf[w],q="",y=(this.style!=qf?zf:Af)[r[0]],x=r.length-1,B=Bf,z,A=1;A<=x;A++){var V="";z=r[A];if(z!==void 0&&!(z&N&&this.style==pf)){var na=z&Cf;if(na){var ua=z&uf;ua?B=ua:z|=B;z&Df||(z|=A==1?Ef:Ff);na&O?V=e(z):na&xf?V=d((z&Gf)>>8,z):na&Hf&&(V=(w>>3&7).toString());if(!V||!V.length){q="INVALID";break}q.length>0&&(q+=",");q+=V||"???"}}}k=this.O("%s %-7s%s %-7s %s",k,l,z&If?"*":" ",y,q);c?p&&(c+=" "+p):p&&(c=p);c&&(k=this.O("%-32s; %s",k,c));u&&(k=u+":\n"+
k);return k+"\n"};
var pf="8080",qf="8086",zf="NONE ACI ADC ADD ADI ANA ANI CALL CC CM CNC CNZ CP CPE CPO CZ CMA CMC CMP CPI DAA DAD DCR DCX DI EI HLT IN INR INX JMP JC JM JNC JNZ JP JPE JPO JZ LDA LDAX LHLD LXI MOV MVI NOP ORA ORI OUT PCHL POP PUSH RAL RAR RET RC RM RNC RNZ RP RPE RPO RZ RLC RRC RST SBB SBI SHLD SPHL STA STAX STC SUB SUI XCHG XRA XRI XTHL".split(" "),Af="NONE ADC ADC ADD ADD AND AND CALL CALLC CALLS CALLNC CALLNZ CALLNS CALLP CALLNP CALLZ NOT CMC CMP CMP DAA ADD DEC DEC CLI STI HLT IN INC INC JMP JC JS JNC JNZ JNS JP JNP JZ MOV MOV MOV MOV MOV MOV NOP OR OR OUT JMP POP PUSH RCL RCR RET RETC RETS RETNC RETNZ RETNS RETP RETNP RETZ ROL ROR RST SBB SBB MOV MOV MOV MOV STC SUB SUB XCHG XOR XOR XCHG".split(" "),tf=
6,rf="B C D E H L M A BC DE HL SP PC PS PSW".split(" "),uf=15,Cf=240,Gf=3840,Df=61440,Bf=0,M=1,vf=2,wf=3,xf=16,O=32,sf=64,Hf=128,P=1792|xf|M,Q=0|xf|M,R=256|xf|M,S=512|xf|M,T=768|xf|M,W=1024|xf|M,X=1280|xf|M,Y=tf<<8|xf|M|sf,Jf=2048|xf|wf,Kf=2304|xf|wf,Lf=2560|xf|wf,Mf=2816|xf|wf,Nf=3584|xf|wf,Ff=4096,Ef=8192,N=16384,If=32768,yf=[[45],[42,Jf,O],[71,Jf|sf,P|N],[29,Jf],[28,Q],[22,Q],[44,Q,O],[63],[45,If],[21,Lf|N,Jf],[40,P|N,Jf|sf],[23,Jf],[28,R],[22,R],[44,R,O],[64],[45,If],[42,Kf,O],[71,Kf|sf,P|N],
[29,Kf],[28,S],[22,S],[44,S,O],[52],[45,If],[21,Lf|N,Kf],[40,P|N,Kf|sf],[23,Kf],[28,T],[22,T],[44,T,O],[53],[45,If],[42,Lf,O],[68,51|sf,Lf|N],[29,Lf],[28,W],[22,W],[44,W,O],[20],[45,If],[21,Lf|N,Lf],[41,Lf|N,51|sf],[23,Lf],[28,X],[22,X],[44,X,O],[16,P|N],[45,If],[42,Mf,O],[70,51|sf,P|N],[29,Mf],[28,Y],[22,Y],[44,Y,O],[72],[45,If],[21,Lf|N,Mf],[39,P|N,51|sf],[23,Mf],[28,P],[22,P],[44,P,O],[17],[43,Q,Q],[43,Q,R],[43,Q,S],[43,Q,T],[43,Q,W],[43,Q,X],[43,Q,Y],[43,Q,P],[43,R,Q],[43,R,R],[43,R,S],[43,R,
T],[43,R,W],[43,R,X],[43,R,Y],[43,R,P],[43,S,Q],[43,S,R],[43,S,S],[43,S,T],[43,S,W],[43,S,X],[43,S,Y],[43,S,P],[43,T,Q],[43,T,R],[43,T,S],[43,T,T],[43,T,W],[43,T,X],[43,T,Y],[43,T,P],[43,W,Q],[43,W,R],[43,W,S],[43,W,T],[43,W,W],[43,W,X],[43,W,Y],[43,W,P],[43,X,Q],[43,X,R],[43,X,S],[43,X,T],[43,X,W],[43,X,X],[43,X,Y],[43,X,P],[43,Y,Q],[43,Y,R],[43,Y,S],[43,Y,T],[43,Y,W],[43,Y,X],[26],[43,Y,P],[43,P,Q],[43,P,R],[43,P,S],[43,P,T],[43,P,W],[43,P,X],[43,P,Y],[43,P,P],[3,P|N,Q],[3,P|N,R],[3,P|N,S],[3,P|
N,T],[3,P|N,W],[3,P|N,X],[3,P|N,Y],[3,P|N,P],[2,P|N,Q],[2,P|N,R],[2,P|N,S],[2,P|N,T],[2,P|N,W],[2,P|N,X],[2,P|N,Y],[2,P|N,P],[73,P|N,Q],[73,P|N,R],[73,P|N,S],[73,P|N,T],[73,P|N,W],[73,P|N,X],[73,P|N,Y],[73,P|N,P],[66,P|N,Q],[66,P|N,R],[66,P|N,S],[66,P|N,T],[66,P|N,W],[66,P|N,X],[66,P|N,Y],[66,P|N,P],[5,P|N,Q],[5,P|N,R],[5,P|N,S],[5,P|N,T],[5,P|N,W],[5,P|N,X],[5,P|N,Y],[5,P|N,P],[76,P|N,Q],[76,P|N,R],[76,P|N,S],[76,P|N,T],[76,P|N,W],[76,P|N,X],[76,P|N,Y],[76,P|N,P],[46,P|N,Q],[46,P|N,R],[46,P|N,S],
[46,P|N,T],[46,P|N,W],[46,P|N,X],[46,P|N,Y],[46,P|N,P],[18,P|N,Q],[18,P|N,R],[18,P|N,S],[18,P|N,T],[18,P|N,W],[18,P|N,X],[18,P|N,Y],[18,P|N,P],[58],[50,Jf],[34,51],[30,51],[11,51],[51,Jf],[4,P|N,O|M],[65,Hf],[62],[54],[38,51],[30,51|If],[15,51],[7,51],[1,P|N,O|M],[65,Hf],[57],[50,Kf],[33,51],[48,O|M,P|N],[10,51],[51,Kf],[74,P|N,O|M],[65,Hf],[55],[54,If],[31,51],[27,P|N,O|M],[8,51],[7,51|If],[67,P|N,O|M],[65,Hf],[61],[50,Lf],[37,51],[78,Mf|sf|N,Lf|N],[14,51],[51,Lf],[6,P|N,O|M],[65,Hf],[60],[49,Lf],
[36,51],[75,Lf|N,Kf|N],[13,51],[7,51|If],[77,P|N,O|M],[65,Hf],[59],[50,Nf],[35,51],[24],[12,51],[51,Nf],[47,P|N,O|M],[65,Hf],[56],[69,Mf|N,Lf|N],[32,51],[25],[9,51],[7,51|If],[19,P|N,O|M],[65,Hf]];n.Dbgx80=of;function Of(a,b,c){E.call(this,a,b,c);this.time=F(this,"Time");this.ports=F(this,"Ports");Gd(this.ports,this,Pf);this.la()}m(Of,E);f=Of.prototype;
f.wa=function(a){var b=a.shift();return this.U==b?(this.J=a.shift(),this.j=a.shift(),this.l=a.shift(),this.m=a.shift(),this.i=a.shift(),this.v=a.shift(),this.L=a.shift(),this.K=a.shift(),this.u=a.shift(),this.g=a.shift(),this.o=a.shift(),this.H=a.shift(),this.h=a.shift(),!0):!1};f.xa=function(a){a.push(this.U);a.push(this.J);a.push(this.j);a.push(this.l);a.push(this.m);a.push(this.i);a.push(this.v);a.push(this.L);a.push(this.K);a.push(this.u);a.push(this.g);a.push(this.o);a.push(this.H);a.push(this.h)};
f.qa=function(){this.M===void 0&&(this.M=F(this,"VT100Keyboard"));this.N===void 0&&(this.N=F(this,"VT100Serial"));this.video===void 0&&(this.video=F(this,"VT100Video"));this.aa===void 0&&(this.aa=F(this,"Debugger",!1))&&this.aa.Bb(this,"nvr","dump non-volatile ram",this.af)};
f.la=function(){this.J=Qf;this.j=Rf|Sf;this.l=Tf;this.m=Uf;this.i=Vf;this.v=Wf;this.L=Xf;this.K=Yf;this.H=this.o=this.g=this.u=0;this.h=[11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11776,11784,11918,11776,11984,11888,11776,11808,11776,12E3,12E3,11901,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};function Zf(a){var b=0,c=0,d=~a.u;for(a=0;a<10;a++)d&1&&(b=9-a),d>>=1;for(a=0;a<10;a++)d&1&&(c=9-a),d>>=1;return b*10+c}
f.hf=function(a){var b=this.j;b&=~$f;if((nd(this.time)&64)<<1&&(b|=$f,b!=this.j)){var c=this.o&1;var d=this.o>>1&7;switch(d){case ag:break;case bg:this.u=this.u<<1|c;break;case cg:c=Zf(this);this.h[c]=dg;this.I(32,"doNVRCommand(): erase data at addr %#06x\n",c);break;case eg:this.g=this.g<<1|c;break;case fg:c=Zf(this);d=this.g&dg;this.h[c]=d;this.I(32,"doNVRCommand(): write data %#06x to addr %#06x\n",d,c);break;case gg:c=Zf(this);d=this.h[c];d==null&&(d=dg);this.g=d;this.I(32,"doNVRCommand(): read data %#06x from addr %#06x\n",
d,c);break;case hg:this.g<<=1;this.H=this.g&dg+1;break;default:this.I(32,"doNVRCommand(): unrecognized command %#04x\n",d)}}b&=~ig;this.H&&(b|=ig);b&=~jg;this.M&&this.M.zc()&&(b|=jg);b&=~kg;this.N&&this.N.zc()&&(b|=kg);this.j=b;this.I(48,"inFlags(%#04x): %#04x\n",a,b);return b};f.Wj=function(a,b){this.I(48,"outBrightness(%#04x): %#04x\n",a,b);this.J=b};f.ak=function(a,b){this.I(48,"outNVRLatch(%#04x): %#04x\n",a,b);this.o=b};
f.Zj=function(a,b){this.I(48,"outDC012(%#04x): %#04x\n",a,b);a=b&3;switch(b>>2&3){case 0:this.i=this.i&-4|a;break;case 1:this.i=this.i&-13|a<<2;this.video&&(b=this.video,a=this.i,b.I("updateScrollOffset(%d)\n",a),b.Z!==a&&((b.Z=a)?b.Nc(!0):b.ma=!0));break;case 2:switch(a){case 0:this.v=~this.v;break;case 2:case 3:this.L=3-a}break;case 3:this.K=a}};
f.Yj=function(a,b){this.I(48,"outNDC011(%#04x): %#04x\n",a,b);b&lg?(b&=mg,this.m!=b&&(this.m=b,this.video&&(a=this.video,b=this.m==mg?50:60,a.I("updateRate(%d)\n",b),a.yb=b))):(b&=ng,this.l!=b&&(this.l=b,this.video&&(a=this.l==ng?132:80,b=this.video,b.I("updateDimensions(%d,%d)\n",a,a>80&&this.j&Rf?14:24),b.u=a,b.ha=b.Da,a>80&&b.ha--,og(b)&&pg(b))))};f.af=function(){for(var a="",b=1;b<=this.h.length;b++)a+=this.O("%04x%c",this.h[b-1],b%10?" ":"\n");return a};
var kg=1,Rf=2,Sf=4,ig=32,$f=64,jg=128,Qf=0,ng=16,lg=32,mg=48,Tf=0,Uf=32,Vf=0,Wf=0,Xf=0,Yf=0,eg=0,bg=1,hg=2,fg=4,cg=5,gg=6,ag=7,dg=16383,Pf={66:[Of.prototype.hf,Of.prototype.Wj],98:[null,Of.prototype.ak],162:[null,Of.prototype.Zj],194:[null,Of.prototype.Yj]};n.VT100Chips=Of;
function qg(a,b,c){E.call(this,a,b,c);this.time=F(this,"Time");this.ports=F(this,"Ports");Gd(this.ports,this,rg);this.m={};for(var d in sg)this.m[d]=Cb(this,sg[d],!1);this.input=F(this,"Input");Vb(this.input,this);(this.o=Cb(this,"ledCaps"))&&Rb(this.input,this.lf.bind(this));this.la()}m(qg,E);f=qg.prototype;f.wa=function(a){var b=a.shift();return this.U==b?(this.g=a.shift(),this.j=a.shift(),this.h=a.shift(),this.l=a.shift(),!0):!1};
f.xa=function(a){a.push(this.U);a.push(this.g);a.push(this.j);a.push(this.h);a.push(this.l)};f.lf=function(a,b){Qc(this.o,0,0,b?1:Jc)};f.qa=function(a){this.X||(this.X=F(this,"CPU"));tg(this,a?this.g:void 0)};f.la=function(){this.g=ug;this.j=vg;this.h=!1;this.l=0;this.i=-1;tg(this)};f.zc=function(){this.h&&nd(this.time)>=this.l&&(this.h=!1);return!this.h};
f.kf=function(a){var b=this.j;if(this.i>=0){var c=this.input;var d=this.i,e=-1;d<c.g.length&&(e=c.g[d].Ac);c=e;c>=0?(this.i++,c&128&&(c&=127)):(this.i=-1,c=wg);this.j=c;nf(this.X,1)}this.I(80,"inUARTAddress(%#04x): %#04x\n",a,b);return b};f.bk=function(a,b){this.I(80,"outUARTStatus(%#04x): %#04x\n",a,b);tg(this,b,this.g);this.g=b;this.h=!0;this.l=nd(this.time)+od(this.time,1.2731488);b&xg&&(this.i=0,nf(this.X,1))};
function tg(a,b,c){for(var d in a.m){var e=a.m[d];if(e){var g=+d,h=void 0,k=1,l=1;b!=void 0&&(g&g-1?(g=~g&255,h=!(b&g)):h=b&g,c!=void 0&&(k=(b^c)&g,l=0));k&&(Qc(e,0,0,h?1:Jc),l&&Hc(e))}}}
var vg=127,wg=127,xg=64,ug=0,yg=C.Va+1,zg=C.Va+2,Ag=C.Va+3,Bg=C.Va+4,Z={},Wb=(Z[C.Sb]=3,Z[C.kc]=5,Z[C.jc]=6,Z[C.vc]=7,Z[C.oc]=8,Z[C.tc]=9,Z[C.Q]=10,Z[C.wb]=16,Z[C.Ee]=20,Z[C.he]=21,Z[C.Yb]=22,Z[C.rc]=23,Z[C.lc]=24,Z[C.E]=25,Z[C.ONE]=26,Z[C.dc]=32,Z[C.Sc]=34,Z[C.Xd]=35,Z[Ag]=35,Z[C.Jd]=36,Z[C.Rc]=37,Z[C.fd]=38,Z[C.ld]=39,Z[C.Yc]=40,Z[C.pd]=41,Z[C.Wc]=42,Z[C.rd]=48,Z[C.Ud]=49,Z[C.Sd]=50,Z[C.Qd]=51,Z[C.Vc]=52,Z[C.ZERO]=53,Z[C.Uc]=54,Z[C.md]=55,Z[C.Xc]=56,Z[C.qd]=57,Z[C.qc]=58,Z[C.qe]=64,Z[C.Vd]=65,Z[C.Td]=
66,Z[C.je]=67,Z[C.Yd]=68,Z[zg]=68,Z[C.Kd]=69,Z[C.cc]=70,Z[C.bc]=71,Z[C.Wb]=72,Z[C.Vb]=73,Z[C.qb]=74,Z[C.re]=80,Z[C.rb]=81,Z[C.le]=82,Z[C.ke]=83,Z[C.De]=85,Z[C.kd]=86,Z[C.Zb]=87,Z[C.Xb]=88,Z[C.Ub]=89,Z[C.mc]=90,Z[C.te]=96,Z[C.Wd]=97,Z[C.oe]=98,Z[C.ne]=99,Z[C.rb]=100,Z[C.ze]=101,Z[C.Nd]=102,Z[C.hc]=103,Z[C.Rb]=104,Z[C.uc]=105,Z[C.Zd]=106,Z[C.se]=112,Z[C.me]=113,Z[C.pe]=114,Z[C.ve]=115,Z[C.Ie]=117,Z[C.fc]=118,Z[C.nd]=119,Z[C.sc]=120,Z[C.Tb]=121,Z[C.Ab]=122,Z[C.$d]=123,Z[yg]=123,Z[C.sb]=124,Z[C.nc]=125,
Z[C.Sa]=126,Z[Bg]=[124,121],Z),Xb={keySetup:yg,keyLineFeed:zg,keyTab:C.qc,keyEsc:C.Wc,keyBreak:Ag,keyCtrl:C.sb,keyCtrlC:Bg,keyCtrlLock:[C.ec,C.sb],keyShiftLock:[C.ec,C.nc],keyCapsLock:C.Sa},Cg={},sg=(Cg[1]="led4",Cg[2]="led3",Cg[4]="led2",Cg[8]="led1",Cg[16]="ledLocked",Cg[32]="ledLocal",Cg[223]="ledOnline",Cg),rg={130:[qg.prototype.kf,qg.prototype.bk]};n.VT100Keyboard=qg;
function Dg(a,b,c){E.call(this,a,b,c);this.N=this.config.irq||2;this.T=this.config.portBase||0;this.time=F(this,"Time");this.ports=F(this,"Ports");Gd(this.ports,this,Eg,this.T);this.H={};for(var d in Fg)this.H[d]=Cb(this,Fg[d],!1);this.V=Yb(this.time,this.U+".receive",this.Fd.bind(this));this.Y=Yb(this.time,this.U+".transmit",this.mk.bind(this));this.i="";this.h=this.m=this.L=null;this.exports={connect:this.Bd,receiveData:this.Fd,receiveStatus:this.ik};this.la()}m(Dg,E);f=Dg.prototype;
f.Bd=function(a){if(!this.h){var b=Gb(this,"connection");if(b){var c=b.split("->");if(c.length==2){var d=c[0].trim();if(d!=this.U)return;c=c[1].trim();if(this.h=Cb(this,c)){var e=this.h.exports;if(e){var g=e.connect;g&&g.call(this.h,this.K);if(this.m=e.receiveData){this.K=a;this.L=e.receiveStatus;this.I("Connected %s.%s to %s\n",this.$,d,c);return}}}}this.I("Unable to establish connection: %s\n",b)}}};
f.wa=function(a){var b=a.shift();return this.U==b?(this.o=a.shift(),this.v=a.shift(),this.J=a.shift(),this.g=a.shift(),this.l=a.shift(),this.j=a.shift(),this.u=a.shift(),!0):!1};f.xa=function(a){a.push(this.U);a.push(this.o);a.push(this.v);a.push(this.J);a.push(this.g);a.push(this.l);a.push(this.j);a.push(this.u)};f.qa=function(){this.X||(this.X=F(this,"CPU"),this.Bd(this.K))};f.la=function(){this.o=!1;this.J=this.v=0;this.g=Gg;this.l=Hg;this.j=Ig;this.u=Jg;Kg(this)};
function Lg(a,b){var c=a.u&b;b&15||(c>>=4);b=Mg[c];c=((a.l&Ng)>>2)+6;a.l&Og&&c++;c+=((a.l&Pg)>>6)+1>>1;return 1E3/(b/c)|0}f.zc=function(){return!!(this.g&Qg)};f.Fd=function(a){a!=null&&(this.i=typeof a!="number"?a:this.i+String.fromCharCode(a));this.i&&(a=this.i.charCodeAt(0),this.I(128,"receiveByte(%#04x): status=%#04x\n",a,this.g),this.M||this.g&Rg||!this.X?a=!1:(this.v=a,this.g|=Rg,nf(this.X,this.N),a=!0),a&&(this.i=this.i.substr(1)),this.i&&jc(this.time,this.V,Lg(this,Sg)));return!0};
f.ik=function(a){this.g&=~Tg;a&za.Tc.Ba&&(this.g|=Tg)};f.mk=function(a){this.g|=Qg|Ug;return a?this.m?this.m.call(this.h,a):!1:!0};f.gf=function(a){var b=this.v;this.I(144,"inData(%#04x): %#04x\n",a,b);this.g&=~Rg;return b};f.jf=function(a){var b=this.g;this.I(144,"inStatus(%#04x): %#04x\n",a,b);return b};
f.$j=function(a,b){this.I(144,"outData(%#04x): %#04x\n",a,b);this.J=b;this.g&=~(Qg|Ug);a:{this.I(128,"transmitByte(%#04x)\n",b);if(this.Z){if(b==19){this.M=!0;break a}if(b==17){this.M=!1;break a}}this.m&&this.m.call(this.h,b)}jc(this.time,this.Y,Lg(this,Vg))};
f.Xj=function(a,b){this.I(144,"outControl(%#04x): %#04x\n",a,b);this.o?(this.L&&(b^this.j)&(Wg|Xg)&&(a=0,this.K?(a|=b&Wg?za.Pd.Ba:0,a|=b&Xg?za.Tc.Ba|za.Ld.Ba:0):(a|=b&Wg?za.Ge.Ba:0,a|=b&Xg?za.Rd.Ba:0),this.L.call(this.h,a)),Kg(this,b,this.j),this.j=b,this.j&Yg&&(this.o=!1)):(this.l=b,this.o=!0)};f.Vj=function(a,b){this.I(144,"outBaudRates(%#04x): %#04x\n",a,b);this.u=b};
function Kg(a,b,c){for(var d in a.H){var e=a.H[d];if(e){var g=+d,h=void 0,k=1,l=1;b!=void 0&&(g&g-1?(g=~g&255,h=!(b&g)):h=b&g,c!=void 0&&(k=(b^c)&g,l=0));k&&(Qc(e,0,0,h?1:Jc),l&&Hc(e))}}}var Ng=12,Og=16,Pg=192,Hg=142,Xg=2,Wg=32,Yg=64,Ig=39,Qg=1,Rg=2,Ug=4,Tg=128,Gg=133,Sg=15,Vg=240,Jg=238,Mg=[50,75,110,134.5,150,200,300,600,1200,1800,2E3,2400,3600,4800,9600,19200],Zg={},Fg=(Zg[Xg]="ledDTR",Zg[Wg]="ledRTS",Zg),Eg={0:[Dg.prototype.gf,Dg.prototype.$j],1:[Dg.prototype.jf,Dg.prototype.Xj],2:[null,Dg.prototype.Vj]};
n.VT100Serial=Dg;
function $g(a,b,c){Tc.call(this,a,b,c);this.ua=8192;this.Y=this.config.bufferAddr;this.df=this.config.bufferRAM;this.u=this.config.bufferWidth;this.K=this.config.bufferHeight;this.Da=this.ha=this.config.cellWidth||1;this.fa=this.config.cellHeight||1;this.L=null;this.eb=!1;this.gb=this.config.bufferBits||1;this.va=this.config.interruptRate;this.zb=this.config.refreshRate||60;this.Oa=this.J/this.u|0;this.cb=this.o/this.K|0;this.fa>1&&(this.K++,this.Z=0,this.ma=!1);this.v=Cb(this,this.config.bus);og(this);
this.L=this.config.fontROM;pg(this);this.X=F(this,"CPU");this.time=F(this,"Time");this.td=Yb(this.time,this.U,this.Nc.bind(this));this.time.T.push(this);jc(this.time,this.td,1E3/Math.max(this.zb,this.va))}m($g,Tc);$g.prototype.Cc=function(){this.time.g||Yc(this)};
function og(a){a.ba=a.u*a.ha;a.da=a.K*a.fa;var b=a.ba,c=a.da;a.T=0;if(!a.df&&(a.T=(a.ba*a.gb>>3)*a.da,!yd(a.v,a.Y,a.T,zd.Ua)))return!1;Xc(a,(a.u+1)*a.K);a.N=document.createElement("canvas");a.N.width=b;a.N.height=c;a.Aa=a.N.getContext("2d");a.H={};a.ef=1<<a.gb;a.V=Array(a.ef);a.V[0]=[0,0,0,255];a.V[1]=[255,255,255,255];a.yb=60;a.oa=!1;a.M=Array(a.u);a.sd&&(a.m[a.sd]=a.fb==null?!1:a.fb);return!0}
function pg(a){a.L&&(a.eb=!0,a.H[ah]=[bh(a,a.ha,a.fa),bh(a,a.ha,a.fa,a.oa)],a.H[ch]=[bh(a,a.ha*2,a.fa),bh(a,a.ha*2,a.fa,a.oa)],a.H[dh]=a.H[eh]=[bh(a,a.ha*2,a.fa*2),bh(a,a.ha*2,a.fa*2,a.oa)])}
function bh(a,b,c,d){a.I("createFontVariation(cxCell=%d, cyCell=%d, fUnderline=%b\n",b,c,d);var e=a.Da<=8?8:16,g=e>8?15:0,h=a.L.length/e,k=d===!1,l={ha:b,fa:c};l.canvas=document.createElement("canvas");l.canvas.width=b*16;l.canvas.height=h/16*c;l.context=l.canvas.getContext("2d");for(var u=l.context.createImageData(b,c),p=0;p<h;p++){for(var w=0,r=w;w<a.fa;w++){var q=p*e+(g+w&e-1);q=d&&w==8?255:a.L[q];for(var y=0;y<c/a.fa;y++){for(var x=0,B=0,z=B;B<a.ha;B++){var A=q&128>>(B>7?7:B);x=a.eb&&!A&&x?x:
A;for(var V=0;V<b/a.ha;V++){k&&(x=!x);var na=u,ua=z+r*na.width,U=a.V[x?1:0];ua*=U.length;na.data[ua]=U[0];na.data[ua+1]=U[1];na.data[ua+2]=U[2];na.data[ua+3]=U[3];z++}x=A}r++}}l.context.putImageData(u,(p&15)*b,(p>>4)*c)}return l}function Xc(a,b){a.ja=!1;b&&(a.ib=b,a.l===void 0||a.l.length!=a.ib)&&(a.l=Array(a.ib))}
$g.prototype.Nc=function(a){var b=!0;if(!a){this.va&&nf(this.X,4);if(b&&this.ja&&this.T){var c=this.v,d=this.Y,e=this.T,g=!0,h=d>>>c.h;for(d=c.blockSize-(d&c.i);e>0&&h<c.g.length;){var k=c.g[h];k.K?(k.K=!1,k.j.type==vd&&(k.l?(k.J=k.Jc,k.o=k.Mc):(k.ra=k.Jc,k.ia=k.Mc)),k=!0):k=!1;k&&(g=!1);e-=d;d=c.blockSize;h++}g&&(b=!1)}jc(this.time,this.td,1E3/Math.max(this.zb,this.va))}b&&Yc(this,a)};
function Yc(a,b){for(var c=0,d,e=-1,g=a.yb==60?2:5,h=0,k=0,l=-1,u=a.Y;c<a.K;){var p=0,w=u,r=a.u;d=e;for(d!=ah&&(r>>=1);;){var q=a.v.na(w++);if((q&fh)==fh){q=a.v.na(w++);e=q&gh;u=(q&hh)<<8|a.v.na(w);u+=q&ih?jh:kh;break}if(p<r)a.M[p++]=q;else break}if(g)g--;else{for(;p<a.M.length;)a.M[p++]=0;if(d>=0)for(w=a.ja&&a.l[h]==r,a.l[h++]=r,r=0;r<p;r++){var y=a.M[r];if(!w||y!==a.l[h]){a.l[l=h]=y;q=a;var x=d;var B=r;var z=c;var A=y;y=a.Aa;var V=A&127;if(A=q.H[x][A&128?1:0]){var na=(V&15)*A.ha;V=(V>>4)*A.fa;var ua=
A.ha,U=A.fa;if(y){B*=q.ha;var ma=z*q.fa;var Ia=q.ha;z=q.fa}else B*=q.Oa,ma=z*q.cb,Ia=q.Oa,z=q.cb;A.ha>q.ha&&(B*=2,Ia*=2);A.fa>q.fa&&(x==eh&&(V+=q.fa),U=q.fa);y?y.drawImage(A.canvas,na,V,ua,U,B,ma,Ia,z):q.m.drawImage(A.canvas,na,V,ua,U,B,ma,Ia,z)}k++}h++}c++}}a.ja=!0;!b&&a.ma&&k==1&&(a.l[l]=-1,k=0);a.ma=!1;(k||b)&&a.Aa&&a.m.drawImage(a.N,0,a.Z,a.ba,a.da-a.fa,0,0,a.Ke,a.Le)}var ah=96,ch=64,dh=32,eh=0,fh=127,hh=15,ih=16,gh=96,jh=8192,kh=16384;n.VT100Video=$g;
function lh(a,b,c){E.call(this,a,a);var d=this;this.i=!1;this.o=c;this.h="";this.m=this.l=!1;Jb(this,!1);this.ua=0;b=b.trim();b[0]=="{"?mh(this,b):(this.h=b,gb(this.h,function(e,g,h,k){h==4&&(!k&&g?(mh(d,g),nh(d)):d.I("error (%d) loading configuration: %s\n",k,e))}));window.addEventListener("load",function(){d.m=!0;nh(d)});window.addEventListener(lb("iOS")?"pagehide":lb("Opera")?"unload":"beforeunload",function(){oh(d)});window.addEventListener("pageshow",function(){d.i||d.qa(!0)})}m(lh,E);
lh.prototype.Pa=function(a,b){var c=this;switch(a){case ph:b.onclick=function(){c.qa()};break;case qh:b.onclick=function(){c.la()}}E.prototype.Pa.call(this,a,b)};
function nh(a){var b=!0;if(a.l&&a.m){for(var c in a.g){var d=void 0,e=a.g[c];try{d=e["class"],n[d]?d=="Machine"?(a.I("PCjs %s v%3.2f\n%s\n",e.name,3,"Copyright \u00a9 2012-2025 Jeff Parsons <Jeff@pcjs.org>"),a.h&&a.I("Configuration: %s\n",a.h)):new n[d](a.$,c,e):a.I('unrecognized %s device "%s"\n',d,c)}catch(h){e.optional||(a.I('error initializing %s device "%s": %s\n',d,c,h.message),b=!1),Lb(a,c)}}if(a.j){var g=mb(a);Fb(a,function(h){return h.Jb&&!h.Jb(g)?(h.I('unable to restore state for device "%s"\n',
h.U),!1):!0})}Jb(a,!0);Kb(a,a.qa.bind(a,b))||a.I("machine %s not ready to power, waiting for device(s)\n",a.$)}}
function mh(a,b){try{a.g=JSON.parse(b);var c=a.g[a.$];if(!c){c=a.g[Sa(a.h)];if(!c)throw Error("configuration missing machine ID");a.g[a.$]=c}Db(a,c,["autoSave","autoStart"]);a.j=a.config.autoSave!==!1;a.u=a.config.autoStart!==!1;if(a.o){var d=eval("("+a.o+")"),e;for(e in d)a.config[e]=d[e]}a.l=!0}catch(g){c=g.message,(d=c.match(/position ([0-9]+)/))&&(c+=" ('"+b.substr(+d[1],40).replace(/\s+/g," ")+"...')"),a.I("machine '%s' initialization error: %s\n",a.$,c)}}
lh.prototype.qa=function(a){a=a===void 0?!this.i:a;if(Ib(this)){var b=this;a&&this.I("power on\n");Fb(this,function(c){c.qa&&c!=b&&(c.config["class"]!="CPU"||b.u&&Ib(b)?c.qa(a):c.time.update(!0));return!0});(this.i=a)||this.I("power off\n")}};lh.prototype.la=function(){if(Ib(this)){var a=this;Fb(this,function(b){b.la&&b!=a&&b.la();return!0});this.I("reset\n")}};function oh(a){if(a.j){var b=[];Fb(a,function(c){c.Xa&&c.Xa(b);return!0});ub(a,b)}a.qa(!1)}var ph="power",qh="reset";
window.VT100=function(a,b,c){var d=new lh(a,b,c);window.command=function(e){return nb(d,e)};return d};n.Machine=lh;})()

//# sourceMappingURL=vt100.js.map
