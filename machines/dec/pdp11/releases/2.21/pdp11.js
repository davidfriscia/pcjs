(function(){/*
 https://www.pcjs.org/machines/modules/v2/message.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/diskapi.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/dumpapi.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/reportapi.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/userapi.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/keys.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/message.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/embed.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/defines.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/format.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/pcfs.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/strlib.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/usrlib.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/weblib.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/component.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/defines.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/panel.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/bus.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/device.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/memory.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/cpu.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/cpustate.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/cpuops.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/rom.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/ram.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/keyboard.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/serial.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/pc11.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/disk.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/drive.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/rk11.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/rl11.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/rx11.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/dbglib.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/debugger.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v2/computer.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/state.js (C) 2012-2025 Jeff Parsons
*/
var k,aa=typeof Object.create=="function"?Object.create:function(a){function b(){}b.prototype=a;return new b},ba=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};
function ca(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var da=ca(this),ea="Int8 Uint8 Uint8Clamped Int16 Uint16 Int32 Uint32 Float32 Float64".split(" ");da.BigInt64Array&&(ea.push("BigInt64"),ea.push("BigUint64"));
function fa(a,b){if(b)for(var c=0;c<ea.length;c++)ha(ea[c]+"Array.prototype."+a,b)}function ia(a,b){b&&ha(a,b)}function ha(a,b){var c=da;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))return;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&b!=null&&ba(c,a,{configurable:!0,writable:!0,value:b})}var ja;
if(typeof Object.setPrototypeOf=="function")ja=Object.setPrototypeOf;else{var ka;a:{var la={a:!0},ma={};try{ma.__proto__=la;ka=ma.a;break a}catch(a){}ka=!1}ja=ka?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var oa=ja;
function t(a,b){a.prototype=aa(b.prototype);a.prototype.constructor=a;if(oa)oa(a,b);else for(var c in b)if(c!="prototype")if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.Kk=b.prototype}function pa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}
function qa(a){var b=typeof Symbol!="undefined"&&Symbol.iterator&&a[Symbol.iterator];if(b)return b.call(a);if(typeof a.length=="number")return{next:pa(a)};throw Error(String(a)+" is not an iterable or ArrayLike");}function ra(a){if(!(a instanceof Array)){a=qa(a);for(var b,c=[];!(b=a.next()).done;)c.push(b.value);a=c}return a}function sa(){for(var a=Number(this),b=[],c=a;c<arguments.length;c++)b[c-a]=arguments[c];return b}
ia("String.prototype.replaceAll",function(a){return a?a:function(b,c){if(b instanceof RegExp&&!b.global)throw new TypeError("String.prototype.replaceAll called with a non-global RegExp argument.");return b instanceof RegExp?this.replace(b,c):this.replace(new RegExp(String(b).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"),"g"),c)}});
ia("Math.trunc",function(a){return a?a:function(b){b=Number(b);if(isNaN(b)||b===Infinity||b===-Infinity||b===0)return b;var c=Math.floor(Math.abs(b));return b<0?-c:c}});ia("String.prototype.repeat",function(a){return a?a:function(b){if(this==null)throw new TypeError("The 'this' value for String.prototype.repeat must not be null or undefined");var c=this;if(b<0||b>1342177279)throw new RangeError("Invalid count value");b|=0;for(var d="";b;)if(b&1&&(d+=c),b>>>=1)c+=c;return d}});
ia("Number.isNaN",function(a){return a?a:function(b){return typeof b==="number"&&isNaN(b)}});ia("Symbol",function(a){function b(f){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c(d+(f||"")+"_"+e++,f)}function c(f,g){this.i=f;ba(this,"description",{configurable:!0,writable:!0,value:g})}if(a)return a;c.prototype.toString=function(){return this.i};var d="jscomp_symbol_"+(Math.random()*1E9>>>0)+"_",e=0;return b});
ia("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");ba(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return wa(pa(this))}});return a});function wa(a){a={next:a};a[Symbol.iterator]=function(){return this};return a}function xa(a,b){a instanceof String&&(a+="");var c=0,d=!1,e={next:function(){if(!d&&c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}d=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e}
ia("Array.prototype.keys",function(a){return a?a:function(){return xa(this,function(b){return b})}});ia("Math.log2",function(a){return a?a:function(b){return Math.log(b)/Math.LN2}});ia("Array.prototype.fill",function(a){return a?a:function(b,c,d){var e=this.length||0;c<0&&(c=Math.max(0,e+c));if(d==null||d>e)d=e;d=Number(d);d<0&&(d=Math.max(0,e+d));for(c=Number(c||0);c<d;c++)this[c]=b;return this}});fa("fill",function(a){return a?a:Array.prototype.fill});
var ya=typeof window!="undefined",za=typeof window!="undefined"?{}:global,u=typeof window!="undefined"?window:global,Aa=typeof document!="undefined"?document:{},w={machines:{},components:[],commands:{},files:null};u.PCjs?w=u.PCjs:u.PCjs=w;u.LOCALDISKS=!1;var y={log:68719476736,warn:549755813888,halt:70368744177664,buffer:0x800000000000};function Ba(){this.i={};for(var a=0;a<23;a++)this.i["ACDFGHMNSTWYBbdfjcsoXx%"[a]]=null}
function Ca(){var a=sa.apply(0,arguments);if(a[0]===void 0)a=new Date(Date.now());else if(typeof a[0]==="string"){var b=a[0];b.indexOf(":")<0?b+=" "+(a[1]||"00:00:00 UTC"):b.match(/^[0-9][0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9] [0-9][0-9]:[0-9][0-9]:[0-9][0-9]$/)&&(a[1]||(b+=" UTC"));a=new Date(b)}else a=a[1]===void 0?new Date(a[0]):new Date(Date.UTC.apply(Date,ra(a)));return a}
Ba.prototype.g=function(a){var b=sa.apply(1,arguments);if(!b||!b.length)return a;var c="",d=a.split(/%([-+ 0#]*)([0-9]*|\*)(\.[0-9]+|)([bwhlL]?)([A-Za-z%])/),e=0,f;for(f=0;f<d.length-6;f+=6){c+=d[f];var g=d[f+5];if(this.i[g]===void 0)c+="%"+d[f+1]+d[f+2]+d[f+3]+d[f+4]+g;else{if(e<b.length){var h=b[e];g!="%"&&e++}else h=b[b.length-1];var l=!1,m=d[f+1],n=m.indexOf("#")>=0,r=m.indexOf("0")>=0,p=d[f+2];p=="*"?(p=h,h=e<b.length?b[e++]:b[b.length-1]):p=+p||0;var q=d[f+3];q=q?+q.substr(1):-1;var v=d[f+4],
D=null,B=0,x="",E="ACDFGHMNSTWY".indexOf(g)>=0&&typeof h!="object"?Ca(h):h;switch(g){case "C":c+=isNaN(E.getTime())?void 0:this.g("%#W, %#F %#D, %#Y".replaceAll("#",n?"#":""),E);continue;case "D":h=n?E.getUTCDate():E.getDate();g="d";break;case "A":case "G":case "H":h=n?E.getUTCHours():E.getHours();g=="A"?(h=h<12?"am":"pm",g="s"):(g=="G"&&(h=h?h>12?h-12:h:12),g="d");break;case "F":case "M":h=n?E.getUTCMonth():E.getMonth();g=="F"?(h=Da[h],g="s"):(h++,g="d");break;case "N":h=n?E.getUTCMinutes():E.getMinutes();
g="d";break;case "S":h=n?E.getUTCSeconds():E.getSeconds();g="d";break;case "T":c+=isNaN(E.getTime())?void 0:this.g("%#Y-%#02M-%#02D %#02H:%#02N:%#02S".replaceAll("#",n?"#":""),E);continue;case "W":h=Ea[n?E.getUTCDay():E.getDay()];g="s";break;case "Y":h=n?E.getUTCFullYear():E.getFullYear(),q>0&&(h%=Math.pow(10,q)),g="d"}switch(g){case "b":c+=h?"true":"false";break;case "d":h=Math.trunc(h),q>=0&&(r=!0,p<q&&(p=q),q=-1);case "f":h=+h;g=h+"";q>=0&&(g=h.toFixed(q));g.length<p&&(r?(h<0&&(p--,g=g.substr(1)),
g=("0".repeat(p)+g).slice(-p),h<0&&(g="-"+g)):g=(" ".repeat(p)+g).slice(-p));c+=g;break;case "j":c+=JSON.stringify(h,null,p||void 0);break;case "c":h=typeof h=="string"?h[0]:String.fromCharCode(h);case "s":if(h!=void 0)for(typeof h!="string"&&(h=h.toString()),q>=0&&(h=h.substr(0,q));h.length<p;)h=m.indexOf("-")>=0?h+" ":" "+h;c+=h;break;case "B":B=2,n&&(x="0b");case "o":B||(B=8),!x&&n&&(x="0o");case "X":D=Fa;case "x":g="";B||(B=16);!x&&n&&(x="0x");D||(D=Ga);typeof h=="string"&&h[0]=="-"&&(l=!0,h=
h.slice(1));h=Math.trunc(h);l&&(h=-h);h<0&&((h|0)==h?h>>>=0:Math.abs(h)<=9007199254740992&&(h+=9007199254740992));q>=0&&(r=!0,p<q&&(p=q));r&&!p&&(v=="b"?p=2:v=="h"||v=="w"?p=4:v=="l"?p=8:(p=Math.abs(h),p=p<=255?2:p<=65535?4:p<=4294967295?8:9),p+=x.length);p-=x.length;do l=16,Number.isNaN(h)||(l=h&B-1,h=Math.trunc(h/B)),r||!g||l||h?g=D[l]+g:(x&&(g=x+g,x=""),p>0&&(g=" "+g));while(--p>0||h);c+=x+g;break;case "%":c+="%";break;default:c=this.i[g]?c+this.i[g](g,m,p,q,h):c+("(unimplemented sprintf type: %"+
g+")")}}}return c+=d[f]};
var Ea="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Da="January February March April May June July August September October November December".split(" "),Ga="0123456789abcdef?",Fa="0123456789ABCDEF?",Ia={163840:[40,1,8,,254],184320:[40,1,9,,252],327680:[40,2,8,,255],368640:[40,2,9,,253],737280:[80,2,9,,249],1228800:[80,2,15,,249],1474560:[80,2,18,,240],1720320:[80,2,21,,240],1884160:[80,2,23,,249],2949120:[80,2,36,,240],10653696:[306,4,17],21411840:[615,4,17],256256:[77,1,
26,128],2494464:[203,2,12,512],5242880:[256,2,40,256],10485760:[512,2,40,256]},Ja={zi:0,Be:1,Ii:2,Ji:3,Ki:4,Li:5,Mi:6,Ni:7,Id:8,Oi:9,Ce:10,Pi:11,Qi:12,De:13,Ri:14,Si:15,Ti:16,Ui:17,Vi:18,Wi:19,Xi:20,Yi:21,Zi:22,$i:23,aj:24,bj:25,cj:26,jj:27," ":32,"!":33,'"':34,"#":35,$:36,"%":37,"&":38,"'":39,"(":40,")":41,"*":42,"+":43,",":44,"-":45,".":46,"/":47,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,":":58,";":59,"<":60,"=":61,">":62,"?":63,"@":64,Gd:65,ui:66,Ci:67,dj:68,E:69,lj:70,oj:71,Aj:72,Cj:73,
Dj:74,Ej:75,Fj:76,Ij:77,Kj:78,Pj:79,Sj:80,Q:81,Uj:82,Wj:83,ek:84,hk:85,jk:86,kk:87,pk:88,qk:89,vf:90,"[":91,"\\":92,"]":93,"^":94,_:95,"`":96,a:97,b:98,c:99,d:100,e:101,f:102,xk:103,yk:104,zk:105,Ek:106,k:107,Fk:108,Gk:109,n:110,Hk:111,p:112,q:113,r:114,s:115,t:116,Lk:117,Mk:118,w:119,x:120,y:121,z:122,"{":123,"|":124,"}":125,"~":126,Ub:127};
function Ka(a){var b=null,c=a.indexOf(La)==0?w.files:null;if(c){a=a.slice(La.length+1).split("/");var d,e;for(d=0;d<a.length;d++){var f=a[d],g=!1;if(!f){b=c;break}for(e=0;e<c.files.length;e++){var h=c.files[e];if(h.name.toLowerCase()==f.toLowerCase()){if(d==a.length-1){b=h;break}if(h.files){c=h;g=!0;break}}}if(b)break;if(!g&&d<a.length-1)break}}return b}var La="/pcfs";w.files||(w.files={name:"",size:0,sk:16,vk:new Date,files:[]});function Ma(){}
function Pa(a,b){if(a){b||(b=10);var c,d=a.indexOf(",")>0;d&&(a=a.replace(/,/g,""));var e=c=a.charAt(0);c=="#"?(b=8,c=""):c=="$"&&(b=16,c="");e!=c?a=a.substr(1):(e=c=a.substr(0,2),c=="0b"&&d||c=="^B"?(b=2,c=""):c=="0o"||c=="^O"?(b=8,c=""):c=="^D"?(b=10,c=""):c=="0x"&&(b=16,c=""),e!=c&&(a=a.substr(2)));e=c=a.slice(-1);c=="Y"||c=="y"?(b=2,c=""):c=="."?(b=10,c=""):c=="H"||c=="h"?(b=16,c=""):c=="K"?c="000":c=="M"?c="000000":c=="G"&&(c="000000000");e!=c&&(a=a.slice(0,-1)+c);var f;e=0;b<=10&&(c=a.match(/(-?[0-9]+)B([0-9]*)/))&&
(a=c[1],e=35-((c[2]||35)&255));if((b&&b!=10?b==16?a.match(/^-?[0-9a-f]+$/i)!==null:b==8?a.match(/^-?[0-7]+$/)!==null:b==2&&a.match(/^-?[01]+$/)!==null:a.match(/^-?[0-9]+$/)!==null)&&!isNaN(f=parseInt(a,b))){e&&(f<0&&(f+=68719476736),f=e>0?f*Math.pow(2,e):Math.trunc(f/Math.pow(2,-e)));var g=f}}return g}
function Qa(a,b,c,d,e){e=e===void 0?0:e;var f="";isNaN(a)||typeof a!="number"?a=null:(a<0&&a>-1&&(a=-1),a<0&&(a+=Math.pow(b,c)),a>=Math.pow(b,c)&&(c=Math.ceil(Math.log(a)/Math.log(b))));for(var g=e||-1;c-- >0;){g||(f=","+f,g=e);if(a==null)f="?"+f;else{var h=a%b;h+=h>=0&&h<=9?48:55;f=String.fromCharCode(h)+f;a=Math.trunc(a/b)}g--}return(d===void 0?"":d)+f}function Ra(a,b,c){b?b>36&&(b=36):(b=Math.abs(a),b=b<=255?8:b<=262143?18:36);return Qa(a,2,b,"",c)}
function Sa(a,b,c){b?b>12&&(b=12):(b=Math.abs(a),b=b<=262143?6:b<=16777215?8:12);return Qa(a,8,b,c?"0o":"")}function Ta(a,b){b?b>11&&(b=11):b=Math.abs(a)<=99999?5:11;return Qa(a,10,b)}function Ua(a,b,c){b?b>9&&(b=9):(b=Math.abs(a),b=b<=255?2:b<=65535?4:b<=4294967295?8:9);return Qa(a,16,b,c?"0x":"")}function Va(a,b){var c=a,d=a.lastIndexOf("/");d>=0&&(c=a.substr(d+1));d=c.indexOf("&");d>0&&(c=c.substr(0,d));b&&(d=c.lastIndexOf("."),d>0&&(c=c.substring(0,d)));return c}
function Wa(a){var b="",c=a.lastIndexOf(".");c>=0&&(b=a.substr(c+1).toLowerCase(),b=="json5"&&(b="json"));return b}function Xa(a,b){return a.indexOf(b,a.length-b.length)!==-1}function Ya(a){return a.replace(/[&<>"'$]/g,function(b){return Za[b]})}function $a(a,b){return db("%"+b+"."+Math.abs(b)+"s",a)}function eb(a){return String.prototype.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}
var Za={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;",$:"&dollar;"},fb={0:"NUL",1:"SOH",2:"STX",3:"ETX",4:"EOT",5:"ENQ",6:"ACK",7:"BEL",8:"BS",9:"TAB",10:"LF",11:"VT",12:"FF",13:"CR",14:"SO",15:"SI",16:"DLE",17:"XON",18:"DC2",19:"XOFF",20:"DC4",21:"NAK",22:"SYN",23:"ETB",24:"CAN",25:"EM",26:"SUB",27:"ESC",28:"FS",29:"GS",30:"RS",31:"US",127:"DEL"},gb=new Ba,db=gb.g.bind(gb);
function hb(a,b,c){var d=0,e=a.length,f=0;for(c===void 0&&(c=function(l,m){return l>m?1:l<m?-1:0});d<e;){var g=d+e>>1,h=void 0;h=c(b,a[g]);h>0?d=g+1:(e=g,f=!h)}return f?d:~d}
function ib(a,b,c,d){function e(){if(m.readyState!==4)return null;try{g=n?m.response:m.responseText}catch(q){z(68719476736,"getResource(%s) exception: %s\n",a,q.message)}if(g!=null&&(m.status==200||!m.status&&g.length&&(u.location?u.location.protocol:"file:")=="file:"))z(2267742732288,"getResource(%s): returned %d bytes\n",a,g.length);else if(f=m.status||-1,z(2199023255552,"getResource(%s) error: %d\n",a,f),!m.status&&!jb){var p=a.match(/(^https?:\/\/[^/]+)(.*)/);p&&(jb=!0,kb("PCjs was unable to perform a cross-origin resource request to '"+
p[1]+"'.\n\nIf you're running an ad blocker, try adding '"+lb()+"' to your whitelist (or find a smarter ad blocker)."))}d&&d(a,g,f);return[g,f]}b=b===void 0?"text":b;c=c===void 0?!1:c;var f=0,g=null,h=null,l=u.resources;if(typeof l=="object"&&(g=l[a]))return d&&d(a,g,f),[g,f];if(c&&typeof l=="function")return l(a,function(p,q){d&&d(a,p,q)}),h;a=u.LOCALDISKS&&(u.location?u.location.hostname:"localhost").match(/^(.+\.local|localhost|0\.0\.0\.0|pcjs)$/)?a.replace(/^\/(diskettes|gamedisks|miscdisks|harddisks|decdisks|pcsigdisks|pcsig[0-9a-z]*-disks|private)\//,
"/disks/$1/").replace(/^\/discs\/([^/]*)\//,"/disks/cdroms/$1/"):a.replace(/^\/(disks\/|)(diskettes|gamedisks|miscdisks|harddisks|decdisks|pcsigdisks|pcsig[0-9a-z]*-disks|private)\//,"https://$2.pcjs.org/").replace(/^\/(disks\/cdroms|discs)\/([^/]*)\//,"https://$2.pcjs.org/");z(2199023255552,"getResource(%s)\n",a);if(za.Zf&&a.indexOf("http")!=0){try{l=b=="arraybuffer"?null:"utf8",g=za.Zf(a,l),l||(g=g.buffer,g.buffer&&(g=g.buffer))}catch(p){f=p.errno}if(g!==void 0)return d&&d(a,g,f),[g,f]}if(a.indexOf(La)==
0&&(l=Ka(a)))return g=l.data,d&&d(a,g,f),[g,f];!a.match(/^[A-Z]:/i)&&a.indexOf("?")<0&&(a=encodeURI(a));if(u.XMLHttpRequest)var m=new u.XMLHttpRequest;else if(u.ActiveXObject)m=new u.ActiveXObject("Microsoft.XMLHTTP");else if(u.fetch)return fetch(a).then(function(p){switch(b){case "json":case "text":return p.text();case "arraybuffer":return p.arrayBuffer();default:throw Error("unsupported response type: "+b);}}).then(function(p){z(2267742732288,"getResource(%s): fetched %d bytes\n",a,p.length);d&&
d(a,p,f)}).catch(function(){z(68719476736,"getResource(%s) fetch error: %d\n",a,f);d&&d(a,g,f)}),h;var n=!1;l=typeof m.responseType==="string";c&&(m.onreadystatechange=e);if(b&&typeof b=="object"){l="";for(var r in b)b.hasOwnProperty(r)&&(l&&(l+="&"),l+=r+"="+encodeURIComponent(b[r]));l=l.replace(/%20/g,"+");z(2267742732288,"getResource(%s): posted %d bytes\n",a,l.length);m.open("POST",a,c);m.setRequestHeader("Content-type","application/x-www-form-urlencoded");m.send(l)}else m.open("GET",a,c),b==
"arraybuffer"&&(l?(n=!0,m.responseType=b):m.overrideMimeType("text/plain; charset=x-user-defined")),m.send();c||(m.readyState=4,h=e());return h}
function mb(a,b){var c,d={ba:null,ga:null,ya:null,xa:null};if(b.charAt(0)=="["||b.charAt(0)=="{")try{var e,f;if(b.charAt(0)=="<")throw Error(b);if(b.indexOf("0x")<0&&b.indexOf("0o")<0&&b.substr(0,2)!='["'){b.indexOf('"values"')<0&&(b=b.replace(/([a-z]+):/gm,'"$1":').replace(/\/\/[^\n]*/gm,""));var g=JSON.parse(b)}else g=eval("("+b+")");d.ya=g.load;d.xa=g.exec;var h=g.width,l=g.values;h&&l&&(h==8?g.bytes=l:h==16?g.words=l:h==32?g.longs=l:g.data=l);if(e=g.bytes)d.ba=e;else if(e=g.words)for(d.ba=Array(e.length*
2),f=c=0;c<e.length;c++)d.ba[f++]=e[c]&255,d.ba[f++]=e[c]>>8&255;else if(e=g.longs)for(d.ba=Array(e.length*4),f=c=0;c<e.length;c++)d.ba[f++]=e[c]&255,d.ba[f++]=e[c]>>8&255,d.ba[f++]=e[c]>>16&255,d.ba[f++]=e[c]>>24&255;else(e=g.data)?d.rk=e:d.ba=g;d.ba&&(d.ba.length?d.ba.length==1&&(A(d.ba[0]),d=null):(A("Empty resource: "+a),d=null));d.ga=g.symbols}catch(m){A("Resource data error ("+a+"): "+m.message),d=null}else{e=[];b=b.replace(/\n/gm," ").replace(/ +$/,"").split(" ");for(c=0;c<b.length;c++){f=
parseInt(b[c],16);if(isNaN(f)){A("Resource data error ("+a+"): invalid hex byte ("+b[c]+")");break}e.push(f&255)}c==b.length&&(d.ba=e)}return d}function lb(){return u.location?u.location.protocol+"//"+u.location.host:"https://www.pcjs.org"}
function nb(){if(ob==null){var a=!1;if(u.localStorage)try{u.localStorage.setItem("PCjs.localStorage","PCjs.localStorage"),a=u.localStorage.getItem("PCjs.localStorage")=="PCjs.localStorage",u.localStorage.removeItem("PCjs.localStorage")}catch(b){pb(b),a=!1}ob=a}return ob}function pb(a){z(1099511627776,"Local storage error: %s\n",a.message)}function qb(a){if(nb())try{var b=u.localStorage.getItem(a)}catch(c){pb(c)}return b}
function tb(a,b){if(nb())try{return u.localStorage.setItem(a,b),!0}catch(c){pb(c)}return!1}function ub(a){if(u.navigator){var b=u.navigator?u.navigator.userAgent:"";return a=="iOS"&&(!!b.match(/(iPod|iPhone|iPad)/)||u.navigator.platform==="MacIntel"&&u.navigator.maxTouchPoints>1)||a=="MSIE"&&!!b.match(/(MSIE|Trident)/)||b.indexOf(a)>=0}return!1}function vb(){var a,b=wb("mobile");if(b)return b=="true";if(ub("Mobi")){if(!a)return!0;(b=a[0]=="!")&&(a=a.substr(1));return ub(a)!=b}return!1}
function wb(a){if(!xb){var b,c={};if(u.location){b||(b=u.location.search.substr(1));for(var d,e=/\+/g,f=/([^&=]+)=?([^&]*)/g;d=f.exec(b);)c[decodeURIComponent(d[1].replace(e," "))]=decodeURIComponent(d[2].replace(e," "))}xb=c}return xb[a]||xb[a.toLowerCase()]}function yb(a,b,c){function d(){--a;a>=0&&(b()||(a=0));a>0?setTimeout(d,0):c()}d()}
function zb(a,b){function c(){b(d===100)&&(e=setTimeout(c,d),d=100)}var d=0,e=null,f=!1;a.onmousedown=function(){f||e||(d=500,c())};a.ontouchstart=function(){e||(d=500,c())};a.onmouseup=a.onmouseout=function(){e&&(clearTimeout(e),e=null)};a.ontouchend=a.ontouchcancel=function(){e&&(clearTimeout(e),e=null);f=!0}}function Fb(a){Gb.init.push(a)}function Hb(a){z(274877906944,"%s\n\nIf it happens again, please send the URL to support@pcjs.org. Thanks.\n",a)}
function Ib(a){if((a=Gb[a])&&Jb)try{for(var b=0;b<a.length;b++)a[b]()}catch(c){Hb("An unexpected error occurred: "+c.message)}}function Kb(a){!Jb&&a?(Jb=!0,Lb&&Ib("init"),Mb&&Ib("show")):Jb=a}var xb=null,Gb={init:[],show:[],exit:[]},Lb=!1,Mb=!1,Jb=!0,jb=!1,ob=null;function Nb(){Lb=!0;Ib("init",!0)}u.addEventListener&&u.addEventListener("load",Nb);function Ob(){Mb=!0;Ib("show",!0)}u.addEventListener&&u.addEventListener("pageshow",Ob);var Pb=ub("iOS")?"pagehide":ub("Opera")?"unload":"beforeunload";
function Qb(){Ib("exit",!0)}u.addEventListener&&u.addEventListener(Pb,Qb);
function C(a,b,c){this.type=a;b||(b={id:"",name:""});this.name=b.name;this.Rd=b.comment;this.tf=b;++Rb;this.id=this.id=b.id||"";this.exports={};this.J=this.bindings={};a=this.id.indexOf(".");a<0?(this.fb="PCjs",this.Wc=this.id):(this.fb=this.id.substr(0,a),this.Wc=this.id.substr(a+1));this.flags={ready:!1,bb:!1,ud:!1,Dk:!1,ia:!1,we:!1,error:!1};this.Lc=null;this.flags.error=!1;this.ha=c||0;this.H=this.i=this.G=this.N=null;w.components.push(this)}
function Sb(a,b,c){w.machines[a]&&b&&(w.machines[a][b]=c,b=="parms"&&typeof c=="string"&&(w.machines[a].config=eval("("+c+")")))}function Tb(){return Date.now()||+new Date}function z(a){var b=sa.apply(1,arguments),c=0;typeof a=="number"&&(c=a,a=b.shift());if(c>=68719476736&&c<=1099511627776){var d=!1;c==1099511627776?(d=!0,a="Error: "+a):c==549755813888?(d=!0,a="Warning: "+a):c==274877906944&&(d=!0);b=db.apply(Ma,[a].concat(ra(b))).trim();d?kb(b):console.log(b)}}function A(a){z(1099511627776,a)}
function kb(a){u.alert&&u.alert(a);console.log(a)}function Ub(a){var b=!1;u.confirm&&(b=u.confirm(a));return b}
function Vb(a,b){b=F("pdp11-control","",b.parentNode);for(var c=0;c<b.length;c++)for(var d=b[c].childNodes,e=0;e<d.length;e++){var f=d[e];if(f.nodeType===1){var g=f.getAttribute("class");if(g)for(var h=g.split(" "),l=0;l<h.length;l++)switch(g=h[l],g){case "pdp11-binding":(g=Wb(f))&&g.binding!==void 0?a.ta(g.type,g.binding,f,g.value):g&&g.type=="description"||z(549755813888,'Component "%s" missing binding%s\n',a.toString(),g?" for "+g.type:""),l=h.length}}}}
function Xb(a){var b,c=[];a&&(b=a.indexOf("."))>0&&(a=a.substr(0,b+1));var d=w.components;for(b=0;b<d.length;b++){var e=d[b];a&&e.id.indexOf(a)!=0||c.push(e)}return c}function Yb(a,b){if(a!==void 0){var c;b&&(c=b.indexOf("."))>0&&(a=b.substr(0,c+1)+a);var d=w.components;for(c=0;c<d.length;c++)if(d[c].id===a)return d[c];d.length&&b!==!1&&z(549755813888,'Component ID "%s" not found\n',a)}return null}
function Zb(a,b){var c=c===void 0?null:c;if(a!==void 0){var d;b&&(b=(d=b.indexOf("."))>0?b.substr(0,d+1):"");var e=w.components;for(d=0;d<e.length;d++)if(c)c==e[d]&&(c=null);else if(!(a!=e[d].type||b&&e[d].id.indexOf(b)))return e[d]}return null}function Wb(a){var b=null;if(a.getAttribute){if(a=a.getAttribute("data-value"))try{b=eval("("+a+")")}catch(d){A(d.message+" ("+a+")")}}else if(b=a.config||null){a=a.id;var c=b.id;a&&c&&c.indexOf(".")<0&&(b.id=a+"."+c)}return b}
function F(a,b,c){b=b===void 0?"":b;c=c===void 0?Aa:c;var d=[];b&&(a+="-"+b,b!="machine"&&(a+="-object"));if(ya)if(c.getElementsByClassName)d=c.getElementsByClassName(a);else{if(c.getElementsByTagName){b=c.getElementsByTagName("*");var e=new RegExp("(^| )"+a+"( |$)");a=0;for(c=b.length;a<c;a++)e.test(b[a].className)&&d.push(b[a])}}else for(a=Object.keys(w.machines),c=0;c<a.length;c++){e=a[c];var f=w.machines[e].config;if(f&&(f=f[b])){Array.isArray(f)||(f=[f]);f=qa(f);for(var g=f.next();!g.done;g=
f.next())d.push({id:e,config:g.value})}}return d}
function $b(a){for(var b=!0,c=w.commands[a];c&&c.length;){var d=c.splice(0,1)[0],e=d[0];z(8796093022208,d.join(" "));var f=null;ec.indexOf(e)>=0&&(f=function(){return function(){$b(a)}}());var g=fc[e];if(g)if(!f)b=g(d[1],d[2],d[3]);else{if(!g(f,d[1],d[2],d[3]))break}else{b=!1;var h=Zb(d[1],a);if(h)if(g=hc[e])b=g(h,d[2],d[3]);else{var l=h.exports;if(l&&(g=l[e]))if(b=!0,!f)b=g.call(h,d[2],d[3]);else if(!g.call(h,f,d[2],d[3]))break}}if(!b){kb("Script error: '"+e+"' command "+(g?" failed":" not recognized"));
break}}c&&!c.length&&delete w.commands[a];return b}k=C.prototype;k.toString=function(){return this.name?this.name:this.id||this.type};
k.ta=function(a,b,c){switch(b){case "clear":return this.J[b]||(this.J[b]=c,c.onclick=function(d){return function(){d.J.print&&(d.J.print.value="")}}(this)),!0;case "print":return this.J[b]||(this.J[b]=c,c.value="",this.print=function(d,e){return function(f,g){f||(f="");if((g===void 0?0:g)==4398046511104&&f.slice(-4)=="...\n"){g=f.slice(0,-1);var h=e.value,l=h.lastIndexOf(g);h=l<0?h+(g+"\n"):h.substr(0,l)+(f.slice(0,-1)+".")+h.substr(l+g.length);h.length>8192&&(h=h.substr(h.length-4096));e.value=h}else e.value+=
f,f=e.value,f.length>8192&&(e.value=f.substr(f.length-4096));e.scrollTop=e.scrollHeight}}(this,c)),!0;default:return!1}};k.print=function(a,b){z(b===void 0?0:b,a)};function ic(a,b){a.flags.error=!0;a.u(274877906944,"%s\n",b)}function jc(a){return a.flags.error?(a.print(a.toString()+" error\n"),!0):!1}function kc(a,b){b&&(a.flags.ready?b():a.Lc=b);return a.flags.ready}function G(a,b){a.flags.error||(a.flags.ready=b!==!1,a.flags.ready&&(b=a.Lc,a.Lc=null,b&&b()))}
function lc(a,b){a.flags.bb&&(b?a.flags.ud=!0:b===void 0&&a.print(a.toString()+" busy\n"));return a.flags.bb}function mc(a,b){if(a.flags.ud)return a.flags.bb=!1,a.flags.ud=!1;if(a.flags.error)return a.print(a.toString()+" error\n"),!1;a.flags.bb=b;return a.flags.bb}k.Ba=function(){return this.flags.ia=!0};k.Aa=function(a,b){b&&(this.flags.ia=!1);return!0};function nc(a,b){var c=b/4294967296|0;return(a&b)==(b|0)&&((a/4294967296|0)&c)==c}
function oc(a,b){b=b===void 0?0:b;b&1&&--b;b=b||a.ha;return!nc(b,2199023255552)&&(nc(0xff000000000-(a.H?618475290624:0),b)||a.H&&nc(a.H.ha,b))?!0:!1}k.u=function(a){var b=sa.apply(1,arguments),c=0;typeof a=="number"&&(c=a||4398046511104,a=b.shift(),nc(c,68719476736)?a=(this.id||this.type||"log")+": "+a:nc(c,137438953472)&&(a=this.type+": "+a));oc(this,c)&&(b=db.apply(Ma,[a].concat(ra(b))),this.H&&this.H.message?this.H.message(b,c):this.print(b,c))};
var ec=["hold","sleep","wait"],fc={alert:function(a){kb(a);return!0},sleep:function(a,b){setTimeout(a,+b);return!1}},hc={select:function(a,b,c){var d=!1;if(a=a.bindings[b])for(b=0;b<a.options.length;b++)if(a.options[b].textContent==c){a.selectedIndex!=b&&(a.selectedIndex=b);d=!0;break}return d}},Rb=0;Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){b=b||0;for(var c=this.length;b<c;b++)if(this[b]===a)return b;return-1});
Array.isArray||(Array.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"});Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return e.apply(this instanceof c&&a?this:a,d.concat(Array.prototype.slice.call(arguments)))}function c(){}if(typeof this!="function")throw new TypeError("Function.prototype.bind: non-callable object");var d=Array.prototype.slice.call(arguments,1),e=this;c.prototype=this.prototype;b.prototype=new c;return b});
var pc="UNKNOWN PANIC ABORT ILLEGAL RED YELLOW FAULT TRACE HALT OPCODE INTERRUPT".split(" "),qc={pd:5,td:144,Yc:8,Ec:{mf:15,Xj:16,nk:32,Wd:64,Da:128,$d:256,ak:512,ij:1024,Dc:2048,hj:4096,hd:57344,ka:{hd:13}},af:{ce:1,Hi:2,nf:3,Db:28,Cc:32,Bc:64,Qd:128,fk:256,Ee:512,Xb:1024,Tj:2048,Zd:4096,lk:8192,Rj:16384,Fe:32768,cd:32736},Ze:{Vb:1,ua:14,Cb:48,Bb:64,Ya:128,dk:256,kj:512,mj:1024,Le:2048,rd:8192,cd:16384,eb:32768,Db:4608,Yb:61438,Sa:3967,ka:{ua:1,Cb:4}},$e:{qd:15,fd:16,Tb:8160,mb:57344,ka:{fd:4,Tb:5,
mb:13}},ua:{Ae:0,$b:2,nb:4,Ic:6,Hc:8,Te:10,Ge:12,mk:14}},rc={pd:5,td:112,Yc:4,Se:"DY",ef:{Da:1,ua:14,Xa:48,Bb:64,Ya:128,mb:768,Jd:15360,fj:16384,eb:32768,Di:16254,$j:128,Yb:65535,Sa:1022,ka:{ua:1,Xa:4,mb:8}},cf:{Sa:65534},ff:{pf:1,qf:4,rf:16,Yj:65408,Xd:63,Gc:64,Zb:65408,He:3,tj:8,ka:{Gc:6,Zb:7}},Fc:{Ke:{Gj:0,ck:1,Ai:2,Hj:3,Hc:4,Pe:5,ik:6,bk:7},Kd:8,Je:16,qj:32,sj:64,Ie:128,rj:256,wj:512,yj:1024,vj:2048,uj:4096,zj:8192,pj:16384,xj:32768},df:{$a:63},Jd:{Qj:1024,ej:2048,ce:2048,Bj:3072,Ee:4096,Za:5120,
Xb:8192,Jj:9216},ua:{Qe:0,Ic:2,sf:4,Hc:6,Ye:8,uf:10,Ue:12,We:14}},sc={pd:5,td:180,Yc:2,Se:"DX",hf:{Vb:1,ua:14,sd:16,DONE:32,Bb:64,ab:128,INIT:16384,eb:32768,Db:16128,Yb:32992,Sa:16479},Vj:{},lf:{$a:127},kf:{$a:31},jf:{Hd:1,Td:2,hd:4,Ub:64,Da:128},ua:{$c:0,EMPTY:2,$b:4,nb:6,Db:8,Xe:10,Jc:12,Ve:14},ERROR:{dd:8,ed:16,wi:24,Re:32,nj:40,Zj:48,od:56,Oj:72,Nj:80,Mj:88,Gi:96,yi:104,Lj:112,nd:120,Fi:128,xi:136}},tc={48:"DL11R",52:"DL11X",56:"PC11R",60:"PC11X",64:"KW11",112:"RL11",144:"RK11",180:"RX11"},uc=
{};sc.gf=["DX",77,1,26,128,1,0,0,128,0];qc.Dc=["RK",203,2,12,512,0,0,0,512,qc.Ec.Dc|qc.Ec.$d|qc.Ec.Wd];rc.bf=["RL",512,2,40,256,0,0,0,256,rc.Fc.Ke.Pe|rc.Fc.Kd|rc.Fc.Je];y.cpu=2;y.trap=4;y.fault=8;y["int"]=16;y.bus=32;y.memory=64;y.mmu=128;y.rom=256;y.device=512;y.panel=1024;y.keyboard=2048;y.key=4096;y.pc11=8192;y.paper=16384;y.disk=32768;y.read=65536;y.write=131072;y.rk11=262144;y.rl11=524288;y.rx11=1048576;y.dl11=2097152;y.serial=4194304;y.kw11=8388608;y.timer=16777216;y.speaker=33554432;
y.computer=67108864;
function vc(a,b){C.call(this,"Panel",a,1024);this.B=this.C=0;this.M=b;this.ea=this.v=this.Va=this.yb=0;this.F=this.I=-1;this.j=this.D=!1;this.K=wc;this.A={};this.g={START:[1,1,!0,!1,this.Rf],STEP:[1,1,!1,!1,this.Sf],ENABLE:[1,1,!1,!1,this.Mf],CONT:[1,1,!0,!1,this.Kf],DEP:[0,0,!0,!1,this.Lf],EXAM:[1,1,!0,!1,this.Nf],LOAD:[1,1,!0,!1,this.Pf],TEST:[0,0,!0,!1,this.Of]};for(a=0;a<22;a++)this.g["S"+a]=[0,0,!1,!1,this.Qf,a];this.H=this.i=this.G=this.N=null;this.exports={hold:this.Ff,toggle:this.jh,reset:this.dh,
set:this.ih};G(this)}t(vc,C);function xc(a,b){return yc(a,a.yb=b)}k=vc.prototype;k.reset=function(a){this.stop();a&&xc(this,0)};
k.ta=function(a,b,c,d){if(this.N&&this.N.ta(a,b,c,d)||this.i&&this.i.ta(a,b,c,d)||this.H&&this.H.ta(a,b,c,d))return!0;switch(b){case "R0":case "R1":case "R2":case "R3":case "R4":case "R5":case "R6":case "R7":case "NF":case "ZF":case "VF":case "CF":case "PS":return this.J[b]=c,this.C++,!0;default:return a=="led"||a=="rled"?(this.J[b]=c,this.A[b]=d?1:0,this.C++,!0):a=="switch"?(this.g[b]===void 0&&(this.g[b]=[d?1:0,d?1:0]),this.J[b]=c,a=c.parentElement||c,a=a.parentElement||a,a.onmousedown=function(e,
f){return function(){zc(e,f)}}(this,b),a.onmouseup=a.onmouseout=function(e,f){return function(){Ac(e,f)}}(this,b),a.ontouchstart=function(e,f){return function(g){zc(e,f);g.preventDefault()}}(this,b),a.ontouchend=function(e,f){return function(){Ac(e,f)}}(this,b),!0):C.prototype.ta.call(this,a,b,c,d)}};k.za=function(a,b,c,d){this.N=a;this.G=b;this.i=c;this.H=d;Bc(b,this,Cc);Dc(b,this.reset.bind(this));Ec(this);Fc(this)};
k.Ba=function(a,b){if(!b)if(this.M&&Gc(),!a)this.reset(!0);else if(!this.restore(a))return!1;return!0};k.Aa=function(a){return a?this.save():!0};k.save=function(){var a=new Hc(this);a.set(0,[this.ea,this.yb,this.Va]);return a.data()};k.restore=function(a){if(a=a[0])Ic(this,this.ea=a[0]),xc(this,a[1]),Jc(this,a[2]);return!0};k.dh=function(){for(var a in this.g){var b=this.g[a];b[1]=b[0]}Fc(this);return!0};function Kc(a,b,c){if(a=a.J[b])a.style.backgroundColor=c?"#ff0000":"#000000"}
function Ec(a,b){for(var c in a.A)Kc(a,c,b!=null?b:a.A[c])}function Lc(a,b,c){if(a=a.J[b])a.style.marginTop=c?"0px":"20px",a.style.backgroundColor=c?"#00ff00":"#228B22"}function Fc(a){for(var b in a.g)Lc(a,b,a.g[b][1])}function Mc(a,b,c,d){if(a.J[b]){var e=a.H&&a.H.X||8;c=c||0;c=e==8?Sa(c,d):Ua(c,d);a.J[b].textContent!=c&&(a.J[b].textContent=c)}}k.Ff=function(a,b,c){if(zc(this,b)){if(c){var d=this;setTimeout(function(){Ac(d,b);a&&a()},+c);return!1}Ac(this,b)}return!0};
k.ih=function(a,b){if(a=="SR")return Jc(this,Pa(b,8));var c=this.g[a];return c?(c[1]=+b?1:0,Lc(this,a,c[1]),!0):!1};k.jh=function(a){return zc(this,a)?(Ac(this,a),!0):!1};function zc(a,b){var c=a.g[b];return c?(Lc(a,b,c[1]=1-c[1]),c[3]=!0,c[4]&&c[4].call(a,c[1],c[5]),b==Nc&&(a.j=!1),!0):!1}function Ac(a,b){var c=a.g[b];c&&(c[2]&&c[3]&&(Lc(a,b,c[1]=c[0]),c[4]&&c[4].call(a,c[1],c[5])),c[3]=!1)}
k.Rf=function(a){a||this.i.flags.W||(Yc(this.i,this.ea),a=this.i,a.G.reset(),Zc(a),this.g[$c]&&this.g[$c][1]&&ad(this.i))};k.Sf=function(){};k.Mf=function(a){a||bd(this.i)};k.Kf=function(a){if(!a&&!this.i.flags.W)if(this.g[$c]&&this.g[$c][1])ad(this.i);else{if((a=this.H)&&!lc(a,!0))mc(a,!0),cd(a,0,null),mc(a,!1);else try{var b=this.i.Ac(1);b>0&&(dd(this.i,b),ed(this.i,b,!0),fd(this.i,b))}catch(c){typeof c!="number"&&(b=c,ic(this.i,b.stack||b.message))}this.stop();this.N&&gd(this.N)}};
k.Lf=function(a){if(a&&!this.i.flags.W)if(this.j&&hd(this),this.j=!0,a=xc(this,this.Va),this.K==wc)id(this.G,this.ea,a);else{var b=this.i,c=this.ea;b.oa++;b.G.Wb(jd(b,c,4),a);b.oa--}};k.Nf=function(a){a||this.i.flags.W||(this.j&&hd(this),this.j=!0,a=this.K==wc?kd(this.G,this.ea):ld(this.i,this.ea),xc(this,a))};k.Pf=function(a){a||this.i.flags.W||Ic(this,this.Va)};k.Of=function(a){a?(this.D=!0,Ec(this,!0)):(this.D=!1,Ec(this),Jc(this,0))};k.Qf=function(a,b){this.Va=a?this.Va|1<<b:this.Va&~(1<<b)};
function hd(a){var b=a.i.model<=1140?8:16,c=a.ea>=65472&&a.ea<65472+b;b=c?1:2;c=c?15:a.G.K;a.g[md]&&a.g[md][1]||(b=-b);Ic(a,a.ea&~c|a.ea+b&c)}function Ic(a,b){a.ea=b&a.G.K;if(a.F!==a.ea){a.F=a.ea;b=a.F;for(var c=0;c<22;c++)nd(a,"A"+c,b&1<<c)}}function yc(a,b){a.v=b&65535;if(a.I!==a.v){a.I=a.v;b=a.I;for(var c=0;c<16;c++)nd(a,"D"+c,b&1<<c)}return a.v}function nd(a,b,c){a.A[b]=c;a.D||Kc(a,b,c)}function Jc(a,b){a.Va=b|0;for(b=0;b<22;b++)a.g["S"+b][1]=a.Va&1<<b?1:0;Fc(a);return!0}
k.stop=function(){Ic(this,this.i.j[7])};k.Dd=function(a){this.ea=a};k.setData=function(a,b){b?this.yb=a:this.v=a};k.Wf=function(a,b){return(b?this.yb:this.Va)&65535};k.ph=function(a){this.yb=a};function Gc(){for(var a=F("pdp11","panel"),b=0;b<a.length;b++){var c=a[b],d=Wb(c),e=Yb(d.id,!1);e||(e=new vc(d,!0));Vb(e,c)}}var wc=7,$c="ENABLE",Nc="LOAD",md="STEP",od={},Cc=(od[65400]=[null,null,vc.prototype.Wf,vc.prototype.ph,"CNSW"],od);Fb(Gc);
function pd(a,b,c){C.call(this,"Bus",a,32);this.i=b;this.H=c;this.V=+a.busWidth||16;this.P=1<<this.V;this.K=this.P-1;this.v=qd;this.j=Math.log2(this.v);this.U=this.v>>2;this.A=this.v-1;this.M=this.P/this.v|0;this.Oa=[];this.B=0;this.I=!1;this.R=[];this.wf=[rd,sd,td,ud];this.g=this.C=[];this.F=this.O=this.D=this.S=this.T=0;a=new vd(this);wd(a,this.H);this.g=Array(this.M);this.C=Array(this.M);for(b=0;b<this.M;b++)this.g[b]=this.C[b]=a;this.F=this.P-qd;xd(this,this.F,qd,yd,this);this.T=this.S=(this.F&
this.K)>>>this.j;this.O=0;this.D=this.K;G(this)}t(pd,C);function zd(a,b){if(b!=a.O){for(var c=0;c<a.M;c++)a.C[c]=a.g[c];a.O=0;a.D=a.K;b&&(a.O=b,b=1<<b,a.D=b-1,b-=qd,a.T=(b&a.D)>>>a.j,a.C[a.T]=a.g[a.S])}}k=pd.prototype;k.reset=function(){for(var a=0;a<this.R.length;a++)this.R[a]();zd(this,16)};k.Ba=function(a,b){if(!b)if(!a)this.reset();else if(!this.restore(a))return!1;return!0};k.Aa=function(a){return a?this.save():!0};
k.save=function(){for(var a=new Hc(this),b=a.set,c=0,d=[],e=0;e<this.M;e++){var f=this.g[e];if(f.wb||f.Df){d[c++]=e;var g=c++;a:if(f=f.save()){for(var h=0,l=0,m=[];h<f.length;){for(var n=f[h],r=h+1;r<f.length&&f[r]===n;)r++;m[l++]=r-h;m[l++]=n;h=r}if(m.length<f.length){f=m;break a}}d[g]=f}}b.call(a,0,d);return a.data()};
k.restore=function(a){a:{a=a[0];var b;for(b=0;b<a.length-1;b+=2){var c=a[b],d=a[b+1];if(d&&d.length<this.U){var e=this.U,f=0;e=e?Array(e):[];for(var g=0;g<d.length-1;)for(var h=d[g++],l=d[g++];h--;)e[f++]=l;d=e}f=this.g[c];if(!f||!f.restore(d)){A("Unable to restore memory block "+c);a=!1;break a}}a=!0}return a};
function xd(a,b,c,d,e){for(var f=b,g=c,h=f>>>a.j;g>0&&h<a.g.length;){var l=a.g[h],m=h*a.v,n=a.v-(f-m);n>g&&(n=g);if(!e&&l&&l.size){if(l.type==d){if(f+g<=l.L)return l.Pb+=l.L-f,l.L=f,!0;if(f>=l.L+l.Pb){n=l.size-(f-m);n>g&&(n=g);l.Pb=f-l.L+n;f=m+a.v;g-=n;h++;continue}}return Ad(a,Bd,f,g)}f=new vd(a,f,n,a.v,d,e);wd(f,a.H,l);a.g[h++]=f;f=m+a.v;g-=n}return g<=0?(a.u(137438953472,"Added %dKb %s at %o\n",c>>10,Cd[d],b),!0):Ad(a,Dd,b,c)}k.Ld=function(a){return this.C[(a&this.D)>>>this.j].rc(a&this.A,a)};
k.zc=function(a){return this.C[(a&this.D)>>>this.j].na(a&this.A,a)};k.Md=function(a,b){this.C[(a&this.D)>>>this.j].uc(a&this.A,b,a)};k.Wb=function(a,b){this.C[(a&this.D)>>>this.j].Ab(a&this.A,b,a)};function Ed(a,b){return a.g[(b&a.K)>>>a.j]}function kd(a,b){a.I=!1;a.B++;b=Ed(a,b).N(b&a.A,b);a.B--;return b}function Fd(a,b,c){a.I=!1;a.B++;Ed(a,b).v(b&a.A,c&255,b);a.B--}function id(a,b,c){a.I=!1;a.B++;Ed(a,b).C(b&a.A,c&65535,b);a.B--}
function Gd(a){for(var b=Hd,c=0,d=0;d<a.g.length;d++){var e=a.g[d];e.type==b&&(c=e.L+e.Pb)}return c}function Id(a,b,c,d,e,f,g,h,l){for(var m=b==c?-1:0;b<=c;b+=2){var n=b&Jd;if(a.Oa[n]!==void 0)return z(549755813888,"I/O address already registered: "+Ua(b,8,!0)),!1;var r=l||"unknown";r&&m>=0&&(r+=m++);a.Oa[n]=[d,e,f,g,r,h||32,!1]}return!0}
function Bc(a,b,c,d){for(var e in c){var f=+e+(d||0),g=c[e];if(!(g[6]&&g[6]>a.i.model)){var h=g[0]?g[0].bind(b):null,l=g[1]?g[1].bind(b):null,m=g[2]?g[2].bind(b):null,n=g[3]?g[3].bind(b):null;f>=65472&&f<=65487&&(!h&&m&&(h=function(v){return function(D){return v(D)&255}.bind(b)}(m)),!l&&n&&(l=function(v){return function(D,B){return v(D,B)}.bind(b)}(n)));for(var r=g[4],p=g[5]||1,q=0;q<p;q++,f+=2)if(r&&p>1&&(r=g[4]+q),!Id(a,f,f,h,l,m,n,g[7]||b.ha,r||b.Wc))return!1}}return!0}
function Dc(a,b){a.R.push(b)}function Kd(a,b,c,d){a.I=!0;a.B||(a.H&&a.H.u(9,"memory fault (%d) on %s\n",d,H(a.H,b)),c&&(a.i.S|=c),I(a.i,4,0,b))}function Ld(a){var b=a.I;a.I=!1;return b}function Ad(a,b,c,d){a.u(1099511627776,"Memory block error (%d: %#x,%#x)\n",b,c,d);return!1}var qd=8192,Jd=qd-1,Bd=1,Dd=2;
function rd(a,b){var c=-1,d=this.controller,e=d.Oa[a],f=b&65535;e?e[0]?c=e[0](f):e[2]&&(c=f&1?e[2](f&-2)>>8:e[2](f)&255):f&1&&(e=d.Oa[a&-2])&&(e[2]?c=e[2](f&-2)>>8:e[0]&&(c=e[0](f)));if(c>=0)return this.i&&this.i.u(32+e[5],"%s.readByte(%s): %s\n",e[4],H(this.i,b),H(this.i,c)),c;Kd(d,b,16,3);c=255;this.i&&this.i.u(32,"warning: unconverted read access to byte @%s: %s\n",H(this.i,b),H(this.i,c));return c}
function sd(a,b,c){var d=!1,e=this.controller,f=e.Oa[a],g=c&65535;if(f)if(f[1])f[1](b,g),d=!0;else{if(f[3]){a=f[2]?f[2](g,!0):0;if(g&1)f[3](a&255|b<<8,g&-2);else f[3](a&-256|b,g);d=!0}}else g&1&&(f=e.Oa[a&-2])&&(f[3]?(g&=-2,a=f[2]?f[2](g,!0):0,f[3](a&255|b<<8,g),d=!0):f[1]&&(f[1](b,g),d=!0));d?this.i&&this.i.u(32+f[5],"%s.writeByte(%s,%s)\n",f[4],H(this.i,c),H(this.i,b)):(Kd(e,c,16,5),this.i&&this.i.u(32,"warning: unconverted write access to byte @%s: %s\n",H(this.i,c),H(this.i,b)))}
function td(a,b){var c=-1,d=this.controller;a=d.Oa[a];var e=b&65535;a&&(a[2]?c=a[2](e):a[0]&&(c=a[0](e)|a[0](e+1)<<8));if(c>=0)return this.i&&this.i.u(32+a[5],"%s.readWord(%s): %s\n",a[4],H(this.i,b),H(this.i,c)),c;Kd(d,b,16,2);c=65535;this.i&&this.i.u(32,"warning: unconverted read access to word @%s: %s\n",H(this.i,b),H(this.i,c));return c}
function ud(a,b,c){var d=!1,e=this.controller;a=e.Oa[a];var f=c&65535;a&&(a[3]?(a[3](b,f),d=!0):a[1]&&(a[1](b&255,f),a[1](b>>8,f+1),d=!0));d?this.i&&this.i.u(32+a[5],"%s.writeWord(%s,%s)\n",a[4],H(this.i,c),H(this.i,b)):(Kd(e,c,16,4),this.i&&this.i.u(32,"warning: unconverted write access to word @%s: %s\n",H(this.i,c),H(this.i,b)))}function K(a){C.call(this,"Device",a,512);this.g={cb:128,Ed:-1}}t(K,C);k=K.prototype;
k.za=function(a,b,c,d){this.G=b;this.N=a;this.i=c;this.H=d;var e=this;this.g.Ed=Md(c,function(){e.g.cb|=128;e.g.cb&64&&Nd(e.i,e.g.Pa);e.N&&gd(e.N,1);Od(e.i,e.g.Ed,1E3/60)});this.g.Pa=Pd(c,64,6,8388608);Bc(b,this,Qd);Dc(b,this.reset.bind(this));d&&Rd(d,128,function(f){var g=e.i;Sd(e,"KIPDR",g.D[0],0,f[0]);Sd(e,"KDPDR",g.D[0],8,f[0]);Sd(e,"KIPAR",g.O[0],0,f[0]);Sd(e,"KDPAR",g.O[0],8,f[0],!0);Sd(e,"SIPDR",g.D[1],0,f[0]);Sd(e,"SDPDR",g.D[1],8,f[0]);Sd(e,"SIPAR",g.O[1],0,f[0]);Sd(e,"SDPAR",g.O[1],8,f[0],
!0);Sd(e,"UIPDR",g.D[3],0,f[0]);Sd(e,"UDPDR",g.D[3],8,f[0]);Sd(e,"UIPAR",g.O[3],0,f[0]);Sd(e,"UDPAR",g.O[3],8,f[0],!0);g.Y&32&&Sd(e,"UNIMAP",g.Ea,-1,f[0])});G(this)};function Sd(a,b,c,d,e,f){a=a.H;if(!(e&&b.indexOf(e.toUpperCase())<0)){e=0;var g=8,h="",l=!1,m=8;d<0&&(e=22,g=c.length,d=0,l=!0,m=4);for(var n=0;n<g;n++)n%m==0&&(h&&(h+="\n"),h+=b+(l?"["+Ta(n,2)+"]":"")+":"),h+=" "+H(a,c[d+n],e);a.u("%s",h+(f?"\n":""))}}k.Ba=function(a,b){if(!b)if(!a)this.reset();else if(!this.restore(a))return!1;return!0};
k.Aa=function(a){return a?this.save():!0};k.reset=function(){this.g.cb=128;Od(this.i,this.g.Ed,1E3/60,!0)};k.save=function(){var a=new Hc(this);a.set(0,[this.g.cb]);return a.data()};k.restore=function(a){a=qa(a[0]);this.g.cb=a.next().value;return!0};k.dg=function(){return this.g.cb};k.xh=function(a){this.g.cb=a&192;this.g.cb&64||be(this.i,this.g.Pa)};k.fg=function(){return ce(this.i)};k.zh=function(a){de(this.i,a&-129|this.i.U&128)};k.gg=function(){return ee(this.i)};k.hg=function(){return fe(this.i)};
k.ig=function(){return this.i.Y};k.Ah=function(a){ge(this.i,a)};k.Ug=function(a){a=a>>1&63;var b=this.i.Ea[a>>1];return a&1?b>>16:b&65535};k.li=function(a,b){b=b>>1&63;var c=b>>1;this.i.Ea[c]=b&1?this.i.Ea[c]&65535|(a&63)<<16:this.i.Ea[c]&-65536|a&65534};k.Ng=function(a){return this.i.D[1][a>>1&7]};k.ei=function(a,b){this.i.D[1][b>>1&7]=a&65295};k.Lg=function(a){return this.i.D[1][(a>>1&7)+8]};k.ci=function(a,b){this.i.D[1][(b>>1&7)+8]=a&65295};k.Mg=function(a){return this.i.O[1][a>>1&7]};
k.di=function(a,b){b=b>>1&7;this.i.O[1][b]=a;this.i.D[1][b]&=65295};k.Kg=function(a){return this.i.O[1][(a>>1&7)+8]};k.bi=function(a,b){b=(b>>1&7)+8;this.i.O[1][b]=a;this.i.D[1][b]&=65295};k.cg=function(a){return this.i.D[0][a>>1&7]};k.wh=function(a,b){this.i.D[0][b>>1&7]=a&65295};k.ag=function(a){return this.i.D[0][(a>>1&7)+8]};k.th=function(a,b){this.i.D[0][(b>>1&7)+8]=a&65295};k.bg=function(a){return this.i.O[0][a>>1&7]};k.uh=function(a,b){b=b>>1&7;this.i.O[0][b]=a;this.i.D[0][b]&=65295};
k.$f=function(a){return this.i.O[0][(a>>1&7)+8]};k.sh=function(a,b){b=(b>>1&7)+8;this.i.O[0][b]=a;this.i.D[0][b]&=65295};k.Tg=function(a){return this.i.D[3][a>>1&7]};k.ki=function(a,b){this.i.D[3][b>>1&7]=a&65295};k.Rg=function(a){return this.i.D[3][(a>>1&7)+8]};k.ii=function(a,b){this.i.D[3][(b>>1&7)+8]=a&65295};k.Sg=function(a){return this.i.O[3][a>>1&7]};k.ji=function(a,b){b=b>>1&7;this.i.O[3][b]=a;this.i.D[3][b]&=65295};k.Qg=function(a){return this.i.O[3][(a>>1&7)+8]};
k.hi=function(a,b){b=(b>>1&7)+8;this.i.O[3][b]=a;this.i.D[3][b]&=65295};k.Nb=function(a){a&=7;return this.i.C&2048?this.i.ra[a]:this.i.j[a]};k.Rb=function(a,b){b&=7;this.i.C&2048?this.i.ra[b]=a:this.i.j[b]=a};k.pg=function(){return this.i.C&49152?this.i.Z[0]:this.i.j[6]};k.Hh=function(a){this.i.C&49152?this.i.Z[0]=a:this.i.j[6]=a};k.sg=function(){return this.i.j[7]};k.Kh=function(a){this.i.j[7]=a};k.Ob=function(a){a&=7;return this.i.C&2048?this.i.j[a]:this.i.ra[a]};
k.Sb=function(a,b){b&=7;this.i.C&2048?this.i.j[b]=a:this.i.ra[b]=a};k.qg=function(){return(this.i.C&49152)>>14==1?this.i.j[6]:this.i.Z[1]};k.Ih=function(a){(this.i.C&49152)>>14==1?this.i.j[6]=a:this.i.Z[1]=a};k.rg=function(){return(this.i.C&49152)>>14==3?this.i.j[6]:this.i.Z[3]};k.Jh=function(a){(this.i.C&49152)>>14==3?this.i.j[6]=a:this.i.Z[3]=a};k.Yf=function(a){return this.i.tc[a-65504>>1]};k.rh=function(a,b){this.i.tc[b-65504>>1]=a};k.se=function(a){return a==65520?(Gd(this.G)>>6)-1:0};k.ye=function(){};
k.Pg=function(){return 1};k.gi=function(){};k.Xf=function(){return this.i.S};k.qh=function(){this.i.S=0};k.eg=function(){return this.i.oc};k.yh=function(a,b){b&1||(a&=255);this.i.oc=a};k.jg=function(a,b){return b?0:this.i.jb};k.Bh=function(a){he(this.i,a)};k.Og=function(a,b){return b?0:this.i.wa&65280};k.fi=function(a){this.i.wa=a|255};k.og=function(){return ie(this.i)};k.Gh=function(a){je(this.i,a)};k.xe=function(a,b){this.u(1,"writeIgnored(%o): %o\n",b,a)};
var L={},Qd=(L[61568]=[null,null,K.prototype.Ug,K.prototype.li,"UNIMAP",64,1170],L[62592]=[null,null,K.prototype.Ng,K.prototype.ei,"SIPDR",8,1145,128],L[62608]=[null,null,K.prototype.Lg,K.prototype.ci,"SDPDR",8,1145,128],L[62624]=[null,null,K.prototype.Mg,K.prototype.di,"SIPAR",8,1145,128],L[62640]=[null,null,K.prototype.Kg,K.prototype.bi,"SDPAR",8,1145,128],L[62656]=[null,null,K.prototype.cg,K.prototype.wh,"KIPDR",8,1140,128],L[62672]=[null,null,K.prototype.ag,K.prototype.th,"KDPDR",8,1145,128],
L[62688]=[null,null,K.prototype.bg,K.prototype.uh,"KIPAR",8,1140,128],L[62704]=[null,null,K.prototype.$f,K.prototype.sh,"KDPAR",8,1145,128],L[62798]=[null,null,K.prototype.ig,K.prototype.Ah,"MMR3",1,1145,128],L[65382]=[null,null,K.prototype.dg,K.prototype.xh,"LKS"],L[65402]=[null,null,K.prototype.fg,K.prototype.zh,"MMR0",1,1140,128],L[65404]=[null,null,K.prototype.gg,K.prototype.xe,"MMR1",1,1145,128],L[65406]=[null,null,K.prototype.hg,K.prototype.xe,"MMR2",1,1140,128],L[65408]=[null,null,K.prototype.Tg,
K.prototype.ki,"UIPDR",8,1140,128],L[65424]=[null,null,K.prototype.Rg,K.prototype.ii,"UDPDR",8,1145,128],L[65440]=[null,null,K.prototype.Sg,K.prototype.ji,"UIPAR",8,1140,128],L[65456]=[null,null,K.prototype.Qg,K.prototype.hi,"UDPAR",8,1145,128],L[65472]=[null,null,K.prototype.Nb,K.prototype.Rb,"R0SET0"],L[65473]=[null,null,K.prototype.Nb,K.prototype.Rb,"R1SET0"],L[65474]=[null,null,K.prototype.Nb,K.prototype.Rb,"R2SET0"],L[65475]=[null,null,K.prototype.Nb,K.prototype.Rb,"R3SET0"],L[65476]=[null,null,
K.prototype.Nb,K.prototype.Rb,"R4SET0"],L[65477]=[null,null,K.prototype.Nb,K.prototype.Rb,"R5SET0"],L[65478]=[null,null,K.prototype.pg,K.prototype.Hh,"R6KERNEL"],L[65479]=[null,null,K.prototype.sg,K.prototype.Kh,"R7KERNEL"],L[65480]=[null,null,K.prototype.Ob,K.prototype.Sb,"R0SET1",1,1145],L[65481]=[null,null,K.prototype.Ob,K.prototype.Sb,"R1SET1",1,1145],L[65482]=[null,null,K.prototype.Ob,K.prototype.Sb,"R2SET1",1,1145],L[65483]=[null,null,K.prototype.Ob,K.prototype.Sb,"R3SET1",1,1145],L[65484]=
[null,null,K.prototype.Ob,K.prototype.Sb,"R4SET1",1,1145],L[65485]=[null,null,K.prototype.Ob,K.prototype.Sb,"R5SET1",1,1145],L[65486]=[null,null,K.prototype.qg,K.prototype.Ih,"R6SUPER",1,1145],L[65487]=[null,null,K.prototype.rg,K.prototype.Jh,"R6USER",1,1145],L[65504]=[null,null,K.prototype.Yf,K.prototype.rh,"CTRL",8,1170],L[65520]=[null,null,K.prototype.se,K.prototype.ye,"LSIZE",1,1170],L[65522]=[null,null,K.prototype.se,K.prototype.ye,"HSIZE",1,1170],L[65524]=[null,null,K.prototype.Pg,K.prototype.gi,
"SYSID",1,1170],L[65526]=[null,null,K.prototype.Xf,K.prototype.qh,"ERR",1,1170],L[65528]=[null,null,K.prototype.eg,K.prototype.yh,"MBR",1,1170],L[65530]=[null,null,K.prototype.jg,K.prototype.Bh,"PIR"],L[65532]=[null,null,K.prototype.Og,K.prototype.fi,"SLR"],L[65534]=[null,null,K.prototype.og,K.prototype.Gh,"PSW"],L);
Fb(function(){for(var a=F("pdp11","device"),b=0;b<a.length;b++){var c=a[b];var d=Wb(c);switch(d.type){case "default":d=new K(d);Vb(d,c);break;case "pc11":d=new ke(d);Vb(d,c);break;case "rl11":d=new le(d);Vb(d,c);break;case "rk11":d=new M(d);Vb(d,c);break;case "rx11":d=new me(d),Vb(d,c)}}});
function vd(a,b,c,d,e,f){this.j=a;this.id=ne+=2;this.offset=0;this.L=b;this.Pb=c;this.size=d||0;this.type=e||oe;this.J=e==pe;this.i=this.controller=null;this.rc=this.B=this.zd;this.na=this.N=this.Ad;this.uc=this.v=this.Qb;this.Ab=this.C=this.Uc;this.G=this.H=0;wd(this);this.wb=this.Df=!1;this.size?f?(this.controller=f,a=[null,0],this.offset=a[1],qe(this,f.wf)):(this.buffer=new ArrayBuffer(this.size),this.A=new DataView(this.buffer,0,this.size),this.g=new Uint8Array(this.buffer,0,this.size),this.D=
new Uint16Array(this.buffer,0,this.size>>1),new Int32Array(this.buffer,0,this.size>>2),qe(this,re?se:te)):qe(this)}k=vd.prototype;k.init=function(a){this.L=a};k.save=function(){var a;if(this.controller)var b=null;else for(b=Array(this.size>>2),a=0;a<b.length;a++)b[a]=this.A.getInt32(a<<2,!0);return b};k.restore=function(a){if(this.controller)return a==null;if(a&&this.size==a.length<<2){var b;for(b=0;b<a.length;b++)this.A.setInt32(b<<2,a[b],!0);return this.wb=!0}return!1};
function qe(a,b){b||(b=ue);ve(a,b);we(a,b)}function ve(a,b,c){c&&a.G||(a.rc=b[0]||a.zd,a.na=b[2]||a.Ad);if(c||c===void 0)a.B=b[0]||a.zd,a.N=b[2]||a.Ad}function we(a,b,c){c&&a.H||(a.uc=!a.J&&b[1]||a.Qb,a.Ab=!a.J&&b[3]||a.Uc);if(c||c===void 0)a.v=b[1]||a.Qb,a.C=b[3]||a.Uc}k.ub=function(a,b){b?this.H++===0&&we(this,xe,!1):this.G++===0&&ve(this,xe,!1)};function ye(a,b){b?--a.H===0&&(a.uc=a.J?a.Qb:a.v,a.Ab=a.J?a.Uc:a.C):--a.G===0&&(a.rc=a.B,a.na=a.N)}
function wd(a,b,c){a.i=b;a.G=a.H=0;c&&((a.G=c.G)&&ve(a,xe,!1),(a.H=c.H)&&we(a,xe,!1))}k.zd=function(a,b){this.i&&this.i.u(64,"attempt to read invalid address %s\n",H(this.i,b));Kd(this.j,b,32,2);return 255};k.Qb=function(a,b,c){this.i&&this.i.u(64,"attempt to write %s to invalid addresses %s\n",H(this.i,b),H(this.i,c));Kd(this.j,c,32,4)};k.Ad=function(a,b){return this.rc(a++,b++)|this.rc(a,b)<<8};k.Uc=function(a,b,c){this.uc(a++,b&255,c++);this.uc(a,b>>8,c)};
k.Uf=function(a,b){this.i&&this.L!=null&&ze(this.i,this.L+a);return this.B(a,b)};k.Wg=function(a,b){this.i&&this.L!=null&&ze(this.i,this.L+a,2);return this.N(a,b)};k.nh=function(a,b,c){this.i&&this.L!=null&&Ae(this.i,this.L+a);this.J?this.Qb(a,b,c):this.v(a,b,c)};k.ni=function(a,b,c){this.i&&this.L!=null&&Ae(this.i,this.L+a,2);this.J?this.Qb(a,b,c):this.C(a,b,c)};k.Tf=function(a){return this.g[a]};
k.Vf=function(a,b){a=this.g[a];this.i&&this.i.u(64,"Memory.readByte(%s): %s\n",H(this.i,b),H(this.i,a));return a};k.Vg=function(a,b){a&1&&Kd(this.j,b,64,2);return this.A.getUint16(a,!0)};k.Zg=function(a,b){a&1&&Kd(this.j,b,64,2);a=this.D[a>>1];this.i&&this.i.u(64,"Memory.readWord(%s): %s\n",H(this.i,b),H(this.i,a));return a};k.mh=function(a,b){this.g[a]=b;this.wb=!0};k.oh=function(a,b,c){this.g[a]=b;this.wb=!0;this.i&&this.i.u(64,"Memory.writeByte(%s,%s)\n",H(this.i,c),H(this.i,b))};
k.mi=function(a,b,c){a&1&&Kd(this.j,c,64,4);this.A.setUint16(a,b,!0);this.wb=!0};k.oi=function(a,b,c){a&1&&Kd(this.j,c,64,4);this.D[a>>1]=b;this.wb=!0;this.i&&this.i.u(64,"Memory.writeWord(%s,%s)\n",H(this.i,c),H(this.i,b))};
var oe=0,Hd=1,pe=2,yd=4,Cd=["NONE","RAM","ROM","VID","H/W"],ne=0,ue=[],xe=[vd.prototype.Uf,vd.prototype.nh,vd.prototype.Wg,vd.prototype.ni],te=[vd.prototype.Tf,vd.prototype.mh,vd.prototype.Vg,vd.prototype.mi],se=[vd.prototype.Vf,vd.prototype.oh,vd.prototype.Zg,vd.prototype.oi],re,Be=new ArrayBuffer(2);(new DataView(Be)).setUint16(0,256,!0);re=(new Uint16Array(Be))[0]===256;
function Ce(a,b){C.call(this,"CPU",a,2);b=+a.cycles||b;var c=+a.multiplier||1;this.jd=0;this.Xc=b;this.hb=c;this.kd=Math.round(this.Xc/1E4)/100;this.qb=this.kd*this.hb;this.ld=this.kc=this.lb=this.vc=0;this.flags.W=this.flags.Qc=!1;this.flags.pa=a.autoStart;typeof this.flags.pa=="string"&&(this.flags.pa=this.flags.pa=="true");this.flags.Hb=!1;this.hc=this.Gb=0;this.jc=+a.csStart;this.Fb=+a.csInterval;this.Ib=+a.csStop;this.fa=[];this.Vd=this.eh.bind(this);this.ib=this.Ha=this.gb=this.g=this.ja=this.Ga=
this.fc=this.Ra=this.Kb=this.md=this.pb=0;this.qa=null;G(this)}t(Ce,C);k=Ce.prototype;k.za=function(a,b,c,d){this.N=a;this.G=b;this.H=d;this.qa=a.B;for(a=0;a<De.length;a++)(b=this.J[De[a]])&&this.N.ta("",De[a],b);G(this)};k.reset=function(){};k.save=function(){return null};k.restore=function(){return!1};
k.Ba=function(a,b){var c=Ee(this.N,"autoStart");c!=null?this.flags.pa=c=="true"?!0:c=="false"?!1:!!c:this.flags.pa==null&&(this.flags.pa=!this.H&&this.J.run===void 0);if(!b){if(a){Fe(this);if(!this.restore(a))return!1;Ge(this)}else this.reset();this.H?this.H.init(this.flags.pa):this.u(137438953472,"No debugger detected\n");this.flags.pa||this.u("CPU will not be auto-started %s\n",this.qa?"(click Run to start)":"(type 'go' to start)")}return!0};k.Aa=function(a){return a?this.save():!0};
k.pa=function(){return this.flags.W?!0:this.flags.pa?ad(this):!1};function Ge(a){a.jc===void 0&&(a.jc=0);a.Fb===void 0&&(a.Fb=-1);a.Ib===void 0&&(a.Ib=-1);a.flags.Hb=a.jc>=0&&a.Fb>0;a.flags.Hb&&(a.hc=0,a.Gb=a.jc-a.ib)}function fd(a,b){if(a.flags.Hb){var c=!1;a.hc|=0;a.Gb-=b;a.Gb<=0&&(a.Gb+=a.Fb,c=!0);a.Ib>=0&&a.Ib<=He(a)&&(a.Fb=a.Ib=-1,Ge(a),bd(a),c=!0);c&&a.u("%d cycles: checksum=%x\n",He(a),a.hc)}}
k.ta=function(a,b,c){var d=this;switch(b){case "power":case "reset":return this.J[b]=c,!0;case "run":return this.J[b]=c,c.onclick=function(){var e;if(e=d.N)if(e=d.N,e.flags.ia)e=!0;else{var f=null,g,h=Xb(e.id);for(g=0;g<h.length&&(f=h[g],f===e||f.flags.ready);g++);if(g==h.length)for(g=0;g<h.length&&(f=h[g],f===e||f.flags.ia);g++);g==h.length&&(f=e);kb("The "+f.type+" component ("+f.id+") is not "+(f.flags.ready?"powered yet":"ready yet"+(f.Lc?" (waiting for notification)":""))+".");e=!1}e&&(d.flags.W?
bd(d):ad(d))},!0;case "speed":return this.J[b]=c,!0;case "setSpeed":return this.J[b]=c,c.onclick=function(){Ie(d,d.hb<<1,!0)},c.textContent=this.qb.toFixed(2)+"Mhz",!0}return!1};function ed(a,b,c){a.ib+=b;c&&(a.gb=a.g=a.ja=0)}function Je(a,b){var c=1;b&&a.hb>1&&a.pb&&(c=a.pb/a.kd);a.ld=Math.round(1E3/Ke);a.kc=Math.floor(a.Xc/Ke*c);b||(a.lb=a.kc);a.vc=0}function He(a){return a.ib+a.Ha+a.gb-a.g}function Fe(a){a.pb=0;a.md=0;a.ib=a.Ha=a.gb=a.g=a.ja=0;Ge(a);Ie(a,1)}
function Ie(a,b,c){var d=!1;if(b!==void 0){a.pb/a.qb<.8?b=1:d=!0;a.hb=b;b=a.kd*a.hb;if(a.qb!=b){a.qb=b;b=a.qb.toFixed(2)+"Mhz";var e=a.J.setSpeed;e&&(e.textContent=b);a.u("target speed: %s\n",b)}c&&a.N&&Le(a.N)}ed(a,a.Ha);a.Ha=0;a.Ga=Tb();a.Ra=0;Je(a);return d}function Md(a,b){var c=a.fa.length;a.fa.push([-1,b]);return c}function Od(a,b,c,d){b>=0&&b<a.fa.length&&(d||a.fa[b][0]<0)&&(c=a.Xc*a.hb/1E3*c|0,a.flags.W&&(c+=Me(a)),a.fa[b][0]=c)}
function Ne(a,b){for(var c=a.fa.length-1;c>=0;c--){var d=a.fa[c];d[0]<0||b>d[0]&&(b=d[0])}return b}function dd(a,b){for(var c=a.fa.length-1;c>=0;c--){var d=a.fa[c];d[0]<0||(d[0]-=b,d[0]<=0&&(d[0]=-1,d[1]()))}}function Me(a,b){var c=a.gb-=a.g;a.g=a.ja=0;b&&(a.gb=0);return c}
k.eh=function(){if(this.flags.W){this.vc>=this.Xc&&Je(this,!0);this.Kb=0;this.fc=Tb();if(this.Ra){var a=this.fc-this.Ra;a>this.ld&&(this.Ga+=a,this.Ga>this.fc&&(this.Ga=this.fc))}try{do{var b=Ne(this,this.flags.Hb?1:this.kc);try{this.Ac(b)}catch(f){if(typeof f!="number")throw f;}b=Me(this,!0);this.Kb+=b;this.Ha+=b;fd(this,b);dd(this,b);this.lb-=b;if(this.lb<=0){this.lb+=this.kc;++this.md>=Oe&&(this.N&&gd(this.N),this.md=0);break}}while(this.flags.W)}catch(f){bd(this);this.N&&this.N.stop(Tb(),He(this));
ic(this,f.stack||f.message);return}if(this.flags.W){a=setTimeout;b=this.Vd;this.Ra=Tb();var c=this.ld;this.Kb&&(c=Math.round(c*this.Kb/this.kc));c-=this.Ra-this.fc;var d=this.Ha,e=this.Ra-this.Ga;e&&(this.pb=Math.round(d/(e*10))/100,e>=864E5&&(this.ib=0,Ie(this)));if(c<0||this.pb<this.qb)c<-1E3&&(this.Ga-=c),c=0;this.vc+=this.Kb;this.Ra+=c;a(b,c)}}};
function ad(a,b){if(jc(a))return!1;if(a.flags.W)return a.u("%s busy\n",a.toString()),!1;Ie(a);a.flags.W=!0;a.flags.Qc=!0;var c=a.J.run;c&&(c.textContent="Halt");a.N&&(b&&Le(a.N,!0),a.N.start(a.Ga,He(a)));a.H||a.u(137438953472,"Started\n");setTimeout(a.Vd,0);return!0}k.Ac=function(){return 0};function bd(a,b){var c=!1;if(a.flags.W){Me(a);ed(a,a.Ha);a.Ha=0;a.flags.W=!1;if(c=a.J.run)c.textContent="Run";a.N&&a.N.stop(Tb(),He(a));c=!0;a.H||a.u(137438953472,"Stopped\n")}a.flags.complete=b;return c}
var Ke=30,Oe=15,De=["power","reset"];
function Pe(a){var b=+a.model||1170;Ce.call(this,a,6666667);this.model=b;this.Sc=+a.addrReset||0;this.Ia=this.C=this.P=this.F=this.I=this.M=this.K=0;this.j=this.ra=this.Z=[];this.O=this.D=this.Ea=this.tc=[];this.Ma=this.R=this.Pd=this.rb=this.sb=this.tb=this.Na=this.S=this.oc=this.jb=this.wa=this.U=this.qc=this.sc=this.Y=this.v=0;this.Sd=[4,2,0,1];this.wc=0;this.Ud=255;this.model<=1120?(this.Yd=Qe.bind(this),this.Eb=this.Af,this.wc=8,this.Ud=-1,this.be=255,this.ae=0):(this.Yd=Re.bind(this),this.Eb=
this.Bf,this.be=~(1792|(this.model<=1140?2048:0))&65535,this.ae=this.model>1140?2048:0);this.yc=this.xc=this.oa=0;this.T=null;this.ec=[];this.bc=this.Zc=this.le;this.cc=this.ad=this.oe;this.Rc=this.bd=this.ue;this.dc=this.gd=this.ve;this.Fa=this.ob=this.lc=this.mc=0;this.va=this.ne;this.na=this.Bd;this.Ab=this.Fd;this.B=this.A=this.Vc=this.V=this.aa=0;this.flags.complete=!1}t(Pe,Ce);k=Pe.prototype;
k.za=function(a,b,c,d){Ce.prototype.za.call(this,a,b,c,d);this.Zc=b.Ld.bind(b);this.ad=b.zc.bind(b);this.bd=b.Md.bind(b);this.gd=b.Wb.bind(b)};k.Ba=function(a,b){for(var c=192,d=0;d<this.ec.length;d++){var e=this.ec[d];e.zb<0&&(e.zb=c,c+=4)}return Ce.prototype.Ba.call(this,a,b)};
k.reset=function(){this.u(137438953472,"Model %d\n",this.model);this.flags.W&&bd(this);this.F=65536;this.I=32768;this.M=65535;this.K=32768;this.C=15;this.j=[0,0,0,0,0,0,0,this.Sc,-1,-2,-3,-4,-5,-6,-7,-8];this.ra=[0,0,0,0,0,0];this.Z=[0,0,0,0];this.O=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];this.D=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[65535,65535,65535,65535,65535,65535,
65535,65535,65535,65535,65535,65535,65535,65535,65535,65535],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];this.Ea=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.tc=[0,0,0,0,0,0,0,0];this.P=0;this.Ia=-1;this.B=this.A=this.Vc=this.V=this.aa=this.v=this.oc=0;Zc(this);Fe(this);this.flags.error=!1;Ce.prototype.reset.call(this)};function Zc(a){a.U=0;a.qc=0;a.sc=0;a.Y=0;a.S=0;a.jb=0;a.wa=255;a.rb=0;a.sb=0;a.tb=0;a.Na=262143;a.Ma=a.j[7];a.R=0;a.T=null;a.G&&(Se(a),a.Pd=Gd(a.G))}
function Se(a){a.bc=a.Zc;a.cc=a.ad;a.Rc=a.bd;a.dc=a.gd;a.lc&&(a.bc=a.le,a.cc=a.oe);a.mc&&(a.Rc=a.ue,a.dc=a.ve);a.rb?(a.Fa=65536,a.ob=a.Y&16?4186112:253952,a.va=a.ne,a.na=a.lc?a.Yg:a.Bd,a.Ab=a.mc?a.ri:a.Fd,zd(a.G,a.Y&16?22:18)):(a.Fa=0,a.ob=57344,a.va=a.Ef,a.na=a.lc?a.Xg:a.te,a.Ab=a.mc?a.pi:a.ze,zd(a.G,16))}function ce(a){var b=a.U;b&57344||(b=b&-3199|a.sb<<5|a.tb<<1);return b}
function de(a,b){b&=-3073;if(a.U!=b){b&57344&&!(a.U&57344)&&(a.qc=a.R>>16&65535,a.sc=a.R&65535);a.U=b;a.sb=(b&96)>>5;a.tb=(b&30)>>1;var c=0;b&257&&(c=4,b&1&&(c|=2));a.rb!=c&&(a.rb=c,Se(a))}}function ee(a){a.U&57344||(a.qc=a.R>>16&65535);a=a.qc;a&65280&&(a=(a<<8|a>>8)&65535);return a}function fe(a){a.U&57344||(a.sc=a.R&65535);return a.sc}function ge(a,b){a.model<1170&&(b&=-49);a.Y!=b&&(a.Y=b,a.Na=b&16?4194303:262143,Se(a))}
function Te(a,b,c,d){a.Sc=b;Yc(a,b);je(a,0);a.G.reset();Zc(a);if(c){a.j[0]=d||0;for(b=1;b<=5;b++)a.j[b]=0;a.j[6]=1024;a.flags.ia?a.flags.W||ad(a):a.flags.pa=!0}else a.H&&a.flags.ia?bd(a)||a.N.flags.reset||(Ue(a.H),gd(a.N,-1)):c===!1&&bd(a);!a.flags.W&&a.qa&&a.qa.stop()}
k.save=function(){var a=new Hc(this);a.set(0,[this.j,this.ra,this.Z,this.O,this.D,this.Ea,this.tc,this.S,this.oc,this.jb,this.wa,this.sb,this.tb,this.Ma,this.v,this.R,this.Ia,this.xc,this.yc,this.Sc]);a.set(1,[ie(this),ce(this),ee(this),fe(this),this.Y]);a.set(2,[this.ib,this.hb,this.flags.pa]);for(var b=a.set,c=[],d=this.T;d;)c.push(d.zb),d=d.next;b.call(a,3,c);b=a.set;c=[];for(d=0;d<this.fa.length;d++)c.push(this.fa[d][0]);b.call(a,4,c);return a.data()};
k.restore=function(a){var b=qa(a[0]);this.j=b.next().value;this.ra=b.next().value;this.Z=b.next().value;this.O=b.next().value;this.D=b.next().value;this.Ea=b.next().value;this.tc=b.next().value;this.S=b.next().value;this.oc=b.next().value;this.jb=b.next().value;this.wa=b.next().value;this.sb=b.next().value;this.tb=b.next().value;this.Ma=b.next().value;this.v=b.next().value;this.R=b.next().value;this.Ia=b.next().value;this.xc=b.next().value;this.yc=b.next().value;this.Sc=b.next().value;b=a[1];je(this,
b[0]);de(this,b[1]);this.qc=b[2];this.sc=b[3];ge(this,b[4]);b=a[2];this.ib=b[0];Ie(this,b[1]);this.flags.pa=b[2];b=a[3];for(var c=b.length-1;c>=0;c--){var d;a:{for(d=0;d<this.ec.length;d++){var e=this.ec[d];if(e.zb===b[c]){d=e;break a}}d=null}d&&(d.next=this.T,this.T=d)}a=a[4];for(b=0;b<this.fa.length&&b<a.length;b++)this.fa[b][0]=a[b];return!0};function Ve(a){return a.F&65536?1:0}function We(a){return a.I&32768?2:0}function Xe(a){return a.M&65535?0:4}function Ye(a){return a.K&32768?8:0}
function Ze(a,b){var c=a.j[7];a.j[7]=c+b&65535;return c}function $e(a,b,c){c&&(Yc(a,a.j[7]+(b<<24>>23)),a.g-=2);a.g-=3}function Yc(a,b){a.j[7]=b&65535}function Pd(a,b,c,d){b={zb:b,priority:c,message:d||0,name:tc[b],next:null};a.ec.push(b);return b}function af(a,b){var c=a.T;if(c==b)a.T=b.next;else for(;c;){var d=c.next;if(d==b){c.next=d.next;break}c=d}a.T&&(a.v|=1)}
function Nd(a,b){if(b){if(b!=a.T){var c=a.T;if(!c||c.priority<=b.priority)b.next=c,a.T=b;else{do{var d=c.next;if(!d||d.priority<=b.priority){b.next=d;c.next=b;break}c=d}while(c)}}a.v|=1;a.u(b.message+16+1,"setIRQ(vector=%o,priority=%d)\n",b.zb,b.priority)}}function be(a,b){b&&(af(a,b),a.u(b.message+16+1,"clearIRQ(vector=%o,priority=%d)\n",b.zb,b.priority))}function bf(a){return a.v&64?(I(a,168,64,-6),!0):a.v&32?(I(a,4,32,-5),!0):a.v&16?(I(a,12,16,-7),!0):!1}
function ie(a){return a.C=a.C&63728|Ye(a)|Xe(a)|We(a)|Ve(a)}function je(a,b){b&=a.be;a.K=b<<12;a.M=~b&4;a.I=b<<14;a.F=b<<16;if((b^a.C)&a.ae)for(var c=a.ra.length;--c>=0;){var d=a.j[c];a.j[c]=a.ra[c];a.ra[c]=d}a.P=b>>14&3;c=a.C>>14&3;a.P!=c&&(a.Z[c]=a.j[6],a.j[6]=a.Z[a.P]);a.C=b;a.v&=-3;a.v|=a.T?2:1}function he(a,b){if(b&=65024){var c=b>>9;do b+=34;while(c>>=1);a.v|=1}a.jb=b}k.Ca=function(a){this.K=this.M=a;this.I=0};k.kb=function(a,b){this.K=this.M=this.F=a;this.I=b||0};
function cf(a,b){a.K=a.M=a.F=b;a.I=a.K^a.F>>1}function df(a,b,c,d){a.K=a.M=a.F=b;a.I=(c^d)&(d^b)}function I(a,b,c,d){if(!a.oa){a.Ia<0?a.Ia=ie(a):a.P||(d=-4);d==-4&&(a.v&256&&(d=-1),a.v|=256,a.S|=4,a.j[6]=b=4);if(d!=-1){a.R=b|4143316992;a.P=0;var e=a.na(b|a.Fa),f=a.na(b+2&65535|a.Fa);je(a,f&-12289|a.Ia>>2&12288);ef(a,a.Ia);ef(a,a.j[7]);Yc(a,e)}a.g-=5;a.v&=~(c|19);a.v|=129;a.Ia=-1;a.xc=d;a.yc=b;d==-1&&bd(a);if(d>=-4)throw b;}}
function ff(a){var b=gf(a),c=gf(a);a.C&49152&&(c=c&-225|a.C&63712);Yc(a,b);je(a,c);a.v&=-17}function hf(a,b){var c=b>>13&31;c<31&&(b=a.Y&32?a.Ea[c]+(b&8191)&4194303:b&-3932161);return b}
function jf(a,b,c){var d=[];if(c){c=hf(a,b);var e=b>>13&31;d.push(c);d.push(e);a.Y&32&&(d.push(a.Ea[e]),d.push(b&8191))}else if(a.rb){e=a.P<<1;var f=b>>13;f>7&&(e|=1);a.Y&a.Sd[a.P]||(f&=7);b&=8191;var g=a.O[a.P][f]<<6;c=g+b&a.Na;c>=3932160&&(c=hf(a,c));d.push(c);d.push(b);d.push(e);d.push(f&7);d.push(g);d.push(a.Na)}else c=b&65535,c>=57344&&(c|=a.ob),d.push(c);return d}
function jd(a,b,c){if(!(c&a.rb)){var d=b&65535;d>=57344&&(d|=a.ob);return d}var e=b>>13;a.Y&a.Sd[a.P]||(e&=7);var f=a.D[a.P][e];d=(a.O[a.P][e]<<6)+(b&8191)&a.Na;d>=3932160&&(d=hf(a,d));if(a.oa)return d;d>=a.Pd&&d<a.ob?(a.S|=32,I(a,4,0,d)):d&1&&!(c&1)&&(a.S|=64,I(a,4,0,d));var g=0;switch(f&7){case 1:g=4096;case 2:f|=128;c&4&&(g=8192);break;case 4:g=4096;case 5:c&4&&(g=4096);case 6:f|=c&4?192:128;break;default:g=32768}(f&32520)!=32512&&(f&8?f&32512&&(b&8128)<(f>>2&8128)&&(g|=16384):(b&8128)>(f>>2&8128)&&
(g|=16384));a.D[a.P][e]=f;if(d!=(4194170&a.Na)||a.P)a.sb=a.P,a.tb=e;g&&(g&57344&&(a.Ia>=0&&(g|=128),a.U&57344||(g|=a.U&4096|a.sb<<5|a.tb<<1,de(a,a.U&-61695|g&61694)),I(a,168,64,-2)),a.U&61440||!(d<(4191360&a.Na)||d>(4194239&a.Na))||(a.U|=4096,a.U&512&&(a.v|=64)));return d}function gf(a){var b=a.na(a.j[6]|a.Fa);a.j[6]=a.j[6]+2&65535;return b}function ef(a,b){var c=a.j[6]-2&65535;a.j[6]=c;a.R=a.R&65535|(a.R&-65536)<<8|16121856;a.v&256||a.Eb(4,-2,c);a.Ab(c,b)}
function kf(a,b,c,d){var e=d&8?0:a.Fa;switch(b){case 0:return I(a,4,0,-3),0;case 1:return c==6&&a.Eb(d,0,a.j[6]),a.g-=3,c==7?a.j[c]:a.j[c]|e;case 2:var f=2;var g=a.j[c];c==6&&a.Eb(d,f,g);c!=7&&(g|=e,c<6&&d&1&&(f=1));a.g-=3;break;case 3:f=2;g=a.j[c];c!=7&&(g|=e);g=a.na(g);g|=e;a.g-=7;break;case 4:f=-2;c<6&&d&1&&(f=-1);g=a.j[c]+f&65535;c==6&&a.Eb(d,f,g);c!=7&&(g|=e);a.g-=4;break;case 5:f=-2;g=a.j[c]-2&65535;c!=7&&(g|=e);g=a.na(g)|e;a.g-=8;break;case 6:return g=a.na(Ze(a,2)),g=g+a.j[c]&65535,c==6&&a.Eb(d,
0,g),a.g-=6,g|e;case 7:return g=a.na(Ze(a,2)),g=g+a.j[c]&65535,g=a.na(g|a.Fa),a.g-=10,g|e}a.j[c]=a.j[c]+f&65535;a.R=a.R&65535|(a.R&-65536)<<8|(f<<3&248|c)<<16;return g}k.Af=function(a,b,c){!this.P&&b<=0&&c<=this.wa&&(this.v|=32)};k.Bf=function(a,b,c){this.P||(c>=65534&&(c|=-65536),a&4&&c<=this.wa&&(c<=this.wa-32?I(this,4,0,-4):(this.S|=8,this.v|=32)))};k.le=function(a){this.H&&ze(this.H,a,1);return this.Zc(a)};k.oe=function(a){this.H&&ze(this.H,a,2);return this.ad(a)};
k.ue=function(a,b){this.H&&Ae(this.H,a,1);this.bd(a,b)};k.ve=function(a,b){this.H&&Ae(this.H,a,2);this.gd(a,b)};function ld(a,b){a.oa++;b=a.G.zc(jd(a,b,2));a.oa--;return b}function Cf(a,b){(b?--a.mc:--a.lc)||Se(a)}k.Ef=function(a,b,c){return kf(this,a,b,c)};k.ne=function(a,b,c){return jd(this,kf(this,a,b,c),c)};k.te=function(a){return this.G.zc(this.Ma=a)};k.Xg=function(a){this.H&&ze(this.H,a,2);return this.te(a)};k.Bd=function(a){return this.G.zc(this.Ma=jd(this,a,2))};
k.Yg=function(a){this.H&&ze(this.H,a,2);return this.Bd(a)};k.ze=function(a,b){this.G.Wb(this.Ma=a,b)};k.pi=function(a,b){this.H&&Ae(this.H,a,2);this.ze(a,b)};k.Fd=function(a,b){this.G.Wb(this.Ma=jd(this,a,4),b)};k.ri=function(a,b){this.H&&Ae(this.H,a,2);this.Fd(a,b)};function Df(a,b,c){var d=a.A=b&7;(b=a.B=(b&56)>>3)?(d=kf(a,b,d,2),c&65536||(a.C&61440)!==61440&&(d&=65535),a.P=a.C>>12&3,c=a.na(d|c&a.Fa),a.P=a.C>>14&3):c=d!=6||(a.C>>2&12288)===(a.C&12288)?a.j[d]:a.Z[a.C>>12&3];return c}
function Ef(a,b,c,d){a.R=a.R&65535|1441792;var e=a.A=b&7;(b=a.B=(b&56)>>3)?(e=kf(a,b,e,4),c&65536||(e&=65535),a.P=a.C>>12&3,e=jd(a,e|c&65536,4),a.P=a.C>>14&3,a.dc(e,d)):e!=6||(a.C>>2&12288)===(a.C&12288)?a.j[e]=d:a.Z[a.C>>12&3]=d}function Ff(a,b){b>>=6;var c=a.aa=b&7;return(b=a.V=(b&56)>>3)?a.bc(a.va(b,c,3)):a.j[c+a.wc]&a.Ud}function Gf(a,b){var c;b>>=6;var d=a.aa=b&7;(b=a.V=(b&56)>>3)?c=a.cc(a.va(b,d,2)):c=a.j[d+a.wc];return c}function Hf(a,b){var c=a.A=b&7;b=a.B=(b&56)>>3;return kf(a,b,c,8)}
function If(a,b){var c=a.A=b&7;return(b=a.B=(b&56)>>3)?a.bc(a.va(b,c,3)):a.j[c]&255}function Jf(a,b){var c,d=a.A=b&7;(b=a.B=(b&56)>>3)?c=a.cc(a.va(b,d,2)):c=a.j[d];return c}function Kf(a,b,c,d){var e=a.A=b&7;(b=a.B=(b&56)>>3)?(e=a.Vc=a.va(b,e,7),c=c<0?a.j[-c-1]&255:c,a.Rc(e,d.call(a,c,a.bc(e))),e&1&&a.g--):(b=a.j[e],c=c<0?a.j[-c-1]&255:c,a.j[e]=b&65280|d.call(a,c,b&255))}
function N(a,b,c,d){var e=a.A=b&7;(b=a.B=(b&56)>>3)?(e=a.va(b,e,6),a.dc(e,d.call(a,c<0?a.j[-c-1]:c,a.cc(e)))):a.j[e]=d.call(a,c<0?a.j[-c-1]:c,a.j[e])}function Lf(a,b,c,d,e){var f=a.A=b&7;(b=a.B=(b&56)>>3)?(d=a.va(b,f,5),e.call(a,(c=c<0?a.j[-c-1]&255:c)<<8),a.Rc(d,c),d&1&&a.g--):(c?(c=c<0?a.j[-c-1]&255:c,a.j[f]=a.j[f]&~d|c<<24>>24&d):a.j[f]&=~d,e.call(a,c<<8))}
function Mf(a,b,c,d){var e=a.A=b&7;(b=a.B=(b&56)>>3)?(e=a.va(b,e,4),d.call(a,c=c<0?a.j[-c-1]:c),a.dc(e,c)):(a.j[e]=c=c<0?a.j[-c-1]:c,d.call(a,c))}
k.Ac=function(a){this.flags.complete=!0;var b=this.H?Nf(this.H)?1:this.flags.Qc?-1:0:0,c=a?this.flags.Qc?0:1:-1;this.flags.Qc=!1;this.gb=this.g=a;this.v=this.v&-5|(b?4:0);do{if(this.v){if(this.v&4){if(Of(this.H,this.j[7],c)){bd(this);break}++b||(this.v&=-5);c||c++}if(a=this.v&11)if(a=!1,this.v&2){var d=160,e=(this.jb&224)>>5,f=this.T&&this.T.priority>e?this.T:null;f&&(d=f.zb,e=f.priority);e>(this.C&224)>>5?(this.v&8&&(Ze(this,2),this.v&=-9),I(this,d,0,-10),e=!0):e=!1;e&&(f&&af(this,f),a=!0);this.T||
this.jb||(this.v&=-3)}else this.v&1&&this.v++;if(a){if(this.v&4&&Of(this.H,this.j[7],c)){bd(this);break}if(c<0)break}if(this.v&112&&bf(this)){if(this.v&4&&Of(this.H,this.j[7],c)){bd(this);break}if(c<0)break}}this.v=this.v&15|this.C&16;a=this.R=this.j[7];f=this.na(a);this.j[7]=a+2&65535;this.Yd(f)}while(this.g>0);return this.flags.complete?this.gb-this.g:this.flags.complete===!1?-1:0};Fb(function(){for(var a=F("pdp11","cpu"),b=0;b<a.length;b++){var c=a[b],d=Wb(c);d=new Pe(d);Vb(d,c)}});
function Pf(a,b){var c=b+a;this.K=this.M=this.F=c;this.I=(a^c)&(b^c);return c&65535}function Qf(a,b){var c=b+a,d=c<<8;this.K=this.M=this.F=d;this.I=(a<<8^d)&(b<<8^d);return c&255}function Rf(a,b){a=b<<1;cf(this,a);return a&65535}function Sf(a,b){a=b<<1;cf(this,a<<8);return a&255}function Tf(a,b){a=b&32768|b>>1|b<<16;cf(this,a);return a&65535}function Uf(a,b){a=b&128|b>>1|b<<8;cf(this,a<<8);return a&255}function Vf(a,b){a=b&~a;this.Ca(a);return a}function Wf(a,b){a=b&~a;this.Ca(a<<8);return a}
function Xf(a,b){a|=b;this.Ca(a);return a}function Yf(a,b){a|=b;this.Ca(a<<8);return a}function Zf(a,b){a=~b|65536;this.kb(a);return a&65535}function $f(a,b){a=~b|256;this.kb(a<<8);return a&255}function ag(a,b){this.K=this.M=a=b-a;this.I=b&(b^a);return a&65535}function bg(a,b){a=b-a;var c=a<<8;b<<=8;this.K=this.M=c;this.I=b&(b^c);return a&255}function cg(a,b){this.K=this.M=a=b+a;this.I=a&(b^a);return a&65535}function dg(a,b){a=b+a;var c=a<<8;this.K=this.M=c;this.I=c&(b<<8^c);return a&255}
function eg(a,b){a=-b;this.kb(a,a&b&32768);return a&65535}function fg(a,b){a=-b;this.kb(a<<8,(a&b&128)<<8);return a&255}function gg(a,b){a=b<<1|this.F>>16&1;cf(this,a);return a&65535}function hg(a,b){a=b<<1|this.F>>16&1;cf(this,a<<8);return a&255}function ig(a,b){a=(this.F&65536|b)>>1|b<<16;cf(this,a);return a&65535}function jg(a,b){a=((this.F&65536)>>8|b)>>1|b<<8;cf(this,a<<8);return a&255}function kg(a,b){var c=b-a;df(this,c,a,b);return c&65535}
function lg(a,b){var c=b-a;df(this,c<<8,a<<8,b<<8);return c&255}function mg(a,b){this.K=this.M=b&65280;this.I=this.F=0;return(b<<8|b>>8)&65535}function ng(a,b){a^=b;this.Ca(a);return a&65535}function og(a){N(this,a,Gf(this,a),Pf);this.g-=this.B?9+(this.aa&&this.A>=6?1:0):(this.V?5:3)+(this.A==7?2:0)}
function pg(a){var b=Jf(this,a);a=a>>6&7;var c=this.j[a];c&32768&&(c|=4294901760);this.F=this.I=0;b&=63;if(b&32)b=64-b,b>16&&(b=16),this.F=c<<17-b,c>>=b;else if(b)if(b>16)this.I=c,c=0;else{this.F=c<<=b;var d=c>>15&65535;d&&d!==65535&&(this.I=32768)}this.j[a]=c&65535;this.K=this.M=c;this.g-=(this.B?6:7)+b}
function qg(a){var b=Jf(this,a);a=a>>6&7;var c=this.j[a]<<16|this.j[a|1];this.F=this.I=0;b&=63;if(b&32){b=64-b;b>32&&(b=32);var d=c>>b-1;this.F=d<<16;d>>=1;c&2147483648&&(d|=4294967295<<32-b)}else b?(d=c<<b-1,this.F=d>>15,d<<=1,b>32&&(b=32),(c>>=32-b)&&(c|4294967295<<b&4294967295)!==4294967295&&(this.I=32768)):d=c;this.j[a]=d>>16&65535;this.j[a|1]=d&65535;this.K=d>>16;this.M=d>>16|d;this.g-=(this.B?6:7)+b}function rg(a){$e(this,a,!Ve(this))}function sg(a){$e(this,a,Ve(this))}
function tg(a){N(this,a,Gf(this,a),Vf);this.g-=this.B?9+(this.aa&&this.A>=6?1:0):(this.V?5:3)+(this.A==7?2:0)}function ug(a){Kf(this,a,Ff(this,a),Wf);this.g-=this.B?9+(this.aa&&this.A>=6?1:0):(this.V?5:3)+(this.A==7?2:0)}function vg(a){N(this,a,Gf(this,a),Xf);this.g-=this.B?9+(this.aa&&this.A>=6?1:0):(this.V?5:3)+(this.A==7?2:0)}function wg(a){Kf(this,a,Ff(this,a),Yf);this.g-=this.B?9+(this.aa&&this.A>=6?1:0):(this.V?5:3)+(this.A==7?2:0)}
function xg(a){var b=Gf(this,a);a=Jf(this,a);this.Ca((b<0?this.j[-b-1]:b)&a);this.g-=this.B?4+(this.aa&&this.A>=6?1:0):(this.V?4:3)+(this.A==7?2:0)}function yg(a){var b=Ff(this,a);a=If(this,a);this.Ca(((b<0?this.j[-b-1]&255:b)&a)<<8);this.g-=this.B?4+(this.aa&&this.A>=6?1:0):(this.V?4:3)+(this.A==7?2:0)}function zg(a){$e(this,a,Xe(this))}function Ag(a){$e(this,a,!Ye(this)==!We(this))}function Bg(a){$e(this,a,!Xe(this)&&!Ye(this)==!We(this))}function Cg(a){$e(this,a,!Ve(this)&&!Xe(this))}
function Dg(a){$e(this,a,Xe(this)||!Ye(this)!=!We(this))}function Eg(a){$e(this,a,Ve(this)||Xe(this))}function Fg(a){$e(this,a,!Ye(this)!=!We(this))}function Gg(a){$e(this,a,Ye(this))}function Hg(a){$e(this,a,!Xe(this))}function Ig(a){$e(this,a,!Ye(this))}function Jg(){I(this,12,0,-9)}function Kg(a){$e(this,a,!0)}function Lg(a){$e(this,a,!We(this))}function Mg(a){$e(this,a,We(this))}function Ng(a){a&1&&(this.F=0);a&2&&(this.I=0);a&4&&(this.M=1);a&8&&(this.K=0);this.g-=5}
function Og(a){var b=Gf(this,a);a=Jf(this,a);var c=(b=b<0?this.j[-b-1]:b)-a;df(this,c,a,b);this.g-=this.B?4+(this.aa&&this.A>=6?1:0):(this.V?4:3)+(this.A==7?2:0)}function Pg(a){var b=Ff(this,a);a=If(this,a);var c=(b=(b<0?this.j[-b-1]&255:b)<<8)-(a<<=8);df(this,c,a,b);this.g-=this.B?4+(this.aa&&this.A>=6?1:0):(this.V?4:3)+(this.A==7?2:0)}
function Qg(a){var b=Jf(this,a);if(b){a=a>>6&7;var c=this.j[a]<<16|this.j[a|1];this.F=this.I=0;b&32768&&(b|=-65536);var d=~~(c/b);d>=-32768&&d<=32767?(this.j[a]=d&65535,this.j[a|1]=c-d*b&65535,this.M=d>>16|d,this.K=d>>16):(this.I=32768,this.M=d>>15|d,this.K=c>>16,b===-1&&this.j[a]===65534&&(this.j[a]=this.j[a|1]=1));this.g-=53}else this.M=this.K=0,this.I=32768,this.F=65536,this.g-=7}function Rg(){I(this,24,0,-9);this.g-=20}
function Sg(){this.C&49152?(this.S|=128,I(this,4,0,-8)):(this.qa&&this.model==1120&&this.qa.setData(this.j[0],!0),this.H?Tg(this.H):bd(this));this.g-=7}function Ug(){I(this,16,0,-9);this.g-=20}var Vg=[0,7,7,10,7,11,9,13];function Wg(a){this.ja=this.g;Yc(this,Hf(this,a));this.g=this.ja-Vg[this.B]}var Xg=[0,14,14,17,14,18,16,20];function Yg(a){this.ja=this.g;var b=Hf(this,a);a=a>>6&7;ef(this,this.j[a]);this.j[a]=this.j[7];Yc(this,b);this.g=this.ja-Xg[this.B]}
var Zg=[3,9,9,13,10,14,12,16,4,9,9,13,10,14,13,17];function $g(a){var b=Gf(this,a);this.ja=this.g;Mf(this,a,b,this.Ca);this.g=this.ja-Zg[(this.V?8:0)+this.B]+(this.A!=7||this.B?0:2)}function ah(a){var b=Ff(this,a);Lf(this,a,b,65535,this.Ca);this.g-=this.B?9+(this.aa&&this.A>=6?1:0):(this.V?5:3)+(this.A==7?2:0)}var bh=[7,13,13,17,14,18,17,21];
function ch(a){var b=Jf(this,a);a=a>>6&7;b=(b<<16>>16)*(this.j[a]<<16>>16);this.j[a]=b>>16&65535;this.j[a|1]=b&65535;b|=0;this.K=b>>16;this.M=this.K|b;this.I=0;this.F=b<-32768||b>32767?65536:0;this.g-=23}function dh(){this.g-=5}function eh(){this.C&49152||(this.G.reset(),Zc(this),this.qa&&this.qa.setData(this.j[0],!0));this.g-=667}function fh(a){if(a&8)P.call(this,a);else{var b=gf(this);a&=7;a==7?Yc(this,b):(Yc(this,this.j[a]),this.j[a]=b);this.g-=9}}function gh(){ff(this);this.g-=13}
function hh(a){a&1&&(this.F=65536);a&2&&(this.I=32768);a&4&&(this.M=0);a&8&&(this.K=32768);this.g-=5}function ih(a){var b=(a&448)>>6;if(this.j[b]=this.j[b]-1&65535)Yc(this,this.j[7]-((a&63)<<1)),this.g+=1;this.g-=6}function jh(a){N(this,a,Gf(this,a),kg);this.g-=this.B?9+(this.aa&&this.A>=6?1:0):(this.V?5:3)+(this.A==7?2:0)}function kh(a){N(this,a,0,mg);this.g-=this.B?9:3+(this.A==7?2:0)}function lh(){I(this,28,0,-9)}
function mh(){this.qa&&(this.qa.Dd(this.j[7],!0),this.qa.setData(this.j[0],!0));this.v|=8;Ze(this,-2);this.g-=3}function nh(a){N(this,a,this.j[(a>>6&7)+this.wc],ng);this.g-=this.B?9:3+(this.A==7?2:0)}function P(a){var b;if(b=this.H)b=this.H,oc(b,2)?(b.u(3,"undefined opcode %s\n",H(b,a)),b=Tg(b)):b=!1;b||I(this,8,0,-9)}function Qe(a){oh[a>>12].call(this,a)}function ph(a){qh[a>>6&3].call(this,a)}function rh(a){sh[a>>6&3].call(this,a)}function th(a){uh[a>>6&3].call(this,a)}
function vh(a){wh[a&15].call(this,a)}function xh(a){yh[a&15].call(this,a)}function zh(a){Ah[a>>6&3].call(this,a)}function Bh(a){Ch[a>>6&3].call(this,a)}function Dh(a){Eh[a>>6&3].call(this,a)}
var oh=[function(a){Fh[a>>8&15].call(this,a)},$g,Og,xg,tg,vg,og,P,function(a){Gh[a>>8&15].call(this,a)},ah,Pg,yg,ug,wg,jh,P],Fh=[function(a){Hh[a>>4&15].call(this,a)},Kg,Hg,zg,Ag,Fg,Bg,Dg,Yg,Yg,ph,rh,th,P,P,P],qh=[function(a){Mf(this,a,0,this.kb);this.g-=this.B?9:3+(this.A==7?2:0)},function(a){N(this,a,0,Zf);this.g-=this.B?9:3+(this.A==7?2:0)},function(a){N(this,a,1,cg);this.g-=this.B?9:3+(this.A==7?2:0)},function(a){N(this,a,1,ag);this.g-=this.B?9:3+(this.A==7?2:0)}],sh=[function(a){N(this,a,0,eg);
this.g-=this.B?11:6},function(a){N(this,a,Ve(this)?1:0,Pf);this.g-=this.B?9:3+(this.A==7?2:0)},function(a){N(this,a,Ve(this)?1:0,kg);this.g-=this.B?9:3+(this.A==7?2:0)},function(a){a=Jf(this,a);this.kb(a);this.g-=this.B?4:3+(this.A==7?2:0)}],uh=[function(a){N(this,a,0,ig);this.g-=this.B?9:3+(this.A==7?2:0)},function(a){N(this,a,0,gg);this.g-=this.B?9:3+(this.A==7?2:0)},function(a){N(this,a,0,Tf);this.g-=this.B?9:3+(this.A==7?2:0)},function(a){N(this,a,0,Rf);this.g-=this.B?9:3+(this.A==7?2:0)}],Hh=
[function(a){Ih[a&15].call(this,a)},P,P,P,Wg,Wg,Wg,Wg,fh,P,vh,xh,kh,kh,kh,kh],Ih=[Sg,mh,gh,Jg,Ug,eh,P,P,P,P,P,P,P,P,P,P],wh=[dh,function(){this.F=0;this.g-=5},function(){this.I=0;this.g-=5},Ng,function(){this.M=1;this.g-=5},Ng,Ng,Ng,function(){this.K=0;this.g-=5},Ng,Ng,Ng,Ng,Ng,Ng,Ng],yh=[dh,function(){this.F=65536;this.g-=5},function(){this.I=32768;this.g-=5},hh,function(){this.M=0;this.g-=5},hh,hh,hh,function(){this.K=32768;this.g-=5},hh,hh,hh,hh,hh,hh,hh],Gh=[Ig,Gg,Cg,Eg,Lg,Mg,rg,sg,Rg,lh,zh,Bh,
Dh,P,P,P],Ah=[function(a){Lf(this,a,0,255,this.kb);this.g-=this.B?9:3+(this.A==7?2:0)},function(a){Kf(this,a,0,$f);this.g-=this.B?9:3+(this.A==7?2:0)},function(a){Kf(this,a,1,dg);this.g-=this.B?9:3+(this.A==7?2:0)},function(a){Kf(this,a,1,bg);this.g-=this.B?9:3+(this.A==7?2:0)}],Ch=[function(a){Kf(this,a,0,fg);this.g-=this.B?11:6},function(a){Kf(this,a,Ve(this)?1:0,Qf);this.g-=this.B?9:3+(this.A==7?2:0)},function(a){Kf(this,a,Ve(this)?1:0,lg);this.g-=this.B?9:3+(this.A==7?2:0)},function(a){a=If(this,
a);this.kb(a<<8);this.g-=this.B?4:3+(this.A==7?2:0)}],Eh=[function(a){Kf(this,a,0,jg);this.g-=this.B?9+(this.Vc&1):3+(this.A==7?2:0)},function(a){Kf(this,a,0,hg);this.g-=this.B?9:3+(this.A==7?2:0)},function(a){Kf(this,a,0,Uf);this.g-=this.B?9+(this.Vc&1):3+(this.A==7?2:0)},function(a){Kf(this,a,0,Sf);this.g-=this.B?9:3+(this.A==7?2:0)}];function Re(a){Jh[a>>12].call(this,a)}
var Jh=[function(a){Kh[a>>8&15].call(this,a)},$g,Og,xg,tg,vg,og,function(a){Lh[a>>8&15].call(this,a)},function(a){Mh[a>>8&15].call(this,a)},ah,Pg,yg,ug,wg,jh,P],Kh=[function(a){Nh[a>>4&15].call(this,a)},Kg,Hg,zg,Ag,Fg,Bg,Dg,Yg,Yg,ph,rh,th,function(a){Oh[a>>6&3].call(this,a)},P,P],Oh=[function(a){a=this.j[7]+((a&63)<<1)&65535;var b=this.na(a|this.Fa);Yc(this,this.j[5]);this.j[6]=a+2&65535;this.j[5]=b;this.g-=8},function(a){a=Df(this,a,0);this.Ca(a);ef(this,a);this.g-=11},function(a){var b=gf(this);
this.ja=this.g;this.Ca(b);Ef(this,a,0,b);this.g=this.ja-bh[this.B]},function(a){Mf(this,a,Ye(this)?65535:0,this.Ca);this.g-=this.B?9:3+(this.A==7?2:0)}],Nh=[function(a){Ph[a&15].call(this,a)},P,P,P,Wg,Wg,Wg,Wg,fh,function(a){!(a&8)||this.model<1145?P.call(this,a):(this.C&49152||(this.C=this.C&-225|(a&7)<<5,this.v|=1,this.v&=-3),this.g-=5)},vh,xh,kh,kh,kh,kh],Ph=[Sg,mh,function(){ff(this);this.v|=this.C&16;this.g-=13},Jg,Ug,eh,gh,function(a){P.call(this,a)},P,P,P,P,P,P,P,P],Lh=[ch,ch,Qg,Qg,pg,pg,qg,
qg,nh,nh,P,P,P,P,ih,ih],Mh=[Ig,Gg,Cg,Eg,Lg,Mg,rg,sg,Rg,lh,zh,Bh,Dh,function(a){this.model<1145?P.call(this,a):Qh[a>>6&3].call(this,a)},P,P],Qh=[function(a){P.call(this,a)},function(a){a=Df(this,a,65536);this.Ca(a);ef(this,a);this.g-=11},function(a){var b=gf(this);this.ja=this.g;this.Ca(b);Ef(this,a,65536,b);this.g=this.ja-bh[this.B]},function(a){P.call(this,a)}];
function Rh(a){C.call(this,"ROM",a,256);this.ga=this.j=null;this.B=+a.addr;this.g=+a.size;this.C=!1;this.v=a.alias;typeof this.v=="string"&&(this.v=eval(this.v));this.A=a.file;this.D=Va(this.A);if(this.A){a=this.A;var b=Wa(this.D);b!="json"&&b!="hex"&&(a=lb()+"/api/v1/dump?file="+this.A+"&format=bytes&decimal=true");var c=this;ib(a,null,!0,function(d,e,f){f?(c.u(274877906944,"Unable to load ROM resource (error %d: %s)\n",f,d),c.A=null):(Sb(c.fb,d,e),(d=mb(d,e))?(c.j=d.ba,c.ga=d.ga):c.A=null);Sh(c)})}}
t(Rh,C);k=Rh.prototype;k.za=function(a,b,c,d){this.G=b;this.i=c;this.H=d;Sh(this)};k.Ba=function(){this.ga&&(this.H&&Th(this.H,this.id,this.B,this.g,this.ga),delete this.ga);return!0};k.Aa=function(){return!0};
function Sh(a){if(!kc(a)){if(a.A){if(!a.j||!a.G)return;a.g||(a.g=a.j.length);if(a.j.length!=a.g)ic(a,"ROM size ("+Ua(a.j.length,8,!0)+") does not match specified size ("+Ua(a.g,8,!0)+")");else{a:{var b=a.B;if(b>=57344&&b<57344+qd){var c={};c=(c[b]=[Rh.prototype.Hg,Rh.prototype.Zh,null,null,null,a.g>>1],c);if(Bc(a.G,a,c)){a.u(137438953472,"Added %d-byte ROM at %o\n",a.g,b);b=a.C=!0;break a}}else if(xd(a.G,b,a.g,pe)){for(c=0;c<a.j.length;c++)Fd(a.G,b+c,a.j[c]);b=!0;break a}b=!1}if(b){b=[];typeof a.v==
"number"?b.push(a.v):a.v!=null&&a.v.length&&(b=a.v);for(c=0;c<b.length;c++){for(var d=a,e=b[c],f=d.G,g=d.g,h=[],l=d.B>>>f.j;g>0&&l<f.g.length;)h.push(f.g[l++]),g-=f.v;f=d.G;d=d.g;g=0;for(e>>>=f.j;d>0&&e<f.g.length;){l=h[g++];if(!l)break;f.g[e++]=l;d-=f.v}}a.C||delete a.j}}}G(a)}}k.Hg=function(a){return this.j[a-this.B]};k.Zh=function(){};Fb(function(){for(var a=F("pdp11","rom"),b=0;b<a.length;b++){var c=a[b],d=Wb(c);d=new Rh(d);Vb(d,c)}});
function Uh(a){C.call(this,"RAM",a);this.ga=this.j=null;this.v=+a.addr;this.A=+a.size;this.ya=a.load;this.xa=a.exec;this.ya!=null&&(this.ya=+this.ya);this.xa!=null&&(this.xa=+this.xa);this.B=this.D=!1;this.g=a.file;this.C=Va(this.g);if(this.g){a=this.g;var b=Wa(this.C);b!="json"&&b!="hex"&&(a=lb()+"/api/v1/dump?file="+this.g+"&format=bytes&decimal=true");var c=this;ib(a,null,!0,function(d,e,f){f?(c.u(274877906944,"Unable to load RAM resource (error %d: %s)\n",f,d),c.g=null):(Sb(c.fb,d,e),(d=mb(d,
e))?(c.j=d.ba,c.ga=d.ga,c.ya==null&&(c.ya=d.ya),c.xa==null&&(c.xa=d.xa)):c.g=null);Vh(c)})}}t(Uh,C);Uh.prototype.za=function(a,b,c,d){this.G=b;this.i=c;this.H=d;Vh(this)};Uh.prototype.Ba=function(a,b){this.ga&&(this.H&&Th(this.H,this.id,this.v,this.A,this.ga),delete this.ga);b||this.reset();return!0};Uh.prototype.Aa=function(){return!0};
function Vh(a){if(a.G&&(!a.B&&a.A&&(xd(a.G,a.v,a.A,Hd)?a.B=!0:a.A=0),!kc(a))){if(!a.B)A("No RAM allocated");else if(a.g){if(!a.j)return;Wh(a,a.j,a.ya,a.xa,a.v)?a.u(137438953472,'Loaded image "%s"\n',a.C):a.u(274877906944,'Error loading image "%s"\n',a.C)}a.D=!0;G(a)}}
Uh.prototype.reset=function(){if(this.B&&!this.D){var a=this.G,b=this.v,c=this.A,d=b&a.A;for(b>>>=a.j;c>0&&b<a.g.length;){var e=a.g[b],f=d,g=c,h=0;f=f||0;h=(h||0)&255;g===void 0&&(g=e.size);if(e.g)for(d=f;g--&&d<e.g.length;d++)e.g[d]=h;else for(d=f;g--&&d<e.size;d++)e.v(f,h,e.L+f);c-=a.v;b++;d=0}this.j&&Wh(this,this.j,this.ya,this.xa,this.v,!this.H)}this.D=!1};
function Wh(a,b,c,d,e,f){var g=!1,h=!1;if(c==null)for(var l=0;l<b.length-1;){var m=b[l]&255|(b[l+1]&255)<<8;if(m)if(m&255){var n=l;if(m!=1){a.u(16384,"invalid signature (%#06x) at offset %#06x\n",m,n);break}if(l+6>=b.length){a.u(16384,"invalid block at offset %#06x\n",n);break}l+=2;var r=b[l++]&255|(b[l++]&255)<<8,p=b[l++]&255|(b[l++]&255)<<8;m+=(r&255)+(r>>8)+(p&255)+(p>>8);for(var q=l,v=r-=6;r>0&&l<b.length;)m+=b[l++]&255,r--;if(r!=0||l>=b.length){a.u(16384,"insufficient data for block at offset %#06x\n",
n);break}m+=b[l++]&255;if(m&255){a.u(16384,"invalid checksum (%#04x) for block at offset %#06x\n",m,n);break}if(v)for(a.u(16384,"loading %#06x bytes at %#06x-%%#06x\n",v,p,p+v);v--;)Fd(a.G,p++,b[q++]&255);else p&1?g=!0:d==null&&(d=p),d!=null&&a.u(16384,"starting address: %#06x\n",d);h=!0}else l++;else l+=2}if(!h&&(c==null&&(c=e),c!=null)){for(e=0;e<b.length;e++)Fd(a.G,c+e,b[e]);h=!0}if(h){if(d==null||g)bd(a.i),f=!1;d!=null&&Te(a.i,d,f)}return h}
Fb(function(){for(var a=F("pdp11","ram"),b=0;b<a.length;b++){var c=a[b],d=Wb(c);d=new Uh(d);Vb(d,c)}});function Xh(a){C.call(this,"Keyboard",a,2048);G(this)}t(Xh,C);Xh.prototype.ta=function(){return!1};Xh.prototype.za=function(a,b,c,d){this.N=a;this.i=c;this.H=d};Fb(function(){for(var a=F("pdp11","keyboard"),b=0;b<a.length;b++){var c=a[b],d=Wb(c);d=new Xh(d);Vb(d,c)}});
function Yh(a){C.call(this,"SerialPort",a,4194304);this.O=+a.adapter;this.U=+a.baudReceive||9600;this.aa=+a.baudTransmit||9600;this.M=a.upperCase;typeof this.M=="string"&&(this.M=this.M=="true");this.B=this.C=null;this.V=+a.tabSize;this.Y=+a.charBOL;this.D=0;this.K=!0;this.S=this.P=null;this.T=this.Z=-1;this.F=this.g=this.j=0;this.A=[];a=a.binding;if(a=="console")this.C="";else if(a){var b=Zb("Panel",this.id);b&&(b=b.J[a])&&this.ta("",a,b)}this.v=this.I=this.R=null;this.exports={connect:this.pe,receiveData:this.Mc,
receiveStatus:this.bh,setConnection:this.hh}}t(Yh,C);k=Yh.prototype;
k.ta=function(a,b,c){if(!a||a=="textarea"){var d=this;this.J[b]=this.B=c;c.onkeydown=function(e){e=e||window.event;var f=0,g=e.keyCode;g==8?f=e.altKey?Ja.Id:Ja.Ub:g==46?f=Ja.Id:e.ctrlKey&&g>=Ja.Gd&&g<=Ja.vf&&(f=g-(Ja.Gd-Ja.Be));f&&(e.preventDefault&&e.preventDefault(),d.Mc(f));return!0};c.onkeypress=function(e){e=e||window.event;if(!e.metaKey){var f=e.which||e.keyCode;e.altKey&&f==Ja.De&&(f=Ja.Ce);d.Mc(f);e.preventDefault&&e.preventDefault()}return!0};c.onpaste=function(e){e.stopPropagation&&e.stopPropagation();
e.preventDefault&&e.preventDefault();(e=e.clipboardData||window.clipboardData)&&d.Mc(e.getData("Text"))};c.removeAttribute("readonly");return!0}return!1};
k.za=function(a,b,c,d){this.N=a;this.G=b;this.i=c;this.H=d;var e=this;this.S=Pd(this.i,this.O?-1:48,4,2097152);this.T=Md(this.i,function(){var f=-1;e.A.length&&(f=e.A.shift()&255,e.u("receiveByte(%#04x)\n",f),e.M&&f>=97&&f<122&&(f-=32),Od(e.i,e.T,1E3/Math.round(e.U/10)));f>=0&&(e.F=f,e.g&128?e.F|=49152:e.g|=128,e.g&64&&Nd(c,e.S))});this.P=Pd(this.i,this.O?-1:52,4,2097152);this.Z=Md(this.i,function(){e.j|=128;e.j&64&&Nd(c,e.P)});Bc(b,this,Zh,this.O?64832+(this.O-1)*8-65392:0);Dc(b,this.reset.bind(this));
G(this)};k.pe=function(a){if(!this.v){var b=Ee(this.N,"connection");if(b){var c=b.split("->");if(c.length==2){var d=eb(c[0]);if(d!=this.Wc)return;c=eb(c[1]);if(this.v=Yb(c)){var e=this.v.exports;if(e){var f=e.connect;f&&f.call(this.v,this.K);if(this.I=e.receiveData){this.K=a;this.R=e.receiveStatus;this.u(137438953472,"Connected %s.%s to %s\n",this.fb,d,c);return}}}}this.u(137438953472,"Unable to establish connection: %s\n",b)}}};
k.Ba=function(a,b){if(!b)if(this.pe(this.K),!a)this.reset();else if(!this.restore(a))return!1;return!0};k.Aa=function(a){return a?this.save():!0};k.reset=function(){$h(this)};k.save=function(){var a=new Hc(this);a.set(0,[this.F,this.g,this.j,this.A]);return a.data()};k.restore=function(a){return $h(this,a[0])};function $h(a,b){b||(b=[0,8192,128,a.A]);b=qa(b);a.F=b.next().value;a.g=b.next().value;a.j=b.next().value;a.A=b.next().value;return!0}
k.Mc=function(a){if(typeof a=="number")this.A.push(a);else if(typeof a=="string")for(var b=0,c,d=0;d<a.length;d++){c=b;b=a.charCodeAt(d);if(b==10){if(c==13)continue;b=13}this.A.push(b)}else this.A=this.A.concat(a);Od(this.i,this.T,1E3/Math.round(this.U/10));return!0};k.bh=function(a){var b=this.g;this.g&=-12289;a&32&&(this.g|=8192);a&256&&(this.g|=4096);b!=this.g&&(this.g|=32768,this.g&32&&Nd(this.i,this.S))};k.hh=function(a,b){return this.v?!1:(this.v=a,this.I=b,!0)};
k.ug=function(){var a=this.g&65534;this.g&=-32769;return a};k.Mh=function(a){var b=a^this.g;this.g=this.g&-112|a&111;this.R&&b&6&&(b=0,b=this.K?b|(a&4?32:0)|(a&2?320:0):b|(a&4?16:0)|(a&2?1048576:0),this.R.call(this.v,b))};k.tg=function(){this.g&=-129;return this.F};k.Lh=function(){};k.ah=function(){return this.j};k.ti=function(a){this.j&128&&(a&64?Nd(this.i,this.P):be(this.i,this.P));this.j=this.j&-70|a&69};k.$g=function(){return 0};
k.si=function(a){a&=255;this.I&&this.I.call(this.v,a);a&=127;if(this.B)if(a==13)this.D=0;else if(a==8)this.B.value=this.B.value.slice(0,-1),this.D>0&&this.D--;else{if(a){var b;a!=13&&a!=10&&(b=fb[a]);b=b?"<"+b+">":String.fromCharCode(a);var c=b.length;a<32&&c==1&&(c=0);a==9&&(a=this.V||8,c=a-this.D%a,this.V&&(b=$a("",-c)));this.Y&&!this.D&&c&&(b=String.fromCharCode(this.Y)+b);this.B.value+=b;this.B.scrollTop=this.B.scrollHeight;this.D+=c}}else if(this.C!=null){if(a==10||this.C.length>=1024)this.print(this.C),
this.C="";a!=10&&(this.C+=String.fromCharCode(a))}Od(this.i,this.Z,1E3/Math.round(this.aa/10));this.j&=-129};var ai={},Zh=(ai[65392]=[null,null,Yh.prototype.ug,Yh.prototype.Mh,"RCSR"],ai[65394]=[null,null,Yh.prototype.tg,Yh.prototype.Lh,"RBUF"],ai[65396]=[null,null,Yh.prototype.ah,Yh.prototype.ti,"XCSR"],ai[65398]=[null,null,Yh.prototype.$g,Yh.prototype.si,"XBUF"],ai);Fb(function(){for(var a=F("pdp11","serial"),b=0;b<a.length;b++){var c=a[b],d=Wb(c);d=new Yh(d);Vb(d,c)}});
function ke(a){C.call(this,"PC11",a,8192);this.P=bi(this,a.autoMount);this.j=0;this.V=+a.baudReceive||3600;this.C=this.g=0;this.M=32768;this.v=this.T=0;this.F=[];this.D=ci;this.A=di;this.O=this.B="";this.ba=this.ya=this.xa=null;this.S=-1;this.R=!vb()&&"FileReader"in u;this.I=null;this.U=-1;this.K=null}t(ke,C);function bi(a,b){if(b&&typeof b=="string")try{b=eval("("+b+")")}catch(c){A(a.type+" auto-mount error: "+c.message+" ("+b+")"),b=null}return b||{}}k=ke.prototype;
k.ta=function(a,b,c){var d=this,e=di;switch(b){case "listTapes":return this.J[b]=c,c.onchange=function(){var f=d.J.descTape,g=c.options[c.selectedIndex];if(f&&g){var h={};if(g=g.getAttribute("data-value"))try{h=eval("("+g+")")}catch(l){A("PC11 option error: "+l.message)}g=h.desc;g===void 0&&(g="");h=h.href;h!==void 0&&(g='<a href="'+h+'" target="_blank">'+g+"</a>");f.innerHTML=g}},!0;case "descTape":return this.J[b]=c,!0;case "readTape":e=ei;case "loadTape":return e||(e=fi),this.J[b]=c,c.onclick=
function(){var f=d.J.listTapes;f&&gi(d,f.options[f.selectedIndex].text,f.value,e)},!0;case "mountTape":if(!this.R){c.parentNode.removeChild(c);break}this.J[b]=c;c.addEventListener("change",function(){var f=c.children[0];f.children[1].disabled=!f.children[0].files.length});c.onsubmit=function(f){if(f=f.currentTarget[1].files[0]){var g=f.name;gi(d,Va(g,!0),g,fi,f)}return!1};return!0;case hi:return this.J[b]=c,!0}return!1};
k.za=function(a,b,c,d){this.N=a;this.G=b;this.i=c;this.H=d;this.K=ii(a);var e=this;if(a=bi(this,Ee(this.N,"autoMount")))for(var f in a)f=="PTR"&&(this.P[f]=a[f]);this.I=Pd(this.i,56,4,8192);this.U=Md(this.i,function(){(e.g&32769)!=1||e.g&128||(e.v<e.F.length?(e.C=e.F[e.v]&255,e.u("%s.advanceReader(%d): %#04x\n",e.type,e.v,e.C),e.v++,ji(e,e.v/e.F.length*100)):e.g|=32768,e.g|=128,e.g&=-2049,e.g&64&&Nd(e.i,e.I))});Bc(b,this,ki);Dc(b,this.reset.bind(this));li(this,"None",ci,!0);this.R&&li(this,"Local Tape",
mi);li(this,"Remote Tape",ni);oi(this)||G(this)};k.Ba=function(a,b){if(!b)if(!a)this.reset();else if(!this.restore(a))return!1;return!0};k.Aa=function(a){return a?this.save():!0};k.reset=function(){this.g&=-2241;this.C=0};function oi(a){a.j=0;var b=a.P.PTR;if(b){var c=b.path||"";if(!(b=b.name))a:{if((b=a.J.listTapes)&&b.options)for(var d=0;d<b.options.length;d++){var e=b.options[d];if(e.value==c){b=e.text;break a}}b=Va(c,!0)}c&&b?pi(a,b,c,fi,!0):qi(a)}return!!a.j}
function gi(a,b,c,d,e){if(c)if(c==mi)a.u(274877906944,'Use "Choose File" and "Mount" to select and load a local tape.\n');else{if(c==ni){c=u.prompt("Enter the URL of a remote tape image.","")||"";if(!c)return;b=Va(c);a.u(137438953472,'Attempting to load %s as "%s"\n',c,b);a.D=ni}else a.D=c;pi(a,b,c,d,!1,e)}else ri(a,!1)}
function pi(a,b,c,d,e,f){var g=-1;if(a.B.toLowerCase()!=c.toLowerCase()||a.A!=d)g++,ri(a,!0),a.flags.bb?a.u(274877906944,"PC11 busy\n"):(e&&(a.j++,a.u('auto-loading tape "%s"\n',b)),a.load(b,c,d,f)?g++:a.flags.bb=!0);g&&si(a,a.O,a.B,a.A,a.ba,a.ya,a.xa)}
k.load=function(a,b,c,d){var e=this,f=b;if(d){var g=new FileReader;g.onload=function(){var h=g.result;h&&(h=new Uint8Array(h,0,h.byteLength),si(e,a,b,c,h),e.D=mi);e.flags.bb=!1;qi(e)};g.readAsArrayBuffer(d);return!1}b.indexOf("/api/v1/dump")<0&&(d=Wa(b),d!="json"&&d!="gz"&&(f=lb()+"/api/v1/dump?path="+encodeURIComponent(b)+"&format=json"));return!!ib(f,null,!0,function(h,l,m){m?e.u(274877906944,'Unable to load tape "%s" (error %d: %s)\n',a,m,h):(Sb(e.fb,h,l),(h=mb(h,l))&&si(e,a,b,c,h.ba,h.ya,h.xa));
e.flags.bb=!1;e.j&&(e.j--,e.j||G(e));qi(e)})};function li(a,b,c,d){if((a=a.J.listTapes)&&a.options){for(var e=0;e<a.options.length;e++)if(a.options[e].value==c)return;e=document.createElement("option");e.text=b;e.value=c;d&&a.childNodes[0]?a.insertBefore(e,a.childNodes[0]):a.appendChild(e)}}
function qi(a){var b=a.J.listTapes;if(b&&b.options){a=a.D||a.B;for(var c=0;c<b.options.length;c++)if(b.options[c].value==a){b.selectedIndex!=c&&(b.selectedIndex=c);break}c==b.options.length&&(b.selectedIndex=0)}}function ji(a,b){b|=0;if(b!==a.S){var c=a.J[hi];c&&(c=(c=F(ti,"",c))&&c[0])&&c.style&&(c.style.width=b+"%");a.S=b}}
function si(a,b,c,d,e,f,g){a.O=b;a.B=c;a.A=d;a.ba=e;a.ya=f;a.xa=g;d==ei?a.K&&Wh(a.K,e,f,g,null,!1)?a.u(137438953472,'Read tape "%s"\n',b):a.u(274877906944,'No valid memory address for tape "%s"\n',b):(a.v=0,a.F=e,a.g&=-32769,a.u(137438953472,'Loaded tape "%s" (%d bytes)\n',b,e.length),ji(a,0))}function ri(a,b){if(a.B||b===!1)a.O="",a.B="",b||(a.A&&a.u(137438953472,"%s\n",a.A==fi?"tape detached":"tape unloaded"),a.D=ci,a.A=di,qi(a))}k.save=function(){return(new Hc(this)).data()};k.restore=function(){return!0};
k.ng=function(){return this.g&65534};k.Fh=function(a){a&1&&(this.g&32768?(a&=-2,this.g&64&&Nd(this.i,this.I)):(this.g&=-129,this.g|=2048,this.C=0,Od(this.i,this.U,1E3/Math.round(this.V/10))));this.g=this.g&-66|a&65};k.mg=function(){this.g&=-129;this.g|=2048;return this.C};k.Eh=function(){};k.lg=function(){return this.M};k.Dh=function(a){this.M=this.M&-65|a&64};k.kg=function(){return this.T};k.Ch=function(a){this.T=a&255};
var ci="",mi="?",ni="??",di=0,fi=1,ei=2,hi="readProgress",ti="pcjs-progress-bar",ui={},ki=(ui[65384]=[null,null,ke.prototype.ng,ke.prototype.Fh,"PRS"],ui[65386]=[null,null,ke.prototype.mg,ke.prototype.Eh,"PRB"],ui[65388]=[null,null,ke.prototype.lg,ke.prototype.Dh,"PPS"],ui[65390]=[null,null,ke.prototype.kg,ke.prototype.Ch,"PPB"],ui);
function vi(a,b,c){C.call(this,"Disk",{id:a.fb+".disk"+Ua(++wi,4)},32768);this.controller=a;this.N=a.N;this.H=a.H;this.B=b;this.Wa=b.name;this.La=this.Cd="";this.wd=b.wd;this.da=this.la=this.ma=this.sa=this.mode=0;this.g=[];this.v=null;this.A=!1;this.create(c,b.da,b.la,b.ma,b.sa);this.j=this.C=null;G(this)}t(vi,C);k=vi.prototype;k.za=function(a,b,c,d){this.H=d};
k.create=function(a,b,c,d,e){this.mode=a;this.da=b;this.la=c;this.ma=d;this.sa=e;this.g=[];if(this.mode!="preload"){a=Array(this.da);for(b=0;b<a.length;b++){c=Array(this.la);for(d=0;d<c.length;d++){e=Array(this.ma);for(var f=1;f<=e.length;f++)e[f-1]=xi(null,b,d,f,this.sa,0);c[d]=e}a[b]=c}this.g=a}this.v=null};
k.load=function(a,b,c,d,e){var f=b;if(this.j)return!0;this.Wa=a;this.La=b;this.Cd=Va(b);var g=this;this.j=d;this.C=e||this.controller;if(c){var h=new FileReader;h.onload=function(){var l=h.result,m=l?l.byteLength:0,n=Ia[m];if(n){g.da=n[0];g.la=n[1];g.ma=n[2];g.sa=n[3]||512;var r=g.sa>>2;var p=n=0;l=new DataView(l,0,m);g.g=Array(g.da);for(m=0;m<g.g.length;m++)for(var q=g.g[m]=Array(g.la),v=0;v<q.length;v++)for(var D=q[v]=Array(g.ma),B=0;B<D.length;B++){for(var x=xi(null,m,v,B+1,g.sa,0),E=x.data,na=
0;na<r;na++,p+=4){var J=E[na]=l.getInt32(p,!0);n=n+J&-1}x.Ja=r;D[B]=x}g.v=n;r=g}else g.u(274877906944,"Unrecognized disk format (%d bytes)\n",m);g.j&&(g.j.call(g.controller,g.B,r,g.Wa,g.La),g.j=null)};h.readAsArrayBuffer(c);return!0}b.indexOf("/api/v1/dump")<0&&(a=Wa(b),a!="json"&&a!="gz"&&(f="path",c="&mbhd=10",!b.indexOf("http:")||!b.indexOf("ftp:")||"dsk ima img 360 720 12 144".split(" ").indexOf(a)>=0?(f="disk",c="&mbhd=0"):Xa(b,"/")&&(f="dir"),f=lb()+"/api/v1/dump?"+f+"="+encodeURIComponent(b)+
(this.wd?"":c)+"&format=json"));return!!ib(f,null,!0,function(l,m,n){yi(g,l,m,n)})};
function yi(a,b,c,d){var e=null;a.A=!1;if(d)a.controller.u(274877906944,'Unable to load disk "%s" (error %d: %s)\n',a.Wa,d,b);else{Sb(a.controller.fb,b,c);try{if(Va(a.Cd,!0).toLowerCase().indexOf("-readonly")>0)a.A=!0;else{var f=c.indexOf("\n");f>0&&f<1024&&c.substring(0,f).indexOf("write-protected")>0&&(a.A=!0)}var g;c.substr(0,1)=="<"?g=["Missing disk image: "+a.Wa]:g=c.indexOf("0x")<0&&c.substr(0,2)!='["'?JSON.parse(c.replace(/([a-z]+):/gm,'"$1":').replace(/\/\/[^\n]*/gm,"")):eval("("+c+")");if(g.length)if(g.length==
1)A(g[0]);else{a.da=g.length;a.la=g[0].length;a.ma=g[0][0].length;var h=g[0][0][0];a.sa=h&&h.length||512;for(d=c=0;d<a.da;d++)for(f=0;f<a.la;f++)for(var l=0;l<a.ma;l++)if(h=g[d][f][l]){var m=h.length;m===void 0&&(m=h.length=512);m>>=2;var n=h.pattern;n===void 0&&(n=h.pattern=0);var r=h.data;if(r===void 0){var p=h.bytes;if(p!==void 0&&p.length){for(var q=m<<2,v=p.length;v<q;v++)p[v]=n;a.fill(h,p,0)}else r=[],n=h.pattern=n|n<<8|n<<16|n<<24,h.data=r;delete h.bytes}xi(h,d,f);for(q=0;q<r.length;q++)c=
c+r[q]&-1}a.g=g;a.v=c;e=a}else A("Empty disk image: "+a.Wa)}catch(D){A("Disk image error ("+b+"): "+D.message)}}a.j&&(a.j.call(a.C,a.B,e,a.Wa,a.La),a.j=null)}function xi(a,b,c,d,e,f){a||(a={sector:d,length:e,data:[],pattern:f});a.Ak=b;a.Bk=c;a.Ua=a.Ja=0;a.wb=!1;return a}k.info=function(){return this.g.length?[this.g.length,this.g[0].length,this.g[0][0].length,this.g[0][0][0].length]:[0,0,0,0]};
k.seek=function(a,b,c,d,e){d=null;var f=this.B,g=this.g[a];if(g){var h=g[b];if(!h&&f.xf&&b<f.la)for(h=g[b]=Array(f.yf),g=0;g<h.length;g++)h[g]=xi(null,a,b,g+1,f.qe,0);if(h){for(g=0;g<h.length;g++)if(h[g]&&h[g].sector==c){d=h[g];break}!d&&f.xf&&f.fe==9&&(d=h[g]=xi(null,a,b,f.fe,f.qe,0))}}e&&e(d,!1);return d};k.fill=function(a,b,c){for(var d=a.length>>2,e=Array(d),f=0;f<d;f++)e[f]=b[c]|b[c+1]<<8|b[c+2]<<16|b[c+3]<<24,c+=4;a.data=e};
k.read=function(a,b){var c=-1;if(a&&b<a.length){c=a.data;var d=b>>2;c=(d<c.length?c[d]:a.pattern)>>((b&3)<<3)&255}return c};k.write=function(a,b,c){if(this.A)return!1;if(b<a.length){if(c!=this.read(a,b,!0)){var d=a.data,e=a.pattern,f=b>>2;b=(b&3)<<3;for(var g=d.length;g<=f;g++)d[g]=e;a.Ja?f<a.Ua?(a.Ja+=a.Ua-f,a.Ua=f):f>=a.Ua+a.Ja&&(a.Ja+=f-(a.Ua+a.Ja)+1):(a.Ua=f,a.Ja=1);d[f]=d[f]&~(255<<b)|c<<b}return!0}return null};
k.save=function(){var a=0,b=[];b[a++]=[this.La,this.v,this.da,this.la,this.ma,this.sa];if(!this.A)for(var c=this.g,d=0;d<c.length;d++)for(var e=0;e<c[d].length;e++)for(var f=0;f<c[d][e].length;f++){var g=c[d][e][f];if(g&&g.Ja){for(var h=[],l=0,m=g.Ua,n=g.Ua+g.Ja;m<n;)h[l++]=g.data[m++];b[a++]=[d,e,f,g.Ua,h]}}return b};
k.restore=function(a){var b=0,c="unsupported restore format";if(a&&a.length>0){var d=0,e=a[d++];e&&e.length>=2&&(!this.g.length&&e.length>=6?this.create("local",e[2],e[3],e[4],e[5]):e[1]!=null&&this.v!=null&&e[1]!=this.v&&(c="original checksum ("+e[1]+") differs from current checksum ("+this.v+")",b=-2));for(this.g.length||(b=-1);d<a.length&&b>=0;){var f=0,g=a[d++],h=g[f++],l=g[f++],m=g[f++];if(h>=this.g.length||l>=this.g[h].length||m>=this.g[h][l].length){c="sector (CHS="+h+":"+l+":"+m+") out of range ("+
b+" changes applied)";b=-1;break}if(this.A){c="unable to modify write-protected disk";b=-1;break}e=g[f++];f=g[f++];g=e+f.length;if(h=this.g[h][l][m]){for(l=h.data.length;l<e;)h.data[l++]=h.pattern;l=0;h.Ua=e;for(h.Ja=f.length;e<g;)h.data[e++]=f[l++];b++}}}b<0&&b!=-2&&this.controller.u(274877906944,'Unable to restore disk "%s": %s\n',this.Wa,c);return b};var wi=0;
function zi(a,b,c,d,e,f){C.call(this,a,b,c);this.P=Ai(this,b.autoMount);this.O=0;this.T=d;this.U=e;this.V=f;this.S=d.Yc;this.j=Array(this.S);this.R=!vb()&&"FileReader"in u;this.D=[];this.Pa=null;this.exports={bootDisk:this.ge,loadDisk:this.yd,selectDrive:this.gh,wait:this.kh}}t(zi,C);function Ai(a,b){if(b&&typeof b=="string")try{b=eval("("+b+")")}catch(c){A(a.type+" auto-mount error: "+c.message+" ("+b+")"),b=null}return b||{}}k=zi.prototype;
k.ta=function(a,b,c){var d=this;switch(b){case "listDisks":return this.J[b]=c,c.onchange=function(){Bi(d)},!0;case "descDisk":case "listDrives":return this.J[b]=c,c.onchange=function(){var e=Pa(c.value,10);e!=null&&aj(d,e)},!0;case "loadDisk":return this.J[b]=c,c.onclick=function(){d.yd()},!0;case "bootDisk":return this.J[b]=c,c.onclick=function(){d.ge()},!0;case "saveDisk":if(!this.R){c.parentNode.removeChild(c);break}this.J[b]=c;c.onclick=function(){var e=d.J.listDrives;if(e&&e.options&&d.j)if(e=
d.j[Pa(e.value,10)||0]){var f=e.ca;if(f){e=f.wk();f=f.Cd.replace(".json",".img");var g=null,h;typeof e!="string"?typeof Blob=="function"&&typeof URL!="undefined"&&URL&&typeof URL.createObjectURL=="function"&&(h=URL.createObjectURL(new Blob([e],{type:"application/octet-stream"}))):h="data:application/octet-stream;base64,"+e;if(h)if(f&&(g=document.createElement("a"),typeof g.download!="string"&&(g=null)),g){g.href=h;g.download=f;document.body.appendChild(g);g.click();document.body.removeChild(g);var l=
"Check your Downloads folder for "+f+"."}else u.open&&(u.open(h),l="Check your browser for a new window/tab containing the requested data"+(f?" ("+f+")":"")+".");else l="Operation unsupported by your browser.";kb(l)}else d.u(274877906944,"No disk loaded in drive.\n")}else d.u(274877906944,"No disk drive selected.\n")};return!0;case "mountDisk":if(this.R)return this.J[b]=c,c.addEventListener("change",function(){var e=c.children[0];e.children[1].disabled=!e.children[0].files.length}),c.onsubmit=function(e){if(e=
e.currentTarget[1].files[0]){var f=e.name;d.yd(Va(f,!0),f,e)}return!1},!0;c.parentNode.removeChild(c)}return!1};k.za=function(a,b,c,d){this.N=a;this.G=b;this.i=c;this.H=d;if(a=Ai(this,Ee(this.N,"autoMount")))for(var e in a)e.substr(0,2)==this.type.substr(0,2)&&(this.P[e]=a[e]);this.reset();this.Pa=Pd(this.i,this.T.td,this.T.pd,this.ha);Bc(b,this,this.V);Dc(b,this.reset.bind(this));cj(this,"None",dj,!0);this.R&&cj(this,"Local Disk",ej);cj(this,"Remote Disk",fj);gj(this)||G(this)};
k.Ba=function(a,b){if(!b){if(!a){if(this.reset(),this.N.P){this.D=[];for(a=0;a<this.j.length;a++)hj(this,a,!0);gj(this,!0)}}else if(!this.restore(a))return!1;if(a=this.J.listDrives){for(;a.firstChild;)a.removeChild(a.firstChild);a.value="";for(b=0;b<this.S;b++){var c=document.createElement("option");c.value=b;c.text=this.j[b].Oc||"---";a.appendChild(c)}this.S>0&&(a.value="0",aj(this,0))}}return!0};k.Aa=function(a){return a?this.save():!0};k.reset=function(){this.xb();ij(this)};
k.save=function(){var a=new Hc(this);a.set(0,this.Pc());for(var b=a.set,c=0;c<this.j.length;c++){var d=this.j[c];d.ca&&jj(this,d.La,d.ca)}b.call(a,1,this.D);b=a.set;c=[];for(d=0;d<this.j.length;d++){var e=this.j[d];c.push([e.Jb,e.Wa,e.La])}b.call(a,2,c);return a.data()};k.restore=function(a){var b=!0;this.xb(a[0])||(b=!1);var c=a[1];c&&(this.D=c);ij(this,a[2])||(b=!1);return b};k.xb=function(){return!0};k.Pc=function(){return[]};
function ij(a,b){for(var c=0;c<a.j.length;c++){var d=a.j[c];d===void 0&&(d=a.j[c]={});var e=a,f=d;d=c;var g=a.U,h=b&&b[c],l=0;f.Lb=d;f.name=e.Wc;f.Kc=f.Jb=!1;f.ac=null;f.wd=!0;f.Oc=g[l++]+d;f.da=g[l++];f.la=g[l++];f.ma=g[l++];f.sa=g[l++];f.Gf=g[l++];f.Hf=g[l++];f.If=g[l++];f.zf=g[l++];f.status=g[l];f.uk=0;f.tk=0;f.fe=1;f.yf=f.ma;f.qe=f.sa;f.Ck=0;f.Jk=null;f.ca||(f.La="");h&&(l=h[1],g=h[2],h[0]?(f=l,h=e.j[d],hj(e,d,!0),h.Jb=!0,d=new vi(e,h,"preload"),e.ie(h,d,f,g,!0)):kj(e,d,l,g,!0)?f.ca&&g&&lj(e,
l,g,f.ca):G(e,!1))}return!0}function gj(a,b){b||(a.O=0);for(var c in a.P){var d=a.P[c],e=d.path||"",f;if(!(f=d.name))a:{if((f=a.J.listDisks)&&f.options)for(var g=0;g<f.options.length;g++){var h=f.options[g];if(h.value==e){f=h.text;break a}}f=Va(e,!0)}if(e&&f&&(g=-1,c&&(g=c.charCodeAt(c.length-1)-48,g<0||g>9)&&(g=-1),g>=0&&g<a.j.length)){!kj(a,g,f,e,!0)&&b&&G(a,!1);continue}a.u(274877906944,"Incorrect auto-mount settings for drive %s (%s)\n",c,JSON.stringify(d))}return!!a.O}
k.yd=function(a,b,c){if(!a&&!b){var d=this.J.listDisks;d&&d.options&&(a=d.options[d.selectedIndex].text,b=d.value)}d=(d=this.J.listDrives)&&Pa(d.value,10);if(d===void 0||d<0||d>=this.j.length)return this.u(274877906944,"Unable to load the selected drive\n"),!1;if(!b)return hj(this,d),!0;if(b==ej)return this.u(274877906944,'Use "Choose File" and "Mount" to select and load a local disk.\n'),!1;if(b==fj){b=u.prompt("Enter the URL of a remote disk image.","")||"";if(!b)return!1;a=Va(b);this.u(137438953472,
'Attempting to load %s as "%s"\n',b,a)}kj(this,d,a,b,!1,c);return!0};k.ge=function(){var a,b=this.J.listDrives;b=b&&Pa(b.value,10);if(b==null||b<0||b>=this.j.length||!(a=this.j[b]))return this.u(274877906944,"Unable to boot the selected drive\n"),!1;if(!a.ca)return this.u(274877906944,"Load a disk into the drive first\n"),!1;Te(this.i,0,!0,b);return(a=this.Mb(a,a.Gf,a.Hf,a.If,a.zf,0,2))?(this.u(274877906944,"Unable to read the boot sector (%s)\n",a),!1):!0};
function kj(a,b,c,d,e,f){var g=-1,h=a.j[b];h.La.toLowerCase()!=d.toLowerCase()&&(g++,hj(a,b,!0),h.Kc?a.u(274877906944,"%s busy\n",a.type):(h.Kc=!0,e&&(h.ke=!0,a.O++,a.u('auto-loading disk "%s"\n',c)),h.Jb=!!f,(new vi(a,h,"preload")).load(c,d,f,a.ie)&&g++));return g}
k.ie=function(a,b,c,d){a.Kc=!1;b&&(b.da>a.da||b.la>a.la)&&(this.u(274877906944,'Disk "%s" too large for drive %s\n',c,this.j[a.Lb].Oc||"---"),b=null);b?(a.ca=b,a.Wa=c,a.La=d,this.re(a.Lb),lj(this,c,d,b),this.u(274877906944,'Loaded disk "%s" in drive %s\n',c,this.j[a.Lb].Oc||"---"),this.N&&Le(this.N)):a.Jb=!1;a.ke&&(a.ke=!1,--this.O||G(this));aj(this,a.Lb);a.ac&&(a.ac(),a.ac=null)};
function cj(a,b,c,d){if((a=a.J.listDisks)&&a.options){for(var e=0;e<a.options.length;e++)if(a.options[e].value==c)return;e=document.createElement("option");e.text=b;e.value=c;d&&a.childNodes[0]?a.insertBefore(e,a.childNodes[0]):a.appendChild(e)}}
function aj(a,b,c){var d=!1;if(b>=0&&b<a.j.length){var e=a.j[b],f=a.J.listDisks;a=a.J.listDrives;if(f&&a&&f.options&&a.options){if(c)for(c=0;c<a.options.length;c++)if(Pa(a.options[c].value,10)==e.Lb){a.selectedIndex!=c&&(a.selectedIndex=c);d=!0;break}c=Pa(a.value,10);e=e.Jb?ej:e.La;if(!isNaN(c)&&c==b){for(c=0;c<f.options.length;c++)if(f.options[c].value==e){f.selectedIndex!=c&&(f.selectedIndex=c);d=!0;break}c==f.options.length&&(f.selectedIndex=0)}}}return d}
k.gh=function(a){var b=this.J.listDrives;if(b&&b.options)for(var c=b.options.length,d=0;d<c;d++)if(b.options[d].textContent==a){var e=Pa(b.options[d].value,10);if(e>=0)return aj(this,e,!0)}return!1};
function Bi(a){var b=a.J.listDisks,c=a.J.descDisk,d=b.options&&b.options[b.selectedIndex];if(c&&d){b={};if(d=d.getAttribute("data-value"))try{b=eval("("+d+")")}catch(e){A(a.type+" option error: "+e.message)}a=b.desc;a===void 0&&(a="");b=b.href;b!==void 0&&(a='<a href="'+b+'" target="_blank">'+a+"</a>");c.innerHTML=a}}k.kh=function(a){for(var b=0;b<this.j.length;b++){var c=this.j[b];if(c&&c.Kc)return c.ac||(c.ac=a),!1}return!0};
function hj(a,b,c){var d=a.j[b];if(d.ca||c===!1)jj(a,d.La,d.ca),d.Wa="",d.La="",d.ca=null,d.Jb=!1,c||(a.u(274877906944,"Drive %s unloaded\n",a.j[b].Oc||"---"),aj(a,b))}function lj(a,b,c,d){var e;for(e=0;e<a.D.length;e++)if(a.D[e][1]==c){d.restore(a.D[e][2]);return}a.D[e]=[b,c,[]]}function jj(a,b,c){var d;for(d=0;d<a.D.length;d++)if(a.D[d][1]==b){a.D[d][2]=c.save();break}}k.re=function(){};k.Mb=function(){return-1};k.Tc=function(){return-1};var dj="",ej="?",fj="??";
function M(a){zi.call(this,"RK11",a,262144,qc,qc.Dc,mj);this.I=this.v=this.g=this.C=this.B=this.A=this.F=0}t(M,zi);k=M.prototype;k.xb=function(a){a||(a=[nj.Dc|nj.$d|nj.Wd,0,Q.Ya,0,0,0,0]);a=qa(a);this.I=a.next().value;this.v=a.next().value;this.g=a.next().value;this.C=a.next().value;this.B=a.next().value;this.A=a.next().value;this.F=a.next().value;return!0};k.Pc=function(){return[this.I,this.v,this.g,this.C,this.B,this.A,this.F]};
k.Mb=function(a,b,c,d,e,f,g,h,l){var m=0;a=a.ca;var n=null;a||(m=R.Qd,e=0);for(;e;){if(!n){if(b>=a.da){m=R.Bc;break}n=a.seek(b,c,d+1);if(!n){m=R.Zd;break}var r=0;++d>=a.ma&&(d=0,++c>=a.la&&(c=0,++b))}var p,q;if((p=a.read(n,r++))<0||(q=a.read(n,r++))<0){m=R.Cc;break}if(!h&&(id(this.G,hf(this.i,f),p|q<<8),Ld(this.G))){m=R.Xb;break}r>=a.sa&&(n=null);f+=g;e--}return l?l(m,b,c,d,e,f):m};
k.Tc=function(a,b,c,d,e,f,g,h,l){var m=0;a=a.ca;var n=null;a||(m=R.Qd,e=0);for(;e;){var r=kd(this.G,hf(this.i,f));if(Ld(this.G)){m=R.Xb;break}if(!n){if(b>=a.da){m=R.Bc;break}n=a.seek(b,c,d+1,!0);if(!n){m=R.Zd;break}var p=0;++d>=a.ma&&(d=0,++c>=a.la&&(c=0,++b))}if(h){var q,v;if((q=a.read(n,p++))<0||(v=a.read(n,p++))<0){m=R.Cc;break}if(r!=(q|v<<8)){m=R.ce;break}}else if(!a.write(n,p++,r&255)||!a.write(n,p++,r>>8)){m=R.Cc;break}p>=a.sa&&(n=null);f+=g;e--}return l?l(m,b,c,d,e,f):m};
k.Me=function(a,b,c,d,e,f){this.B=f&65535;this.g=this.g&~Q.Cb|f>>16-Q.ka.Cb&Q.Cb;this.C=65536-e&65535;this.A=this.A&~oj.qd|d&oj.qd;this.v|=a;pj(this);return!0};function pj(a){a.g&=~Q.eb;a.v&&(a.v|=R.Fe,a.g|=Q.eb,a.v&R.cd&&(a.g|=Q.cd),a.u("%s: ERROR: %o\n",a.type,a.v))}k.zg=function(){return this.I};k.Rh=function(){};k.Ag=function(){return this.v};k.Sh=function(){};k.wg=function(){return this.g&Q.Yb};
k.Oh=function(a){this.g=this.g&~Q.Sa|a&Q.Sa;if(this.g&Q.Vb){a=!0;var b,c="",d=(this.A&oj.mb)>>oj.ka.mb,e=this.j[d];this.g&=~(Q.Ya|Q.rd);this.v&=~R.nf;switch(b=this.g&Q.ua){case qj.Ae:this.u("%s: CRESET(%d)\n",this.type,d);this.v=this.A=0;this.g=Q.Ya;break;case qj.Te:c="RCHK";case qj.nb:c||(c="READ");var f=this.Mb;case qj.Ic:c||(c="WCHK");case qj.$b:c||(c="WRITE");f||(f=this.Tc);var g=(this.A&oj.Tb)>>oj.ka.Tb;var h=(this.A&oj.fd)>>oj.ka.fd;var l=this.A&oj.qd;var m=65536-this.C&65535;var n=(this.g&
Q.Cb)<<16-Q.ka.Cb|this.B;var r=this.g&Q.Le?0:2;this.u(1,"%s: %s(%d:%d:%d) %o-%o\n",this.type,c,g,h,l,n,n+(m<<1));if(g>=e.da){this.v|=R.Bc;break}if(l>=e.ma){this.v|=R.Cc;break}a=f.call(this,e,g,h,l,m,n,r,b>=qj.Ic,this.Me.bind(this));break;case qj.Hc:g=(this.A&oj.Tb)>>oj.ka.Tb;this.u("%s: SEEK(%d)\n",this.type,g);g<e.da?this.g|=Q.rd:this.v|=R.Bc;break;case qj.Ge:this.u("%s: DRESET(%d)\n",this.type,d);this.v=this.A=0;this.g=Q.Ya|Q.rd;break;default:this.u("%s: UNSUPPORTED(%s)\n",this.type,b)}this.I=e.status|
(e.ca?nj.Da:0)|d<<nj.ka.hd|this.A&nj.mf;pj(this);a&&(this.g&=~Q.Vb,this.g|=Q.Ya,this.g&Q.Bb&&Nd(this.i,this.Pa))}};k.Bg=function(){return this.C};k.Th=function(a){this.C=a};k.vg=function(){return this.B};k.Nh=function(a){this.B=a};k.xg=function(){return this.A};k.Ph=function(a){this.A=a};k.yg=function(){return this.F};k.Qh=function(a){this.F=a};
var nj=qc.Ec,R=qc.af,Q=qc.Ze,oj=qc.$e,qj=qc.ua,rj={},mj=(rj[65280]=[null,null,M.prototype.zg,M.prototype.Rh,"RKDS"],rj[65282]=[null,null,M.prototype.Ag,M.prototype.Sh,"RKER"],rj[65284]=[null,null,M.prototype.wg,M.prototype.Oh,"RKCS"],rj[65286]=[null,null,M.prototype.Bg,M.prototype.Th,"RKWC"],rj[65288]=[null,null,M.prototype.vg,M.prototype.Nh,"RKBA"],rj[65290]=[null,null,M.prototype.xg,M.prototype.Ph,"RKDA"],rj[65294]=[null,null,M.prototype.yg,M.prototype.Qh,"RKDB"],rj);
function le(a){zi.call(this,"RL11",a,524288,rc,rc.bf,sj);this.g=this.F=this.v=this.A=this.C=this.B=0}t(le,zi);k=le.prototype;k.xb=function(a){a||(a=[S.Da|S.Ya,0,0,0,0,0]);a=qa(a);this.g=a.next().value;this.F=a.next().value;this.v=a.next().value;this.A=a.next().value;this.C=a.next().value;this.B=a.next().value;return!0};k.Pc=function(){return[this.g,this.F,this.v,this.A,this.C,this.B]};
k.Mb=function(a,b,c,d,e,f,g,h,l){g=0;a=a.ca;h=null;a||(g=tj.Za,e=0);for(;e;){if(!h){h=a.seek(b,c,d+1);if(!h){g=tj.Za;break}var m=0}var n,r;if((n=a.read(h,m++))<0||(r=a.read(h,m++))<0){g=tj.Za;break}id(this.G,hf(this.i,f),n|r<<8);if(Ld(this.G)){g=tj.Xb;break}f+=2;e--;if(m>=a.sa&&(h=null,++d>=a.ma&&(d=0,++c>=a.la&&(c=0,++b>=a.da)))){g=tj.Za;break}}return l?l(g,b,c,d,e,f):g};
k.Tc=function(a,b,c,d,e,f,g,h,l){g=0;a=a.ca;h=null;a||(g=tj.Za,e=0);for(;e;){var m=kd(this.G,hf(this.i,f));if(Ld(this.G)){g=tj.Xb;break}f+=2;e--;if(!h){h=a.seek(b,c,d+1,!0);if(!h){g=tj.Za;break}var n=0}if(!a.write(h,n++,m&255)||!a.write(h,n++,m>>8)){g=tj.Za;break}if(n>=a.sa&&(h=null,++d>=a.ma&&(d=0,++c>=a.la&&(c=0,++b>=a.da)))){g=tj.Za;break}}return l?l(g,b,c,d,e,f):g};
k.Ne=function(a,b,c,d,e,f){this.F=f&65535;this.g=this.g&~S.Xa|f>>16-S.ka.Xa&S.Xa;this.B=f>>16&uj.$a;this.A=this.v=b<<vj.ka.Zb|(c?vj.Gc:0)|d&vj.Xd;this.C=65536-e&65535;a&&(this.g|=a|S.eb);return!0};k.Eg=function(){return this.g&S.Yb};
k.Wh=function(a){this.g=this.g&~S.Sa|a&S.Sa;this.B=this.B&60|(a&S.Xa)>>S.ka.Xa;if(!(this.g&S.Ya)){a=!0;var b="",c=this.j[(this.g&S.mb)>>S.ka.mb],d=c.ca;this.g&=~S.Da;switch(this.g&S.ua){case wj.Qe:case wj.Ic:case wj.We:break;case wj.sf:this.C&xj.Kd&&(this.g&=S.Da|S.ua|S.Xa);this.C=c.status|this.A&vj.Gc|(d&&d.da==512?xj.Ie:0);break;case wj.Hc:if((this.v&vj.He)==vj.pf){var e=this.v&vj.Zb;b=(this.v&vj.rf)<<2;this.A=this.v&vj.qf?this.A+e:this.A-e;this.v=this.A=this.A&vj.Zb|b}break;case wj.Ye:this.C=this.A;
break;case wj.Ue:b="READ",e=this.Mb;case wj.uf:b||(b="WRITE");e||(e=this.Tc);var f=this.v>>vj.ka.Zb;var g=this.v&vj.Gc?1:0;var h=this.v&vj.Xd;!d||f>=d.da||h>=d.ma?this.g|=tj.Za|S.eb:(a=65536-this.C&65535,d=(this.B&uj.$a)<<16|this.F,this.u(1,"%s: %s(%d:%d:%d) %o-%o\n",this.type,b,f,g,h,d,d+(a<<1)),a=e.call(this,c,f,g,h,a,d,2,!1,this.Ne.bind(this)))}a&&(this.g|=S.Da|S.Ya,this.g&S.Bb&&Nd(this.i,this.Pa))}};k.Cg=function(){return this.F};k.Uh=function(a){this.F=a&yj.Sa};k.Fg=function(){return this.v};
k.Xh=function(a){this.v=a};k.Gg=function(){return this.C};k.Yh=function(a){this.C=a};k.Dg=function(){return this.B};k.Vh=function(a){this.B=a&uj.$a;this.g=this.g&~S.Xa|(this.B&3)<<S.ka.Xa};
var S=rc.ef,yj=rc.cf,vj=rc.ff,xj=rc.Fc,uj=rc.df,tj=rc.Jd,wj=rc.ua,zj={},sj=(zj[63744]=[null,null,le.prototype.Eg,le.prototype.Wh,"RLCS"],zj[63746]=[null,null,le.prototype.Cg,le.prototype.Uh,"RLBA"],zj[63748]=[null,null,le.prototype.Fg,le.prototype.Xh,"RLDA"],zj[63750]=[null,null,le.prototype.Gg,le.prototype.Yh,"RLMP"],zj[63752]=[null,null,le.prototype.Dg,le.prototype.Vh,"RLBE"],zj);
function me(a){zi.call(this,"RX11",a,1048576,sc,sc.gf,Aj);this.K=this.I=this.v=this.M=this.g=this.F=0;this.A=U.Db;this.B=0;this.C=Array(128).fill(0)}t(me,zi);k=me.prototype;k.xb=function(a){a?(a=qa(a),this.g=a.next().value,this.F=a.next().value,this.K=a.next().value,this.I=a.next().value,this.v=a.next().value,this.M=a.next().value,this.A=a.next().value,this.B=a.next().value,this.C=a.next().value):(this.F=this.g=0,this.I=this.K=1,this.M=this.v=0,this.A=U.nb,this.B=0,be(this.i,this.Pa),Bj(this));return!0};
k.Pc=function(){return[this.g,this.F,this.K,this.I,this.v,this.M,this.A,this.B,this.C]};k.re=function(a){a==0&&this.xb()};function Cj(a,b){b&&(a.M=b,a.F=a.v,a.g|=V.eb);a.A=U.Db;a.g|=V.DONE;a.g&V.Bb&&Nd(a.i,a.Pa)}
k.Mb=function(a,b,c,d,e,f,g,h,l){h=0;var m=a.ca,n=null;this.u(1,"%s.readData(%d:%d:%d) %o-%o\n",this.type,b,c,d,f,f+(e<<1));m||(h=a.Lb?Dj.ed:Dj.dd,e=0);for(;e;){if(!n){if(b>=m.da){h=Dj.Re;break}n=m.seek(b,c,d+1);if(!n){h=Dj.od;break}var r=0;++d>=m.ma&&(d=0,++c>=m.la&&(c=0,++b))}var p;if((a=m.read(n,r++))<0||(p=m.read(n,r++))<0){h=Dj.nd;break}id(this.G,hf(this.i,f),a|p<<8);r>=m.sa&&(n=null);f+=g;e--}return l?l(h,b,c,d,e,f):h};
function Bj(a){var b=0,c=a.g&V.sd?1:0,d=a.j[c];d=d&&d.ca;var e=a.K&Ej.$a,f=a.I&Fj.$a;a.v&=~(Gj.Hd|Gj.Td|Gj.Ub|Gj.Da);if(d)if(a.v|=Gj.Da,a.u(1,"%s.readSector(%d:%d:%d)\n",a.type,e,0,f),c=d.seek(e,0,f,!0)){e=0;for(f=a.C.length;e<f;){var g=d.read(c,e);if(g<0){b=Dj.nd;break}a.C[e++]=g}c.Cf&&(a.v|=Gj.Ub)}else b=Dj.od;else b=c?Dj.ed:Dj.dd;Cj(a,b)}
k.Ig=function(a,b){a=this.g;if(!b)switch(a&=V.Yb,this.A){case U.$c:case U.EMPTY:this.B<this.C.length&&(this.g|=V.ab);break;case U.nb:case U.$b:case U.Jc:this.B<2&&(this.g|=V.ab)}return a};
k.$h=function(a){this.g=this.g&~V.Sa|a&V.Sa;if(this.g&V.INIT)this.xb();else if(this.g&V.Vb&&this.A==U.Db)switch(this.A=this.g&V.ua,this.g&=~(V.Vb|V.ab|V.DONE|V.eb),be(this.i,this.Pa),this.u(1,"%s.processCommand(%s)\n",this.type,Hj[this.A>>1]),this.A){case U.$c:case U.EMPTY:case U.nb:case U.$b:case U.Jc:this.B=0;break;case U.Xe:a=this.j[this.g&V.sd?1:0];this.v&=~Gj.Da;a&&a.ca&&(this.v|=Gj.Da);this.F=this.v;Cj(this);break;case U.Ve:this.F=this.M,Cj(this)}else this.g&V.Bb?this.g&V.DONE&&Nd(this.i,this.Pa):
be(this.i,this.Pa)};k.Jg=function(a,b){if(!b)switch(this.A){case U.EMPTY:this.g&V.ab&&(this.g&=~V.ab,this.F=this.C[this.B]&255,this.u(1,"%s.readByte(%d): %#04x\n",this.type,this.B,this.F),++this.B>=this.C.length&&Cj(this))}return this.F};
k.ai=function(a){switch(this.A){case U.$c:this.g&V.ab&&(this.g&=~V.ab,this.C[this.B]=a&255,this.u(1,"%s.writeByte(%d,%#04x)\n",this.type,this.B,a),++this.B>=this.C.length&&Cj(this));break;case U.nb:case U.$b:case U.Jc:if(this.g&V.ab)switch(this.g&=~V.ab,this.B++){case 0:this.I=a;break;case 1:if(this.K=a,this.A==U.nb)Bj(this);else{var b=this.A==U.Jc,c=0,d=this.g&V.sd?1:0,e=this.j[d];e=e&&e.ca;var f=this.K&Ej.$a,g=this.I&Fj.$a;this.v&=~(Gj.Hd|Gj.Td|Gj.Ub|Gj.Da);if(e)if(this.v|=Gj.Da,this.u(1,"%s.writeSector(%d:%d:%d)\n",
this.type,f,0,g),d=e.seek(f,0,g,!0))for(b&&(d.Cf=!0),b=0,f=this.C.length;b<f;){if(!e.write(d,b,this.C[b]&255)){c=Dj.nd;break}b++}else c=Dj.od;else c=d?Dj.ed:Dj.dd;Cj(this,c)}}}this.F=a};var V=sc.hf,Ej=sc.lf,Fj=sc.kf,Gj=sc.jf,U=sc.ua,Dj=sc.ERROR,Hj="FILL EMPTY WRITE READ UNUSED RDSTAT WRDEL RDERR".split(" "),Ij={},Aj=(Ij[65144]=[null,null,me.prototype.Ig,me.prototype.$h,"RXCS"],Ij[65146]=[null,null,me.prototype.Jg,me.prototype.ai,"RXDB"],Ij);
function Jj(a,b,c){C.call(this,a,b,c);this.X=+b.base||16;this.S=["{","}"];this.ja=["[","]"];this.Ra=this.D=0;this.U=!1;this.C=-1;this.B=[];this.v={};this.Ea=[]}t(Jj,C);Jj.prototype.me=function(){return-1};Jj.prototype.xd=function(){};
function Kj(a,b,c,d){if(c)if(b){a.C<0&&a.B.length&&(a.C=0);if(a.C<0||b!=a.B[a.C])a.B.splice(0,0,b),a.C=0;a.C--}else a.U?b="end":b=a.B[a.C+1];a=[];if(b){b=b.replace(/""/g,"'");c=0;var e=null;d=d||";";for(var f=0;f<=b.length;f++){var g=b.charAt(f);if(g=='"'||g=="'")e?g==e&&(e=null):e=g;else if(g==d&&!e||!g)a.push(eb(b.substring(c,f))),c=f+1}}return a}
function Lj(a,b,c){var d=a;b=b||32;if(c)if(b==32)d=a>>>0;else if(b<32)d=a&(1<<b)-1;else{if(b=Math.pow(2,b),a<0||a>=b)d=a%b,d<0&&(d+=b)}else b<=32?d=a<<32-b>>32-b:(b=Math.pow(2,b-1),a>=b?(d=a%b,(a/b|0)&1&&(d-=b)):a<-b&&(d=a%b,((-a-1)/b|0)&1?d&&(d+=b):d||(d-=b)));a!=d&&(a=d);return a}
function Mj(a,b,c){for(c=c===void 0?-1:c;c--&&b.length;){var d=b.pop();if(a.length<2)return!1;var e=a.pop();var f=a.pop();switch(d){case "*":f*=e;break;case "/":if(!e)return!1;f=Math.trunc(f/e);break;case "^/":if(!e)return!1;f%=e;break;case "+":f+=e;break;case "-":f-=e;break;case "<<":f<<=e;break;case ">>":f>>=e;break;case ">>>":f>>>=e;break;case "<":f=f<e?1:0;break;case "<=":f=f<=e?1:0;break;case ">":f=f>e?1:0;break;case ">=":f=f>=e?1:0;break;case "==":f=f==e?1:0;break;case "!=":f=f!=e?1:0;break;
case "&":f&=e;break;case "!":case "|":f|=e;break;case "^!":f^=e;break;case "&&":f=f&&e?1:0;break;case "||":f=f||e?1:0;break;case ",,":f=Lj(f,18,!0)*262144+Lj(e,18,!0);break;case "^_":d=="^_"&&(e=35-(e&255));e&&(f=Lj(f,0,!0),f=e>0?f*Math.pow(2,e):Math.trunc(f/Math.pow(2,-e)));break;default:return!1}a.push(Lj(f))}return!0}
function Nj(a,b,c,d,e,f){var g,h=!1,l=0,m=[],n=[],r=a.X;for(a.X=e;c<d;){var p=b[c++].trim();var q=c<d?b[c++]:"";if(p)var v=Oj(a,p,void 0,f,l);else if(q=="{"){p=1;for(v=c;c<d;)if(c++,q=c<b.length?b[c++]:"",q=="{")p++;else if(q=="}"&&!--p)break;v=Nj(a,b,v,c-1,a.X,f);v!=null&&l&&(v=Pj(v,l));p=c<d?b[c++].trim():"";q=c<d?b[c++]:""}else{if(q==" ")continue;if(q=="^B"){a.X=2;continue}if(q=="^O"){a.X=8;continue}if(q=="^D"){a.X=10;continue}if(!(l&-1073741824)){if(q=="+")continue;if(q=="-"){l=l<<2|1;continue}if(q==
"~"||q=="^-"){l=l<<2|2;continue}if(q=="^L"){l=l<<2|3;continue}}h=!0;break}if(v===void 0)if(f)f.push(p),v=0;else{h=!0;f=[];break}m.push(Lj(v));if(q==" ")if(c<b.length-1&&!b[c])c++,q=b[c++];else{h=!0;break}if(!q)break;l=a.S[0]=="<"?Qj:Rj;if(!l[q]){h=!0;break}n.length&&l[q]<=l[n[n.length-1]]&&Mj(m,n,1);n.push(q);a.X=q=="^_"?10:e;l=0}if(h||!Mj(m,n)||m.length!=1)h=!0;h?f||a.u("parse error (%s)\n",p||q):g=m.pop();a.X=r;return g}
function Sj(a,b,c,d,e){for(var f;(f=b.indexOf(c))>=0;){for(var g=0,h=f+1,l=e;h<b.length;){var m=b[h++];if(m==c){l=-1;break}if(!l)break;l--;m=m.charCodeAt(0);d==7?m&=127:m=m-32&63;g=Lj(g*Math.pow(2,d)+m,d*e,!0)}if(l>=0){a.u("parse error (%s%s%s)\n",c,b,c);return}b=b.substr(0,f)+H(a,g,-1)+b.substr(h)}return b}
function Tj(a,b,c){var d=void 0,e=c===!1;c=Array.isArray(c)?c:void 0;if(b){a.S[0]!="{"&&(b=b.split(a.S[0]).join("{").split(a.S[1]).join("}"));b=Sj(a,b,'"',7,5);if(!b)return d;b=Sj(a,b,"'",6,6);if(!b)return d;a.X!=16&&(b=b.replace(/(^|[^A-Z0-9$%.])([0-9]+)B/,"$1$2^_").replace(/\s+/g," "));b=b.split(/({|}|\|\||&&|\||\^!|\^B|\^O|\^D|\^L|\^-|~|\^_|&|!=|!|==|>=|>>>|>>|>|<=|<<|<|-|\+|\^\/|\/|\*|,,| )/);d=Nj(a,b,0,b.length,a.X,c);d!==void 0&&e&&Uj(a,null,d)}return d}
function Pj(a,b){for(;b;){var c;switch(b&3){case 1:a=-Lj(a);break;case 2:a^=-1;break;case 3:for(c=35;c>=0&&!(a&Math.pow(2,c));)c--;a=35-c}b>>>=2}return a}
function Oj(a,b,c,d,e){e=e===void 0?0:e;var f=Array.isArray(d)?d:void 0;if(b!=void 0){var g=a.me(b);if(g>=0)g=a.xd(g);else if(g=b,a.v[g]?g=a.v[g].value:(g=g.substr(0,6),g=a.v[g]&&a.v[g].value),g!=void 0){var h=a.v[b]&&a.v[b].fh;h&&(f?f.push(h):(f=Tj(a,h,d),f!==void 0?g+=f:(d||a.u("undefined %s: %s (%s)\n",c||"value",b,h),g=void 0)))}else g=Pa(b,b.length>1||a.X>10?a.X:10);g!=void 0?g=Lj(Pj(g,e)):d||a.u("invalid %s: %s\n",c||"value",b)}else d||a.u("missing %s\n",c||"value");return g}
function Uj(a,b,c){var d=!1;if(c!==void 0){d=!0;var e=a.X==8?H(a,c,32,8,1)+"  "+c+".":H(a,c,32,16,1)+"  "+H(a,c,32,8,1)+"  "+H(a,c,32,2,8)+"  "+c+".";c>=32&&c<127&&(e+=" '"+String.fromCharCode(c)+"'")}a.u("%s%s\n",b!=null?b+": ":"",e);return d}function Vj(a,b){var c=0;if(a.v){if(b)return Uj(a,b,a.v[b]&&a.v[b].value);b=Object.keys(a.v);b.sort();for(var d=0;d<b.length;d++)Uj(a,b[d],a.v[b[d]].value),c++}return c>0}
function H(a,b,c,d,e){c=c===void 0?0:c;e=e===void 0?0:e;switch((d===void 0?0:d)||a.X){case 2:a=Ra(b,c>0?c:0,e);break;case 8:a=Sa(b,c>0?(c+2)/3|0:0,!!e);break;case 10:a=Ta(b,c>0?Math.ceil(c*.3):0);break;default:a=Ua(b,c>0?c+3>>2:0,!!e)}return c=c<0?a.replace(/^0+([0-9A-F]+)$/i,"$1"):a}function Wj(a,b){for(var c=0;c<a.Ea.length;c++)a.Ea[c](b,void 0)}
var Rj={"||":5,"&&":6,"!":7,"|":7,"^!":8,"&":9,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,"^_":19,"{":20,"}":20},Qj={",,":1,"||":5,"&&":6,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,"!":15,"|":15,"^!":15,"&":15,"^_":19,"{":20,"}":20};
function Xj(a){Jj.call(this,"Debugger",a,-1);this.Ga=!1;this.S=["(",")"];this.ja=[];this.M=W();this.Fa=W();this.T=W();this.F=[];this.g=this.P=this.K=[];Yj(this);this.V=this.fa=0;this.A=[];this.ra=void 0;Zj(this);this.H=this;this.oa={};this.ha=0;this.Y=null;this.R=[];ak(this,a.messages);this.wa=a.commands;this.Ma=bk;this.Z=[];this.O=0;this.Na=this.va=null;this.D=this.Ia=this.Ha=this.aa=this.qa=0;this.j=this.I=null;var b=this;u.pdp11===void 0&&(u.pdp11=function(c){return ck(b,c)})}t(Xj,Jj);
function dk(a){a=a&&a.L;a==null&&(a=-1);return a}function W(a,b,c){return{L:a===void 0?null:a,Ka:b===void 0?!1:b,Ta:!1,X:c}}k=Xj.prototype;k.Dd=function(a,b){a.L=b;a.Ta=!1;a.X=void 0};function ek(a){return[a.L,a.Ka,a.X,a.Ta,a.Nc]}function fk(a,b){var c=W(b[0],b[1],b[2]);c.Ta=b[3];b[4]&&(c.de=Kj(a,c.Nc=b[4]));return c}
k.za=function(a,b,c,d){this.G=b;this.N=a;this.i=c;this.j=a.B;(a=Ee(a,"messages"))&&ak(this,a);this.i.model<1140&&(this.Z=this.Z.concat(gk));this.i.model<1145&&(this.Z=this.Z.concat(hk));Rd(this,32,function(e){a:{var f=d.G.g,g=e[0],h=e=0,l=f.length;if(g){e=dk(ik(d,g));if(e===-1){d.u("invalid address: %s\n",g);break a}h=e>>>d.G.j;l=1}d.u("blockid   physical   blockaddr  used    size    type\n");d.u("--------  ---------  ---------  ------  ------  ----\n");g=-1;for(var m=0;l--;){var n=f[h];n.type==g?
m++||d.u("...\n"):(g=n.type,m=Cd[g],n&&d.u("%08x  %%08x  %%08x  %#06x  %#06x  %s\n",n.id,h<<d.G.j,n.L,n.Pb,n.size,m),g!=oe&&(g=-1),m=0);e+=d.G.v;h++}}});G(this)};
k.ta=function(a,b,c){var d=this;switch(b){case "debugInput":return this.I=this.J[b]=c,c.onkeydown=function(e){if(e.keyCode==13){var f=d.I.value;d.I.value="";ck(d,f,!0)}else if(e.keyCode==27)d.I.value=f="";else if(e.keyCode==38?(f=null,d.C<d.B.length-1&&(f=d.B[++d.C])):e.keyCode==40&&(d.C>0?f=d.B[--d.C]:(f="",d.C=-1)),f!=null){var g=f.length;d.I.value=f;d.I.setSelectionRange(g,g)}f!=null&&e.preventDefault&&e.preventDefault()},!0;case "debugEnter":return this.J[b]=c,zb(c,function(){if(d.I){var e=d.I.value;
d.I.value="";ck(d,e,!0);return!0}return!1}),!0;case "step":return this.J[b]=c,zb(c,function(e){var f=!1;lc(d,!0)||(mc(d,!0),f=cd(d,e?1:0,null),mc(d,!1));return f}),!0}return!1};function jk(a){if(a.I){var b=0,c=0;window&&(b=window.scrollX,c=window.scrollY);a.I.focus();window&&window.scrollTo(b,c)}}k.Nd=function(a,b){var c=255,d=dk(a);d!==-1&&(a.Ka||d>65535?(c=this.G,d=hf(this.i,d),c.I=!1,c.B++,d=Ed(c,d).B(d&c.A,d),c.B--):(c=this.i,c.oa++,d=c.G.Ld(jd(c,d,3)),c.oa--),c=d,b&&kk(a,b));return c};
k.Qa=function(a,b){var c=65535,d=dk(a);d!==-1&&(c=a.Ka||d>65535?kd(this.G,hf(this.i,d)):ld(this.i,d),b&&kk(a,b));return c};k.Od=function(a,b,c){var d=dk(a);if(d!==-1){if(a.Ka||d>65535)Fd(this.G,hf(this.i,d),b);else{var e=this.i;e.oa++;e.G.Md(jd(e,d,5),b);e.oa--}c&&kk(a,c);gd(this.N,-1)}};k.Oe=function(a,b,c){var d=dk(a);if(d!==-1){if(a.Ka||d>65535)id(this.G,hf(this.i,d),b);else{var e=this.i;e.oa++;e.G.Wb(jd(e,d,4),b);e.oa--}c&&kk(a,c);gd(this.N,-1)}};
function ik(a,b,c){c=(c?a.M:a.Fa).L;var d;if(b!==void 0){a:{var e;var f=a.S[0];c=a.S[1];var g=f=="("||f=="{"||f=="["?"\\":"",h=f=="["?"\\":"";for(g=new RegExp(g+f+"([^"+h+f+h+c+"]+)"+g+c);e=b.match(g);){h=Tj(a,e[1]);if(h===void 0){b=void 0;break a}e=f+e[1]+c;h=h!=null?H(a,h):"undefined";b=b.replace(e,h)}if(a.ja.length)for(f=a.ja[0],c=a.ja[1],g=f=="("||f=="{"||f=="["?"\\":"",h=f=="["?"\\":"",g=new RegExp(g+f+"([^"+h+f+h+c+"]+)"+g+c);e=b.match(g);)b=b.replace("["+e[1]+"]","unimplemented");for(;f=b.match(/\$([a-z]+)/i);){c=
null;switch(f[1].toLowerCase()){case "ops":c=a.Ra}if(c==null)break;b=b.replace(f[0],c.toString())}}if(b.charAt(0)=="%"){var l=!0;b=b.substr(1)}var m;a:{f=a.G;c=b.toUpperCase();for(n in f.Oa)if(g=+n,f.Oa[g][4]==c){var n=f.F+g;break a}n=null}if(n==null&&b.match(/^[a-z_][a-z0-9_]*$/i))for(f=b.toUpperCase(),c=0;c<a.F.length;c++)if(g=a.F[c].ga[f],g!=null){n=g.o;break}n!=null&&(m=W(n));if(f=m)return f;b.indexOf("0x")>=0?d=16:b.indexOf("0o")>=0?d=8:b.indexOf(".")>=0&&(d=10);c=Tj(a,b)}c!=null&&(f=W(c,l,d));
return f}function lk(a,b,c){c&&(c=c.match(/(['"])(.*?)\1/))&&(b.de=Kj(a,b.Nc=c[2]))}function kk(a,b){a.L!=null&&(a.L+=b||1)}function mk(a,b){return(b.Ka?"%":"")+H(a,b.L)}
function ak(a,b){a.H=a;a.ha=549755813888;a.Y=null;a.R=[];b=Kj(a,b.replace("keys","key").replace("kbd","keyboard"),!1,",");if(b.length)for(var c in y){a:{var d=void 0;if(Array.prototype.indexOf)d=b.indexOf(c,d);else{d=d||0;d<0&&(d+=b.length);d<0&&(d=0);for(var e=b.length;d<e;d++)if(d in b&&b[d]===c)break a;d=-1}}d>=0&&(a.ha|=y[c],a.u("%s messages enabled\n",c))}}function Rd(a,b,c){for(var d in y)if(b==y[d]){a.oa[d]=c;break}}
k.me=function(a){a=a.toUpperCase();var b=nk[a];b==null&&(b=-1,a.charAt(0)=="R"&&(b=+a.charAt(1),b<0||b>7))&&(b=-1);return b};function ok(a,b){if(b<pk||a.j)var c=qk[b];return c||""}
k.xd=function(a){if(a>=0)if(a<8)var b=this.i.j[a];else if(a<16)b=this.i.ra[a-8];else if(a<20)b=this.i.Z[a-16];else{var c=this.i,d=this.j;switch(a){case rk:b=ie(this.i);break;case sk:b=c.jb;break;case tk:b=c.S;break;case uk:b=c.wa&65280;break;case vk:b=ce(c);break;case wk:b=ee(c);break;case xk:b=fe(c);break;case yk:b=c.Y;break;case pk:d&&(b=d.ea);break;case zk:d&&(b=d.yb);break;case Ak:d&&(b=d.Va)}}return b};
k.message=function(a,b){var c;if(b&1&&this.i){var d=" @"+mk(this,W(this.i.R&65535));a=a.replace(/(\n?)$/,d)}if(!this.Y||a!=this.Y)if(this.Y=a,this.ha&0x800000000000)this.R.push(a);else{if(this.ha&70368744177664&&this.i&&(c=this.i.flags.W)||lc(this,!0))c&&(a=a.replace(/(\n?)$/," (cpu halted)$1")),Bk(this);this.print(a,b);this.i&&(a=this.i,Me(a),a.lb=0,a.N&&gd(a.N))}};
k.init=function(a){this.Ga=!0;this.u("Type ? for help with PDPjs Debugger commands\n");Ue(this);a||jk(this);this.wa&&(a=this.wa,this.wa=null,ck(this,a))};function Zj(a){var b;if(!Nf(a))a.A&&a.A.length&&a.u("instruction history buffer freed\n"),a.V=0,a.A=[];else if(!a.A||!a.A.length){a.A=Array(Ck);for(b=0;b<a.A.length;b++)a.A[b]=W();a.V=0;a.u("instruction history buffer allocated\n")}}function Dk(a,b,c){if(!Ek(a,c))return!1;ad(a.i,b);return!0}
function cd(a,b,c,d){if(!Ek(a))return!1;var e="";c===null&&(e=(c=!a.va||a.va=="tr")?"tr":"t");a.D=0;b||Nf(a)&&Of(a,a.i.j[7],0);try{b=Ne(a.i,b);var f=a.i.Ac(b);f>0&&(dd(a.i,f),a.D+=f,ed(a.i,f,!0),fd(a.i,f),a.aa++)}catch(g){typeof g!="number"&&(b=g,a.D=0,ic(a.i,b.stack||b.message))}d!==!1&&(a.j&&a.j.stop(),gd(a.N,-1));Ue(a,c||!1,e);return a.D>0}function Bk(a,b){a.i&&bd(a.i,b)}
function Ue(a,b,c){if(a.Ga){b===void 0&&(b=!0);c&&a.u("%s%s\n",Fk,c);c=a.i;if(c=c.v&128?c.yc|c.xc<<8:0){var d=c>>8;d=d<0?pc[-d]:H(a,d);a.u("trapped to %s (%s)\n",H(a,c&255,8),d)}a.M=W(a.i.j[7]);b&&a.O!=1?Gk(a):Hk(a)}}function Ek(a,b){var c;(c=!a.i||!kc(a.i))||(c=a.i,c.flags.ia?c=!0:(c.u("%s not powered\n",c.toString()),c=!1),c=!c);return c||a.i.flags.W?(b||a.u("cpu busy or unavailable, command ignored\n"),!1):!jc(a.i)}k.Ba=function(a,b){return!b&&(this.reset(!0),a)?this.restore(a):!0};
k.Aa=function(a,b){b&&this.u("%s\n",a?"suspending":"shutting down");return a?this.save():!0};k.reset=function(a){Zj(this);this.aa=0;this.Y=null;this.D=0;this.M=W(this.i.j[7]);this.flags.W=!1;Ik(this);a||Ue(this)};k.save=function(){var a=new Hc(this);a.set(0,ek(this.M));a.set(1,ek(this.T));a.set(2,[this.B,this.U,this.ha]);a.set(3,this.F);return a.data()};
k.restore=function(a){var b=0;a[2]!==void 0&&(this.M=fk(this,a[b++]),this.T=fk(this,a[b++]),this.B=a[b][0],typeof this.B=="string"&&(this.B=[this.B]),this.U=a[b][1],this.ha|=a[b][2]);a[3]&&(this.F=a[3]);return!0};k.start=function(a,b){this.O||this.u("running\n");this.flags.W=!0;this.Ha=a;this.Ia=b;Wj(this,0)};
k.stop=function(a,b){if(this.flags.W){this.flags.W=!1;this.D=b-this.Ia;Wj(this,1);if(!this.O){b="stopped";if(this.D){a-=this.Ha;var c=a>0?Math.round(this.D*1E3/a):0;b+=" (";Nf(this)&&(b+=this.aa+" instructions, ",this.aa=0);b+=this.D+" cycles, "+a+" ms, "+c+" hz)"}else oc(this,70368744177664)&&(b+=" (use the 't' command to execute blocked faults)");this.u("%s\n",b)}Ue(this,!0);jk(this);Ik(this,this.i.j[7]);Wj(this,2);this.Y=null}};function Nf(a){return a.g.length>1||!!a.fa}
function Of(a,b,c){var d=-1;c||(d=ld(a.i,b),d==0&&(a.i.R&65535)==b&&(b=Ze(a.i,2)));if(c>0&&(a.fa&&!--a.fa||Jk(a,b,1,a.g)))return!0;c>=0&&a.A.length&&(a.aa++,d<0&&(d=ld(a.i,b)),(d&65535)!=65535&&(a.Dd(a.A[a.V],b),++a.V==a.A.length&&(a.V=0)));return!1}function Tg(a){var b=a.i;if(b.flags.W)throw Yc(b,a.i.R&65535),Bk(a),-1;return!1}function ze(a,b,c){Jk(a,b,c||1,a.P)&&Bk(a,!1)}function Ae(a,b,c){Jk(a,b,c||1,a.K)&&Bk(a,!1)}
function Yj(a){var b;a.g=["bp"];if(a.P!==void 0)for(b=1;b<a.P.length;b++){var c=a.P[b];var d=dk(c);c.Ka?(c=a.G,ye(c.g[d>>>c.j],!1)):Cf(a.i,!1)}a.P=["br"];if(a.K!==void 0)for(b=1;b<a.K.length;b++)c=a.K[b],d=dk(c),c.Ka?(c=a.G,ye(c.g[d>>>c.j],!0)):Cf(a.i,!0);a.K=["bw"];a.qa=0;a.fa=0}
k.ub=function(a,b,c){var d=!0;c||Kk(this,a,b,!1,!0);if(a!=this.g){var e=dk(b);if(e===-1)this.u("invalid address: %s\n",mk(this,b)),d=!1;else{var f=a==this.K;e>65535&&(b.Ka=!0);if(b.Ka){var g=this.G;g.g[e>>>g.j].ub(e&g.A,f)}else e=this.i,(f?e.mc++:e.lc++)||Se(e)}}d&&(a.push(b),c?b.Ta=!0:(Lk(this,a,a.length-1,"set"),Zj(this)))};
function Kk(a,b,c,d,e){var f=!1;c=dk(c);for(var g=1;g<b.length;g++){var h=b[g];if(c==dk(h)&&(!d||h.Ta)){f=!0;h.Ta||e||Lk(a,b,g,"cleared");b.splice(g,1);b!=a.g&&(b=b==a.K,h.Ka?(d=a.G,ye(d.g[c>>>d.j],b)):Cf(a.i,b));h.Ta||Zj(a);break}}return f}function Mk(a,b){for(var c=1;c<b.length;c++)Lk(a,b,c);return b.length-1}function Lk(a,b,c,d){c=b[c];a.u("%s %s%s\n",b[0],mk(a,c),d?" "+d:c.Nc?' "'+c.Nc+'"':"")}
function Ik(a,b){if(b!==void 0)Jk(a,b,1,a.g,!0),a.O=0;else for(b=1;b<a.g.length;b++){var c=a.g[b];if(c.Ta){if(!Kk(a,a.g,c,!0))break;b=0}}}
function Jk(a,b,c,d,e){var f=!1;if(!a.qa++)for(var g=1;!f&&g<d.length;g++){var h=d[g];if(!e||h.Ta)for(var l=dk(h)&(d==a.g?65535:-1),m=0;m<c;m++)if(b+m==l){var n;f=!0;h.Ta&&(Kk(a,d,h,!0),e=!0);if(n=h.de){f=!1;for(var r=0;r<n.length;r++)if(!Nk(a,n[r],!0)){if(n[r].indexOf("if")){f=!0;break}for(var p=r+1;p<n.length&&n[p].indexOf("else");p++)r++;if(p==n.length){f=!0;break}}a.i.flags.W||(f=!0)}if(f){e||Lk(a,d,g,"hit");break}}}a.qa--;return f}
function Ok(a,b,c,d){var e=W(b.L),f=a.Qa(b,2),g,h;for(h in a.Ma)if(g=a.Ma[h][f&h])break;g||(g=Pk);var l=g[0];a.Z.indexOf(l)>=0&&(g=Pk,l=g[0]);var m=h="",n=Qk[l],r=g.length-1;l||r||(h=H(a,f));for(l=1;l<=r;l++){var p=g[l];if(p!==void 0){var q=a;var v=f;var D=p;p=b;var B="",x=D&Rk;if(x==X)p=p.L+((v&255)<<24>>23)&65535,B=H(q,p);else if(x==Sk)p=p.L-((v&63)<<1)&65535,B=H(q,p);else if(x==Tk)B=H(q,v&7,3);else if(x==Uk)B=H(q,v&63,6);else if(x==Vk)B=H(q,v&255,8);else if(v&=D,D&Wk&&(v>>=6,D>>=6),D&Z){D=null;
x=v&Xk;switch(v&Yk){case 0:B=ok(q,x);break;case 8:B="@"+ok(q,x);D=Zk(q,q.i.j[x]);break;case 16:x<7?B="("+ok(q,x)+")+":(v=q.Qa(p,2),B="#"+H(q,v,-1));break;case 24:x<7?B="@("+ok(q,x)+")+":(v=q.Qa(p,2),B="@#"+H(q,v,-1),D=Zk(q,v));break;case 32:B="-("+ok(q,x)+")";break;case 40:B="@-("+ok(q,x)+")";break;case 48:v=q.Qa(p,2);B=H(q,v,-1)+"("+ok(q,x)+")";x==7&&(B=H(q,v=v+p.L&65535),D=Zk(q,v));break;case 56:v=q.Qa(p,2),B="@"+H(q,v)+"("+ok(q,x)+")",x==7&&(B="@"+H(q,v=v+p.L&65535),D=Zk(q,ld(q.i,v)))}D&&(B=[B,
D])}q=B;if(!q||!q.length){h="INVALID";break}typeof q!="string"&&(m=q[1],q=q[0]);h.length>0&&(h+=",");h+=q||"???"}}f="";g=mk(a,e)+":";if(e.L!==-1&&b.L!==-1){do if(f+=" "+H(a,a.Qa(e,2)),e.L==null)break;while(e.L!=b.L)}g+=$a(f,-24);g+=$a(n,-5);h&&(g+=" "+h);if(c||m)g=$a(g,-60)+";"+(c||""),g=a.i.flags.Hb?g+("cycles="+He(a.i).toString()+" cs="+Ua(a.i.hc)):g+(d!=null?"="+d.toString():""),m&&(g.slice(-1)!=";"&&(g+=" "),g+=m);return g}
function Zk(a,b){b=jf(a.i,b)[0];b>=a.i.ob&&b<a.G.F&&(b=b-a.i.ob+a.G.F);var c=a.G;a=null;b>=c.F&&(b=c.Oa[b&Jd])&&(a=b[4]);return a}function $k(a,b){switch(b){case "N":a=Ye(a.i);break;case "Z":a=Xe(a.i);break;case "V":a=We(a.i);break;case "C":a=Ve(a.i);break;default:a=0}return b.charAt(0)+(a?"1":"0")+" "}function al(a,b){var c=ok(a,b);c&&(c+="="+H(a,a.xd(b))+" ");return c}k.he=function(a,b){return a[0]>b[0]?1:a[0]<b[0]?-1:0};
function Th(a,b,c,d,e){var f=[],g;for(g in e){var h=e[g];typeof h=="number"&&(e[g]=h={o:h});var l=h.o,m=h.a;if(l!==void 0){var n=f;l=[l>>>0,g];var r=hb(n,l,a.he);r<0&&n.splice(-(r+1),0,l)}m&&(h.a=m.replace(/''/g,'"'))}a.F.push({Ik:b,L:c,Jf:d,ga:e,ee:f})}function bl(a,b,c){var d=[],e=dk(b)>>>0;for(b=0;b<a.F.length;b++){var f=a.F[b],g=f.L>>>0,h=f.Jf;if(e>=g&&e<g+h){e=hb(f.ee,[e-g],a.he);e>=0?cl(a,b,e,d):c&&(e=~e,cl(a,b,e-1,d),cl(a,b,e,d));break}}return d}
function cl(a,b,c,d){var e={},f=a.F[b].ee,g=0,h=null;c>=0&&c<f.length&&(g=f[c][0],h=f[c][1]);h&&(e=a.F[b].ga[h],h=h.charAt(0)=="."?null:e.l||h);d.push(h);d.push(g);d.push(e.a);d.push(e.c)}function dl(a,b){var c=b.match(/^\s*([A-Z_]?[A-Z0-9_]*)\s*(=?)\s*(.*)$/i);if(c){if(!c[1])return Vj(a)||a.u("no variables\n"),!0;if(!c[2])return Vj(a,c[1]);if(!c[3])return delete a.v[c[1]],!0;b=Tj(a,c[3]);return b!==void 0?(a.v[c[1]]={value:b,fh:void 0},!0):!1}a.u("invalid assignment: %s\n",b);return!1}
function el(a,b,c){var d=null;if(b=ik(a,b,!0)){var e=bl(a,b,!0);if(e.length){var f;if(e[0]){var g="";(f=b.L-e[1])&&(g=" + "+Ua(f,4,!0));f=e[0]+" ("+H(a,e[1])+")"+g;c&&a.u("%s\n",f);d=f}e.length>4&&e[4]&&(g="",(f=e[5]-b.L)&&(g=" - "+Ua(f,4,!0)),f=e[4]+" ("+H(a,e[5])+")"+g,c&&a.u("%s\n",f),d||(d=f))}else c&&a.u("no symbols\n")}return d}
function Gk(a,b){var c;if(b&&b[1]=="?")a.u("register commands:\n"),a.u("\tr\tdump registers\n"),a.u("\trm\tdump misc registers\n"),a.u("\trx [#]\tset flag or register x to [#]\n");else{var d=!1,e=a.i;c==null&&(c=!0);if(b!=null&&b.length>1){var f=b[1];if(f=="m")d=!0;else{var g=f.indexOf("=");if(g>0)b=f.substr(g+1),f=f.substr(0,g);else if(b.length>2)b=b[2];else{a.u("missing value for %s\n",b[1]);return}g=Tj(a,b);if(g===void 0)return;b=f.toUpperCase();switch(b){case "SP":case "R6":e.j[6]=g&65535;break;
case "PC":case "R7":Yc(e,g);a.M=W(e.j[7]);break;case "N":e.K=g?32768:0;break;case "Z":e.M=g?0:1;break;case "V":e.I=g?32768:0;break;case "C":e.F=g?65536:0;break;case "PS":je(e,g);break;case "PI":he(e,g);break;case "ER":e.S=g;d=!0;break;case "SL":e.wa=g|255;break;case "M0":de(e,g);d=!0;break;case "M3":ge(e,g);d=!0;break;case "AR":a.j&&(d=a.j,Ic(d,d.ea=g));d=!0;break;case "DR":a.j&&xc(a.j,g);d=!0;break;case "SR":a.j&&Jc(a.j,g);d=!0;break;default:if(b.charAt(0)=="R"&&(b=+b.charAt(1),b>=0&&b<6)){e.j[b]=
g&65535;break}a.u("unknown register: %s\n",f);return}gd(a.N);a.u("updated registers:\n")}}f=a.u;b="";for(g=0;g<6;g++)b+=al(a,g);b=b+"\n"+(al(a,6)+al(a,7));b+=al(a,rk)+al(a,sk)+al(a,uk);b+=$k(a,"T")+$k(a,"N")+$k(a,"Z")+$k(a,"V")+$k(a,"C");d&&(d=b,g=al(a,vk)+al(a,wk),g+=al(a,xk)+al(a,yk)+al(a,tk),g=g+"\n"+(al(a,Ak)+al(a,pk)+al(a,zk)),b=d+("\n"+g));f.call(a,"%s\n",b);c&&(a.M=W(e.j[7]),Hk(a,mk(a,a.M)))}}
function fl(a,b){b=eb(b);var c=b.match(/^(['"])(.*?)\1$/);c?c[2].length>1?a.u("%s\n",c[2]):Uj(a,null,c[2].charCodeAt(0)):Tj(a,b,!1)}
function gl(a,b,c){if(c=="?")a.u("trace commands:\n"),a.u("\tt  [#]\ttrace # instructions\n"),a.u("\ttr [#]\ttrace # instructions with register updates\n"),a.u("\ttc [#]\ttrace # cycles\n"),a.u("note: bn [#] breaks after # instructions without updates\n");else{var d=b!="t";c=Oj(a,c,void 0,!0)||1;var e=0;b=="tc"&&(e=c,c=1);a.va=b;yb(c,function(){return mc(a,!0)&&cd(a,e,d,!1)},function(){a.j&&a.j.stop();gd(a.N,-1);mc(a,!1)})}}
function Hk(a,b,c,d){if(b=ik(a,b,!0)){d===void 0&&(d=1);var e=256;if(c!==void 0)if(c.charAt(0)=="l")c=Oj(a,c.substr(1)),c!=null&&(d=c);else{d=ik(a,c,!0);if(!d||d.L<b.L)return;e=d.L-b.L;if(e>256){a.u("range too large\n");return}d=-1}c=0;for(var f;e>0&&d--;){f=lc(a,!1)||a.O?a.D:null;var g=f!=null?"cycles":null,h=bl(a,b),l=b.L;if(h[0]&&d&&(!c&&d||h[0].indexOf("+")<0)){var m=h[0]+":";h[2]&&(m+=" "+h[2]);a.u("%s\n",m)}h[3]&&(g=h[3],f=null);f=Ok(a,b,g,f);a.u("%s\n",f);a.M=b;e-=b.L-l;c++}}}
function Nk(a,b,c){var d=!0;try{b.length&&b!="end"?c||a.u("%s%s\n",Fk,b):(a.U&&(a.u("ended assemble at %s\n",mk(a,a.T)),a.M=a.T,a.U=!1),b="");var e=b.charAt(0);if(e=='"'||e=="'")return!0;a.Y=null;if(kc(a)&&b.length>0){a.U&&(b="a "+mk(a,a.T)+" "+b);var f=!1,g=b.replace(/ +/g," ").split(" ");g[0]=g[0].toLowerCase();if(g&&g.length)for(var h=g[0],l=h.charAt(0),m=1;m<h.length;m++){var n=h.charAt(m);if(l=="?"||l=="r"||n<"a"||n>"z"){g[0]=h.substr(m);g.unshift(h.substr(0,m));break}}switch(g[0].charAt(0)){case "a":var r=
ik(a,g[1],!0);if(r)if(a.T=r,g[2]===void 0)a.u("begin assemble at %s\n",mk(a,r)),a.U=!0,gd(a.N);else{a.u("not supported yet\n");var p=[];if(p.length){for(var q=0;q<p.length;q++)a.Od(r,p[q],1);a.u("%s\n",Ok(a,a.T))}}break;case "b":a:{var v=g[0],D=g[1],B=b;if(D=="?")a.u("breakpoint commands:\n"),a.u("\tbp #\tset exec breakpoint\n"),a.u("\tbr #\tset read breakpoint\n"),a.u("\tbw #\tset write breakpoint\n"),a.u("\tbc #\tclear breakpoint (* to clear all)\n"),a.u("\tbl\tlist all breakpoints\n"),a.u("\tbn [#]\tbreak after # instruction(s)\n");
else{var x=v.charAt(1);if(x=="l"){var E=Mk(a,a.g);E+=Mk(a,a.P);(E+=Mk(a,a.K))||a.u("no breakpoints\n")}else if(x=="n"){var na=+D||0;D&&(a.fa=na);a.u("break after %d instruction(s)\n",na)}else if(D===void 0)a.u("missing breakpoint address\n");else{var J=W();if(D!="*"&&(J=ik(a,D,!0),!J))break a;x=="c"?J.L==null?(Yj(a),a.u("all breakpoints cleared\n")):Kk(a,a.g,J)||Kk(a,a.P,J)||Kk(a,a.K,J)||a.u("breakpoint missing: %s\n",mk(a,J)):J.L!=null&&(lk(a,J,B),x=="p"?a.ub(a.g,J):x=="r"?a.ub(a.P,J):x=="w"?a.ub(a.K,
J):a.u("unknown breakpoint command: %s\n",x))}}}break;case "c":var Na=a.N;Na.C&&(Na.C.value="");break;case "d":a:{var Y,ta=g[0],ua=g[1],rb=g[2],Fl=g[3];if(ua=="?"){var ac="";for(Y in y)a.oa[Y]&&(ac&&(ac+=","),ac+=Y);ac+=",state,symbols";a.u("dump memory commands:\n");a.u("\tda [a]        dump info for address a\n");a.u("\tdb [a] [n]    dump n bytes at address a\n");a.u("\tdw [a] [n]    dump n words at address a\n");a.u("\tdd [a] [n]    dump n dwords at address a\n");a.u("\tds [a] [n]    dump n words at address a as JSON\n");
a.u("\tdh [p] [n]    dump n instructions from history position p\n");ac.length&&a.u("dump extension commands:\n\t%s\n",ac)}else if(ua=="state"){var lf=hl(a.N,!0);if(rb=="console")console.log(lf);else{var Ci=a.N;Ci.C&&(Ci.C.value="");lf&&a.u("%s\n",lf)}}else if(ua=="symbols")for(var mf=0;mf<a.F.length;mf++){var nf=a.F[mf],bc;for(bc in nf.ga)if(bc.charAt(0)!="."){var Di=nf.ga[bc].o;if(Di!==void 0){var Ei=nf.ga[bc].l;Ei&&(bc=Ei);a.u("%s %s\n",H(a,Di),bc)}}}else{if(ta=="d"){for(Y in y)if(g[1]==Y){var Fi=
a.oa[Y];Fi?(g.shift(),g.shift(),Fi(g)):a.u("no dump registered for %s\n",ua);break a}ua||(ta=a.Na||"dw")}else a.Na=ta;if(ta=="dh"){var Gi=ua,Hi=rb,Ii="",Ji=0,Oa=a.V,ab=a.A;if(ab.length){var Ha=+Gi||a.ra,Oc=+Hi||10;isNaN(Ha)?Ha=Oc:Ii="more ";Ha>ab.length&&(a.u("note: only %d available\n",ab.length),Ha=ab.length);Oa-=Ha;Oa<0&&(ab[ab.length-1].L==null?(Ha=Oa+Ha,Oa=0):Oa+=ab.length);var of=[];Hi=="call"&&(Oc=1E5,of=["CALL"]);for(Gi!==void 0&&a.u("%d instructions earlier:\n",Ha);Oc>0&&Oa!=a.V;){var Ki=
ab[Oa++];if(Ki.L==null)break;var Pc=W(Ki.L),Gl=Ha--,Li=Ok(a,Pc,"history",Gl);(!of.length||Li.indexOf(of[0])>=0)&&a.u("%s\n",Li);Pc.vd&&(Oa+=Pc.vd,Oc-=Pc.vd,Ha-=Pc.vd);Oa>=ab.length&&(Oa=0);a.ra=Ha;Ji++;Oc--}}Ji||(a.u("no %shistory available\n",Ii),a.ra=void 0)}else{var va=ik(a,ua);if(va)if(ta=="da"){var pf=va.Ka||va.L>65535,O=jf(a.i,va.L||0,pf);a.u("%s%s  %08o\n",$a("",pf?-12:-19),Ra(va.L,pf?22:17,3),va.L);O.length<6?(O.length>2&&(a.u("    OFFSET:             %s  %08o\n",Ra(O[3],13,3),O[3]),a.u("UNIMAP[%s]: %s  %08o\n",
Ta(O[1],2),Ra(O[2],22,3),O[2])),a.u("  PHYSICAL: %s  %08o\n",Ra(O[0],22,3),O[0])):(a.u("    OFFSET:             %s  %08o\n",Ra(O[1],13,3),O[1]),a.u("+   %sPAR%s: %s  %08o\n",il[O[2]],O[3],Ra(O[4],22,3),O[4]),a.u("&  MMUMASK: %s  %08o\n",Ra(O[5],22,3),O[5]),a.u("= PHYSICAL: %s  %08o\n",Ra(O[0],22,3),O[0]))}else{var Ab=0,qf=ta=="ds";if(rb){if(rb.charAt(0)=="l")rb=rb.substr(1)||Fl,Ab=Oj(a,rb);else{var Mi=ik(a,rb);Mi&&(Ab=Mi.L-va.L)}Ab<0&&(Ab=0);Ab>65536&&(Ab=65536)}var Il=a.X;va.X&&(a.X=va.X);for(var Bb=
ta=="dd"?4:ta=="db"?1:2,Td=Bb*Ab||128,rf=qf?16:a.X,Jl=(Td+rf-1)/rf|0||1,Cb="";Jl--&&Td>0;){var Db="",Ni="";ua=mk(a,va);for(var Ud=rf,Vd=0,Wd=0;Ud>0&&Td>0;){var cc=1,sf=Bb==1?a.Nd(va,cc):a.Qa(va,cc=2);Vd|=sf<<(Wd<<3);Wd+=cc;Wd==Bb&&(qf?(Db&&(Db+=","),Db+="0x"+Ua(Vd,Bb<<1)):(Db+=H(a,Vd,Bb<<3),Db+=Bb==1?Ud==9?"-":" ":"  "),Vd=Wd=0);Ud-=cc;for(Td-=cc;Bb==1&&cc--;){var tf=sf&255;Ni+=tf>=32&&tf<127?String.fromCharCode(tf):".";sf>>=8}}Cb&&(Cb+="\n");Cb=qf?Cb+(Db+","):Cb+(ua+":  "+Db+(Ud==0?" "+Ni:""))}Cb&&
a.u("%s\n",Cb);a.Fa=va;a.X=Il}}}}break;case "e":if(g[0]=="else")break;var uf=g[0],vf=g[1];if(uf=="eb"){var Qc=1;var Oi=255;var Pi=a.Nd;var Qi=a.Od}else uf=="e"||uf=="ew"?(Qc=2,Oi=65535,Pi=a.Qa,Qi=a.Oe):vf=null;if(vf==null)a.u("edit memory commands:\n"),a.u("\teb [a] [...]  edit bytes at address a\n"),a.u("\tew [a] [...]  edit words at address a\n");else{var Xd=ik(a,vf);if(Xd)for(var Yd=2;Yd<g.length;Yd++){var Rc=Tj(a,g[Yd]);if(Rc===void 0){a.u("unrecognized value: %s\n",g[Yd]);break}Rc&~Oi&&a.u("warning: %x exceeds %s-byte value\n",
Rc,Qc);a.u("changing %s%s to %s\n",mk(a,Xd),oc(a,32)?"":" from "+H(a,Pi.call(a,Xd),Qc<<3),H(a,Rc,Qc<<3));Qi.call(a,Xd,Rc,Qc)}}break;case "g":a:{var Ri=g[1],Kl=b;if(Ri!==void 0){var wf=ik(a,Ri,!0);if(!wf)break a;lk(a,wf,Kl);a.ub(a.g,wf,!0)}Dk(a,!0,c)}break;case "h":a.flags.W?(c||a.u("halting\n"),Bk(a)):lc(a,!0)||c||a.u("already halted\n");break;case "i":if(g[0]=="if"){var Sc=b.substr(2);Sc=eb(Sc);if(Tj(a,Sc)){c||a.u("true: %s\n",Sc);var Si=!0}else c||a.u("false: %s\n",Sc),Si=!1;Si||(d=!1);break}f=
!0;break;case "k":var Ll=g[0];if(g[1]=="?")a.u("stack trace commands:\n"),a.u("\tk\tshow frame addresses\n"),a.u("\tks\tshow symbol information\n");else{var xf=0,yf=W(),Tc=W(a.i.j[6]);for(a.u("stack trace for %s\n",mk(a,Tc));xf<10;){for(var Eb=null,Ml=256;Tc.L>>>0<65536;){yf.L=a.Qa(Tc,2);if(Tc.L==null||!Ml--)break;if(!(yf.L&1)){for(var Nl=a,Zd=yf,Ti=null,Uc=Zd.L,Ui=Uc,zf=1;zf<=6&&Uc;zf++){if(zf>2){Zd.L=Uc;var $d=Ok(Nl,Zd);if($d.indexOf("JSR")>=0){var Vi=$d.indexOf(" ");if(Uc+($d.indexOf(" ",Vi+1)-
Vi-1)/2==Ui){Ti=$d;break}}}Uc-=2}Zd.L=Ui;if(Eb=Ti)break}}if(!Eb||Eb==null)break;var Wi=null;if(Ll=="ks"){var Xi=Eb.match(/[0-9A-F]+$/);Xi&&(Wi=el(a,Xi[0]))}Eb=$a(Eb,-50)+"  ;"+(Wi||"stack="+mk(a,Tc));a.u("%s\n",Eb);xf++}xf||a.u("no return addresses found\n")}break;case "l":if(g[0]=="ln"){el(a,g[1],!0);break}f=!0;break;case "m":a:{var bb,cb=null,T=g[1];T=="?"&&(T=void 0);if(T!==void 0){var sb=0;if(T=="all")sb=-4097,T=null;else if(T=="on")cb=!0,T=null;else if(T=="off")cb=!1,T=null;else{T=="keys"&&(T=
"key");T=="kbd"&&(T="keyboard");for(bb in y)if(T==bb){sb=y[bb];cb=!!(a.ha&sb);break}if(!sb){a.u("unknown message category: %s\n",T);break a}}if(sb)if(g[2]=="on")a.ha|=sb,cb=!0;else if(g[2]=="off"&&(a.ha&=~sb,cb=!1,sb==0x800000000000)){for(var Yi=a.R.length>=1E3?a.R.length-1E3:0;Yi<a.R.length;)a.u("%s\n",a.R[Yi++]);a.R=[]}}var Ol=0,Vc="";for(bb in y)if(!T||T==bb){var Pl=!!(a.ha&y[bb]);if(cb===null||cb==Pl)Vc&&(Vc+=","),++Ol%10||(Vc+="\n\t"),bb=="key"&&(bb="keys"),Vc+=bb}T===void 0&&a.u("message commands:\n\tm [category] [on|off]\tturn categories on/off\n");
a.u("%s%s\n",cb!==null?cb?"messages on:  ":"messages off: ":"message categories:\n\t",Vc||"none");Zj(a)}break;case "p":if(g[0]=="print"){fl(a,b.substr(5));break}var Ql=g[0];if(g[1]=="?")a.u("step commands:\n"),a.u("\tp\tstep over instruction\n"),a.u("\tpr\tstep over instruction with register update\n");else{var Zi=Ql=="pr"?1:0,$i=1+Zi;if(a.O)a.u("step in progress\n");else{var ae=W(a.i.j[7]),dc=a.Qa(ae);dc==3||dc==4||(dc&65280)==34816||(dc&65024)==32256||(dc&65280)==35072?(a.O=$i,kk(ae,2)):(dc&65024)==
2048&&(Ok(a,ae),a.O=$i);a.O?(a.ub(a.g,ae,!0),Dk(a)||(a.N&&Le(a.N),a.O=0)):gl(a,Zi?"tr":"t")}}break;case "r":if(b=="reset"){a.N&&a.N.reset();break}Gk(a,g);break;case "s":a:switch(g[1]){case "base":if(g[2]){var Wc=+g[2];if(Wc==8||Wc==10||Wc==16)a.X=Wc;else{a.u("invalid base: %d\n",Wc);break}}a.u("default base: %d\n",a.X);break;case "cs":var Xc;g[3]!==void 0&&(Xc=+g[3]);switch(g[2]){case "int":a.i.Fb=Xc;break;case "start":a.i.jc=Xc;break;case "stop":a.i.Ib=Xc;break;default:a.u("unknown cs option\n");
break a}Xc!==void 0&&Ge(a.i);a.u("checksums %s\n",a.i.flags.Hb?"enabled":"disabled");break;case "sp":g[2]!==void 0&&(Ie(a.i,+g[2])||a.u("warning: using 1x multiplier, previous target not reached\n"));a.u("target speed: %s (%dx)\n",a.i.qb.toFixed(2)+"Mhz",a.i.hb);break;default:if(g[1]){a.u("unknown option: %s\n",g[1]);break}case "?":a.u("debugger options:\n"),a.u("\tbase #\t\tset default base to #\n"),a.u("\tcs int #\tset checksum cycle interval to #\n"),a.u("\tcs start #\tset checksum cycle start count to #\n"),
a.u("\tcs stop #\tset checksum cycle stop count to #\n"),a.u("\tsp #\t\tset speed multiplier to #\n")}break;case "t":gl(a,g[0],g[1]);break;case "u":Hk(a,g[1],g[2],8);break;case "v":if(g[0]=="var"){dl(a,b.substr(3))||(d=!1);break}if(g[0]=="ver"){a.u("%s version %s (%s%s%s)\n","PDPjs","2.21",a.i.model,uc.Ei?",RELEASE":uc.gj?",DEBUG":",NODEBUG",uc.gk?",TYPEDARRAYS":uc.Bi?",BYTEARRAYS":",LONGARRAYS");a.u("%s\n",u.navigator?u.navigator.userAgent:"");break}f=!0;break;case "?":if(g[1]){fl(a,b.substr(1));
break}var Af="commands:",Bf;for(Bf in jl)Af+="\n"+$a(Bf,-9)+jl[Bf];Nf(a)||(Af+="\nnote: history disabled if no exec breakpoints");a.u("%s\n",Af);break;default:f=!0}f&&(a.u("unknown command: %s\n",b),d=!1)}}catch(bj){a.u("debugger error: %s\n",bj.stack||bj.message),d=!1}return d}function ck(a,b,c){var d=d===void 0?!1:d;b=Kj(a,b,c===void 0?!1:c);for(var e in b)if(!Nk(a,b[+e],d))return!1;return!0}
var jl={"?":"help/print","a [#]":"assemble","b [#]":"breakpoint",c:"clear output","d [#]":"dump memory","e [#]":"edit memory","g [#]":"go [to #]",h:"halt","if":"eval expression","int [#]":"request interrupt",k:"stack trace",ln:"list nearest symbol(s)",m:"messages",p:"step over",print:"print expression",r:"dump/set registers",reset:"reset machine",s:"set options","t [#]":"trace","u [#]":"unassemble","var":"assign variable",ver:"print version"},Qk=".WORD ADC ADCB ADD ASL ASLB ASR ASRB BCC BCS BEQ BGE BGT BHI BIC BICB BIS BISB BIT BITB BLE BLOS BLT BMI BNE BPL BPT BR BVC BVS CCC CLC CLCN CLCV CLCVN CLCVZ CLCZ CLCZN CLN CLR CLRB CLV CLVN CLVZ CLVZN CLZ CLZN CMP CMPB COM COMB DEC DECB INC INCB HALT JMP JSR MARK MFPD MFPI MFPS MOV MOVB MTPD MTPI MTPS NEG NEGB NOP RESET ROL ROLB ROR RORB RTI RTS SBC SBCB SCC SEC SECN SECV SECVN SECVZ SECZ SECZN SEN SEV SEVN SEVZ SEVZN SEZ SEZN SUB SWAB SXT TST TSTB WAIT MUL DIV ASH ASHC XOR SOB EMT TRAP SPL IOT RTT MFPT".split(" "),
rk=20,sk=21,tk=22,uk=23,vk=24,wk=25,xk=26,yk=27,pk=28,zk=29,Ak=30,nk={SP:6,PC:7,PS:rk,PI:sk,ER:tk,SL:uk,M0:vk,M1:wk,M2:xk,M3:yk,AR:pk,DR:zk,SR:Ak},qk="R0 R1 R2 R3 R4 R5 SP PC A0 A1 A2 A3 A4 A5 A6 A7 S0 S1 S2 S3 PS PI ER SL M0 M1 M2 M3 AR DR SR".split(" "),il="KI KD SI SD ?? ?? UI UD".split(" "),Xk=7,Yk=56,Z=Yk|Xk,Wk=4032,X=4096,Sk=8192,Tk=12288,Uk=24576,Vk=32768,Rk=61440,bk={61440:{4096:[62,Wk,Z],8192:[47,Wk,Z],12288:[18,Wk,Z],16384:[14,Wk,Z],20480:[16,Wk,Z],24576:[3,Wk,Z],36864:[63,Wk,Z],40960:[48,
Wk,Z],45056:[19,Wk,Z],49152:[15,Wk,Z],53248:[17,Wk,Z],57344:[94,Wk,Z]},65024:{2048:[57,448,Z],28672:[100,Z,448],29184:[101,Z,448],29696:[102,Z,448],30208:[103,Z,448],30720:[104,448,Z],32256:[105,448,Sk]},65280:{256:[27,X],512:[24,X],768:[10,X],1024:[11,X],1280:[22,X],1536:[12,X],1792:[20,X],32768:[25,X],33024:[23,X],33280:[13,X],33536:[21,X],33792:[28,X],34048:[29,X],34304:[8,X],34560:[9,X],34816:[106,Vk],35072:[107,Vk]},65472:{64:[56,Z],192:[95,Z],2560:[39,Z],2624:[49,Z],2688:[53,Z],2752:[51,Z],
2816:[67,Z],2880:[1,Z],2944:[77,Z],3008:[97,Z],3072:[73,Z],3136:[71,Z],3200:[6,Z],3264:[4,Z],3328:[58,Uk],3392:[60,Z],3456:[65,Z],3520:[96,Z],35328:[40,Z],35392:[50,Z],35456:[54,Z],35520:[52,Z],35584:[68,Z],35648:[2,Z],35712:[78,Z],35776:[98,Z],35840:[74,Z],35904:[72,Z],35968:[7,Z],36032:[5,Z],36096:[66,Z],36160:[59,Z],36224:[64,Z],36288:[61,Z]},65528:{128:[76,Xk],152:[108,Tk]},65535:{0:[55],1:[99],2:[75],3:[26],4:[109],5:[70],6:[110],7:[111],160:[69],161:[31],162:[41],163:[33],164:[45],165:[36],
166:[43],167:[35],168:[38],169:[32],170:[42],171:[34],172:[46],173:[37],174:[44],175:[30],176:[69],177:[80],178:[88],179:[82],180:[92],181:[85],182:[90],183:[84],184:[87],185:[81],186:[89],187:[83],188:[93],189:[86],190:[91],191:[79]}},Pk=[0],gk=[58,60,65,96,110,100,101,102,103,104,105],hk=[108,59,64],Ck=1E3,Fk=">> ";Fb(function(){for(var a=F("pdp11","debugger"),b=0;b<a.length;b++){var c=a[b],d=Wb(c);d=new Xj(d);Vb(d,c)}});
function kl(a,b,c){C.call(this,"Computer",a,67108864);this.flags.ia=!1;this.S=null;ll(this,b);this.O=Ee(this,"autoPower",a,6);this.v=0;this.V=+a.busWidth||+a.buswidth;this.K=this.D=this.M=null;this.I=this.U=!1;this.F=this.A=null;this.T=this.P=this.R=!1;this.url=Ee(this,"url")||"";(Math.random()+.1).toString(36);this.j=ml(this);if(this.i=Zb("CPU",this.id)){this.H=Zb("Debugger",this.id);this.G=new pd({id:this.fb+".bus",busWidth:this.V},this.i,this.H);var d=Xb(this.id);if(this.C=(this.B=Zb("Panel",this.id))&&
this.B.J.print)for(b=0;b<d.length;b++){var e=d[b];e.print=this.B.print}this.u(0,"%s v%s\n%s\n%s\n","PDPjs","2.21","Copyright \u00a9 2012-2025 Jeff Parsons <Jeff@pcjs.org>","License: MIT <https://www.pcjs.org/LICENSE.txt>");this.u(0,"Portions adapted from the PDP-11/70 Emulator by Paul Nankervis <http://skn.noip.me/pdp11/pdp11.html>\n");for(b=0;b<d.length;b++)e=d[b],e.za&&e.za(this,this.G,this.i,this.H);b=null;e=Ee(this,"resume",a);e!==void 0&&(e.length>1?b=this.D=e:this.g=parseInt(e,10));e=!1;d=Ee(this,
"state");d||(e=!0,d=a.state);d&&(this.M=b=d,e||(this.I=!0,this.g=nl),this.g&&(this.F=new Hc(this,"2.21"),this.F.load()?b=null:delete this.F));!b&&this.g&&(b=ol(this))&&(this.I=!0);if(b){var f=this;ib(b,null,!0,function(g,h,l){l?(f.D=null,f.I=!1,f.u(274877906944,"Unable to load machine state from server (error %d%s)\n",l,h?": "+eb(h):"")):(f.K=h,f.U=!0);G(f)})}else G(this);this.J.power||(this.O=!0);!c&&this.O&&this.wait(this.nc)}else A("Unable to find CPU component")}t(kl,C);
function ll(a,b){if(!b){var c,d=u.resources;if(typeof d=="object"&&(c=d.parms))try{b=eval("("+c+")")}catch(e){A(e.message+" ("+c+")")}}a.S=b}function Ee(a,b,c,d){var e=b.toLowerCase();e=wb(b)||wb(e);var f=u.resources;e===void 0&&a.S&&(e=a.S[b]);e===void 0&&c&&(e=c[b]);e===void 0&&typeof f=="object"&&f[b]&&(e=b);e===void 0&&(e=void 0);if(typeof e=="string"&&d)switch(d){case 4:e=+e;isNaN(e)&&(e=0);break;case 6:e=e=="true"}return e}k=kl.prototype;
k.wait=function(a,b){for(var c=this,d=Xb(this.id),e=0;e<=d.length;e++){var f=e<d.length?d[e]:this;if(!kc(f)){kc(f,function(){c.wait(a,b)});return}}a.call(this,b)};function pl(a,b){var c=new Hc(a,"2.21",ql);if(c.load()&&rl(c)){var d=c.get(sl),e=b?b.get(sl):"unknown";d!=e&&(a.u(274877906944,"Machine state may be out-of-date\n(%s vs. %s)\nCheck your browser's local storage limits\n",d,e),b||c.clear())}}
k.nc=function(a){a===void 0&&(a=this.g||(this.K?tl:nl));if(!this.v){this.v++;var b=!1,c=!1;this.R=!1;var d=this.F||new Hc(this,"2.21");if(a==ul)b=!0;else if(a>nl){if(d.load(this.K)){this.A=new Hc(this,"2.21",vl);this.A.load()&&(wl(),a=xl,yl(this.A));this.A.set(sl,db("%T",new Date));this.A.store();var e=this.g&&!this.I;if(a==tl||Ub("Click OK to restore the previous PDPjs machine state, or CANCEL to reset the machine.")){if(c=rl(d)){var f=d.get("code"),g=d.get("data");f&&(f=="ok"?d.load(g):(f=="error"&&
g!="no machine state"?(this.u(274877906944,"Error: %s\n",g),g=="unable to verify user"&&(tb(zl,""),this.j=null)):this.u("%s: %s\n",f,g),yl(d),d.load()?(c=rl(d),e=!0):c=!1))}e&&pl(this,c?d:null)}else a==xl&&d.clear()}else pl(this);delete this.K;delete this.F}e=Xb(this.id);for(f=0;f<e.length;f++)g=e[f],g!==this&&g!=this.i&&(c=Al(this,g,d,b,c));b=[d,a,c];a!=ul?this.wait(this.je,b):this.je(b)}};
function Al(a,b,c,d,e){if(!b.flags.ia){b.flags.ia=!0;var f=null;try{if(e&&((f=c.get(b.id))||(f=c.get(b.id.replace(/-[0-9]+\./i,".")))),typeof f==="string"&&(f=null),!b.Ba(f,d)&&f&&(A("Unable to restore state for "+b.type),a.M&&!a.U?(c.clear(),a.g=nl,u.location&&u.location.reload()):a.R=!0,b.Ba(null),e=!1),!d&&b.Rd){var g=b.Rd.split("|");for(a=0;a<g.length;a++)b.u(137438953472,"%s\n",g[a])}}catch(h){A("Error restoring state for "+b.type+" ("+h.message+")")}}return e}
k.je=function(a){var b=a[0],c=a[1]<0;a=a[2];this.T=!0;this.flags.ia=!0;var d=this.J.power;d&&(d.textContent="Shutdown");this.i&&(Al(this,this.i,b,c,a),gd(this,-2),this.i.pa());this.R&&(wl(),b.clear());!c&&this.A&&(this.A.clear(),delete this.A);this.v=0};function wl(){Hb("There may be a problem with your PDPjs machine.")}
function hl(a,b,c){var d="none";if(a.v)return null;a.v--;var e=new Hc(a,"2.21"),f=new Hc(a,"2.21",ql),g=db("%T",new Date);f.set(sl,g);e.set(sl,g);e.set(Bl,"2.21");e.set(Cl,u.location?u.location.href:null);e.set(Dl,u.navigator?u.navigator.userAgent:"");if(a.i&&a.i.Aa){c&&(b&&(a.i.flags.pa=a.i.flags.W),bd(a.i));var h=a.i.Aa(b,c);typeof h==="object"&&e.set(a.i.id,h);c&&(a.i.flags.ia=!1,h===!1&&(d=null))}g=Xb(a.id);for(var l=0;l<g.length;l++){var m=g[l];m.flags.ia&&(m.Aa&&(h=m.Aa(b,c),typeof h==="object"&&
e.set(m.id,h)),c&&(m.flags.ia=!1,h===!1&&(d=null)))}d&&(c?(g=h=!1,b?(a.j&&El(a,a.j,e.toString()),f.store()&&e.store()||(d=null,h=g=!0)):a.g&&(h=!0,g=a.g==Hl),h&&e.clear(g)):d=e.toString());c&&(a.flags.ia=!1,b=a.J.power)&&(b.textContent="Power");a.v=0;return d}
k.reset=function(){this.flags.reset=!0;this.G&&this.G.reset&&(this.u("Resetting %s\n",this.G.type),this.G.reset());this.i&&this.i.reset&&(this.u("Resetting %s\n",this.i.type),this.i.reset());for(var a=Xb(this.id),b=0;b<a.length;b++){var c=a[b];c!==this&&c!==this.G&&c!==this.i&&c.reset&&(this.u("Resetting %s\n",c.type),c.reset())}this.flags.reset=!1;gd(this,-1)};k.start=function(a,b){for(var c=Xb(this.id),d=0;d<c.length;d++){var e=c[d];e.type!="CPU"&&e!==this&&e.start&&e.start(a,b)}gd(this,-1)};
k.stop=function(a,b){for(var c=Xb(this.id),d=0;d<c.length;d++){var e=c[d];e.type!="CPU"&&e!==this&&e.stop&&e.stop(a,b)}gd(this,-1)};
function gd(a,b){if(a.i){var c=a.i,d=b||0,e=c.J.speed;e&&(d<=0||(c.jd+=d)>=30)&&(e.textContent=c.flags.W?c.pb.toFixed(2)+"Mhz":"Stopped",c.jd=0)}if(a.B&&(a=a.B,b=b||0,a.C)){c=a.i.flags.W;d=!!(a.i.v&8);if(b<=0||(a.B+=b)>=60){for(e=0;e<a.i.j.length;e++)Mc(a,"R"+e,a.i.j[e]);e=ie(a.i);Mc(a,"PS",e);Mc(a,"NF",e&8?1:0,1);Mc(a,"ZF",e&4?1:0,1);Mc(a,"VF",e&2?1:0,1);Mc(a,"CF",e&1?1:0,1);a.B=0}b<-1?a.ea=a.i.j[7]:b>0&&c&&!d&&(a.ea=a.i.Ma);Ic(a,a.ea);yc(a,a.yb);b=a.i;b=b.rb?b.Y&16?1:2:4;nd(a,"B22",b&1);nd(a,"B18",
b&2);nd(a,"B16",b&4)}}
k.ta=function(a,b,c){var d=this;switch(b){case "power":return this.J[b]=c,c.onclick=function(){d.v||(d.flags.ia?hl(d,!1,!0):d.wait(d.nc))},!0;case "reset":return this.J[b]=c,c.onclick=function(){if(d.flags.ia&&!d.v)if(d.g&&!d.D){var e=Ub("Click OK to save changes to this PDPjs machine.\n\nWARNING: If you CANCEL, all disk changes will be discarded.");hl(d,e,!0);!e&&d.M?u.location&&u.location.reload():(e||(d.P=!0),d.nc(nl),d.P=!1)}else d.reset(),d.i&&!d.H&&d.i.pa()},!0;case "save":if(Xa(u.location?u.location.hostname:
"localhost","pcjs.org"))c.parentNode.removeChild(c);else return this.J[b]=c,c.onclick=function(){var e=ml(d,!0);if(e){var f=!!(d.g&&!d.D||d.M),g=hl(d,f);f?El(d,e,g):d.u(274877906944,"Resume disabled, machine state not saved\n")}},!0}return!1};
function ml(a,b){var c=a.j;c||((c=qb(zl),c!==void 0)?!c&&b&&(b=null,u.prompt&&(b=u.prompt("Saving machine states on the pcjs.org server is currently unsupported.\n\nIf you're running your own server, enter your user ID below.","")),c=b)&&((c=Rl(a,c))||a.u(274877906944,"The user ID is invalid.\n")):b&&a.u(274877906944,"Browser local storage is not available\n"));return c}
function Rl(a,b){a.j=null;b=ib(lb()+"/api/v1/user?req=verify&user="+b);var c=b[1];if(!b[0]&&c)try{b=eval("("+c+")"),b.code&&b.code=="ok"&&(tb(zl,b.data),a.j=b.data)}catch(d){A(d.message+" ("+c+")")}return a.j}function ol(a){var b=null;a.j&&(b=lb()+"/api/v1/user?req=load&user="+a.j+"&state="+Sl(a,"2.21"));return b}
function El(a,b,c){if(c){var d={req:"store"};d.user=b;d.state=Sl(a,"2.21");d.data=c;b=ib(lb()+"/api/v1/user",d);d=b[0];if(b[1]){if(d){var e=d.indexOf("\n");e>0&&(d=d.substr(0,e));d.indexOf("Error: ")||(d=d.substr(7))}d='{"code":'+b[1]+',"data":"'+d+'"}'}b=JSON.parse(d);b&&b.code=="ok"?a.u(274877906944,"Machine state saved to server\n"):c&&(c=b&&b.data||"unable to save machine state",c=b.code=="error"?"Error: "+c:"Error "+b.code+": "+c,a.u(274877906944,"%s\n",c),tb(zl,""),a.j=null)}}
function ii(a){var b=b===void 0?null:b;a=Xb(a.id);for(var c=0;c<a.length;c++){var d=a[c];if(b)b==d&&(b=null);else if(d.type=="RAM")return d}return null}function Le(a,b){if(a.C){var c=0,d=0;!b&&window&&(c=window.scrollX,d=window.scrollY);a.C.focus();!b&&window&&window.scrollTo(c,d)}}var vl="failsafe",ql="validate",sl="timestamp",Bl="version",Cl="url",Dl="browser",zl="user",ul=-1,nl=0,tl=1,xl=2,Hl=3;
Fb(function(){for(var a=F("pdp11","machine"),b=0;b<a.length;b++){var c=a[b],d=Wb(c);c=F("pdp11","computer",c);for(var e=0;e<c.length;e++){var f=c[e],g=Wb(f);g=new kl(g,d,!0);Vb(g,f);g.O&&g.wait(g.nc)}}});Gb.show.push(function(){for(var a=F("pdp11","computer"),b=0;b<a.length;b++){var c=Wb(a[b]);if(c=Zb("Computer",c.id))c.flags.we=!1,c.T&&!c.flags.ia&&c.nc(ul)}});
Gb.exit.push(function(){for(var a=F("pdp11","computer"),b=0;b<a.length;b++){var c=Wb(a[b]);if(c=Zb("Computer",c.id))c.flags.we=!0,c.flags.ia&&hl(c,!(!c.g||c.D),!0)}});function Hc(a,b,c){this.id=a.id;this.g="";this.i={};this.j=this.G=!1;this.key=Sl(a,b,c);yl(this,a.tf)}k=Hc.prototype;k.set=function(a,b){try{this.i[a]=b}catch(c){z(1099511627776,c.message)}};k.get=function(a){return this.i[a]||null};k.data=function(){return this.i};
k.load=function(a){return a?(this.g=a,this.j=!0,this.G=!1,!0):this.j?!0:nb()&&(a=qb(this.key))?(this.g=a,this.j=!0,z(2199023255552,"localStorage(%s): %d bytes loaded\n",this.key,a.length),!0):!1};function rl(a){var b=!0;if(!a.G)try{a.i=JSON.parse(a.g),a.G=!0}catch(c){A(c.message||c),b=!1}return b}
k.store=function(){var a=!0;if(nb()){var b=JSON.stringify(this.i);tb(this.key,b)?z(2199023255552,"localStorage(%s): %d bytes stored\n",this.key,b.length):(z(1099511627776,"Unable to store %d bytes in browser local storage\n",b.length),a=!1)}return a};k.toString=function(){return this.i?JSON.stringify(this.i):this.g};function yl(a,b){a.g="";a.i={};a.j=a.G=!1;b&&a.set("parms",b)}
k.clear=function(a){yl(this);var b=[];if(nb())try{for(var c=0,d=u.localStorage.length;c<d;c++)b.push(u.localStorage.key(c))}catch(f){pb(f)}for(c=0;c<b.length;c++)if((d=b[c])&&(a||d.substr(0,this.key.length)==this.key)){var e=d;if(nb())try{u.localStorage.removeItem(e)}catch(f){pb(f)}z(2199023255552,"localStorage(%s) removed\n",d);b.splice(c,1);c=0}};function Sl(a,b,c){a=a.id;if(b){var d=b.indexOf(".");d>0&&(a+=".v"+b.substr(0,d))}c&&(a+="."+c);return a}var Tl=0;
function Ul(a,b,c,d,e,f,g,h,l){h("Loading "+a+"...");ib(a,null,!0,function(m,n,r){r?(n||(n="unable to load "+a+" ("+r+")"),l(m,n,null)):Vl(n,a,b,c,d,e,f,g,h,l)})}
function Vl(a,b,c,d,e,f,g,h,l,m){function n(r,p,q){if(q)m(r,q,null);else{c&&(Sb(c,b,p),(q=b)&&q.indexOf("/")<0&&window.location.pathname.slice(-1)=="/"&&(q=window.location.pathname+q),f?f.slice(-1)=="}"?(f=f.slice(0,-1),f.length>1&&(f+=",")):f='{state:"'+f+'",':f="{",f+='url:"'+q+'"}',typeof resources=="object"&&(q=null),f=f.replace(/\$/g,"$$$$").replace(/'/g,"&apos;"),g&&(r=p.match(/(<machine[^>]*\sclass=)(['"])(.*?)(\2[^>]*>)/))&&(p=p.replace(r[0],r[1]+r[2]+g+r[4]),g=""),(r=p.match(/(<machine[^>]*\sdebugger=)(['"])(available)(\2[^>]*>)/))&&
(p=p.replace(r[0],r[1]+r[2]+"optional"+r[4])),p=p.replace(/(<machine[^>]*\sid=)(['"]).*?\2/,"$1$2"+c+"$2"+(g?' class="'+g+'"':"")+(f?" parms='"+f+"'":"")+(q?' url="'+q+'"':"")));h||(p=p.replace(/(<xsl:variable name="APPNAME">).*?(<\/xsl:variable>)/,"$1"+d+"$2"),p=p.replace(/(<xsl:variable name="APPCLASS">).*?(<\/xsl:variable>)/,"$1"+e+"$2"),p=p.replace(/<xsl:variable name="APPVERSION"(\/>|>[^<]*<\/xsl:variable>)/,'<xsl:variable name="APPVERSION">2.21</xsl:variable>'));r=null;if(p.charAt(0)=="<")try{h||
(p=p.replace(/<!DOCTYPE(.|[\r\n])*]>\s*/g,"")),window.ActiveXObject||"ActiveXObject"in window?(r=new window.ActiveXObject("Microsoft.XMLDOM"),r.async=!1,r.loadXML(p)):r=(new window.DOMParser).parseFromString(p,"text/xml")}catch(v){r=null,p=v.message}else p="unrecognized XML: "+(p.length>255?p.substr(0,255)+"...":p);m(b,p,r)}}a?h?Wl(b,a,l,n):n(b,a,""):m(b,"no data",null)}
function Wl(a,b,c,d){var e;if(e=/<([a-z]+)\s+ref="(.*?)"(.*?)\/>/g.exec(b)){var f=e[2];c("Loading "+f+"...");ib(f,null,!0,function(g,h,l){if(l||!h)d(g,b,"unable to resolve XML reference: "+e[0]+" ("+l+")");else{if(l=e[3]){var m=h.match(new RegExp("<"+e[1]+"[^>]*>"));if(m){for(var n=m[0],r,p=/( [a-z]+=)(['"])(.*?)\2/gi;r=p.exec(l);)n=n.toLowerCase().indexOf(r[1].toLowerCase())<0?n.replace(">",r[0]+">"):n.replace(new RegExp(r[1]+"(['\"])(.*?)\\1"),r[0]);m[0]!=n&&(h=h.replace(m[0],n))}else{d(g,b,"missing <"+
e[1]+"> in "+f);return}}h=h.replace(/<\?xml[^>]*>[\r\n]*/,"");b=b.replace(e[0],h);Wl(g,b,c,d)}})}else d(a,b,"")}
function Xl(a,b,c,d,e,f,g){function h(x){if(r===void 0){var E=n&&F("machine-warning","",n);r=E&&E[0]||n}r&&(r.innerHTML=Ya(x))}function l(x,E){if(typeof E=="string"&&E.indexOf("<!DOCTYPE html>")>=0){var na=E.match(/<title>(?:PCjs: |)(.*?)<\/title>/);na&&(E=na[1])}z(1099511627776,"%s\n",E);h("Error: "+E+(x?" ("+x+")":""));p&&m();p=!1}function m(){--Tl||Kb(!0)}var n,r,p=!0;Tl++;w.machines[c]={};if(!d)return f&&Sb(c,"parms",f),m(),p;wb("debugger")=="true"&&d.indexOf("/debugger")<0&&(d=d.replace("/machine.xml",
"/debugger/machine.xml"));try{if(n=document.getElementById(c)){var q,v=u.resources;if(typeof v=="object"&&(q=v.css)){var D=document.head||document.getElementsByTagName("head")[0],B=document.createElement("style");B.type="text/css";B.styleSheet?B.styleSheet.cssText=q:B.appendChild(document.createTextNode(q));D.appendChild(B)}e||(e="/machines/"+b+"/xsl/components.xsl");b=b.split("/").pop();q=function(x,E,na){na?Ul(e||"","",a,b,"","",!1,h,function(J,Na,Y){if(Y)if(Sb(c,e||"",Na),h("Processing "+d+"..."),
window.ActiveXObject||"ActiveXObject"in window)(Y=na.transformNode(Y))?(n.outerHTML=Y,m()):l(J,"transformNodeToObject failed");else if(document.implementation&&document.implementation.createDocument)if(Na=new XSLTProcessor,Na.importStylesheet(Y),Y=Na.transformToFragment(na,document))if(Na=n.parentNode){var ta=J=0,ua=n.getBoundingClientRect();ua.bottom<0&&(J=window.scrollX,ta=window.scrollY);Na.replaceChild(Y,n);(n=document.getElementById(c))&&ua.bottom<0&&(Y=n.getBoundingClientRect(),ta=window.performance&&
window.performance.navigation.type==window.performance.navigation.TYPE_RELOAD?0:ta+Math.ceil(Y.height-ua.height),window.scrollTo(J,ta));m()}else l(J,"invalid machine element: "+c);else l(J,"transformToFragment failed");else l(J,"unable to transform XML: unsupported browser");else l(J,Na)}):l(x,E)};d.charAt(0)!="<"?Ul(d,c,a,b,f||"",g||"",!0,h,q):Vl(d,"",c,a,b,f||"",g||"",!1,h,q)}else l(d,"missing machine element: "+c)}catch(x){l(d,x.message)}return p}
function Yl(a,b,c,d,e){Kb(!1);return Xl("PCx86","pcx86",a,b,c,d,e)}u.embedC1P=function(a,b,c,d,e){Kb(!1);return Xl("C1Pjs","osi/c1p",a,b,c,void 0,e)};u.embedPC=Yl;u.embedPCx86=Yl;u.embedPCx80=function(a,b,c,d,e){Kb(!1);return Xl("PCx80","pcx80",a,b,c,d,e)};u.embedPDP10=function(a,b,c,d,e){Kb(!1);return Xl("PDPjs","dec/pdp10",a,b,c,d,e)};u.embedPDP11=function(a,b,c,d,e){Kb(!1);return Xl("PDPjs","dec/pdp11",a,b,c,d,e)};
u.commandMachine=function(a,b,c,d,e,f){if(e=="script"){d=!1;e=w.commands;c+=".machine";if(!f)delete e[c],d=!0;else if(typeof f=="string"&&!e[c]){d=!0;for(var g=c,h=f.length,l=[],m=[],n="",r=null,p=0;p<h;p++){var q=f[p];if(q=='"'||q=="'")r&&q!=r?n+=q:(r?r=null:r=q,n&&(m.push(n),n=""));else{if(!r){if(q=="\r"||q=="\n")q=";";if(q==" "||q=="\t"||q==";"){n&&(m.push(n),n="");q==";"&&m.length&&(l.push(m),m=[]);continue}}n+=q}}n&&m.push(n);m.length&&l.push(m);e[g]=l;$b(c)||(d=!1)}return d?(b&&(a.disabled=
!0),!0):!1}if(d&&(g=Zb(d,c+".machine"))&&(h=g.exports)&&(h=h[e]))return h.call(g,f)?(b&&(a.disabled=!0),!0):!1;console.log("unimplemented: commandMachine('"+c+"','"+d+"','"+e+"','"+f+"')");return!1};u.enableEvents=Kb;u.sendEvent=Ib;})()

//# sourceMappingURL=pdp11.js.map
