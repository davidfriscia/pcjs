(function(){/*
 https://www.pcjs.org/machines/dec/pdp11/modules/v3/dl11.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v3/pc11.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/defines.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/message.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/format.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/stdlib.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/stdio.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/webio.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/device.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/input.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/led.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/time.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/bus.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/memory.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/ports.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/ram.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/rom.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/cpu.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/debugger.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v3/pdp11ops.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v3/pdp11.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v3/pdp11dbg.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/dec/pdp11/modules/v3/iopage.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/machine.js (C) 2012-2026 Jeff Parsons
*/
var l,aa=typeof Object.create=="function"?Object.create:function(a){function b(){}b.prototype=a;return new b},ba=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};
function ca(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var da=ca(this),ea="Int8 Uint8 Uint8Clamped Int16 Uint16 Int32 Uint32 Float32 Float64".split(" ");da.BigInt64Array&&(ea.push("BigInt64"),ea.push("BigUint64"));
function fa(a,b){if(b)for(var c=0;c<ea.length;c++)ha(ea[c]+"Array.prototype."+a,b)}function t(a,b){b&&ha(a,b)}function ha(a,b){var c=da;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))return;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&b!=null&&ba(c,a,{configurable:!0,writable:!0,value:b})}var ia;
if(typeof Object.setPrototypeOf=="function")ia=Object.setPrototypeOf;else{var ja;a:{var ka={a:!0},la={};try{la.__proto__=ka;ja=la.a;break a}catch(a){}ja=!1}ia=ja?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var ma=ia;
function w(a,b){a.prototype=aa(b.prototype);a.prototype.constructor=a;if(ma)ma(a,b);else for(var c in b)if(c!="prototype")if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.Bg=b.prototype}function na(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}
function oa(a){if(!(a instanceof Array)){var b=typeof Symbol!="undefined"&&Symbol.iterator&&a[Symbol.iterator];if(b)a=b.call(a);else if(typeof a.length=="number")a={next:na(a)};else throw Error(String(a)+" is not an iterable or ArrayLike");for(var c=[];!(b=a.next()).done;)c.push(b.value);a=c}return a}function pa(){for(var a=Number(this),b=[],c=a;c<arguments.length;c++)b[c-a]=arguments[c];return b}
t("String.prototype.replaceAll",function(a){return a?a:function(b,c){if(b instanceof RegExp&&!b.global)throw new TypeError("String.prototype.replaceAll called with a non-global RegExp argument.");return b instanceof RegExp?this.replace(b,c):this.replace(new RegExp(String(b).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"),"g"),c)}});
t("Math.trunc",function(a){return a?a:function(b){b=Number(b);if(isNaN(b)||b===Infinity||b===-Infinity||b===0)return b;var c=Math.floor(Math.abs(b));return b<0?-c:c}});t("String.prototype.repeat",function(a){return a?a:function(b){if(this==null)throw new TypeError("The 'this' value for String.prototype.repeat must not be null or undefined");var c=this;if(b<0||b>1342177279)throw new RangeError("Invalid count value");b|=0;for(var d="";b;)if(b&1&&(d+=c),b>>>=1)c+=c;return d}});
t("Number.isNaN",function(a){return a?a:function(b){return typeof b==="number"&&isNaN(b)}});t("Math.log2",function(a){return a?a:function(b){return Math.log(b)/Math.LN2}});
t("Symbol",function(a){function b(f){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c(d+(f||"")+"_"+e++,f)}function c(f,g){this.H=f;ba(this,"description",{configurable:!0,writable:!0,value:g})}if(a)return a;c.prototype.toString=function(){return this.H};var d="jscomp_symbol_"+(Math.random()*1E9>>>0)+"_",e=0;return b});
t("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");ba(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return qa(na(this))}});return a});function qa(a){a={next:a};a[Symbol.iterator]=function(){return this};return a}function ra(a,b){a instanceof String&&(a+="");var c=0,d=!1,e={next:function(){if(!d&&c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}d=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e}
t("Array.prototype.keys",function(a){return a?a:function(){return ra(this,function(b){return b})}});t("Array.prototype.fill",function(a){return a?a:function(b,c,d){var e=this.length||0;c<0&&(c=Math.max(0,e+c));if(d==null||d>e)d=e;d=Number(d);d<0&&(d=Math.max(0,e+d));for(c=Number(c||0);c<d;c++)this[c]=b;return this}});fa("fill",function(a){return a?a:Array.prototype.fill});t("Number.parseInt",function(a){return a||parseInt});
t("Array.prototype.values",function(a){return a?a:function(){return ra(this,function(b,c){return c})}});function sa(){this.R=""}var ta,ua=new ArrayBuffer(2);(new DataView(ua)).setUint16(0,256,!0);ta=(new Uint16Array(ua))[0]===256;
var va={zd:{Va:4,ua:16},$b:{Va:5,ua:32},bd:{Va:6,ua:64},Vb:{Va:8,ua:256},cd:{Va:20,ua:1048576},kg:{Va:22,ua:4194304}},wa={ng:typeof window!="undefined",node:typeof window!="undefined"?{}:global,process:typeof process!="undefined"?process:{},window:typeof window!="undefined"?window:global,document:typeof document!="undefined"?document:{},nb:{machines:{},components:[],commands:{},files:null}};wa.window.PCjs?wa.nb=wa.window.PCjs:wa.window.PCjs=wa.nb;
var xa=wa.process,ya=wa.nb.machines,za=wa.nb.components,x={};x.Defines=sa;var Aa={all:0xffffffffffff,addr:1,bus:2,fault:4,memory:8,ports:16,chips:32,kbd:64,serial:128,misc:256,cpu:512,mmu:2048,"int":1024,trap:4096,video:8192,monitor:16384,screen:32768,disk:131072,file:65536,time:262144,timer:524288,event:1048576,input:2097152,key:4194304,mouse:8388608,touch:16777216,info:274877906944,warn:549755813888,error:1099511627776,halt:70368744177664,buffer:0x800000000000};
function Ba(){this.H={};for(var a=0;a<23;a++)this.H["ACDFGHMNSTWYBbdfjcsoXx%"[a]]=null}Ba.prototype.g=function(a,b){return this.H[a]?!1:(this.H[a]=b,!0)};
function Ca(){var a=pa.apply(0,arguments);if(a[0]===void 0)a=new Date(Date.now());else if(typeof a[0]==="string"){var b=a[0];b.indexOf(":")<0?b+=" "+(a[1]||"00:00:00 UTC"):b.match(/^[0-9][0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9] [0-9][0-9]:[0-9][0-9]:[0-9][0-9]$/)&&(a[1]||(b+=" UTC"));a=new Date(b)}else a=a[1]===void 0?new Date(a[0]):new Date(Date.UTC.apply(Date,oa(a)));return a}
Ba.prototype.K=function(a){var b=pa.apply(1,arguments);if(!b||!b.length)return a;var c="",d=a.split(/%([-+ 0#]*)([0-9]*|\*)(\.[0-9]+|)([bwhlL]?)([A-Za-z%])/),e=0,f;for(f=0;f<d.length-6;f+=6){c+=d[f];var g=d[f+5];if(this.H[g]===void 0)c+="%"+d[f+1]+d[f+2]+d[f+3]+d[f+4]+g;else{if(e<b.length){var h=b[e];g!="%"&&e++}else h=b[b.length-1];var k=!1,n=d[f+1],m=n.indexOf("#")>=0,r=n.indexOf("0")>=0,p=d[f+2];p=="*"?(p=h,h=e<b.length?b[e++]:b[b.length-1]):p=+p||0;var q=d[f+3];q=q?+q.substr(1):-1;var v=d[f+4],
u=null,y=0,z="",C="ACDFGHMNSTWY".indexOf(g)>=0&&typeof h!="object"?Ca(h):h;switch(g){case "C":c+=isNaN(C.getTime())?void 0:this.K("%#W, %#F %#D, %#Y".replaceAll("#",m?"#":""),C);continue;case "D":h=m?C.getUTCDate():C.getDate();g="d";break;case "A":case "G":case "H":h=m?C.getUTCHours():C.getHours();g=="A"?(h=h<12?"am":"pm",g="s"):(g=="G"&&(h=h?h>12?h-12:h:12),g="d");break;case "F":case "M":h=m?C.getUTCMonth():C.getMonth();g=="F"?(h=Da[h],g="s"):(h++,g="d");break;case "N":h=m?C.getUTCMinutes():C.getMinutes();
g="d";break;case "S":h=m?C.getUTCSeconds():C.getSeconds();g="d";break;case "T":c+=isNaN(C.getTime())?void 0:this.K("%#Y-%#02M-%#02D %#02H:%#02N:%#02S".replaceAll("#",m?"#":""),C);continue;case "W":h=Ea[m?C.getUTCDay():C.getDay()];g="s";break;case "Y":h=m?C.getUTCFullYear():C.getFullYear(),q>0&&(h%=Math.pow(10,q)),g="d"}switch(g){case "b":c+=h?"true":"false";break;case "d":h=Math.trunc(h),q>=0&&(r=!0,p<q&&(p=q),q=-1);case "f":h=+h;g=h+"";q>=0&&(g=h.toFixed(q));g.length<p&&(r?(h<0&&(p--,g=g.substr(1)),
g=("0".repeat(p)+g).slice(-p),h<0&&(g="-"+g)):g=(" ".repeat(p)+g).slice(-p));c+=g;break;case "j":c+=JSON.stringify(h,null,p||void 0);break;case "c":h=typeof h=="string"?h[0]:String.fromCharCode(h);case "s":if(h!=void 0)for(typeof h!="string"&&(h=h.toString()),q>=0&&(h=h.substr(0,q));h.length<p;)h=n.indexOf("-")>=0?h+" ":" "+h;c+=h;break;case "B":y=2,m&&(z="0b");case "o":y||(y=8),!z&&m&&(z="0o");case "X":u=Fa;case "x":g="";y||(y=16);!z&&m&&(z="0x");u||(u=Ga);typeof h=="string"&&h[0]=="-"&&(k=!0,h=
h.slice(1));h=Math.trunc(h);k&&(h=-h);h<0&&((h|0)==h?h>>>=0:Math.abs(h)<=9007199254740992&&(h+=9007199254740992));q>=0&&(r=!0,p<q&&(p=q));r&&!p&&(v=="b"?p=2:v=="h"||v=="w"?p=4:v=="l"?p=8:(p=Math.abs(h),p=p<=255?2:p<=65535?4:p<=4294967295?8:9),p+=z.length);p-=z.length;do k=16,Number.isNaN(h)||(k=h&y-1,h=Math.trunc(h/y)),r||!g||k||h?g=u[k]+g:(z&&(g=z+g,z=""),p>0&&(g=" "+g));while(--p>0||h);c+=z+g;break;case "%":c+="%";break;default:c=this.H[g]?c+this.H[g](g,n,p,q,h):c+("(unimplemented sprintf type: %"+
g+")")}}}return c+=d[f]};var Ea="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Da="January February March April May June July August September October November December".split(" "),Ga="0123456789abcdef?",Fa="0123456789ABCDEF?";function Ha(){sa.apply(this,arguments)}w(Ha,sa);
function Ia(a,b){if(a){b||(b=10);var c,d=a.indexOf(",")>0;d&&(a=a.replace(/,/g,""));var e=c=a.charAt(0);c=="#"?(b=8,c=""):c=="$"&&(b=16,c="");e!=c?a=a.substr(1):(e=c=a.substr(0,2),c=="0b"&&d||c=="^B"?(b=2,c=""):c=="0o"||c=="^O"?(b=8,c=""):c=="^D"?(b=10,c=""):c=="0x"&&(b=16,c=""),e!=c&&(a=a.substr(2)));e=c=a.slice(-1);c=="Y"||c=="y"?(b=2,c=""):c=="."?(b=10,c=""):c=="H"||c=="h"?(b=16,c=""):c=="K"?c="000":c=="M"?c="000000":c=="G"&&(c="000000000");e!=c&&(a=a.slice(0,-1)+c);var f;e=0;b<=10&&(c=a.match(/(-?[0-9]+)B([0-9]*)$/))&&
(a=c[1],e=35-((c[2]||35)&255));if((b&&b!=10?b==16?a.match(/^-?[0-9a-f]+$/i)!==null:b==8?a.match(/^-?[0-7]+$/)!==null:b==2&&a.match(/^-?[01]+$/)!==null:a.match(/^[+-]?[0-9]+$/)!==null)&&!isNaN(f=parseInt(a,b))){e&&(f<0&&(f+=68719476736),f=e>0?f*Math.pow(2,e):Math.trunc(f/Math.pow(2,-e)));var g=f}}return g}
function E(a,b,c,d,e){d=d===void 0?0:d;var f=f===void 0?0:f;var g="",h="",k=-1;c||(c=a.ea||10);d&&(k=Math.ceil(d/Math.log2(c)));if(e==void 0)switch(c){case 8:e="0o";break;case 16:e="0x";break;case 10:h=".";default:e=""}isNaN(b)||typeof b!="number"?(b=void 0,e=h=""):(b<0&&b>-1&&(b=-1),d&&(b<0&&(b+=Math.pow(2,d)),b>=Math.pow(2,d)&&(k=Math.ceil(Math.log(b)/Math.log(c)))));for(a=f||-1;k--;){a||(g=","+g,a=f);if(b==void 0){if(g="?"+g,k<0)break}else if(d=b%c,b=Math.trunc(b/c),d+=d>=0&&d<=9?48:55,g=String.fromCharCode(d)+
g,!b&&k<0)break;a--}return e+g+h}function Ja(a,b){var c=a/F|0,d=b/F|0;return(a&b)==(b|0)&&(c&d)==d}var F=4294967296;x.StdLib=Ha;function G(){Ha.call(this);this.format=new Ba;this.Dc=this.format.g.bind(this.format);this.K=this.format.K.bind(this.format)}w(G,Ha);G.prototype.flush=function(){var a=Ka;Ka="";this.Na(a)};function La(a,b){var c=a,d=a.lastIndexOf("/");d>=0&&(c=a.substr(d+1));d=c.indexOf("&");d>0&&(c=c.substr(0,d));b&&(d=c.lastIndexOf("."),d>0&&(c=c.substring(0,d)));return c}
G.prototype.Na=function(a,b){var c=a.length,d=a.lastIndexOf("\n");b?d>=0&&(b=Date.now(),Ma||(Ma=b),a=((b-Ma)/1E3).toFixed(3)+": "+a,c=a.length):this.R=="node"?(xa.Ag.write(a),a=""):(d>=0&&(console.log(Ka+a.slice(0,d)),Ka="",a=a.slice(d+1)),Ma=null);Ka+=a;return c};G.prototype.o=function(a){return this.Na(this.K.apply(this,[a].concat(oa(pa.apply(1,arguments)))))};var Ka="",Ma=null;x.StdIO=G;
function Na(a){G.call(this);this.ba={};this.pa=0;this.X=this;a&&(this.X.pa=0,this.X.Ga=[],this.X.Ca=0,this.X.gb={},this.X.tg=!1)}var Oa;w(Na,G);l=Na.prototype;l.Ja=function(a,b){var c=this,d=this;this.ba[a]=b;switch(a){case Pa.Yc:b.onclick=function(){var e=c.Sa(Pa.hb,!0);e&&(e.value="")};break;case Pa.hb:Qa(b),b.addEventListener("keydown",function(e){Ra(d,e,!0)}),b.addEventListener("keypress",function(e){Ra(d,e)})}};function Sa(a,b){var c=Ta.Xb;a.X.gb[c]||(a.X.gb[c]=[]);a.X.gb[c].push(b)}
function Ua(a,b,c){var d=!1;typeof b=="boolean"&&(d=b,b=c.shift());if(b=a.K.apply(a,[b].concat(oa(c))))a.o("%s\n",b),d||alert(b)}function Qa(a){a.setAttribute("autocapitalize","off");a.setAttribute("autocomplete","off");a.setAttribute("autocorrect","off");a.setAttribute("spellcheck","false");a.value=""}l.error=function(a,b){Ua(this,"%s",this.K.apply(this,[a].concat(oa(b))))};l.Sa=function(a){return this.ba[a]};
function Va(a){var b=window;if(b){do{for(var c=0;c<Wa.length;c++){var d=Wa[c];d=d?d+a[0].toUpperCase():a[0];d+=a.substr(1);if(d in b)return d}if(a.indexOf("screen")<0)break;a=a.replace("screen","Screen")}while(1)}return null}function Xa(a,b){return a.config.bindings&&a.config.bindings[b]}function Ya(a){if(a=a.ba[Za])var b=a.textContent;return b}function $a(a,b,c){a=+a||0;a<b&&(a=b);a>c&&(a=c);return a}
function H(a,b,c,d){a=a.config[b];a===void 0?a=c:(d&&d[a]!==void 0&&(a=d[a]),d=typeof c,typeof a!=d&&(d=="boolean"?a=!!a:typeof c=="number"&&(a=+a)));return a}function ab(a,b,c){if(typeof b=="string")return bb(b,function(d,e,f,g){var h=!1;if(g){h=g<0;var k=d}else{if(f!=4)return;try{var n=JSON.parse(e)}catch(m){k=m.message||"unknown error"}}k&&Ua(a,h,"Unable to load %s media (error %d: %s)");c(n)}),!1;c(b);return!0}
function bb(a,b){var c=0,d=null,e=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");e.onreadystatechange=function(){e.readyState!==4?b(a,d,e.readyState,c):(d=e.responseText,e.status==200||!e.status&&d.length&&(window?window.location.protocol:"file:")=="file:"||(c=e.status||-1),b(a,d,e.readyState,c))};e.open("GET",a,!0);e.send()}
function cb(a){if(db.ub===void 0){var b=!1;if(window)try{window.localStorage.setItem(db.Za,db.Za),b=window.localStorage.getItem(db.Za)==db.Za,window.localStorage.removeItem(db.Za)}catch(c){a.o("%s\n",c.message),b=!1}db.ub=b}return!!db.ub}function eb(a,b){b=b===void 0?0:b;b>1&&b%2&&b--;b=b||a.pa;return(b|1)==-1||Ja(a.X.pa,b)?!0:!1}
function fb(a){if(window){var b=window.navigator.userAgent;return a=="iOS"&&(!!b.match(/(iPod|iPhone|iPad)/)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1)||a=="MSIE"&&!!b.match(/(MSIE|Trident)/)||b.indexOf(a)>=0}return!1}function gb(a){var b=null;if(cb(a)){var c;if(window)try{(c=window.localStorage.getItem(a.Y))&&(b=JSON.parse(c))}catch(d){a.o("%s\n",d.message)}}return b}
function Ra(a,b,c){b=b||window.event;var d=b.which||b.keyCode;if(d){var e=a.X,f=b.target;if(c){a=!1;var g;c=f.value;var h=c.lastIndexOf("\n");d==I.Tb&&f.selectionStart<=h+1&&(a=!0);d==I.Jd?(a=!0,e.Ca>0&&(g=e.Ga[--e.Ca])):d==I.ad&&(a=!0,e.Ca<e.Ga.length&&(g=e.Ga[++e.Ca]||""));a&&b.preventDefault();g!=void 0&&(f.value=c.substr(0,h+1)+g)}else d=String.fromCharCode(d),g=f.value,c=g.lastIndexOf("\n"),f.selectionStart<=c&&f.setSelectionRange(g.length,g.length),b.stopPropagation(),d=="@"&&e.Ca>0&&c+1==g.length&&
(f.value+=e.Ga[--e.Ca],d="\r"),d=="\r"&&(b.preventDefault(),g=f.value+="\n",f.blur(),f.focus(),(b=hb(a,g.slice(g.lastIndexOf("\n",g.length-2)+1,-1)||""))&&a.o("%s\n",b.replace(/\n$/,"")))}}function ib(a){return a=="true"||a=="on"?!0:a=="false"||a=="off"?!1:void 0}
function jb(a,b){if(b!=void 0){var c=a.X;try{if(b=b.trim())c.Ca<c.Ga.length&&b==c.Ga[c.Ca]?c.Ca++:(c.Ga.push(b),c.Ca=c.Ga.length);var d=b.split(" "),e=d[0],f=a.X.gb[Ta.Xb];switch(e[0]){case "m":if(e[1]=="?"){var g="";kb.forEach(function(r){g+=r+"\n"});g&&(g="message commands:\n"+g);break}g="";var h=void 0;e=d[d.length-1].toLowerCase();var k=ib(e);k!=void 0&&d.pop();d.length<=1&&(k!=void 0&&(h=k,k=void 0),d[1]="all");d[1]=="all"&&(d=Object.keys(Aa));for(f=1;f<d.length;f++){e=d[f];var n=Aa[e];if(!n){g+=
"unrecognized message: "+e+"\n";break}k!=void 0&&lb(a,n,k);if(h==void 0||h==eb(a,n))g+=a.K("%8s: %b\n",e,eb(a,n))}eb(a,0x800000000000)&&(g+="all messages will be buffered until buffer is turned off\n");g||(g="no messages\n");break;case "?":g="",mb.forEach(function(r){g+=r+"\n"}),g&&(g="default commands:\n"+g);default:if(d.unshift(b),f)for(a=0;a<f.length;a++){var m=f[a](d);if(m!=void 0){g=g?g+m:m;break}}}}catch(r){g="error: "+r.message+"\n"}}return g}
function hb(a,b){b=b===void 0?"?":b;if(b){var c="";b=b.split(/(?:\n|;\s*)/);for(var d=0;d<b.length;d++)c+=jb(a,b[d])}return c}
l.Na=function(a,b){b==void 0&&(b=eb(this,0x800000000000));if(!b){var c=this.Sa(Pa.hb,!0);if(c){b=c.selectionStart;for(var d=a.split(/([\n\r\b])/),e=0;e<d.length;e++){var f=d[e];if(f)if(f=="\b"||f=="\r")for(;b>0&&c.value.slice(b-1,b)!="\n"&&(b--,f!="\b"););else if(f=="\n"){for(f="";b<c.value.length&&(f=c.value[b],b++,f!="\n"););f!="\n"&&(c.value+="\r\n",b=c.value.length)}else c.value=c.value.slice(0,b)+f+c.value.slice(b+f.length),b+=f.length}c.focus();c.setSelectionRange(b,b);c.value.length>=8192&&
(c.value=c.value.slice(c.value.length-8192+4096));c.scrollTop=c.scrollHeight;return a.length}}return G.prototype.Na.call(this,a,b)};l.o=function(a){var b=pa.apply(1,arguments),c=0;typeof a=="number"&&(c=a,a=b.shift());return eb(this,c)?(Ja(c,1099511627776)&&(a="error: "+a),Ja(c,549755813888)&&(a="warning: "+a),G.prototype.o.call.apply(G.prototype.o,[this,a].concat(oa(b)))):0};function nb(a,b){if(cb(a)){b=JSON.stringify(b);try{window.localStorage.setItem(a.Y,b)}catch(c){a.o("%s\n",c.message)}}}
function ob(a,b,c){(a=a.ba[b])&&a.textContent!=c&&(a.textContent=c)}function lb(a,b,c){var d=!1;c?(c=a.X.pa,a.X.pa=(c|b)+(c/F|0|b/F|0)*F):(d=Ja(a.X.pa,0x800000000000)&&Ja(b,0x800000000000),c=a.X.pa,a.X.pa=(c&~b)+((c/F|0)&~(b/F|0))*F);d&&a.flush()}
var Pa={Yc:"clear",hb:"print"},mb=["\u2191 \u2193\t\trecall commands","@\t\trepeat last command","m?\t\tmessage commands"],kb=["m\t\tdisplay all messages","m on\t\tdisplay all active messages","m off\t\tdisplay all inactive messages","m all [on|off]\tturn all messages on or off","m ... [on|off]\tturn selected messages on or off"],Ta={Xb:"command"},pb={Zb:13,tb:65,Sb:66,Ub:67,ac:68,E:69,bc:70,cc:71,dc:72,ec:73,fc:74,mc:75,nc:76,rc:77,sc:78,tc:79,uc:80,Q:81,vc:82,xc:83,yc:84,zc:85,Ac:86,Cc:87,Ec:88,
Gc:89,Cb:90,a:97,b:98,c:99,d:100,e:101,f:102,rg:103,sg:104,ug:105,vg:106,k:107,wg:108,xg:109,n:110,yg:111,p:112,q:113,r:114,s:115,t:116,Cg:117,Dg:118,w:119,x:120,y:121,z:122},I={Tb:8,Gd:9,qd:10,Zb:13,Dd:16,Zc:17,Xc:18,bg:19,wb:20,bf:27,Fd:32,eg:33,dg:34,af:35,yf:36,qc:37,Jd:38,zb:39,vf:39,ad:40,sf:44,fg:44,zf:45,$e:46,uf:46,xf:47,ZERO:48,ONE:49,Id:50,Hd:51,ld:52,kd:53,Ed:54,Cd:55,dd:56,rd:57,jd:59,hd:61,tb:65,Sb:66,Ub:67,ac:68,E:69,bc:70,cc:71,dc:72,ec:73,fc:74,mc:75,nc:76,rc:77,sc:78,tc:79,uc:80,
Q:81,vc:82,xc:83,yc:84,zc:85,Ac:86,Cc:87,Ec:88,Gc:89,Cb:90,Wb:91,tf:91,rf:92,ig:93,wf:93,Df:96,Uf:96,qf:96,Ef:97,Sf:97,Ff:98,Rf:98,Gf:99,Xf:99,Hf:100,Vf:100,If:101,Of:101,Jf:102,Zf:102,Kf:103,Tf:103,Lf:104,ag:104,Mf:105,Yf:105,Wf:106,Nf:107,$f:109,Pf:110,Qf:111,cf:112,gf:113,hf:114,jf:115,kf:116,lf:117,mf:118,nf:119,pf:120,df:121,ef:122,ff:123,sd:144,Ad:145,gd:173,Bd:186,ed:187,Ze:188,$c:189,cg:190,lg:191,Xe:192,Af:219,Ye:220,hg:221,gg:222,fd:224,Bf:901,Bc:1E3},qb={},rb=(qb[I.jd]=I.Bd,qb[I.hd]=I.ed,
qb[I.gd]=I.$c,qb[I.fd]=I.Wb,qb),sb={qc:1,zb:2,Cf:3},J={},tb=(J[I.Tb]="\b",J[I.Gd]="\t",J[I.qd]="\n",J[I.Zb]="\r",J[I.Fd]=" ",J[I.ZERO]="0",J[I.ONE]="1",J[I.Id]="2",J[I.Hd]="3",J[I.ld]="4",J[I.kd]="5",J[I.Ed]="6",J[I.Cd]="7",J[I.dd]="8",J[I.rd]="9",J[I.tb]="A",J[I.Sb]="B",J[I.Ub]="C",J[I.ac]="D",J[I.E]="E",J[I.bc]="F",J[I.cc]="G",J[I.dc]="H",J[I.ec]="I",J[I.fc]="J",J[I.mc]="K",J[I.nc]="L",J[I.rc]="M",J[I.sc]="N",J[I.tc]="O",J[I.uc]="P",J[I.Q]="Q",J[I.vc]="R",J[I.xc]="S",J[I.yc]="T",J[I.zc]="U",J[I.Ac]=
"V",J[I.Cc]="W",J[I.Ec]="X",J[I.Gc]="Y",J[I.Cb]="Z",J[I.qc]="Left",J[I.zb]="Right",J),Wa=["","moz","ms","webkit"],ub={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",
darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",
fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",
lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",
navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",
seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},db={ub:void 0,Za:"PCjs.localStorage"};x.WebIO=Na;
function L(a,b,c,d){a=a===void 0?"default":a;b=b===void 0?a:b;c=c===void 0?{}:c;d=d===void 0?[]:d;Na.call(this,a==b);this.Y=a;this.R=b;ya[this.Y]||(ya[this.Y]={});ya[this.Y][this.R]&&this.o("warning: machine configuration contains multiple '%s' devices\n",this.R);ya[this.Y][this.R]=this;this.id=this.Y==this.R?this.Y:this.Y+"."+this.R;za.push(this);this.X=vb(this,this.Y);this.ready=!0;wb(this,c,d);this.Ha={};this.Fc=[]}w(L,Na);l=L.prototype;l.Db=function(){};l.Eb=function(){};
function wb(a,b,c){c=b.overrides||c;if(c.length){var d,e=Oa;if(!e){e={};if(window){d||(d=window.location.search.slice(1));for(var f,g=/\+/g,h=/([^&=]+)=?([^&]*)/g;f=h.exec(d);)e[decodeURIComponent(f[1].replace(g," ")).trim()]=decodeURIComponent(f[2].replace(g," ")).trim()}Oa=e}d=e;for(var k in d)c.indexOf(k)>=0&&(e=d[k],f=Ia(e,10),f==void 0&&(e=="true"?f=!0:e=="false"?f=!1:(f=e,e='"'+e+'"')),b[k]=f,a.o("overriding %s property '%s' with %s\n",a.R,k,e))}a.config=b;c=b.bindings;c=c===void 0?{}:c;if(typeof document!=
"undefined"){a.config.ba||(a.config.ba=c);(k=Array.isArray(c))?c.indexOf("container")<0&&c.push("container"):c.container||(c.container=a.R);for(var n in c){e=c[n];if(k)n=e;else if(e.match(/^[0-9]+$/)){d=+e;a.ba[n]=[];do{e=n+d++;e=document.getElementById(e);if(!e)break;a.ba[n].push(e)}while(1);continue}(d=document.getElementById(e))&&a.Ja(n,d)}}b=b===void 0?{}:b;a.version=3;if(a.version){n="";var m;a.Y!=a.R&&(m=vb(a,a.Y).version)&&m!=a.version&&(n="Machine");n||(m=b.version)&&m>a.version&&(n="Config");
n&&(m=a.K("%s Device version (%3.2f) incompatible with %s version (%3.2f)",b.og,a.version,n,m),a.error("%s\n\nClearing your browser's cache may resolve the issue.",m))}}function M(a,b,c,d){a.Ha[b]={get:c.bind(a),set:d?d.bind(a):null}}function xb(a,b,c){a.Ha[b]&&(a.Ha[c]=a.Ha[b])}function yb(a,b){var c;try{var d=ya[a.Y];if(d)for(c in d){var e=d[c];if(e.R!=e.Y&&!b(e))return!1}return!0}catch(f){a.o("error while enumerating device '%s': %s\n",c,f.message)}return!1}
l.Sa=function(a,b){b=b===void 0?!1:b;if(a){var c=Na.prototype.Sa.call(this,a,b);if(c===void 0&&b){b=ya[this.Y];for(var d in b)if(c=b[d].ba[a])break;c||(c=null);this.ba[a]=c}}return c};function vb(a,b,c){var d=b,e=a.Y,f=e.indexOf(".");f>0&&(e=e.substr(0,f),b=b.substr(f+1));b=(f=ya[e])&&f[b]||null;if(!b){for(f=0;f<za.length;f++)if(za[f].id===d){b=za[f];break}if(!b&&(c===void 0||c))throw Error(a.K('no "%s" device',d));}return b}
function N(a,b,c){var d=null,e=ya[a.Y];if(e)for(var f in e)if(e[f].config["class"]==b){if(d){d=null;break}d=e[f]}if(!d&&(c===void 0||c))throw Error(a.K("no %s device",b));return d}function zb(a,b){var c=vb(a,a.Y);return c&&c.config&&c.config[b]||a.config[b]}function Ab(a,b){return(a=a.Ha[b])&&a.get()}function Bb(a){return a==a.X&&a.ready?yb(a,function(b){return Bb(b)}):a.ready}function Cb(a,b){b=b===void 0?a.ready:b;a.ready=b;if(Bb(a)){for(;b=a.Fc.pop();)b();a!=a.X&&Cb(a.X)}}
function Db(a,b){if(Bb(a))return b(),!0;a.Fc.push(b);return!1}l.Sc=function(){};l.o=function(a){var b=pa.apply(1,arguments);return typeof a=="number"&&eb(this,a)&&(this.aa===void 0&&(this.aa=N(this,"Debugger",!1)),this.aa&&this.aa.Sc(a),this.X.pa&1&&(this.H===void 0&&(this.H=N(this,"CPU")),this.H))?(a=b.shift(),Na.prototype.o.call(this,"%#06x: %s.%s\n",this.H.Kb,this.R,this.K.apply(this,[a].concat(oa(b))).trim())):Na.prototype.o.call.apply(Na.prototype.o,[this,a].concat(oa(b)))};
function Eb(a,b){(a=ya[a.Y])&&delete a[b]}function Fb(a,b,c){(a=a.Ha[b])&&a.set&&a.set(c)}x.Device=L;
function Gb(a,b,c){L.call(this,a,b,c);this.pa=2097152;this.T=this.I=null;this.time=N(this,"Time");this.X=N(this,"Machine");this.$=H(this,"drag",!1);this.S=H(this,"scroll",!1);this.Z=H(this,"hexagonal",!1);this.l=H(this,"releaseDelay",0);this.m=!1;a=this.config.map;this.h=this.j=null;if(a)if(a.length)this.h=a;else{this.j={};b=Object.keys(a);for(var d=0;d<b.length;d++){var e=[],f=b[d],g=a[f];typeof g=="string"?g=[g]:g.length==void 0&&(e=g.grid,g=g.keys,typeof g=="string"&&(g=[g]));this.j[f]={keys:g,
grid:e,state:0}}}this.L=[];this.M=[];this.i=this.N=null;(a=this.ba[Hb])&&Ib(this,a,this.Sa(c.focusBinding,!0),this.config.location);this.ra()}w(Gb,L);function Jb(a,b){a.I=b}function Kb(a,b,c){for(var d=0;d<a.L.length;d++){var e=a.L[d];e.id===b&&e.jb(b,c)}}
function Ib(a,b,c,d){d=d===void 0?[]:d;if(d.length||a.h||a.j){var e={};e.Ve=d[0]||0;e.We=d[1]||0;e.ab=d[2]||b.clientWidth;e.ib=d[3]||b.clientHeight;e.kb=d[4]||1;e.qb=d[5]||1;e.Vd=d[6]||b.naturalWidth||e.ab;e.Xd=d[7]||b.naturalHeight||e.ib;e.Vc=d[8]||0;e.Wc=d[9]||0;e.Ud=d[10]||0;e.Wd=d[11]||0;a.h?(e.mb=a.h.length,e.bb=a.h[0].length):(e.bb=e.kb,e.mb=e.qb,e.kb=e.qb=0);e.Oc=e.ab/(e.bb+e.bb*e.kb)|0;e.Pc=e.ib/(e.mb+e.mb*e.qb)|0;e.Td=e.Oc*e.kb|0;e.Qc=e.Pc*e.qb|0;e.fb=e.sb=-1;Lb(a,b,e);Mb(a,b,e);a.time&&
a.l&&(a.W=Nb(a.time,"timerInputRelease",function(){e.fb<0&&e.sb<0&&Ob(a,-1,-1)}))}if(a.h||a.j)a.time&&a.l&&(a.ca=Nb(a.time,"timerKeyRelease",function(){Pb(a)})),a.u=0,a.J="",a.v=[],d=b,c&&(d=c,a.i||c.nodeName!="BUTTON"||(d=document,a.i=c,Qb(a,b),a.N=b)),Qb(a,d),a.i||(a.i=d)}function Rb(a){a.l?Sb(a.time,a.ca,a.l):Pb(a)}
function Tb(a,b,c,d,e){if(a=a.ba[b]){for(b=0;b<a.options.length&&a.options[b].text!=c;b++);void 0==a.options.length&&(b=document.createElement("option"),b.text=c,b.value=d,(e===void 0?0:e)&&a.childNodes[0]?a.insertBefore(b,a.childNodes[0]):a.appendChild(b))}}
function Qb(a,b){function c(e,f,g){var h=document.activeElement;a.o(5242880,"%s.onKey%s(%d): %5.2f (%s)\n",h.id||h.nodeName,e,f,Date.now()/1E3%60,g!=void 0?g?"used":"unused":"ignored")}function d(e,f){e=document.activeElement;return a.i&&e!=a.i&&e!=a.N?null:f||window.event}b.addEventListener("keydown",function(e){if(e=d(this,e)){var f=e.which||e.keyCode,g=Ub(a,f,!0,e);c("Down",f,g);g&&e.preventDefault()}});b.addEventListener("keypress",function(e){if(e=d(this,e)){var f=e.which||e.charCode,g=Ub(a,
f);c("Press",f,g);g&&e.preventDefault()}});b.addEventListener("keyup",function(e){if(e=d(this,e)){var f=e.which||e.keyCode,g=Ub(a,f,!1,e);c("Up",f);g&&e.preventDefault();b.nodeName=="TEXTAREA"&&(b.value="")}})}
function Lb(a,b,c){b.addEventListener("mousedown",function(d){if(!a.m){var e=a.i;if(e){var f=window.scrollX,g=window.scrollY;e.focus();window.scrollTo(f,g)}d.button||Vb(a,b,Wb,d,c)}});b.addEventListener("mousemove",function(d){a.m||Vb(a,b,Xb,d,c)});b.addEventListener("mouseup",function(d){a.m||d.button||Vb(a,b,Yb,d,c)});b.addEventListener("mouseout",function(d){a.m||(c.fb<0?Vb(a,b,Xb,d,c):Vb(a,b,Yb,d,c))})}
function Mb(a,b,c){b.addEventListener("touchstart",function(d){a.S&&(a.m=!0);Vb(a,b,Wb,d,c)});b.addEventListener("touchmove",function(d){Vb(a,b,Xb,d,c)});b.addEventListener("touchend",function(d){Vb(a,b,Yb,d,c)})}
function Ub(a,b,c,d){if(c!=void 0){var e=rb[b]||b;var f=tb[b];var g=Zb[e];d=d&&d.location==sb.zb;g&$b&&d&&(g>>=1);g&&(g&ac&&(c=!(a.g&g)),a.g=c?a.g|g:a.g&~g,Kb(a,e,c))}else f=String.fromCharCode(b).toUpperCase(),b>=pb.tb&&b<=pb.Cb?a.g&(bc|cc)||(a.g|=cc,Kb(a,I.wb,!0)):b>=pb.a&&b<=pb.z&&a.g&cc&&(a.g&=~cc,Kb(a,I.wb,!1));if(a.h){if(c!=void 0)return!1;for(e=0;e<a.h.length;e++)for(g=a.h[e],d=0;d<g.length;d++)if(g[d].split("|").indexOf(f)>=0)return a.u?a.v.length<16&&a.v.push(b):(a.u=1,a.J=f,Ob(a,d,e),Kb(a,
f,!0),Rb(a)),!0}if(a.j){if(c==void 0)return!0;b=Object.keys(a.j);for(e=0;e<b.length;e++)if(g=b[e],a.j[g].keys.indexOf(f)>=0)return Kb(a,g,c),a.j[g].state=c?1:0,!0}return!1}function Pb(a){a.u==1?(a.u++,Kb(a,a.J,!1),a.J="",Ob(a,-1,-1),Rb(a)):(a.u=0,a.v.length&&Ub(a,a.v.shift()))}Gb.prototype.ra=function(){this.g=0;this.O=this.U=-1};
function Vb(a,b,c,d,e){var f=-1,g=-1,h=!1,k=-1,n=-1;if(c<Yb){d=d||window.event;d.targetTouches&&d.targetTouches.length?(k=d.targetTouches[0].clientX,n=d.targetTouches[0].clientY,h=d.targetTouches.length>1):(k=d.clientX,n=d.clientY);var m=d.target.getBoundingClientRect();k-=m.left;n-=m.top;k=e.Vd/b.offsetWidth*k|0;n=e.Xd/b.offsetHeight*n|0;var r=k-e.Ve;var p=n-e.We;var q=m=!1;var v=k>=e.Vc&&k<e.Vc+e.Ud&&n>=e.Wc&&n<e.Wc+e.Wd;if(r>=0&&r<e.ab&&p+e.Qc>=0||v)if(h||a.S||d.preventDefault(),r>=0&&r<e.ab&&
p>=0&&p<e.ib){q=!0;d=e.ab/e.bb|0;var u=e.ib/e.mb|0,y=r/d|0,z=p/u|0;!a.Z||z&1||(r-=d>>1,y=r/d|0,y==e.bb-1&&(r=-1));u=z*u+(e.Qc>>1);r-=y*d+(e.Td>>1);p-=u;r>=0&&r<e.Oc&&p>=0&&p<e.Pc&&(f=y,g=z,m=!0)}}r=r||0;p=p||0;d=b.offsetWidth;b=b.offsetHeight;if(c==Wb||c==Yb)for(y=0;y<a.M.length;y++)z=a.M[y],c==Yb?z.jb(z.id,!1):(u=p/(b/z.qg|0)|0,(r/(d/z.pg|0)|0)==z.Eg&&u==z.Fg&&z.jb(z.id,!0));if(!h)if(c==Wb)e.fb=k,e.sb=n,q?(Ob(a,f,g),m&&a.l&&Sb(a.time,a.W,a.l,!0)):v&&a.X.qa();else if(c==Xb)e.fb>=0&&e.sb>=0&&a.$?Ob(a,
f,g):a.I&&a.I(f,g);else if(c==Yb){if(c=a.l)c=a.time,f=a.W,c=c.g&&f>0&&f<=c.h.length?c.h[f-1].za>=0:!1;c||Ob(a,-1,-1);e.fb=e.sb=-1}else a.o("unrecognized action: %d\n",c)}function Ob(a,b,c){if(b!=a.O||c!=a.U)a.O=b,a.U=c,a.T&&a.T(b,c)}var Wb=1,Xb=2,Yb=3,Hb="surface",bc=3,$b=170,cc=512,ac=3584,dc={},Zb=(dc[I.Dd]=2,dc[I.Zc]=8,dc[I.Xc]=32,dc[I.Wb]=128,dc[I.wb]=cc,dc[I.sd]=1024,dc[I.Ad]=2048,dc);x.Input=Gb;
function ec(a,b,c){L.call(this,a,b,c,["color","backgroundColor"]);a=this.ba[fc];if(!a)throw Error("LED "+this.config.ba[fc]+" binding for '"+fc+"' missing");b=document.createElement("canvas");if(!b||!b.getContext)throw a.innerHTML="LED device requires HTML5 canvas support",Error("LED device requires HTML5 canvas support");this.oa=Xa(this,fc)+".canvas";b.setAttribute("id",this.oa);this.type=$a(H(this,"type",hc,ic),jc,kc);this.i=lc[this.type][0];this.u=lc[this.type][1];this.width=H(this,"width",this.i);
this.height=H(this,"height",this.u);this.j=H(this,"cols",1);this.L=this.j+H(this,"colsExtra",0);this.Z=H(this,"rows",1);this.O=this.Z+H(this,"rowsExtra",0);this.ca=this.width*this.j;this.T=this.height*this.Z;this.m=mc("black",0);this.h=nc(this.config.color)||this.m;this.ka=mc(this.h,1,.25);this.ja=mc(this.h,1,2);this.l=nc(this.config.backgroundColor);this.la=H(this,"fixed",!1);this.la||(b.style.width="100%",b.style.height="auto");this.ha=H(this,"hexagonal",!1);this.ma=H(this,"highlight",!0);this.S=
H(this,"persistent",this.type<kc);b.setAttribute("width",this.ca.toString());b.setAttribute("height",this.T.toString());b.style.backgroundColor=this.m;a.appendChild(b);this.ga=b.getContext("2d");if(this.v=document.createElement("canvas"))this.v.width=this.$=this.i*this.j,this.v.height=this.J=this.u*this.Z,this.g=this.v.getContext("2d");this.ta=(this.O+1)*this.L*4;this.buffer=Array(this.ta);this.va=this.j<this.L?(this.L-this.j)*4:0;this.M=this.N=!1;this.I=this.W=0;this.U=-1;var d=this;this.time=N(this,
"Time");oc(this.time,function(e,f){pc(d,!1,e,f)});qc(d)}w(ec,L);function qc(a){for(var b=a.buffer,c=0;c<b.length;c+=4){var d=a,e=b,f=c;e[f]=d.type<kc?rc:" ";e[f+1]=d.h==d.m?null:d.h;e[f+2]=0;e[f+3]=sc}a.M=a.N=!0;pc(a,!0)}function tc(a){a.l?(a.g.fillStyle=a.l,a.g.fillRect(0,0,a.$,a.J)):a.g.clearRect(0,0,a.$,a.J)}
function pc(a,b,c,d){b=b===void 0?!1:b;c=c===void 0?0:c;d=d===void 0?60:d;if(a.M||b){if(a.type<kc){d=0;if(!a.S||b)tc(a);else if(a.I){d=a.j-a.I;var e=a.i*d;a.g.drawImage(a.v,a.i*a.I,0,e,a.J,0,0,e,a.J)}for(var f=e=0;f<a.O;f++){for(var g=0;g<a.j;g++){var h=a.buffer[e],k=a.buffer[e+1]||a.m,n=a.ma&&e==a.U;if(a.buffer[e+3]&sc||n||b){if(g>=d)a:{var m=a,r=h;h=k;var p=g;k=f;var q=n;p=p===void 0?0:p;k=k===void 0?0:k;q=q===void 0?!1:q;var v=0;if(m.ha&&!(k&1)&&(v=m.i>>1,p==m.j-1))break a;if(h&&h!=m.h){q=q?mc(h,
1,2):h;var u=mc(h,1,.25)}else q=q?m.ja:m.h,u=m.ka;h=!1;r=r?q:u;q==m.m&&(r=m.l,h=!0);q=p*m.i+v;u=k*m.u;m.S&&(p=p*m.i+v,k*=m.u,m.l?(m.g.fillStyle=m.l,m.g.fillRect(p,k,m.i,m.u)):m.g.clearRect(p,k,m.i,m.u));m.g.fillStyle=r;k=uc[m.type];k.length==3?(m.g.beginPath(),m.g.arc(q+k[0],u+k[1],k[2],0,Math.PI*2),h?(m.g.globalCompositeOperation="destination-out",m.g.fill(),m.g.globalCompositeOperation="source-over"):m.g.fill()):m.g.fillRect(q+k[0],u+k[1],k[2],k[3])}a.buffer[e+3]=n?a.buffer[e+3]|sc:a.buffer[e+3]&
~sc}e+=4}e+=a.va}a.I=0}else{b="";for(d=0;d<a.buffer.length;d+=4)b+=a.buffer[d]||" ",a.buffer[d+3]&vc&&(b+=".");tc(a);for(f=e=d=0;d<b.length;d++){n=b[d];n=="."&&e&&e--;g=a;k=n;n=e;m=f;n=n===void 0?0:n;m=m===void 0?0:m;if(k=wc[k])for(h=0;h<k.length;h++)if(p=g,v=xc[k[h]]){r=(n===void 0?0:n)*p.i;q=(m===void 0?0:m)*p.u;p.g.fillStyle=p.h;p.g.beginPath();if(v.length==3)p.g.arc(r+v[0],q+v[1],v[2],0,Math.PI*2);else for(u=0;u<v.length;u+=2)u?p.g.lineTo(r+v[u],q+v[u+1]):p.g.moveTo(r+v[u],q+v[u+1]);p.g.closePath();
p.g.fill()}if(++e==a.j&&(e=0,++f==a.O))break}}a.ga.globalCompositeOperation=a.l&&a.h!=a.m?"source-over":"copy";a.ga.drawImage(a.v,0,0,a.$,a.J,0,0,a.ca,a.T);a.M=!1;a.U=-1}else a.S||a.N||(!c||!a.W||c-a.W>=(1E3/d|0))&&qc(a);a.N=!1;c&&(a.W=c)}function nc(a){return(a=a||void 0)&&ub[a]||a}
function mc(a,b,c){b=b===void 0?1:b;c=c===void 0?1:c;if(a){var d=[];a=ub[a]||a;var e=a;var f=16;var g=e.match(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i);g||(f=10,g=e.match(/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,?\s*(\d+|)\)$/i));if(g){for(e=1;e<g.length;e++)d[e-1]=Number.parseInt(g[e],f);d.length=e-1;f=!0}else f=!1;if(f){a="rgba(";for(f=0;f<3;f++)g=Math.round(d[f]*c),g=g<0?0:g>255?255:g,a+=g+",";a+=(f<d.length?d[f]:b)+")"}}return a}
ec.prototype.wa=function(a){var b=a.shift(),c=a.shift();a=a.shift();if(b==this.h&&c==this.l&&a&&a.length==this.buffer.length){this.buffer=a;for(b=0;b<=this.buffer.length-4;b+=4)this.buffer[b+1]==this.m&&(this.buffer[b+1]=null);pc(this,!0);return!0}return!1};ec.prototype.xa=function(a){this.buffer&&(a.push(this.h),a.push(this.l),a.push(this.buffer))};
var jc=0,hc=1,kc=3,ic={small:jc,round:hc,square:2,digit:kc},fc="container",rc=0,vc=1,sc=128,yc={},uc=(yc[jc]=[4,4,4],yc[hc]=[16,16,14],yc[2]=[2,2,28,28],yc),lc=[[8,8],[32,32],[32,32],[96,128]],xc={A:[30,8,79,8,67,19,37,19],B:[83,10,77,52,67,46,70,22],C:[77,59,71,100,61,89,64,64],D:[28,91,58,91,69,104,15,104],E:[18,59,28,64,25,88,12,100],F:[24,10,34,21,31,47,18,52],G:[24,56,34,50,60,50,71,56,61,61,33,61],P:[80,102,8]},wc={" ":[],0:"ABCDEF".split(""),1:["B","C"],2:["A","B","D","E","G"],3:["A","B","C",
"D","G"],4:["B","C","F","G"],5:["A","C","D","F","G"],6:"ACDEFG".split(""),7:["A","B","C"],8:"ABCDEFG".split(""),9:"ABCDFG".split(""),A:"ABCEFG".split(""),B:["C","D","E","F","G"],C:["A","D","E","F"],D:["B","C","D","E","G"],E:["A","D","E","F","G"],F:["A","E","F","G"],"-":["G"],".":["P"]};x.LED=ec;
function zc(a,b,c){L.call(this,a,b,c);this.oa=H(this,"cyclesMinimum",1E5);this.Ia=H(this,"cyclesMaximum",1E9);this.ha=$a(H(this,"cyclesPerSecond",1E6),this.oa,this.Ia);this.$=60;this.T=0;this.U=1E3/this.$;this.Pa=H(this,"updatesPerSecond",2)||2;this.Xa=1E3/this.Pa;this.Ea=0;this.Ya=H(this,"timeLock",!0);this.ma=this.M=0;this.la=this.l=1;this.va=this.u=this.ha/1E4/100;this.ja=[];this.I=[];this.h=[];this.ca=[];this.ta=this.g=this.S=this.J=!1;this.L=this.j=0;a=Va("requestAnimationFrame");if(!a){a="setTimeout";
var d=this.U}this.Qa=window[a].bind(window,this.ze.bind(this),d);this.Wa=window[Va("cancelAnimationFrame")||"clearTimeout"].bind(window);this.Z=this.W=this.m=this.i=this.ga=0;Ac(this)||Bc(this,this.la)}w(zc,L);function oc(a,b){a.ja.push(b)}l=zc.prototype;
l.Ja=function(a,b){var c=this;switch(a){case Cc:b.onclick=function(){Dc(c)&&(c.g?Ec(c):c.start())};break;case Fc:b.onclick=function(){Bc(c,c.l<<1);Gc(c,Hc(c.u))};break;case Ic:b.onclick=function(){Jc(c)};break;case Kc:b.addEventListener("mousedown",function(){c.J=!0}),b.addEventListener("mouseup",function(){Ac(c);c.J=!1}),b.addEventListener("mousemove",function(){c.J&&Ac(c)}),b.addEventListener("change",function(){c.J=!0;Ac(c);c.J=!1})}L.prototype.Ja.call(this,a,b)};
function Nb(a,b,c){var d=d===void 0?-1:d;var e=a.h.length+1;a.h.push({id:b,Md:c,lb:d,za:-1});d>=0&&Sb(a,e,d);return e}
function Lc(a,b,c,d){var e=0,f=a.u,g=f*1E6;b&&c&&(f=b/(c*10)/100,a.o(262144,"calcSpeed(%d cycles, %5.3fms): %5.3fMhz\n",b,c,f),d>a.U&&(a.l>1&&(a.l>>=1,a.o(549755813888,"frame time (%5.3fms) exceeded maximum (%5.3fms), target multiplier now %d\n",d,a.U,a.l)),e=d));a.M=f;a.ma=f/a.va;b=a.ma/a.l;a.ga=g/b/a.$+1E-8;a.o(262144,"nCyclesDepositPerFrame(%5.3f) = nCyclesPerSecond(%d) / nDivisor(%5.3f) / nFramesPerSecond(%d)\n",a.ga,g,b,a.$);return e}
function Mc(a,b){a.W=a.m=b;if(!a.I.length)return a.m=0,a.W;for(var c=0;a.m>0;){if(c<a.I.length){var d=a.I[c++];b=d.Be.call(d,b)||1}else c=b=0;a.m-=b}return a.W-a.m}function Nc(a,b){b=b===void 0?a.W-a.m:b;if(!a.g){if(a.i)for(var c=0;c<a.I.length;c++){var d=a.I[c];d.Ce.call(d)}a.i=b}a.i-=b;a.i<1&&(a.S=!0);a.Z+=b;a.W=a.m=0;a.g||(a.Z=0);return b}
function Oc(a,b){b=b===void 0?0:b;if(b){var c=b;a.i+=b}else for(c=a.i,c<1&&(c=a.i+=a.ga),c<0&&(a.o(262144,"warning: cycle count dropped below zero: %f\n",c),c=a.i=0),c|=0,b=a.h.length;b>0;b--){var d=a.h[b-1];!(d.za<0)&&c>d.za&&(c=d.za)}return c}function Hc(a){a>=1?a=a.toFixed(2)+"Mhz":(a=Math.round(a*1E6),a=a<=999?a+"Hz":Math.ceil(a/1E3)+"Khz");return a}function Pc(a){a.o(262144,"getSpeedCurrent(%5.3fhz)\n",a.M*1E6);return a.g&&a.M?Hc(a.M):"Stopped"}
function Dc(a){return a.ta?!0:(a.o("not powered\n"),!1)}function Qc(a,b){if(b>=1)for(var c=a.h.length;c>0;c--){var d=a.h[c-1];d.za<0||(d.za-=b,d.za<=0&&(d.za=-1,d.Md(),d.lb>=0&&Sb(a,c,d.lb)))}}l.qa=function(a){this.ta=a;this.aa===void 0&&(this.aa=N(this,"Debugger",!1))&&this.aa.Db(this,"time","dump time state",this.ae)};function Jc(a,b){Dc(a)&&(a.g?a.o("already running\n"):a.j?Ec(a):Rc(a,b))}
l.ze=function(a){a=a===void 0?Date.now():a;this.L=0;if(this.g){if(this.T){var b=a-this.T;b<1&&(b=16.67);this.$=1E3/b}this.T=a;a=Date.now();this.N&&(b=a-this.O-this.U,b>this.U&&(this.v+=b,this.o(549755813888,"browser throttling detected, compensating by %5.3fms\n",b)));this.O=a;this.v||(this.v=a);this.ka=0;try{this.S=!1;do Qc(this,Nc(this,Mc(this,Oc(this))));while(this.g&&!this.S)}catch(c){this.o("%s\n",c.message),Ec(this)}this.N=Date.now();this.ka&&(this.v+=this.ka,this.O+=this.ka);this.O+=Lc(this,
this.Z,this.N-this.v,this.N-this.O);this.N-this.Ea>=this.Xa&&this.update();for(a=0;a<this.ja.length;a++)this.ja[a](this.T,this.$);this.L=this.Qa()}};function Bc(a,b){if(b!==void 0){if(b<1||!a.J&&a.M>0&&a.M<a.u*.9)b=a.la;a.l=b;b=a.va*a.l;a.u!=b&&(a.u=b,Gc(a,Hc(a.u)))}a.v=a.N=0;a.i=a.Z=0;Lc(a);for(b=a.h.length;b>0;b--){var c=a.h[b-1];c.lb>=0&&Sb(a,b,c.lb,!0)}}function Ac(a){var b=a.ba[Kc];return b?(Bc(a,Math.floor((b.value-b.min)/(b.max-b.min)*(a.Ia-a.oa)+a.oa)/a.ha|0),!0):!1}
function Sb(a,b,c,d){b>0&&b<=a.h.length&&(b=a.h[b-1],d||b.za<0)&&(c=Math.ceil(a.ha*(a.Ya?a.la:a.ma)/1E3*(c===void 0?1E3:c)),a.g&&(c+=Nc(a)),b.za=c)}l.start=function(){if(this.g||this.j)return!1;this.g=!0;this.v=this.N=this.T=0;this.update(!0);this.L=this.Qa();return!0};function Rc(a,b){b=b===void 0?1:b;a.g||(b&&!a.j&&(a.j=b),a.j&&(a.j--,Qc(a,Nc(a,Mc(a,Oc(a,1)))),a.update(!1),a.j&&setTimeout(function(){Rc(a,0)},0)))}
function Ec(a){return a.g?(a.g=!1,Nc(a),a.L&&(a.Wa(a.L),a.L=0),a.update(!0),!0):a.j?(a.j=0,a.update(!0),!0):!1}l.update=function(a){a&&this.o(this.g?"started with %s target\n":"stopped\n",Hc(this.u));ob(this,Cc,this.g?"Halt":"Run");ob(this,Ic,this.j?"Stop":"Step");this.J||Gc(this,Pc(this));for(var b=0;b<this.ca.length;b++){var c=this.ca[b];c.Tc.call(c,a!=void 0)}this.Ea=Date.now();this.S=!0};function Gc(a,b){ob(a,Sc,b);ob(a,Fc,b)}
l.ae=function(){var a=this.K("nCyclesPerSecond: %f\n",this.ha);a+=this.K("nUpdatesPerSecond: %f\n",this.Pa);a+=this.K("nTargetMultiplier: %f\n",this.l);return a+=this.K("nCyclesDepositPerFrame: %f\n",this.ga)};var Cc="run",Fc="setSpeed",Sc="speed",Ic="step",Kc="throttle";x.Time=zc;
function Tc(a,b,c){L.call(this,a,b,c);this.type=this.config.type=="static"?Uc:Vc;this.da=this.config.addrWidth||16;this.m=Math.pow(2,this.da);this.l=this.m-1|0;this.blockSize=this.config.blockSize||(this.da>16?4096:1024);this.blockSize>this.m&&(this.blockSize=this.m);this.L=this.m/this.blockSize|0;this.h=Math.log2(this.blockSize)|0;this.i=(1<<this.h)-1;this.j=this.config.dataWidth||8;this.I=Math.pow(2,this.j)-1;this.u=this.config.littleEndian!==!1;this.g=Array(this.L);this.v=0;this.J=null;a=new P(a,
b+"[NONE]",{size:this.blockSize,bus:this.R});for(b=0;b<this.m;b+=this.blockSize)Wc(this,b,this.blockSize,Q.NONE,a);Xc(this,this.type)}w(Tc,L);function Wc(a,b,c,d,e){for(var f=b>>>a.h;c>0&&f<a.g.length;){var g=f*a.blockSize,h=a.blockSize-(b-g);h>c&&(h=c);var k=a.g[f];if(b!=g||h!=a.blockSize||k&&k.type!=Q.NONE)break;k=a.R+"["+E(a,b,16,a.da)+"]";b=e?e.size==a.blockSize?e:new P(a.Y,k,{type:d,ia:b,size:h,bus:a.R}):new P(a.Y,k,{type:d,ia:b,size:h,bus:a.R});a.g[f]=b;b=g+a.blockSize;c-=h;f++}}
function Yc(a,b){for(var c=Q.yd,d=0,e=0;e<a.g.length;e++){var f=a.g[e];f&&f.type&c&&(b(f),d++)}return d}function Zc(a,b,c){if(!(b&a.i)){b>>>=a.h;var d=a.g[b];a.g[b]=c}return d}function $c(a,b,c){a.aa&&a.aa.o(4,"bus fault (%d) at %n\n",c,b);a.J&&a.J(b,c)}l=Tc.prototype;l.qa=function(){this.aa===void 0&&(this.aa=N(this,"Debugger",!1))};l.ra=function(){};l.Hb=function(a){return a&&this.wa(a)?!0:!1};l.cb=function(a){this.xa(a)};
l.wa=function(a){for(var b=0;b<this.g.length;b++){var c=this.g[b];if((this.type==Vc||c.type&Q.Ra)&&c.wa){var d=a.shift();if(!c.wa(d))return!1}}return!0};l.xa=function(a){for(var b=0;b<this.g.length;b++){var c=this.g[b];if((this.type==Vc||c.type&Q.Ra)&&c.xa){var d=[];c.xa(d);a.push(d)}}};l.Jb=function(a){return this.g[a>>>this.h].Jb(a&this.i)};l.md=function(a){return this.g[a>>>this.h].Aa(a&this.i)};l.eb=function(a,b){this.g[a>>>this.h].eb(a&this.i,b)};
l.Da=function(a,b){this.g[a>>>this.h].ya(a&this.i,b)};l.hc=function(a){return a&1?this.Aa(a+1&this.l)|this.Aa(a)<<this.j:this.g[a>>>this.h].na(a&this.i)};l.jc=function(a){return a&1?this.Aa(a)|this.Aa(a+1&this.l)<<this.j:this.g[a>>>this.h].na(a&this.i)};l.he=function(a){return(a&this.i)==this.i?this.u?this.jc(a):this.hc(a):this.g[a>>>this.h].na(a&this.i)};l.kc=function(a,b){a&1?(this.ya(a,b>>this.j),this.ya(a+1&this.l,b&this.I)):this.g[a>>>this.h].fa(a&this.i,b)};
l.lc=function(a,b){a&1?(this.ya(a,b&this.I),this.ya(a+1&this.l,b>>this.j)):this.g[a>>>this.h].fa(a&this.i,b)};l.Ee=function(a,b){(a&this.i)==this.i?this.u?this.lc(a,b):this.kc(a,b):this.g[a>>>this.h].fa(a&this.i,b)};function Xc(a,b){var c=a.v;a.v+=b;c&&a.v||(a.Aa=a.md,a.ya=a.Da,a.type==Vc?(a.na=a.he,a.fa=a.Ee):a.u?(a.na=a.jc,a.fa=a.lc):(a.na=a.hc,a.fa=a.kc))}l.ob=function(a,b){return this.g[a>>>this.h].ob(b)?(Xc(this,1),!0):!1};l.Mb=function(a,b){return this.g[a>>>this.h].Mb(b)?(Xc(this,1),!0):!1};
l.pb=function(a,b){return this.g[a>>>this.h].pb(b)?(Xc(this,-1),!0):!1};l.Ob=function(a,b){return this.g[a>>>this.h].Ob(b)?(Xc(this,-1),!0):!1};var Uc=0,Vc=1;x.Bus=Tc;
function P(a,b,c){L.call(this,a,b,c);this.ia=this.config.addr;this.size=this.config.size;this.type=this.config.type||Q.NONE;this.j=(a=this.config.bus)?vb(this,a):N(this,a="Bus");if(!this.j)throw Error(this.K("unable to find bus '%s'",a));this.g=this.j.j;this.i=Math.pow(2,this.g)-1;this.W=this.$=!1;this.l=this.j.u!==!1;this.values=this.Z=this.buffer=this.U=null;a=this.Oa;b=this.Da;c=this.l?this.je:this.ie;var d=this.l?this.Ge:this.Fe;this.j.type==Uc&&(b=this.Pe,c=this.l?this.od:this.nd,d=this.Qe,this.g==
8&&zb(this,"ArrayBuffer")!==!1&&(this.$=!0,c=this.l==ta?this.se:this.te));switch(this.type){case Q.NONE:this.Aa=this.La;this.ya=this.Fa;this.na=this.ke;this.fa=this.He;break;case Q.wc:this.Aa=a;this.ya=this.Fa;this.na=c;this.fa=this.Fa;break;case Q.Ra:this.Aa=a,this.ya=b,this.na=c,this.fa=d}this.L=this.m=0;this.T=this.u=this.S=this.M=this.v=this.J=null;ad(this,this.config.values);bd(this)}w(P,L);
function ad(a,b){typeof b=="string"?(Cb(a,!1),bb(b,function(c,d,e,f){if(e==4)if(!f&&d){try{var g=JSON.parse(d);ad(a,g.values)}catch(h){a.o("error (%s) parsing resource: %s\n",h.message,c)}Cb(a,!0)}else a.o("error (%d) loading resource: %s\n",f,c)})):a.config.values=b}
function bd(a,b){if(a.type>Q.NONE&&(a.$?(a.buffer=new ArrayBuffer(a.size),a.U=new DataView(a.buffer,0,a.size),a.values=new Uint8Array(a.buffer,0,a.size),a.Z=new Uint16Array(a.buffer,0,a.size>>1),new Int32Array(a.buffer,0,a.size>>2)):a.values=Array(a.size).fill(0),b))for(var c=0;c<b.length;c++)a.values[c]=b[c]}l=P.prototype;
l.ra=function(){if(this.config.values)a:{var a=this.j,b=this.ia,c=this.size,d=this.config.values,e=0,f=b&a.i;b>>>=a.h;c>d.length&&(c=d.length);for(;c>0&&b<a.g.length;){var g=a.g[b++];if(!g)break a;for(;c>0&&f<g.size;)g.Da(f++,d[e++]),c--;f=0}}else this.type&Q.Ra&&this.values&&this.values.fill(0)};l.La=function(){return this.i};l.ke=function(a){return this.l?this.La(a)|this.La(a+1)<<this.g:this.La(a+1)|this.La(a)<<this.g};l.Jb=function(a){return this.values?this.values[a]:0};l.Oa=function(a){return this.values[a]};
l.nd=function(a){return this.values[a+1]|this.values[a]<<this.g};l.od=function(a){return this.values[a]|this.values[a+1]<<this.g};l.se=function(a){return this.Z[a>>>1]};l.te=function(a){return this.U.getUint16(a,this.l)};l.ie=function(a){return this.Oa(a+1)|this.Oa(a)<<this.g};l.je=function(a){return this.Oa(a)|this.Oa(a+1)<<this.g};l.Fa=function(){};l.He=function(a,b){this.l?(this.Fa(a,b&this.i),this.Fa(a+1,b>>this.g)):(this.Fa(a,b>>this.g),this.Fa(a+1,b&this.i))};
l.eb=function(a,b){this.values&&(this.values[a]=b)};l.Da=function(a,b){this.values[a]=b};l.Pe=function(a,b){this.values[a]=b;this.W=!0;this.m?this.M=this.Da:this.ya=this.Da};l.xb=function(a,b){this.values[a]=b>>this.g;this.values[a+1]=b&this.i};l.yb=function(a,b){this.values[a]=b&this.i;this.values[a+1]=b>>this.g};l.Pb=function(a,b){this.Z[a>>>1]=b};l.Qb=function(a,b){this.U.setUint16(a,b,this.l)};l.Fe=function(a,b){this.Da(a,b>>this.g);this.Da(a+1,b&this.i)};
l.Ge=function(a,b){this.Da(a,b&this.i);this.Da(a+1,b>>this.g)};l.Qe=function(a,b){this.buffer?this.l==ta?(this.Pb(a,b),this.m?this.u=this.Pb:this.fa=this.Pb):(this.Qb(a,b),this.m?this.u=this.Qb:this.fa=this.Qb):this.l?(this.yb(a,b),this.m?this.u=this.yb:this.fa=this.yb):(this.xb(a,b),this.m?this.u=this.xb:this.fa=this.xb)};
l.ob=function(a){if(!this.L){var b=this;this.L++;this.v=a;this.S=this.Aa;this.T=this.na;this.Aa=function(c){var d=b.S(c);b.v(b.ia,c,d);return d};this.na=function(c){var d=b.T(c);b.v(b.ia,c,d);b.v(b.ia,c+1,d);return d};return!0}return this.v==a?(this.L++,!0):!1};l.Mb=function(a){if(!this.m){var b=this;this.m++;this.J=a;this.M=this.ya;this.u=this.fa;this.ya=function(c,d){b.J(b.ia,c,d);b.M(c,d)};this.fa=function(c,d){b.J(b.ia,c,d);b.J(b.ia,c+1,d);b.u(c,d)};return!0}return this.J==a?(this.m++,!0):!1};
l.pb=function(a){return this.L&&this.v==a?(--this.L||(this.Aa=this.S,this.na=this.T,this.S=this.T=this.v=null),!0):!1};l.Ob=function(a){return this.m&&this.J==a?(--this.m||(this.ya=this.M,this.fa=this.u,this.M=this.u=this.J=null),!0):!1};l.wa=function(a){if(a){var b=a.shift();if(this.R==b){this.W=a.shift();a.shift();if(a=a.shift()){var c=this.size;c=c===void 0?0:c;if(a.length!=c){b=0;c=c?Array(c):[];for(var d=0;d<a.length-1;)for(var e=a[d++],f=a[d++];e--;)c[b++]=f;a=c}bd(this,a)}return!0}}return!1};
l.xa=function(a){a.push(this.R);a.push(this.W);a.push(!1);if(this.values){var b=this.values;for(var c=0,d=0,e=[];c<b.length;){for(var f=b[c],g=c+1;g<b.length&&b[g]===f;)g++;e[d++]=g-c;e[d++]=f;c=g}b=e.length>=b.length?b:e}else b=this.values;a.push(b)};var Q={NONE:1,wc:2,Ra:4,yd:14,mg:12};x.Memory=P;function cd(a,b,c){P.call(this,a,b,c);this.I=[];this.N=[];this.h=[];this.O=[];this.config.addr!=void 0&&Wc(this.j,this.config.addr,this.config.size,Q.NONE,this)}w(cd,P);
function dd(a,b,c,d,e,f,g,h){for(var k;c<=d;c++){k=!1;if(e){if(a.I[c])break;a.I[c]=e.bind(b)}if(f){if(a.N[c])break;a.N[c]=f.bind(b)}if(g){if(a.h[c])break;a.h[c]=g.bind(b)}if(h){if(a.O[c])break;a.O[c]=h.bind(b)}k=!0}if(!k)throw Error(a.K("handler for port %#0x already exists",c));}function ed(a,b,c){var d=d===void 0?0:d;for(var e in c){var f=c[e];dd(a,b,+e+d,+e+d,f[0],f[1],f[2],f[3])}}
cd.prototype.La=function(a){var b,c=this.ia+a;if(b=this.I[c]){var d=b(c);var e=!0}else if(b=this.h[c])d=c&1?b(c&-2)>>this.g:b(c)&this.i,e=!0;else if(c&1)if(c&=-2,b=this.h[c])d=b(c)>>this.g,e=!0;else if(b=this.I[c])d=b(c),e=!0;e||($c(this.j,c,0),this.o(272,"readNone(%#04x): unknown port\n",c),d=P.prototype.La.call(this,a));return d};
cd.prototype.Fa=function(a,b){var c,d=this.ia+a;if(c=this.N[d]){c(d,b);var e=!0}else if(c=this.O[d])e=this.h[d]?this.h[d](d,!0):0,d&1?c(d,e&this.i|b<<this.g):c(d,e&~this.i|b),e=!0;else if(d&1)if(d&=-2,c=this.O[d])e=this.h[d]?this.h[d](d,!0):0,c(d,e&this.i|b<<this.g),e=!0;else if(c=this.N[d])c(d,b),e=!0;e||($c(this.j,d,1),this.o(272,"writeNone(%#04x,%#04x): unknown port\n",d,b),P.prototype.Fa.call(this,a,b))};x.Ports=cd;
function fd(a,b,c){c.type=Q.NONE;P.call(this,a,b,c);Wc(this.j,this.config.addr,this.config.size,Q.Ra);Db(this,this.ra.bind(this))}w(fd,P);x.RAM=fd;
function gd(a,b,c){c.type=Q.wc;P.call(this,a,b,c);Wc(this.j,this.config.addr,this.config.size,this.config.type,this);Db(this,this.ra.bind(this));this.H=this.aa=void 0;if(x.LED&&this.ba[hd]){var d=this;this.I=Math.pow(2,Math.ceil(Math.log2(this.values.length)/2));this.N=this.values.length/this.I|0;this.h=new ec(a,b+"LEDs",{"class":"LED",bindings:{container:Xa(this,hd)},type:hc,cols:this.I,rows:this.N,color:H(this,"colorROM","green"),backgroundColor:H(this,"backgroundColorROM","black"),persistent:!0}),
qc(this.h);this.O=new Gb(a,b+"Input",{"class":"Input",location:[0,0,this.h.ca,this.h.T,this.I,this.N],bindings:{surface:Xa(this,hd)}});this.ca=Ya(this)||"";Jb(this.O,function(e,f){if(d.H){var g=d.ca;e>=0&&f>=0&&(e=f*d.I+e,f=d.H,g=f.aa&&id(f.aa,d.ia+e,1)||"");ob(d,Za,g)}})}}w(gd,P);
gd.prototype.wa=function(a){var b=!0,c=a.shift();if(c&&this.h){var d=c.length;this.h.buffer.length==d?(this.h.buffer=c,pc(this.h,!0)):(this.o("inconsistent saved LED state (%d), unable to load\n",d),b=!1)}a.length&&(d=(a=a.shift())&&a.length||-1,this.values.length==d?this.values=a:(this.o("inconsistent saved ROM state (%d), unable to load\n",d),b=!1));return b};gd.prototype.qa=function(){this.H===void 0&&(this.H=N(this,"CPU"));this.aa===void 0&&(this.aa=N(this,"Debugger",!1))&&this.aa.Eb&&this.aa.Eb(this.config.symbols)};
gd.prototype.Oa=function(a){if(this.h){var b=this.h,c=sc;c=(c===void 0?0:c)&129;var d=((a/this.I|0)*b.L+a%this.I)*4;if(d<=b.buffer.length-4){if(b.buffer[d]!==1||(b.buffer[d+3]&129)!==c)b.buffer[d]=1,b.buffer[d+3]=b.buffer[d+3]&-130|c|sc,b.M=!0;b.U=d;b.N=!0;b.I=0}}return this.values[a]};gd.prototype.xa=function(a){this.h&&(a.push(this.h.buffer),a.push(this.values))};var hd="array",Za="cellDesc";x.ROM=gd;
function jd(a,b,c){c["class"]="CPU";L.call(this,a,b,c);this.aa=void 0;this.Ya=this.Kb=0;this.T=this.config.addrReset||0;this.time=N(this,"Time");this.time.I.push(this);this.time.ca.push(this);this.ka=this.$=0}w(jd,L);jd.prototype.abort=function(a){this.Ya=this.Kb;this.o("%s\n",a.message);Ec(this.time)};function kd(a,b){a.aa=b;return a.Ha}jd.prototype.Be=function(a){this.ka=this.$=a===void 0?0:a;return this.ka-this.$};jd.prototype.Ce=function(){this.ka-=this.$;this.$=0};
function ld(a,b,c){c["class"]="Debugger";L.call(this,a,b,c);var d=this;this.ea=this.config.defaultRadix||16;this.ja=1;this.W=["(",")"];this.Dc("a",function(f,g,h,k,n){return E(d,n.V,d.ea,h)});this.Dc("n",function(f,g,h,k,n){return E(d,n,d.ea,h,g.indexOf("#")<0?"":void 0)});this.ka=this.I=0;this.M={};this.la=[];this.ma=[];this.H=N(this,"CPU");this.Ha=kd(this.H,this);this.input=N(this,"Input",!1);if(a=this.H.config.busMemory||this.config.busMemory){this.g=vb(this,a);if(a=this.H.config.busIO||this.config.busIO)this.j=
vb(this,a,!1);this.j||(this.j=this.g)}else this.g=this.j=N(this,"Bus");this.L=this.g.da;this.Ea=Math.pow(2,this.L)-1|0;this.v=this.ga=0;this.u=[];for(var e in R)this.u[R[e]]=[];this.m=[];this.m[R.Ba]=this.g;this.m[R.$a]=this.g;this.m[R.Ta]=this.j;this.m[R.Ua]=this.j;this.l=[];this.l[R.Ba]=this.Pd.bind(this);this.l[R.$a]=this.Sd.bind(this);this.l[R.Ta]=this.Nd.bind(this);this.l[R.Ua]=this.Od.bind(this);this.i=[];this.O=void 0;this.U=null;this.Z=0;this.time=N(this,"Time");this.time.ca.push(this);this.$=
0;this.J=[];this.T="";this.Db(this,"state","dump machine state",this.$d);this.ca=md();this.oa=md();this.ha=!1;this.S=0;this.h=[];Sa(this,this.ee.bind(this));(e=zb(this,"commands"))&&hb(this,e)}w(ld,L);l=ld.prototype;l.Db=function(a,b,c,d){this.J.push({Zd:a,name:b,Yd:c,jb:d})};function nd(a,b,c){for(var d,e=0;e<a.J.length;e++){var f=a.J[e];if(f.name==b){d=f.jb.call(f.Zd,c);break}}return d}
l.Eb=function(a){if(a&&a.length)for(var b=0;b<a.length-2;b+=3){var c=od(this,a[b]);if(c){var d=pd[a[b+1]];if(d){c={address:c,type:d,name:a[b+2]};d=this.la;var e=c,f=qd(d,e,this.Mc);f<0&&d.splice(-(f+1),0,e);d=this.ma;e=qd(d,c,this.Nc);e<0&&d.splice(-(e+1),0,c)}}}};function qd(a,b,c){var d=0,e=a.length,f=0;for(c===void 0&&(c=function(k,n){return k>n?1:k<n?-1:0});d<e;){var g=d+e>>1,h=void 0;h=c(b,a[g]);h>0?d=g+1:(e=g,f=!h)}return f?d:~d}l.Mc=function(a,b){return a.name>b.name?1:a.name<b.name?-1:0};
l.Nc=function(a,b){return a.address.V>b.address.V?1:a.address.V<b.address.V?-1:0};function rd(a,b,c){b=qd(a.ma,{address:b,type:0,name:void 0},a.Nc);if(b>=0&&(a=a.ma[b],!c||a.type==c))var d=a.name;return d}function sd(a,b,c,d){d=d===void 0?a.g:d;b.V=b.V+c&d.l}function md(a){a=a===void 0?0:a;var b=td.vd;return typeof a=="number"?{V:a,Lb:-1,type:b}:{V:a.V,Lb:a.Lb,type:a.type}}
function od(a,b,c){if(b){var d=md();var e=0,f=b.charAt(e);switch(f){case "&":e++;break;case "#":e++;d.type=td.wd;break;case "%":e++,f=b.charAt(e),f=="%"?e++:d.type=td.Bc}f=b.indexOf(":",e);if(f>=0){var g=ud(a,b.substring(e,f),c);g==void 0?d=null:(d.Lb=g,e=f+1)}d&&(b=ud(a,b.substring(e),c),b==void 0?d=null:d.V=b&a.Ea)}return d}function vd(a,b,c,d){d=d===void 0?a.g:d;a.v++;var e=d.Jb(b.V);c&&sd(a,b,c,d);a.v--;return e}
function wd(a,b,c){if(a.L<=32)return b&c;b=S(a,b,0,!0);c=S(a,c,0,!0);return((b/F|0)&(c/F|0))*F+((b&c)>>>0)}function xd(a,b,c){if(a.L<=32)return b^c;b=S(a,b,0,!0);c=S(a,c,0,!0);return((b/F|0)^(c/F|0))*F+((b^c)>>>0)}
function yd(a,b,c,d){for(d=d===void 0?-1:d;d--&&c.length;){var e=c.pop();if(b.length<2)return!1;var f=b.pop();var g=b.pop();switch(e){case "*":g*=f;break;case "/":if(!f)return!1;g=Math.trunc(g/f);break;case "^/":if(!f)return!1;g%=f;break;case "+":g+=f;break;case "-":g-=f;break;case "<<":g<<=f;break;case ">>":g>>=f;break;case ">>>":g>>>=f;break;case "<":g=g<f?1:0;break;case "<=":g=g<=f?1:0;break;case ">":g=g>f?1:0;break;case ">=":g=g>=f?1:0;break;case "==":g=g==f?1:0;break;case "!=":g=g!=f?1:0;break;
case "&":g=wd(a,g,f);break;case "!":case "|":e=a;e.L<=32?g|=f:(g=S(e,g,0,!0),f=S(e,f,0,!0),g=(g/F|0|f/F|0)*F+((g|f)>>>0));break;case "^!":g=xd(a,g,f);break;case "&&":g=g&&f?1:0;break;case "||":g=g||f?1:0;break;case ",,":g=S(a,g,18,!0)*262144+S(a,f,18,!0);break;case "_":case "^_":e=="^_"&&(f=35-(f&255));f&&(g=S(a,g,0,!0),g=f>0?g*Math.pow(2,f):Math.trunc(g/Math.pow(2,-f)));break;default:return!1}b.push(S(a,g))}return!0}
function zd(a,b,c,d,e,f){var g,h=!1,k=0,n=[],m=[],r=a.ea;for(a.ea=e;c<d;){var p=b[c++].trim();var q=c<d?b[c++]:"";if(p){var v=void 0;var u=a;var y=p,z=f;k=k===void 0?0:k;if(y!=void 0){v=Ab(u,y.toUpperCase());if(v==void 0){v=void 0;var C=u,U=qd(C.la,{address:null,type:0,name:y},C.Mc);U>=0&&(v=C.la[U].address.V);if(v==void 0)if(v=u,C=y,v.M[C]?v=v.M[C].value:(C=C.substr(0,6),v=v.M[C]&&v.M[C].value),v==void 0)v=Ia(y,y.length>1||u.ea>10?u.ea:10);else if(y=u.M[y]&&u.M[y].zg)z?z.push(y):(z=ud(u,y,z),z!==
void 0?v+=z:v=void 0)}v!=void 0&&(v=S(u,Ad(u,v,k)))}u=v}else if(q=="{"){p=1;for(u=c;c<d;)if(c++,q=c<b.length?b[c++]:"",q=="{")p++;else if(q=="}"&&!--p)break;u=zd(a,b,u,c-1,a.ea,f);u!=null&&k&&(u=Ad(a,u,k));p=c<d?b[c++].trim():"";q=c<d?b[c++]:""}else{if(q==" ")continue;if(q=="^B"){a.ea=2;continue}if(q=="^O"){a.ea=8;continue}if(q=="^D"){a.ea=10;continue}if(!(k&-1073741824)){if(q=="+")continue;if(q=="-"){k=k<<2|1;continue}if(q=="~"||q=="^-"){k=k<<2|2;continue}if(q=="^L"){k=k<<2|3;continue}}h=!0;break}if(u===
void 0)if(f)f.push(p),u=0;else{h=!0;break}n.push(S(a,u));if(q==" ")if(c<b.length-1&&!b[c])c++,q=b[c++];else{h=!0;break}if(!q)break;u=a.W[0]=="<"?Bd:Cd;if(!u[q]){h=!0;break}m.length&&u[q]<=u[m[m.length-1]]&&yd(a,n,m,1);m.push(q);a.ea=q=="^_"?10:e;k=0}if(h||!yd(a,n,m)||n.length!=1)h=!0;h?f||a.o("parse error (%s)\n",p||q):g=n.pop();a.ea=r;return g}
function Dd(a,b,c,d){for(var e,f=a.L/d|0;(e=b.indexOf(c))>=0;){for(var g=0,h=e+1,k=f;h<b.length;){var n=b[h++];if(n==c){k=-1;break}if(!k)break;k--;n=n.charCodeAt(0);d==6&&(n-=32);n&=(1<<d)-1;g=S(a,g*Math.pow(2,d)+n,d*f,!0)}if(k>=0){a.o("parse error (%c%s%c)\n",c,b,c);return}b=b.substr(0,e)+E(a,g)+b.substr(h)}return b}
function ud(a,b,c){if(b){a.W[0]!="{"&&(b=b.split(a.W[0]).join("{").split(a.W[1]).join("}"));b=Dd(a,b,'"',8);if(!b)return d;b=Dd(a,b,"'",6);if(!b)return d;a.ea!=16&&(b=b.replace(/(^|[^A-Z0-9$%.])([0-9]+)B/,"$1$2^_").replace(/\s+/g," "));b=b.split(/({|}|\|\||&&|\||\^!|\^B|\^O|\^D|\^L|\^-|~|\^_|_|&|!=|!|==|>=|>>>|>>|>|<=|<<|<|-|\+|\^\/|\/|\*|,,| )/);var d=zd(a,b,0,b.length,a.ea,c)}return d}
function Ad(a,b,c){for(;c;){var d;switch(c&3){case 1:b=-S(a,b);break;case 2:b=xd(a,b,-1);break;case 3:for(d=35;d>=0&&!wd(a,b,Math.pow(2,d));)d--;b=35-d}c>>>=2}return b}function S(a,b,c,d){var e=b;c=c||a.L;if(d)if(c==32)e=b>>>0;else if(c<32)e=b&(1<<c)-1;else{if(a=Math.pow(2,c),b<0||b>=a)e=b%a,e<0&&(e+=a)}else c<=32?e=b<<32-c>>32-c:(a=Math.pow(2,c-1),b>=a?(e=b%a,(b/a|0)&1&&(e-=a)):b<-a&&(e=b%a,((-b-1)/a|0)&1?e&&(e+=a):e||(e-=a)));b!=e&&(b=e);return b}
l.Fb=function(a){function b(h){for(var k=0;k<h.length;k++)if(h[k]!=void 0)return!1;return!0}if(a<-1)return Ed(this,this.Fb);var c="";if(a>=0){var d=this.i[a];if(d!=void 0){c=d>>8;d&=255;var e=this.m[c];if(e){var f=this.u[c],g=f[d];(c&1?e.Ob(g.V,this.l[c]):e.pb(g.V,this.l[c]))?(f[d]=void 0,this.i[a]=void 0,b(f)&&(f.length=0,b(this.i)&&(this.i.length=0)),c=this.K("%2d: %s %*a cleared\n",a,Fd[c],e.da,g),--this.ga||this.ha||(c+=Gd(this,!1))):c=this.K("invalid break address: %*a\n",e.da,g)}else c="invalid bus"}else c=
this.K("invalid break index: %d\n",a)}else c="missing break index\n";return c};function Hd(a,b){if(a.U&&(b==void 0||a.U.V==b)){var c=c===void 0?R.Ba:c;b=-1;var d=Id(a.U,a.u[c]);if(d>=0)for(var e=0;e<a.i.length;e++){var f=a.i[e];if(f!=void 0&&c==f>>8&&d==(f&255)){b=e;break}}c=b;c>=0&&a.Fb(c);a.U=null}}
l.Gb=function(a,b){b=b===void 0?!1:b;if(a<-1)return Ed(this,this.Gb,b);if(a>=0){var c=this.i[a];if(c!=void 0){var d=c>>8;c=this.u[d][c&255];if(c!=void 0){var e=b?"enabled":"disabled",f=this.m[d];!c.disabled==!b?(c.disabled=!b,a=this.K("%2d: %s %*a %s\n",a,Fd[d],f.da,c,e)):a=this.K("%2d: %s %*a already %s\n",a,Fd[d],f.da,c,e)}else a=this.K("no break address at index: %d\n",a)}else a=this.K("invalid break index: %d\n",a)}else a="missing break index\n";return a};
function Ed(a,b,c){for(var d="",e=0;e<a.i.length;e++)a.i[e]!=void 0&&(d+=b.call(a,e,c));d||(d="no break addresses found");return d}function Jd(a,b,c){c=c===void 0?R.Ba:c;a=a.u[c];for(c=0;c<a.length;c++){var d=a[c];if(d.V==b)return d}}function Id(a,b){for(var c=0;c<b.length;c++)if(b[c].V==a.V)return c;return-1}
function Kd(a,b){b=b===void 0?!1:b;for(var c="",d=0;d<a.i.length;d++){var e=a.i[d];if(e!=void 0){var f=e>>8;e=a.u[f][e&255];f=a.K("%s %*a",Fd[f],a.m[f].da,e);b?(c&&(c+=";"),c+=f,e.disabled&&(c+=";bd "+d)):c+=a.K("%2d: %s %s\n",d,f,e.disabled?"disabled":"enabled")}}c||b||(c="no break addresses found\n");return c}
function Ld(a,b,c){c=c===void 0?R.Ba:c;if(b){var d=a.m[c];if(d){var e=a.u[c];var f=Id(b,e);if(f>=0)f=-(f+1);else{for(f=0;f<e.length&&e[f]!=void 0;f++);e[f]=b}e=f;if(e>=0)if(f=c&1?d.Mb(b.V,a.l[c]):d.ob(b.V,a.l[c])){for(f=0;f<a.i.length&&a.i[f]!=void 0;f++);a.i[f]=c<<8|e;b=a.K("%2d: %s %*a set\n",f,Fd[c],d.da,b);a.ga++||a.h.length||(b+=Gd(a,!0))}else b=a.K("invalid break address: %*a\n",d.da,b),a.u[c][e]=void 0;else b=a.K("%s %*a already set\n",Fd[c],d.da,b)}else b="invalid bus"}else b="missing break address\n";
return b}function Md(a,b){b>=0&&(a.I=b);var c="instruction break count: "+(a.I>0?a.I:"disabled")+"\n";b>0&&(a.h.length||(c+=Gd(a,!0)),a.ha=!0);return c}function Nd(a,b){var c;if(b){var d=ib(b);d!=void 0?a.ka=d?0xffffffffffff:0:c=a.K("unrecognized message option: %s\n",b)}c||(c=a.K("break on message: %b\n",!!a.ka));return c}l.Nd=function(a,b){this.v||(a==void 0?T(this,"break on unknown input %#0x: %#0x",b):(a=Jd(this,a+b,R.Ta))&&!a.disabled&&T(this,"break on input %*a: %#0x",this.j.da))};
l.Od=function(a,b){this.v||(a==void 0?T(this,"break on unknown output %#0x: %#0x",b):(a=Jd(this,a+b,R.Ua))&&!a.disabled&&T(this,"break on output %*a: %#0x",this.j.da))};l.Pd=function(a,b){this.v||(a==void 0?T(this,"break on unknown read %#0x: %#0x",b):(a+=b,this.h.length&&a==this.H.Kb&&(this.Z++,this.I>0&&(--this.I||T(this,"break on instruction count")),this.h[this.S++]=a,this.S==this.h.length&&(this.S=0)),(b=Jd(this,a,R.Ba))&&!b.disabled&&(T(this,"break on read %*a: %#0x",this.g.da),Hd(this,a))))};
l.Sd=function(a,b){this.v||(a==void 0?T(this,"break on unknown write %#0x: %#0x",b):(a=Jd(this,a+b,R.$a))&&!a.disabled&&T(this,"break on write %*a: %#0x",this.g.da))};function T(a,b,c){b=a.K.apply(a,[b].concat(oa(c)));a.o("%s\n",b);Ec(a.time)}function Od(a,b,c){c=c===void 0?a.g:c;return E(a,b.V,a.ea,c.da,"")}
function Pd(a,b,c){c=c===void 0?10:c;var d="";if(a.h.length){var e,f=[];c>a.h.length&&(c=a.h.length);b<0&&(b=c);var g=a.S-b;for(g<0&&(g+=a.h.length);g>=0&&g<a.h.length&&c>0;){var h=a.h[g++];if(h==void 0)break;g==a.h.length&&(g=0);e?e.V=h:e=md(h);for(h=0;h<a.ja;h++)f[h]=vd(a,e,1);sd(a,e,-f.length);d+=a.Nb(e,f,a.K("[%6d]",b--));c--}}return d||"no history"}
function id(a,b,c){var d=[],e="";for(b=typeof b=="number"?md(b):b;c--;){for(sd(a,b,d.length);d.length<a.ja;)d.push(vd(a,b,1));sd(a,b,-d.length);e+=a.Nb(b,d)}return e}
function Qd(a,b,c,d,e,f){var g="";f=f?a.j:a.g;c||(c=f.j);var h=c>>3;d||(d=128);var k=0,n=d+15>>4||1,m=h==4?16:a.ea;e=="y"&&(m=h,n=d,k=h*8);b||(b=a.oa);for(;n--&&d>0;){var r=e=0,p,q="",v="",u=Od(a,b,f);for(p=m;p>0&&d>0;p--){var y=vd(a,b,1,f);e|=y<<(r++<<3);r==h&&(q+=E(a,e,0,c,""),q+=h==1?p==9?"-":" ":" ",k&&(v+=E(a,e,2,c,"")),e=r=0);k||(v+=y>=32&&y<127?String.fromCharCode(y):".");d--}g&&(g+="\n");g+=u+"  "+q+" "+v}a.oa=b;return g}
l.$d=function(){var a=[];yb(this,function(b){b.cb&&b.cb(a);return!0});return JSON.stringify(a,null,2)};function Rd(a,b,c,d){var e=0,f="";d=d?a.j:a.g;for(var g=0;b!=void 0&&g<c.length;g++){var h=vd(a,b,0,d);if(h==void 0)break;var k=a,n=b,m=c[g],r=d;r=r===void 0?k.g:r;k.v++;r.eb(n.V,m);k.v--;f+=a.K("%*a: %#*n changed to %#*n\n",a.g.da,b,a.g.j,h,a.g.j,c[g]);sd(a,b,1,d);e++}e||(f+=a.K("%d locations updated\n",e));a.time.update();return f}
function Gd(a,b){var c="";b!=void 0&&b==!a.h.length&&Yc(a.g,function(d){b?a.g.ob(d.ia,a.l[R.Ba]):a.g.pb(d.ia,a.l[R.Ba])})&&(b?(a.S=0,a.h=Array(Sd)):a.h=[]);return c+=a.K("instruction history %s\n",a.h.length?"enabled":"disabled")}l.wa=function(a){var b=a.shift();return this.R==b?(hb(this,a.shift()),this.X.pa=a.shift(),!0):!1};l.Sc=function(a){Ja(this.ka,a)?T(this,"break on message"):this.time.S=!0};
l.ee=function(a){var b=a[1],c=a[2],d=[],e=[],f=!1,g="";this.O=void 0;if(c=="*")var h=-2;else{h=Ia(c);h==void 0&&(h=-1);var k=od(this,c,e);if(k===null)return}var n=0;a[3]&&(n=Ia(a[3].substr(a[3][0]=="l"?1:0))||8);for(var m=3;m<a.length;m++)d.push(Ia(a[m],16));if(b=="d"){m=nd(this,c,d);if(m!=void 0)return m;b=this.T||b}if(b[0]!="s"&&e.length)return"unrecognized symbol(s): "+e;switch(b[0]){case "b":b[1]=="c"?g=this.Fb(h):b[1]=="d"?g=this.Gb(h):b[1]=="e"?g=this.Gb(h,!0):b[1]=="i"?g=Ld(this,k,R.Ta):b[1]==
"l"?g=Kd(this):b[1]=="m"?g=Nd(this,c):b[1]=="n"?g=Md(this,h):b[1]=="o"?g=Ld(this,k,R.Ua):b[1]=="r"?g=Ld(this,k,R.Ba):b[1]=="w"?g=Ld(this,k,R.$a):b[1]=="?"?(g="break commands:\n",Td.forEach(function(r){g+=r+"\n"})):b[1]&&(g=void 0);break;case "d":this.T=b;if(b[1]!="b"&&b[1])if(b[1]=="w")c=16;else if(b[1]=="d")c=32;else if(b[1]=="i"){if(!this.j){g="invalid bus";break}c=this.j.j;n=n||1;f=!0}else{if(b[1]=="h")this.T="",g=Pd(this,h,n);else if(b[1]=="?"){if(this.T="",g="dump commands:\n",Ud.forEach(function(r){g+=
r+"\n"}),this.J.length)for(g+="dump extensions:\n",b=0;b<this.J.length;b++)k=this.J[b],g+=this.K("d   %-12s%s\n",k.name,k.Yd)}else this.T="",g=void 0;break}else c=8;g=Qd(this,k,c,n,b[2],f);break;case "e":if(b[1]=="o"){if(!this.j){g="invalid bus";break}f=!0}else if(b[1]){g=void 0;break}g=Rd(this,k,d,f);break;case "g":if(this.time.start()){if(k!=void 0){Hd(this);g=Ld(this,k);if(g.indexOf(":")!=2)break;this.U=k;g=""}break}g="already started\n";break;case "h":Ec(this.time)||(g="already stopped\n");break;
case "p":a.shift();a.shift();b=a.join(" ");g+=this.K("%s = %s\n",b,E(this,ud(this,b)));break;case "r":if(b=b.substr(1).toUpperCase()){if(Ab(this.H,b)==void 0){g+=this.K("unrecognized register: %s\n",b);break}k!=void 0&&Fb(this.H,b,k.V)}this.ca.V=this.H.Ya;g+=this.H.toString();break;case "s":k=ib(c);if(b[1]=="h"){if(this.ga||this.I>0)k=void 0;g=Gd(this,k);k!=void 0&&(this.ha=k)}else b[1]=="p"?h>0?(Bc(this.time,h),g="target speed:  "+Hc(this.time.u)):g="current speed: "+Pc(this.time):b[1]=="s"&&this.va?
(h=this.va.indexOf(c),h>=0&&(this.style=this.va[h]),g="style: "+this.style):b[1]=="?"?(g="set commands:\n",Vd.forEach(function(r){g+=r+"\n"})):g=void 0;break;case "t":n=Ia(c,10)||1;this.O=!0;if(b[1]){if(b[1]!="r"){g=void 0;break}this.O=!1}Jc(this.time,n);break;case "u":if(b[1]){g=void 0;break}n||(n=8);k||(k=this.ca);g+=id(this,k,n);this.ca=k;break;case "?":g="debugger commands:\n";Wd.forEach(function(r){g+=r+"\n"});break;default:g=void 0}g==void 0&&a[0]&&(g="unrecognized command '"+a[0]+"' (try '?')\n");
return g};l.Hb=function(a){return a&&this.wa(a[0])?(a.shift(),!0):!1};l.cb=function(a){var b=[];this.xa(b);a.push(b);this.$=0};l.Tc=function(a){if(a){if(this.time.g){if(this.$&&this.input){a=this.input;var b=a.i;b&&Bb(a.X)&&(a.o(2097152,'setFocus("%s")\n',b.id||b.nodeName),b.focus(),b.scrollIntoView())}}else this.O?this.Na(id(this,this.H.Ya,1)):(this.Z&&(this.H.o("%d instructions executed\n",this.Z),this.Z=0),this.H.Na(this.H.toString()),this.O==void 0&&this.$&&(a=this.Sa(Pa.hb,!0))&&a.focus());this.$++}};
l.xa=function(a){a.push(this.R);a.push(Kd(this,!0));a.push(this.X.pa)};l.Nb=function(a,b,c){var d=this.K,e=Od(this,a);b=b.shift();sd(this,a,1);return d.call(this,"%s %02x       unsupported       ; %s\n",e,b,c||"")};
var Wd="b?\t\tbreak commands;d?\t\tdump commands;e[o] [addr] ...\tedit memory/ports;g    [addr]\trun (to addr);h\t\thalt;p    [expr]\tparse expression;r?   [value]\tdisplay/set registers;s?\t\tset commands;t[r] [n]\tstep (n instructions);u    [addr] [n]\tunassemble (at addr)".split(";"),Td="bc [n|*]\tclear break address;bd [n|*]\tdisable break address;be [n|*]\tenable break address;bl [n]\t\tlist break addresses;bi [addr]\tbreak on input;bo [addr]\tbreak on output;br [addr]\tbreak on read;bw [addr]\tbreak on write;bm [on|off]\tbreak on message;bn [count]\tbreak on instruction count".split(";"),
Ud="db  [addr]\tdump bytes (8 bits);dw  [addr]\tdump words (16 bits);dd  [addr]\tdump dwords (32 bits);di  [addr]\tdump input ports;d*y [addr]\tdump values in binary;dh  [n] [l]\tdump instruction history buffer;ds\t\tdump machine state".split(";"),Vd=["sh [on|off]\tset instruction history","sp [n]\t\tset speed multiplier","ss\t\tset debugger style"],td={Bc:1,vd:0,wd:2,jg:0},R={Ba:0,$a:1,Ta:2,Ua:3},Xd={},Fd=(Xd[R.Ba]="br",Xd[R.$a]="bw",Xd[R.Ta]="bi",Xd[R.Ua]="bo",Xd),Yd={ud:"PC"},Zd={BYTE:1,td:2,xd:4,
oc:5,Yb:6,Kd:7},pd={"=":Zd.Kd,1:Zd.BYTE,2:Zd.td,4:Zd.xd,"@":Zd.oc,";":Zd.Yb},Sd=1E5,Cd={"||":5,"&&":6,"!":7,"|":7,"^!":8,"&":9,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,_:19,"^_":19,"{":20,"}":20},Bd={",,":1,"||":5,"&&":6,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,"!":15,"|":15,"^!":15,"&":15,_:19,"^_":19,"{":20,"}":20};function $d(a,b,c){jd.call(this,a,b,c)}w($d,jd);
function ae(a,b,c){jd.call(this,a,b,c);this.model=+this.config.model||be;this.T=+this.config.addrReset||0;this.u=N(this,"Bus");this.u.J=this.pd.bind(this);this.ce=N(this,"IOPage");N(this,"Panel",!1);this.I=0;this.Wa=null;this.input=N(this,"Input",!1);this.model<=ce?(this.Hc=this.Qd,this.Jc=~(de|ee|fe|ge)&65535,this.Rb=0):(this.Hc=this.Rd,this.Jc=~(de|(this.model<=he?ee:0))&65535,this.Rb=this.model>he?ee:0);this.Bb=this.Ab=this.la=0;this.l=null;this.Pa=[];ie(this)}w(ae,$d);
function ie(a){a.ca=65536;a.ha=32768;a.ja=65535;a.ga=32768;a.W=15;a.h=[0,0,0,0,0,0,0,a.T,-1,-2,-3,-4,-5,-6,-7,-8];a.Z=[0,0,0,0,0,0];a.va=[0,0,0,0];a.Ea=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];a.Ia=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];a.Ma=
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];a.Lc=[0,0,0,0,0,0,0,0];a.i=0;a.v=-1;a.Kc=0;a.g=0;je(a);for(var b={Ka:0};b.Ka<=7;b={Ka:b.Ka},b.Ka++)M(a,"R"+b.Ka,function(c){return function(){return a.h[c.Ka]}}(b),function(c){return function(d){return a.h[c.Ka]=d&65535}}(b));xb(a,"R6","SP");xb(a,"R7",Yd.ud);M(a,"CF",function(){return a.ca&65536&&me?1:0},function(c){a.ca=c?65536:0});M(a,"NF",function(){return a.ga&32768&&ne?1:0},function(c){a.ga=c?32768:0});M(a,"VF",function(){return a.ha&
32768&&oe?1:0},function(c){a.ha=c?32768:0});M(a,"ZF",function(){return(a.ja&65535?0:pe)?1:0},function(c){a.ja=c?0:1});M(a,"PS",function(){return qe(a)},function(c){return re(a,c)});M(a,"PI",function(){return a.ta},function(c){if(c&=se){var d=c>>te;do c+=ue;while(d>>=1);a.g|=ve}a.ta=c});M(a,"ER",function(){return a.sa});M(a,"SL",function(){return a.M&65280},function(c){a.M=c|255});M(a,"M0",function(){return we(a)},function(c){return xe(a,c)});M(a,"M1",function(){return ye(a)});M(a,"M2",function(){return ze(a)});
M(a,"M3",function(){return a.J},function(c){return Ae(a,c)})}function je(a){a.j=0;a.ma=0;a.oa=0;a.J=0;a.sa=0;a.ta=0;a.M=255;a.U=0;a.O=0;a.S=0;a.L=262143;a.Ic=[4,2,0,1];a.N=a.h[7];a.m=0;a.l=null;Be(a);for(var b=a.u,c=Q.Ra,d=0,e=0;e<b.g.length;e++){var f=b.g[e];f.type&c&&(d=f.ia+f.size)}a.be=d}l=ae.prototype;l.Tc=function(){};function we(a){var b=a.j;b&Ce||(b=b&~(De|Ee|Fe)|a.O<<5|a.S<<1);return b}
function xe(a,b){b&=~De;if(a.j!=b){b&Ce&&!(a.j&Ce)&&(a.ma=a.m>>16&65535,a.oa=a.m&65535);a.j=b;a.O=(b&Fe)>>Ge;a.S=(b&Ee)>>He;var c=0;b&(Ie|Je)&&(c=Ke,b&Ie&&(c|=Le));a.U!=c&&(a.U=c,Be(a))}}function ye(a){a.j&Ce||(a.ma=a.m>>16&65535);a=a.ma;a&65280&&(a=(a<<8|a>>8)&65535);return a}function ze(a){a.j&Ce||(a.oa=a.m&65535);return a.oa}function Ae(a,b){a.model<be&&(b&=~(Me|Ne));a.J!=b&&(a.J=b,a.L=b&Me?Oe:Pe,Be(a))}
function Be(a){a.Wa&&Zc(a.u,a.I,a.Wa);a.U?(a.Qa=Qe,a.I=a.J&Me?Re:Se,a.Xa=a.ve,a.Rc=a.Se):(a.Qa=0,a.I=Te,a.Xa=a.ue,a.Rc=a.Re);a.Wa=Zc(a.u,a.I,a.ce)}
l.wa=function(a){if(!a||!a.length)return this.o("invalid saved state\n"),!1;var b=a.shift(),c=a.shift();if(b!=this.R||(c|0)!==3)return this.o("CPU state mismatch (%s %3.2f)\n",b,c),!1;try{this.h=a.shift();this.Z=a.shift();this.va=a.shift();this.Ea=a.shift();this.Ia=a.shift();this.Ma=a.shift();this.Lc=a.shift();this.sa=a.shift();this.Kc=a.shift();this.ta=a.shift();this.M=a.shift();this.O=a.shift();this.S=a.shift();this.N=a.shift();this.g=a.shift();this.m=a.shift();this.v=a.shift();this.Ab=a.shift();
this.Bb=a.shift();this.T=a.shift();re(this,a.shift());xe(this,a.shift());this.ma=a.shift();this.oa=a.shift();Ae(this,a.shift());for(var d=a.shift(),e=d.length-1;e>=0;e--){a:{for(a=0;a<this.Pa.length;a++){var f=this.Pa[a];if(f.rb===d[e]){var g=f;break a}}g=null}g&&(g.next=this.l,this.l=g)}}catch(h){return this.o("CPU state error: %s\n",h.message),!1}return!0};
l.xa=function(a){a.push(this.R);a.push(3);a.push(this.h);a.push(this.Z);a.push(this.va);a.push(this.Ea);a.push(this.Ia);a.push(this.Ma);a.push(this.Lc);a.push(this.sa);a.push(this.Kc);a.push(this.ta);a.push(this.M);a.push(this.O);a.push(this.S);a.push(this.N);a.push(this.g);a.push(this.m);a.push(this.v);a.push(this.Ab);a.push(this.Bb);a.push(this.T);a.push(qe(this));a.push(we(this));a.push(ye(this));a.push(ze(this));a.push(this.J);for(var b=a.push,c=[],d=this.l;d;)c.push(d.rb),d=d.next;b.call(a,c)};
function Ue(a,b,c){b={rb:b,priority:4,message:c||0,name:Ve[b],next:null};a.Pa.push(b);return b}function We(a,b){if(b){if(b!=a.l){var c=a.l;if(!c||c.priority<=b.priority)b.next=c,a.l=b;else{do{var d=c.next;if(!d||d.priority<=b.priority){b.next=d;c.next=b;break}c=d}while(c)}}a.g|=ve;a.o(1024+b.message,"setIRQ(vector=%o,priority=%d)\n",b.rb,b.priority+")")}}function qe(a){return a.W=a.W&(ge|fe|ee|Xe|Ye)|(a.ga&32768?ne:0)|(a.ja&65535?0:pe)|(a.ha&32768?oe:0)|(a.ca&65536?me:0)}
function re(a,b){b&=a.Jc;a.ga=b<<12;a.ja=~b&4;a.ha=b<<14;a.ca=b<<16;if((b^a.W)&a.Rb)for(var c=a.Z.length;--c>=0;){var d=a.h[c];a.h[c]=a.Z[c];a.Z[c]=d}a.i=b>>Ze&$e;c=a.W>>Ze&$e;a.i!=c&&(a.va[c]=a.h[6],a.h[6]=a.va[a.i]);a.W=b;a.g&=~af;a.g|=a.l?af:ve}l.pd=function(a,b){b<=3&&(this.H.sa|=bf);cf(this,df,0,a)};
function cf(a,b,c,d){a.o(4096,"trap to vector %o (%o: %s)\n",b,d,d<0?ef[-d]:"BUS ERROR");if(!a.la){a.v<0?a.v=qe(a):a.i||(d=ff);d==ff&&(a.g&gf&&(d=hf),a.g|=gf,a.sa|=jf,a.h[6]=b=4);if(d!=hf){a.m=b|4143316992;a.i=0;var e=a.Xa(b|a.Qa),f=a.Xa(b+2&65535|a.Qa);re(a,f&~fe|a.v>>2&fe);kf(a,a.v);kf(a,a.h[7]);a.h[lf]=e&65535}a.g&=~(c|mf|nf);a.g|=ve|of;a.v=-1;a.Ab=d;a.Bb=b;d==hf&&Ec(a.time);if(d>=ff)throw b;}}function pf(a,b){var c=b>>13&31;c<31&&(b=a.J&Ne?a.Ma[c]+(b&8191)&Oe:b&~qf);return b}
function rf(a,b,c){if(!(c&a.U)){var d=b&65535;d>=Te&&(d|=a.I);return d}var e=b>>13;a.J&a.Ic[a.i]||(e&=7);var f=a.Ia[a.i][e];d=(a.Ea[a.i][e]<<6)+(b&8191)&a.L;d>=qf&&(d=pf(a,d));if(a.la)return d;d>=a.be&&d<a.I?(a.sa|=sf,cf(a,df,0,d)):d&1&&!(c&tf)&&(a.sa|=uf,cf(a,df,0,d));var g=0;switch(f&vf){case wf:g=xf;case yf:f|=zf;c&Ke&&(g=Af);break;case Bf:g=xf;case Cf:c&Ke&&(g=xf);case Df:f|=c&Ke?zf|Ef:zf;break;default:g=Ff}(f&(Gf|Hf))!=Gf&&(f&Hf?f&Gf&&(b&8128)<(f>>2&8128)&&(g|=If):(b&8128)>(f>>2&8128)&&(g|=If));
a.Ia[a.i][e]=f;if(d!=((Re|Jf)&a.L)||a.i)a.O=a.i,a.S=e;g&&(g&Ce&&(a.v>=0&&(g|=Kf),a.j&Ce||(g|=a.j&xf|a.O<<5|a.S<<1,xe(a,a.j&~Lf|g&Lf)),cf(a,Mf,Nf,Of)),a.j&(Ce|xf)||!(d<((Re|Pf)&a.L)||d>((Re|Qf|1)&a.L))||(a.j|=xf,a.j&Rf&&(a.g|=Nf)));return d}function kf(a,b){var c=a.h[6]-2&65535;a.h[6]=c;a.m=a.m&65535|(a.m&-65536)<<8|16121856;a.g&gf||a.Hc(Sf,-2,c);a.Rc(c,b)}l.Qd=function(a,b,c){!this.i&&b<=0&&c<=this.M&&(this.g|=Tf)};
l.Rd=function(a,b,c){this.i||(c>=65534&&(c|=-65536),a&Ke&&c<=this.M&&(c<=this.M-32?cf(this,df,0,ff):(this.sa|=Uf,this.g|=Tf)))};l.ue=function(a){return this.u.na(this.N=a)};l.ve=function(a){return this.u.na(this.N=rf(this,a,Vf))};l.Re=function(a,b){this.u.fa(this.N=a,b)};l.Se=function(a,b){this.u.fa(this.N=rf(this,a,Sf),b)};
l.toString=function(){var a="";if(this.aa)for(var b="R0 R1 R2 R3 R4 R5  SP PC PS PI SL NF ZF VF CF  M0 M1 M2 M3 ER  SR AR DR".split(" "),c=0;c<b.length;c++){var d=b[c];if(d){var e=16;d[1]=="F"&&(e=1);var f=Ab(this,d);f!=void 0&&(a+=this.aa.K("%s=%*n ",d,e,f))}else a+="\n"}return a};
var ce=1120,he=1140,be=1170,$e=3,me=1,oe=2,pe=4,ne=8,Ye=16,Xe=224,de=1792,ee=2048,fe=12288,ge=49152,Ze=14,se=65024,ue=34,te=9,df=4,Mf=168,hf=-1,Of=-2,ff=-4,ef="UNKNOWN PANIC ABORT ILLEGAL RED YELLOW FAULT TRACE HALT OPCODE INTERRUPT".split(" "),ve=1,af=2,nf=3,mf=16,Tf=32,Nf=64,of=128,gf=256,lf=7,tf=1,Le=2,Ke=4,Qe=65536,jf=4,Uf=8,bf=16,sf=32,uf=64,Ie=1,Ee=30,Fe=96,Kf=128,Je=256,Rf=512,De=3072,xf=4096,Af=8192,If=16384,Ff=32768,Ce=57344,Lf=61694,He=1,Ge=5,Me=16,Ne=32,wf=1,yf=2,Bf=4,Cf=5,Df=6,vf=7,Hf=
8,Ef=64,zf=128,Gf=32512,Pf=62592,Jf=65402,Qf=65470,Ve={48:"DL11R",52:"DL11X",56:"PC11R",60:"PC11X",64:"KW11",112:"RL11",144:"RK11",180:"RX11"},Vf=0|Le,Sf=0|Ke,Te=57344,Se=253952,Re=4186112,Pe=262143,qf=3932160,Oe=4194303;x.PDP11=ae;function Wf(a,b,c){ld.call(this,a,b,c);this.ta=Xf;this.N=[];this.H.model<he&&(this.N=this.N.concat(Yf));this.H.model<1145&&(this.N=this.N.concat(Zf));this.ja=6}w(Wf,ld);
Wf.prototype.Nb=function(a,b,c){function d(B){var A=k.H,D=[];if(A.U){var O=A.i<<1,K=B>>13;K>7&&(O|=1);A.J&A.Ic[A.i]||(K&=7);var ke=B&8191,le=A.Ea[A.i][K]<<6;B=le+ke&A.L;B>=qf&&(B=pf(A,B));D.push(B);D.push(ke);D.push(O);D.push(K&7);D.push(le);D.push(A.L)}else B&=65535,B>=Te&&(B|=A.I),D.push(B);return null}function e(B){return $f[B]||"?"}function f(B,A){var D="",O=A&ag;if(O==V)D=a.V+((B&255)<<24>>23)&65535,D=h(D);else if(O==bg)D=a.V-((B&63)<<1)&65535,D=h(D);else if(O==cg)D=E(k,B&7,0,3,"");else if(O==
dg)D=E(k,B&63,0,6,"");else if(O==eg)D=E(k,B&255,0,8,"");else if(B&=A,A&W&&(B>>=6,A>>=6),A&X){O=null;var K=B&7;switch(B&56){case 0:D=e(K);break;case 8:D="@"+e(K);O=d(k.H.h[K]);break;case 16:K<7?D="("+e(K)+")+":(A=g(),D="#"+h(A));break;case 24:K<7?D="@("+e(K)+")+":(A=g(),D="@#"+h(A),O=d(A));break;case 32:D="-("+e(K)+")";break;case 40:D="@-("+e(K)+")";break;case 48:A=g();D=h(A)+"("+e(K)+")";K==7&&(D=h(A=A+a.V&65535),O=d(A));break;case 56:A=g(),D="@"+h(A)+"("+e(K)+")",K==7&&(D="@"+h(A=A+a.V&65535),B=
k.H,B.la++,A=B.u.na(rf(B,A,Vf)),B.la--,O=d(A))}O&&(D=[D,O])}return D}function g(){var B=b.shift()|b.shift()<<8;m+=h(B)+" ";sd(k,a,2);return B}function h(B){return E(k,B,0,16,"")}var k=this,n=Od(this,a),m="",r=rd(this,a,Zd.oc),p=rd(this,a,Zd.Yb),q=g(),v;for(y in this.ta)if(v=this.ta[y][q&y])break;v||(v=fg);var u=v[0];this.N.indexOf(u)>=0&&(v=fg,u=v[0]);var y=gg[u];var z="",C=v.length-1;u||C||(z=h(q));for(u=1;u<=C;u++){var U=v[u];if(U!=void 0){U=f(q,U);if(!U||!U.length){z="INVALID";break}typeof U!=
"string"&&(U=U[0]);z.length>0&&(z+=",");z+=U||"???"}}n=this.K("%s %-21s %-7s %s",n,m,y,z);c?p&&(c+=" "+p):p&&(c=p);c&&(n=this.K("%-32s; %s",n,c));r&&(n=r+":\n"+n);return n+"\n"};
var gg=".WORD ADC ADCB ADD ASL ASLB ASR ASRB BCC BCS BEQ BGE BGT BHI BIC BICB BIS BISB BIT BITB BLE BLOS BLT BMI BNE BPL BPT BR BVC BVS CCC CLC CLCN CLCV CLCVN CLCVZ CLCZ CLCZN CLN CLR CLRB CLV CLVN CLVZ CLVZN CLZ CLZN CMP CMPB COM COMB DEC DECB INC INCB HALT JMP JSR MARK MFPD MFPI MFPS MOV MOVB MTPD MTPI MTPS NEG NEGB NOP RESET ROL ROLB ROR RORB RTI RTS SBC SBCB SCC SEC SECN SECV SECVN SECVZ SECZ SECZN SEN SEV SEVN SEVZ SEVZN SEZ SEZN SUB SWAB SXT TST TSTB WAIT MUL DIV ASH ASHC XOR SOB EMT TRAP SPL IOT RTT MFPT".split(" "),$f=
"R0 R1 R2 R3 R4 R5 SP PC A0 A1 A2 A3 A4 A5 A6 A7 S0 S1 S2 S3 PS PI ER SL M0 M1 M2 M3 AR DR SR".split(" "),X=63,W=4032,V=4096,bg=8192,cg=12288,dg=24576,eg=32768,ag=61440,Xf={61440:{4096:[62,W,X],8192:[47,W,X],12288:[18,W,X],16384:[14,W,X],20480:[16,W,X],24576:[3,W,X],36864:[63,W,X],40960:[48,W,X],45056:[19,W,X],49152:[15,W,X],53248:[17,W,X],57344:[94,W,X]},65024:{2048:[57,448,X],28672:[100,X,448],29184:[101,X,448],29696:[102,X,448],30208:[103,X,448],30720:[104,448,X],32256:[105,448,bg]},65280:{256:[27,
V],512:[24,V],768:[10,V],1024:[11,V],1280:[22,V],1536:[12,V],1792:[20,V],32768:[25,V],33024:[23,V],33280:[13,V],33536:[21,V],33792:[28,V],34048:[29,V],34304:[8,V],34560:[9,V],34816:[106,eg],35072:[107,eg]},65472:{64:[56,X],192:[95,X],2560:[39,X],2624:[49,X],2688:[53,X],2752:[51,X],2816:[67,X],2880:[1,X],2944:[77,X],3008:[97,X],3072:[73,X],3136:[71,X],3200:[6,X],3264:[4,X],3328:[58,dg],3392:[60,X],3456:[65,X],3520:[96,X],35328:[40,X],35392:[50,X],35456:[54,X],35520:[52,X],35584:[68,X],35648:[2,X],
35712:[78,X],35776:[98,X],35840:[74,X],35904:[72,X],35968:[7,X],36032:[5,X],36096:[66,X],36160:[59,X],36224:[64,X],36288:[61,X]},65528:{128:[76,7],152:[108,cg]},65535:{0:[55],1:[99],2:[75],3:[26],4:[109],5:[70],6:[110],7:[111],160:[69],161:[31],162:[41],163:[33],164:[45],165:[36],166:[43],167:[35],168:[38],169:[32],170:[42],171:[34],172:[46],173:[37],174:[44],175:[30],176:[69],177:[80],178:[88],179:[82],180:[92],181:[85],182:[90],183:[84],184:[87],185:[81],186:[89],187:[83],188:[93],189:[86],190:[91],
191:[79]}},fg=[0],Yf=[58,60,65,96,110,100,101,102,103,104,105],Zf=[108,59,64];x.PDP11Dbg=Wf;function hg(a,b,c){cd.call(this,a,b,c);for(var d in ig){var e=ig[d];d=+d;a=e[0];b=e[1];c=e[2];e=e[3];d>=65472&&d<=65487&&(!a&&c&&(a=function(f){return function(g){return f(g)&255}}(c)),!b&&e&&(b=function(f){return function(g,h){return f(g,h)}}(e)));dd(this,this,d,d,a,b,c,e)}this.ra()}w(hg,cd);l=hg.prototype;l.qa=function(){this.H===void 0&&(this.H=N(this,"Debugger"))};
l.wa=function(a){return a&&(a=a.shift(),this.R==a)?!0:!1};l.xa=function(a){a.push(this.R)};l.re=function(a){a=a>>1&63;var b=this.H.Ma[a>>1];return a&1?b>>16:b&65535};l.Oe=function(a,b){a=a>>1&63;var c=a>>1;this.H.Ma[c]=a&1?this.H.Ma[c]&65535|(b&63)<<16:this.H.Ma[c]&-65536|b&65534};var jg={},ig=(jg[61568]=[null,null,hg.prototype.re,hg.prototype.Oe,"UNIMAP",64,be],jg);x.IOPage=hg;Aa.dl11=268435456;
function Y(a,b,c){L.call(this,a,b,c);this.O=+this.config.baudReceive||9600;this.S=+this.config.baudTransmit||9600;this.time=N(this,"Time");this.T=Nb(this.time,this.R+".receive",this.Uc.bind(this));this.U=Nb(this.time,this.R+".transmit",this.De.bind(this));this.ports=N(this,"IOPage");ed(this.ports,this,kg);this.j="";this.i=this.l=this.v=null;this.exports={connect:this.de,receiveData:this.Uc,receiveStatus:this.ye,setConnection:this.Ae};this.ra()}w(Y,L);l=Y.prototype;
l.de=function(a){if(!this.i){var b=zb(this,"connection");if(b){var c=b.split("->");if(c.length==2){var d=c[0].trim();if(d!=this.R)return;c=c[1].trim();if(this.i=vb(this,c)){var e=this.i.exports;if(e){var f=e.connect;f&&f.call(this.i,this.L);if(this.l=e.receiveData){this.L=a;this.v=e.receiveStatus;this.o("Connected %s.%s to %s\n",this.Y,d,c);return}}}}this.o("Unable to establish connection: %s\n",b)}}};
l.wa=function(a){var b=a.shift();return this.R==b?(this.m=a.shift(),this.g=a.shift(),this.h=a.shift(),this.J=a.shift(),!0):!1};l.xa=function(a){a.push(this.R);a.push(this.m);a.push(this.g);a.push(this.h);a.push(this.J)};l.qa=function(){this.H||(this.H=N(this,"CPU"),this.M=Ue(this.H,this.N?-1:48,128),this.u=Ue(this.H,this.N?-1:52,128))};l.ra=function(){this.m=0;this.g=8192;this.h=128;this.J=[]};
l.Uc=function(a){a!=null&&(this.j=typeof a!="number"?a:this.j+String.fromCharCode(a));this.j&&(a=this.j.charCodeAt(0),this.o(128,"receiveByte(%#04x)\n",a),this.I?a=!1:(this.m=a,this.g&128?this.m|=49152:this.g|=128,this.g&64&&We(this.H,this.M),a=!0),a&&(this.j=this.j.substr(1)),this.j&&Sb(this.time,this.T,1E3/Math.round(this.O/10)));return!0};l.ye=function(a){var b=this.g;this.g&=-12289;a&va.$b.ua&&(this.g|=8192);a&va.Vb.ua&&(this.g|=4096);b!=this.g&&(this.g|=32768,this.g&32&&We(this.H,this.M))};
l.Ae=function(a,b){return this.i?!1:(this.i=a,this.l=b,!0)};l.De=function(a){var b=!0;this.h|=128;this.h&64&&We(this.H,this.u);a&&(b=this.l?this.l.call(this.i,a):!1);return b};l.qe=function(){var a=this.g&65534;this.g&=-32769;return a};l.Ne=function(a){var b=a^this.g;this.g=this.g&-112|a&111;this.v&&b&6&&(b=0,this.L?(b|=a&4?va.$b.ua:0,b|=a&2?va.bd.ua|va.Vb.ua:0):(b|=a&4?va.zd.ua:0,b|=a&2?va.cd.ua:0),this.v.call(this.i,b))};l.pe=function(){this.g&=-129;return this.m};l.Me=function(){};l.xe=function(){return this.h};
l.Ue=function(a){if(this.h&128)if(a&64)We(this.H,this.u);else{var b=this.H,c=this.u;if(c){var d=b.l;if(d==c)b.l=c.next;else for(;d;){var e=d.next;if(e==c){d.next=e.next;break}d=e}b.l&&(b.g|=ve);b.o(1024+c.message,"clearIRQ(vector=%o,priority=%d)\n",c.rb,c.priority+")")}}this.h=this.h&-70|a&69};l.we=function(){return 0};
l.Te=function(a){a:{a&=255;this.o(128,"transmitByte(%#04x)\n",a);if(this.W){if(a==19){this.I=!0;break a}if(a==17){this.I=!1;break a}}this.l&&this.l.call(this.i,a);Sb(this.H,this.U,1E3/Math.round(this.S/10))}this.h&=-129};var lg={},kg=(lg[65392]=[null,null,Y.prototype.qe,Y.prototype.Ne,"RCSR"],lg[65394]=[null,null,Y.prototype.pe,Y.prototype.Me,"RBUF"],lg[65396]=[null,null,Y.prototype.xe,Y.prototype.Ue,"XCSR"],lg[65398]=[null,null,Y.prototype.we,Y.prototype.Te,"XBUF"],lg);x.DL11=Y;Aa.pc11=536870912;
function Z(a,b,c){L.call(this,a,b,c);this.name=this.config.name||"PTR";this.h=zb(this,"autoLoad")||"";this.S=+this.config.baudReceive||3600;this.i=this.config.library||[];this.v=null;this.M=window&&"FileReader"in window;this.L=N(this,"Bus");this.time=N(this,"Time");this.T=Nb(this.time,this.R+".reader",this.Ld.bind(this));this.input=N(this,"Input");this.J=null;this.m=this.g=0;this.I=32768;this.j=this.O=0;this.u=[];this.l=mg;this.N=-1;this.ports=N(this,"IOPage");ed(this.ports,this,ng);ab(this,this.i,
this.ge.bind(this))||Cb(this,!1)}w(Z,L);l=Z.prototype;
l.Ja=function(a,b){var c=this,d=mg;switch(a){case "readTape":d=og;case "loadTape":d||(d=pg);b.onclick=function(){var e=c.ba[qg];e&&(e=c.i[e.selectedIndex])&&rg(c,e,d)};break;case "mountTape":this.M?(b.addEventListener("change",function(){var e=b.children[0];e.children[1].disabled=!e.children[0].files.length}),b.onsubmit=function(e){(e=e.currentTarget[1].files[0])&&rg(c,{name:La(e.name,!0),path:e.name},pg,e);return!1}):(this.o("Local tape support not available\n"),b.parentNode.removeChild(b))}L.prototype.Ja.call(this,
a,b)};l.fe=function(){var a=this.ba[sg],b=this.ba[qg],c=b.options[b.selectedIndex];if(a&&c){b={};if(c=c.getAttribute("data-value"))try{b=eval("("+c+")")}catch(d){this.o("PC11 option error: %s",d.message)}c=b.desc;c===void 0&&(c="");b=b.href;b!==void 0&&(c='<a href="'+b+'" target="_blank">'+c+"</a>");a.innerHTML=c}};l.wa=function(a){a=a.shift();return this.R==a?!0:!1};l.xa=function(a){a.push(this.R)};l.qa=function(){this.H||(this.H=N(this,"CPU"),this.J=Ue(this.H,56,536870912))};
l.ra=function(){this.g&=-2241;this.m=0};
function rg(a,b,c,d){var e=b.name,f=b.path;a.o(536870912,'load("%s","%s")\n',e,f);if(!f)return tg(a),!0;if(f==ug)return Ua(a,'Use "Choose File" and "Mount" to select and load a local tape.'),!0;if(f==vg){f=window.prompt("Enter the URL of a remote tape image.","")||"";if(!f)return!1;e=La(f);a.o('Attempting to load %s as "%s"',f,e)}a.l=c;if(d){var g=new FileReader;g.onload=function(){var h=g.result;h&&(b.values=new Uint8Array(h,0,h.byteLength),a.Ib(b));wg(a)};g.readAsArrayBuffer(d);return!1}if(!b.values&&
!ab(a,b.path,a.Ib.bind(a)))return!1;a.Ib(b);return!0}function wg(a){if(a.v){var b=a.ba[qg];if(b&&b.options){var c;for(c=0;c<b.options.length;c++)if(b.options[c].value==a.v.path){b.selectedIndex!=c&&(b.selectedIndex=c);break}c==b.options.length&&(b.selectedIndex=0)}}}function xg(a,b){b|=0;if(b!==a.N){var c=a.ba[yg];c&&(c=(c=c.getElementsByClassName(zg))&&c[0])&&c.style&&(c.style.width=b+"%");a.N=b}}
l.ge=function(a){a=this.i=a||[];var b=this.fe.bind(this),c=qg,d=this.ba[c];if(d){for(var e=0;e<a.length;e++)Tb(this,c,a[e].name,a[e].path);b&&(d.onchange=b)}Tb(this,qg,"None",Ag,!0);this.M&&Tb(this,qg,"Local Tape",ug);Tb(this,qg,"Remote Tape",vg);Cb(this,!0);if(this.h&&typeof this.h=="string"){for(a=0;a<this.i.length;a++)if(b=this.i[a],typeof b=="object"&&b.name==this.h){this.h=b;break}a==this.i.length&&(Ua(this,"Unable to find %s media: %s",this.R),this.h="")}this.h?rg(this,this.h,pg)||Cb(this,!1):
wg(this)};
l.Ib=function(a){var b=a.name,c=a.values,d=a.addrLoad,e=a.addrExec;this.v=a;Cb(this,!0);if(this.l==og){var f=e,g=a=!1;e=!1;if(d==null)for(var h=0;h<c.length-1;){var k=c[h]&255|(c[h+1]&255)<<8;if(k)if(k&255){var n=h;if(k!=1){this.o(536870912,"invalid signature (%#06x) at offset %#06x\n",k,n);break}if(h+6>=c.length){this.o(536870912,"invalid block at offset %#06x\n",n);break}h+=2;var m=c[h++]&255|(c[h++]&255)<<8,r=c[h++]&255|(c[h++]&255)<<8;k+=(m&255)+(m>>8)+(r&255)+(r>>8);for(var p=h,q=m-=6;m>0&&h<
c.length;)k+=c[h++]&255,m--;if(m!=0||h>=c.length){this.o(536870912,"insufficient data for block at offset %#06x\n",n);break}k+=c[h++]&255;if(k&255){this.o(536870912,"invalid checksum (%#04x) for block at offset %#06x\n",k,n);break}if(q)for(this.o(536870912,"loading %#06x bytes at %#06x-%#06x\n",q,r,r+q);q--;)this.L.eb(r++,c[p++]&255);else r&1?g=!0:f==null&&(f=r),f!=null&&this.o(536870912,"starting address: %#06x\n",f);e=!0}else h++;else h+=2}if(!e&&(d==null&&(d=null),d!=null)){for(e=0;e<c.length;e++)this.L.eb(d+
e,c[e]);e=!0}if(e){if(f==null||g)Ec(this.time),a=!1;if(f!=null&&(c=this.H,d=f,c.T=d,c.h[lf]=d&65535,re(c,0),je(c),a)){c.h[0]=0;for(a=1;a<=5;a++)c.h[a]=0;c.h[6]=1024}}e?this.o('Read tape "%s"',b):Ua(this,'No valid memory address for tape "%s"',b)}else this.j=0,this.u=c,this.g&=-32769,this.o('Loaded tape "%s" (%d bytes)',b,c.length),xg(this,0)};function tg(a){a.v=null;a.l&&a.o(a.l==pg?"tape detached":"tape unloaded");a.l=mg;wg(a)}
l.Ld=function(){(this.g&32769)!=1||this.g&128||(this.j<this.u.length?(this.m=this.u[this.j]&255,this.o(536870912,"%s.advanceReader(%d): %#02x\n",this.R,this.j,this.m),this.j++,xg(this,this.j/this.u.length*100)):this.g|=32768,this.g|=128,this.g&=-2049,this.g&64&&We(this.H,this.J))};l.oe=function(){return this.g&65534};l.Le=function(a){a&1&&(this.g&32768?(a&=-2,this.g&64&&We(this.H,this.J)):(this.g&=-129,this.g|=2048,this.m=0,Sb(this.time,this.T,1E3/Math.round(this.S/10))));this.g=this.g&-66|a&65};
l.ne=function(){this.g&=-129;this.g|=2048;return this.m};l.Ke=function(){};l.me=function(){return this.I};l.Je=function(a){this.I=this.I&-65|a&64};l.le=function(){return this.O};l.Ie=function(a){this.O=a&255};
var Ag="",ug="?",vg="??",mg=0,pg=1,og=2,qg="listTapes",sg="descTape",yg="readProgress",zg="progressBar",Bg={},ng=(Bg[65384]=[null,null,Z.prototype.oe,Z.prototype.Le,"PRS"],Bg[65386]=[null,null,Z.prototype.ne,Z.prototype.Ke,"PRB"],Bg[65388]=[null,null,Z.prototype.me,Z.prototype.Je,"PPS"],Bg[65390]=[null,null,Z.prototype.le,Z.prototype.Ie,"PPB"],Bg);x.PC11=Z;
function Cg(a,b,c){L.call(this,a,a);var d=this;this.i=!1;this.u=c;this.h="";this.m=this.l=!1;Cb(this,!1);this.pa=0;b=b.trim();b[0]=="{"?Dg(this,b):(this.h=b,bb(this.h,function(e,f,g,h){g==4&&(!h&&f?(Dg(d,f),Eg(d)):d.o("error (%d) loading configuration: %s\n",h,e))}));window.addEventListener("load",function(){d.m=!0;Eg(d)});window.addEventListener(fb("iOS")?"pagehide":fb("Opera")?"unload":"beforeunload",function(){Fg(d)});window.addEventListener("pageshow",function(){d.i||d.qa(!0)})}w(Cg,L);
Cg.prototype.Ja=function(a,b){var c=this;switch(a){case Gg:b.onclick=function(){c.qa()};break;case Hg:b.onclick=function(){c.ra()}}L.prototype.Ja.call(this,a,b)};
function Eg(a){var b=!0;if(a.l&&a.m){for(var c in a.g){var d=void 0,e=a.g[c];try{d=e["class"],x[d]?d=="Machine"?(a.o("PCjs %s v%3.2f\n%s\n",e.name,3,"Copyright \u00a9 2012-2026 Jeff Parsons <Jeff@pcjs.org>"),a.h&&a.o("Configuration: %s\n",a.h)):new x[d](a.Y,c,e):a.o('unrecognized %s device "%s"\n',d,c)}catch(g){e.optional||(a.o('error initializing %s device "%s": %s\n',d,c,g.message),b=!1),Eb(a,c)}}if(a.j){var f=gb(a);yb(a,function(g){return g.Hb&&!g.Hb(f)?(g.o('unable to restore state for device "%s"\n',
g.R),!1):!0})}Cb(a,!0);Db(a,a.qa.bind(a,b))||a.o("machine %s not ready to power, waiting for device(s)\n",a.Y)}}
function Dg(a,b){try{a.g=JSON.parse(b);var c=a.g[a.Y];if(!c){c=a.g[La(a.h,!0)];if(!c)throw Error("configuration missing machine ID");a.g[a.Y]=c}wb(a,c,["autoSave","autoStart"]);a.j=a.config.autoSave!==!1;a.v=a.config.autoStart!==!1;if(a.u){var d=eval("("+a.u+")"),e;for(e in d)a.config[e]=d[e]}a.l=!0}catch(f){c=f.message,(d=c.match(/position ([0-9]+)/))&&(c+=" ('"+b.substr(+d[1],40).replace(/\s+/g," ")+"...')"),a.o("machine '%s' initialization error: %s\n",a.Y,c)}}
Cg.prototype.qa=function(a){a=a===void 0?!this.i:a;if(Bb(this)){var b=this;a&&this.o("power on\n");yb(this,function(c){c.qa&&c!=b&&(c.config["class"]!="CPU"||b.v&&Bb(b)?c.qa(a):c.time.update(!0));return!0});(this.i=a)||this.o("power off\n")}};Cg.prototype.ra=function(){if(Bb(this)){var a=this;yb(this,function(b){b.ra&&b!=a&&b.ra();return!0});this.o("reset\n")}};function Fg(a){if(a.j){var b=[];yb(a,function(c){c.cb&&c.cb(b);return!0});nb(a,b)}a.qa(!1)}var Gg="power",Hg="reset";
window.PDP11v3=function(a,b,c){var d=new Cg(a,b,c);window.command=function(e){return hb(d,e)};return d};x.Machine=Cg;})()

//# sourceMappingURL=pdp11v3.js.map
