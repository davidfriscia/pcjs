(function(){/*
 https://www.pcjs.org/machines/modules/v3/defines.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/message.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/format.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/stdlib.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/stdio.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/webio.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/device.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/input.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/led.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/monitor.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/time.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/bus.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/memory.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/ram.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/rom.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/cpu.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/debugger.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/pcx86/modules/v3/cpux86.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/pcx86/modules/v3/dbgx86.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/pcx86/modules/v3/video.js (C) 2012-2025 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/machine.js (C) 2012-2025 Jeff Parsons
*/
var p,aa=typeof Object.create=="function"?Object.create:function(a){function b(){}b.prototype=a;return new b},ba=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};
function ca(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var da=ca(this),ea="Int8 Uint8 Uint8Clamped Int16 Uint16 Int32 Uint32 Float32 Float64".split(" ");da.BigInt64Array&&(ea.push("BigInt64"),ea.push("BigUint64"));
function fa(a,b){if(b)for(var c=0;c<ea.length;c++)ha(ea[c]+"Array.prototype."+a,b)}function r(a,b){b&&ha(a,b)}function ha(a,b){var c=da;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))return;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&b!=null&&ba(c,a,{configurable:!0,writable:!0,value:b})}var ia;
if(typeof Object.setPrototypeOf=="function")ia=Object.setPrototypeOf;else{var ja;a:{var ka={a:!0},la={};try{la.__proto__=ka;ja=la.a;break a}catch(a){}ja=!1}ia=ja?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var ma=ia;
function w(a,b){a.prototype=aa(b.prototype);a.prototype.constructor=a;if(ma)ma(a,b);else for(var c in b)if(c!="prototype")if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.af=b.prototype}function na(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}
function A(a){if(!(a instanceof Array)){var b=typeof Symbol!="undefined"&&Symbol.iterator&&a[Symbol.iterator];if(b)a=b.call(a);else if(typeof a.length=="number")a={next:na(a)};else throw Error(String(a)+" is not an iterable or ArrayLike");for(var c=[];!(b=a.next()).done;)c.push(b.value);a=c}return a}function oa(){for(var a=Number(this),b=[],c=a;c<arguments.length;c++)b[c-a]=arguments[c];return b}
r("String.prototype.replaceAll",function(a){return a?a:function(b,c){if(b instanceof RegExp&&!b.global)throw new TypeError("String.prototype.replaceAll called with a non-global RegExp argument.");return b instanceof RegExp?this.replace(b,c):this.replace(new RegExp(String(b).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"),"g"),c)}});
r("Math.trunc",function(a){return a?a:function(b){b=Number(b);if(isNaN(b)||b===Infinity||b===-Infinity||b===0)return b;var c=Math.floor(Math.abs(b));return b<0?-c:c}});r("String.prototype.repeat",function(a){return a?a:function(b){if(this==null)throw new TypeError("The 'this' value for String.prototype.repeat must not be null or undefined");var c=this;if(b<0||b>1342177279)throw new RangeError("Invalid count value");b|=0;for(var d="";b;)if(b&1&&(d+=c),b>>>=1)c+=c;return d}});
r("Number.isNaN",function(a){return a?a:function(b){return typeof b==="number"&&isNaN(b)}});r("Math.log2",function(a){return a?a:function(b){return Math.log(b)/Math.LN2}});
r("Symbol",function(a){function b(g){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c(d+(g||"")+"_"+e++,g)}function c(g,f){this.u=g;ba(this,"description",{configurable:!0,writable:!0,value:f})}if(a)return a;c.prototype.toString=function(){return this.u};var d="jscomp_symbol_"+(Math.random()*1E9>>>0)+"_",e=0;return b});
r("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");ba(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return pa(na(this))}});return a});function pa(a){a={next:a};a[Symbol.iterator]=function(){return this};return a}function qa(a,b){a instanceof String&&(a+="");var c=0,d=!1,e={next:function(){if(!d&&c<a.length){var g=c++;return{value:b(g,a[g]),done:!1}}d=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e}
r("Array.prototype.keys",function(a){return a?a:function(){return qa(this,function(b){return b})}});r("Array.prototype.fill",function(a){return a?a:function(b,c,d){var e=this.length||0;c<0&&(c=Math.max(0,e+c));if(d==null||d>e)d=e;d=Number(d);d<0&&(d=Math.max(0,e+d));for(c=Number(c||0);c<d;c++)this[c]=b;return this}});fa("fill",function(a){return a?a:Array.prototype.fill});r("Number.parseInt",function(a){return a||parseInt});
r("Array.prototype.values",function(a){return a?a:function(){return qa(this,function(b,c){return c})}});function ra(){this.U=""}var sa=new ArrayBuffer(2);(new DataView(sa)).setUint16(0,256,!0);new Uint16Array(sa);var B={Ne:typeof window!="undefined",node:typeof window!="undefined"?{}:global,process:typeof process!="undefined"?process:{},window:typeof window!="undefined"?window:global,document:typeof document!="undefined"?document:{},Wa:{machines:{},components:[],commands:{},files:null}};
B.window.PCjs?B.Wa=B.window.PCjs:B.window.PCjs=B.Wa;var ta=B.process,C=B.Wa.machines,ua=B.Wa.components,D={};D.Defines=ra;var va={all:0xffffffffffff,addr:1,bus:2,fault:4,memory:8,ports:16,chips:32,kbd:64,serial:128,misc:256,cpu:512,mmu:2048,"int":1024,trap:4096,video:8192,monitor:16384,screen:32768,disk:131072,file:65536,time:262144,timer:524288,event:1048576,input:2097152,key:4194304,mouse:8388608,touch:16777216,info:274877906944,warn:549755813888,error:1099511627776,halt:70368744177664,buffer:0x800000000000};
function wa(){this.u={};for(var a=0;a<23;a++)this.u["ACDFGHMNSTWYBbdfjcsoXx%"[a]]=null}wa.prototype.g=function(a,b){return this.u[a]?!1:(this.u[a]=b,!0)};
function xa(){var a=oa.apply(0,arguments);if(a[0]===void 0)a=new Date(Date.now());else if(typeof a[0]==="string"){var b=a[0];b.indexOf(":")<0?b+=" "+(a[1]||"00:00:00 UTC"):b.match(/^[0-9][0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9] [0-9][0-9]:[0-9][0-9]:[0-9][0-9]$/)&&(a[1]||(b+=" UTC"));a=new Date(b)}else a=a[1]===void 0?new Date(a[0]):new Date(Date.UTC.apply(Date,A(a)));return a}
wa.prototype.I=function(a){var b=oa.apply(1,arguments);if(!b||!b.length)return a;var c="",d=a.split(/%([-+ 0#]*)([0-9]*|\*)(\.[0-9]+|)([bwhlL]?)([A-Za-z%])/),e=0,g;for(g=0;g<d.length-6;g+=6){c+=d[g];var f=d[g+5];if(this.u[f]===void 0)c+="%"+d[g+1]+d[g+2]+d[g+3]+d[g+4]+f;else{if(e<b.length){var h=b[e];f!="%"&&e++}else h=b[b.length-1];var k=!1,n=d[g+1],l=n.indexOf("#")>=0,t=n.indexOf("0")>=0,m=d[g+2];m=="*"?(m=h,h=e<b.length?b[e++]:b[b.length-1]):m=+m||0;var q=d[g+3];q=q?+q.substr(1):-1;var v=d[g+4],
u=null,x=0,y="",z="ACDFGHMNSTWY".indexOf(f)>=0&&typeof h!="object"?xa(h):h;switch(f){case "C":c+=isNaN(z.getTime())?void 0:this.I("%#W, %#F %#D, %#Y".replaceAll("#",l?"#":""),z);continue;case "D":h=l?z.getUTCDate():z.getDate();f="d";break;case "A":case "G":case "H":h=l?z.getUTCHours():z.getHours();f=="A"?(h=h<12?"am":"pm",f="s"):(f=="G"&&(h=h?h>12?h-12:h:12),f="d");break;case "F":case "M":h=l?z.getUTCMonth():z.getMonth();f=="F"?(h=ya[h],f="s"):(h++,f="d");break;case "N":h=l?z.getUTCMinutes():z.getMinutes();
f="d";break;case "S":h=l?z.getUTCSeconds():z.getSeconds();f="d";break;case "T":c+=isNaN(z.getTime())?void 0:this.I("%#Y-%#02M-%#02D %#02H:%#02N:%#02S".replaceAll("#",l?"#":""),z);continue;case "W":h=za[l?z.getUTCDay():z.getDay()];f="s";break;case "Y":h=l?z.getUTCFullYear():z.getFullYear(),q>0&&(h%=Math.pow(10,q)),f="d"}switch(f){case "b":c+=h?"true":"false";break;case "d":h=Math.trunc(h),q>=0&&(t=!0,m<q&&(m=q),q=-1);case "f":h=+h;f=h+"";q>=0&&(f=h.toFixed(q));f.length<m&&(t?(h<0&&(m--,f=f.substr(1)),
f=("0".repeat(m)+f).slice(-m),h<0&&(f="-"+f)):f=(" ".repeat(m)+f).slice(-m));c+=f;break;case "j":c+=JSON.stringify(h,null,m||void 0);break;case "c":h=typeof h=="string"?h[0]:String.fromCharCode(h);case "s":if(h!=void 0)for(typeof h!="string"&&(h=h.toString()),q>=0&&(h=h.substr(0,q));h.length<m;)h=n.indexOf("-")>=0?h+" ":" "+h;c+=h;break;case "B":x=2,l&&(y="0b");case "o":x||(x=8),!y&&l&&(y="0o");case "X":u=Aa;case "x":f="";x||(x=16);!y&&l&&(y="0x");u||(u=Ba);typeof h=="string"&&h[0]=="-"&&(k=!0,h=
h.slice(1));h=Math.trunc(h);k&&(h=-h);h<0&&((h|0)==h?h>>>=0:Math.abs(h)<=9007199254740992&&(h+=9007199254740992));q>=0&&(t=!0,m<q&&(m=q));t&&!m&&(v=="b"?m=2:v=="h"||v=="w"?m=4:v=="l"?m=8:(m=Math.abs(h),m=m<=255?2:m<=65535?4:m<=4294967295?8:9),m+=y.length);m-=y.length;do k=16,Number.isNaN(h)||(k=h&x-1,h=Math.trunc(h/x)),t||!f||k||h?f=u[k]+f:(y&&(f=y+f,y=""),m>0&&(f=" "+f));while(--m>0||h);c+=y+f;break;case "%":c+="%";break;default:c=this.u[f]?c+this.u[f](f,n,m,q,h):c+("(unimplemented sprintf type: %"+
f+")")}}}return c+=d[g]};var za="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ya="January February March April May June July August September October November December".split(" "),Ba="0123456789abcdef?",Aa="0123456789ABCDEF?";function Ca(){ra.apply(this,arguments)}w(Ca,ra);
function Da(a,b){if(a){b||(b=10);var c,d=a.indexOf(",")>0;d&&(a=a.replace(/,/g,""));var e=c=a.charAt(0);c=="#"?(b=8,c=""):c=="$"&&(b=16,c="");e!=c?a=a.substr(1):(e=c=a.substr(0,2),c=="0b"&&d||c=="^B"?(b=2,c=""):c=="0o"||c=="^O"?(b=8,c=""):c=="^D"?(b=10,c=""):c=="0x"&&(b=16,c=""),e!=c&&(a=a.substr(2)));e=c=a.slice(-1);c=="Y"||c=="y"?(b=2,c=""):c=="."?(b=10,c=""):c=="H"||c=="h"?(b=16,c=""):c=="K"?c="000":c=="M"?c="000000":c=="G"&&(c="000000000");e!=c&&(a=a.slice(0,-1)+c);var g;e=0;b<=10&&(c=a.match(/(-?[0-9]+)B([0-9]*)$/))&&
(a=c[1],e=35-((c[2]||35)&255));if((b&&b!=10?b==16?a.match(/^-?[0-9a-f]+$/i)!==null:b==8?a.match(/^-?[0-7]+$/)!==null:b==2&&a.match(/^-?[01]+$/)!==null:a.match(/^[+-]?[0-9]+$/)!==null)&&!isNaN(g=parseInt(a,b))){e&&(g<0&&(g+=68719476736),g=e>0?g*Math.pow(2,e):Math.trunc(g/Math.pow(2,-e)));var f=g}}return f}
function E(a,b,c,d,e){d=d===void 0?0:d;var g=g===void 0?0:g;var f="",h="",k=-1;c||(c=a.ca||10);d&&(k=Math.ceil(d/Math.log2(c)));if(e==void 0)switch(c){case 8:e="0o";break;case 16:e="0x";break;case 10:h=".";default:e=""}isNaN(b)||typeof b!="number"?(b=void 0,e=h=""):(b<0&&b>-1&&(b=-1),d&&(b<0&&(b+=Math.pow(2,d)),b>=Math.pow(2,d)&&(k=Math.ceil(Math.log(b)/Math.log(c)))));for(a=g||-1;k--;){a||(f=","+f,a=g);if(b==void 0){if(f="?"+f,k<0)break}else if(d=b%c,b=Math.trunc(b/c),d+=d>=0&&d<=9?48:55,f=String.fromCharCode(d)+
f,!b&&k<0)break;a--}return e+f+h}function Ea(a,b){var c=a/F|0,d=b/F|0;return(a&b)==(b|0)&&(c&d)==d}var F=4294967296;D.StdLib=Ca;function G(){Ca.call(this);this.format=new wa;this.Ob=this.format.g.bind(this.format);this.u=this.format.I.bind(this.format)}w(G,Ca);G.prototype.flush=function(){var a=Fa;Fa="";this.za(a)};function Ga(a){var b=a,c=a.lastIndexOf("/");c>=0&&(b=a.substr(c+1));c=b.indexOf("&");c>0&&(b=b.substr(0,c));c=b.lastIndexOf(".");c>0&&(b=b.substring(0,c));return b}
G.prototype.za=function(a,b){var c=a.length,d=a.lastIndexOf("\n");b?d>=0&&(b=Date.now(),Ha||(Ha=b),a=((b-Ha)/1E3).toFixed(3)+": "+a,c=a.length):this.U=="node"?(ta.$e.write(a),a=""):(d>=0&&(console.log(Fa+a.slice(0,d)),Fa="",a=a.slice(d+1)),Ha=null);Fa+=a;return c};G.prototype.m=function(a){return this.za(this.u.apply(this,[a].concat(A(oa.apply(1,arguments)))))};var Fa="",Ha=null;D.StdIO=G;
function H(a){G.call(this);this.V={};this.ga=0;this.I=this;a&&(this.I.ga=0,this.I.ua=[],this.I.la=0,this.I.La={},this.I.Ka=!1)}var Ia;w(H,G);p=H.prototype;p.xa=function(a,b){var c=this,d=this;this.V[a]=b;switch(a){case Ja.vc:b.onclick=function(){var e=c.sa(Ja.Oa,!0);e&&(e.value="")};break;case Ja.Oa:Ka(b),b.addEventListener("keydown",function(e){La(d,e,!0)}),b.addEventListener("keypress",function(e){La(d,e)})}};function Ma(a,b){var c=Na.yb;a.I.La[c]||(a.I.La[c]=[]);a.I.La[c].push(b)}
function Ka(a){a.setAttribute("autocapitalize","off");a.setAttribute("autocomplete","off");a.setAttribute("autocorrect","off");a.setAttribute("spellcheck","false");a.value=""}p.error=function(a,b){b=this.u.apply(this,[a].concat(A(b)));var c="%s";a=!1;typeof c=="boolean"&&(a=c,c=b.shift());if(b=this.u.apply(this,[c].concat(A(b))))this.m("%s\n",b),a||alert(b)};p.sa=function(a){return this.V[a]};
function Oa(a,b,c){if(a){do{for(var d=0;d<Pa.length;d++){var e=Pa[d];if(c){if(e+=c,b+e in a)return e}else if(e=e?e+b[0].toUpperCase():b[0],e+=b.substr(1),e in a)return e}if(b.indexOf("screen")<0)break;b=b.replace("screen","Screen")}while(1)}return null}function Qa(a,b){return a.config.bindings&&a.config.bindings[b]}function Ra(a){if(a=a.V[Sa])var b=a.textContent;return b}function Ta(a,b,c){a=+a||0;a<b&&(a=b);a>c&&(a=c);return a}
function I(a,b,c,d){a=a.config[b];a===void 0?a=c:(d&&d[a]!==void 0&&(a=d[a]),d=typeof c,typeof a!=d&&(d=="boolean"?a=!!a:typeof c=="number"&&(a=+a)));return a}
function Ua(a,b){var c=0,d=null,e=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");e.onreadystatechange=function(){e.readyState!==4?b(a,d,e.readyState,c):(d=e.responseText,e.status==200||!e.status&&d.length&&(window?window.location.protocol:"file:")=="file:"||(c=e.status||-1),b(a,d,e.readyState,c))};e.open("GET",a,!0);e.send()}
function Va(){var a,b=Ia;if(!b){b={};if(window){a||(a=window.location.search.slice(1));for(var c,d=/\+/g,e=/([^&=]+)=?([^&]*)/g;c=e.exec(a);)b[decodeURIComponent(c[1].replace(d," ")).trim()]=decodeURIComponent(c[2].replace(d," ")).trim()}Ia=b}return b}function Wa(a){if(J.bb===void 0){var b=!1;if(window)try{window.localStorage.setItem(J.Ea,J.Ea),b=window.localStorage.getItem(J.Ea)==J.Ea,window.localStorage.removeItem(J.Ea)}catch(c){a.m("%s\n",c.message),b=!1}J.bb=b}return!!J.bb}
function Xa(a,b){b=b===void 0?0:b;b>1&&b%2&&b--;b=b||a.ga;return(b|1)==-1||Ea(a.I.ga,b)?!0:!1}function Ya(a){if(window){var b=window.navigator.userAgent;return a=="iOS"&&(!!b.match(/(iPod|iPhone|iPad)/)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1)||a=="MSIE"&&!!b.match(/(MSIE|Trident)/)||b.indexOf(a)>=0}return!1}function Za(a){var b=null;if(Wa(a)){var c;if(window)try{(c=window.localStorage.getItem(a.M))&&(b=JSON.parse(c))}catch(d){a.m("%s\n",d.message)}}return b}
function La(a,b,c){b=b||window.event;var d=b.which||b.keyCode;if(d){var e=a.I,g=b.target;if(c){a=!1;var f;c=g.value;var h=c.lastIndexOf("\n");d==K.ub&&g.selectionStart<=h+1&&(a=!0);d==K.$c?(a=!0,e.la>0&&(f=e.ua[--e.la])):d==K.zc&&(a=!0,e.la<e.ua.length&&(f=e.ua[++e.la]||""));a&&b.preventDefault();f!=void 0&&(g.value=c.substr(0,h+1)+f)}else d=String.fromCharCode(d),f=g.value,c=f.lastIndexOf("\n"),g.selectionStart<=c&&g.setSelectionRange(f.length,f.length),b.stopPropagation(),d=="@"&&e.la>0&&c+1==f.length&&
(g.value+=e.ua[--e.la],d="\r"),d=="\r"&&(b.preventDefault(),f=g.value+="\n",g.blur(),g.focus(),(b=$a(a,f.slice(f.lastIndexOf("\n",f.length-2)+1,-1)||""))&&a.m("%s\n",b.replace(/\n$/,"")))}}function ab(a){window&&window.addEventListener("resize",a)}function bb(a){return a=="true"||a=="on"?!0:a=="false"||a=="off"?!1:void 0}
function cb(a,b){if(b!=void 0){var c=a.I;try{if(b=b.trim())c.la<c.ua.length&&b==c.ua[c.la]?c.la++:(c.ua.push(b),c.la=c.ua.length);var d=b.split(" "),e=d[0],g=a.I.La[Na.yb];switch(e[0]){case "m":if(e[1]=="?"){var f="";db.forEach(function(t){f+=t+"\n"});f&&(f="message commands:\n"+f);break}f="";var h=void 0;e=d[d.length-1].toLowerCase();var k=bb(e);k!=void 0&&d.pop();d.length<=1&&(k!=void 0&&(h=k,k=void 0),d[1]="all");d[1]=="all"&&(d=Object.keys(va));for(g=1;g<d.length;g++){e=d[g];var n=va[e];if(!n){f+=
"unrecognized message: "+e+"\n";break}k!=void 0&&eb(a,n,k);if(h==void 0||h==Xa(a,n))f+=a.u("%8s: %b\n",e,Xa(a,n))}Xa(a,0x800000000000)&&(f+="all messages will be buffered until buffer is turned off\n");f||(f="no messages\n");break;case "?":f="",fb.forEach(function(t){f+=t+"\n"}),f&&(f="default commands:\n"+f);default:if(d.unshift(b),g)for(a=0;a<g.length;a++){var l=g[a](d);if(l!=void 0){f=f?f+l:l;break}}}}catch(t){f="error: "+t.message+"\n"}}return f}
function $a(a,b){b=b===void 0?"?":b;if(b){var c="";b=b.split(/(?:\n|;\s*)/);for(var d=0;d<b.length;d++)c+=cb(a,b[d])}return c}
p.za=function(a,b){b==void 0&&(b=Xa(this,0x800000000000));if(!b){var c=this.sa(Ja.Oa,!0);if(c){b=c.selectionStart;for(var d=a.split(/([\n\r\b])/),e=0;e<d.length;e++){var g=d[e];if(g)if(g=="\b"||g=="\r")for(;b>0&&c.value.slice(b-1,b)!="\n"&&(b--,g!="\b"););else if(g=="\n"){for(g="";b<c.value.length&&(g=c.value[b],b++,g!="\n"););g!="\n"&&(c.value+="\r\n",b=c.value.length)}else c.value=c.value.slice(0,b)+g+c.value.slice(b+g.length),b+=g.length}c.focus();c.setSelectionRange(b,b);c.value.length>=8192&&
(c.value=c.value.slice(c.value.length-8192+4096));c.scrollTop=c.scrollHeight;return a.length}}return G.prototype.za.call(this,a,b)};p.m=function(a){var b=oa.apply(1,arguments),c=0;typeof a=="number"&&(c=a,a=b.shift());return Xa(this,c)?(Ea(c,1099511627776)&&(a="error: "+a),Ea(c,549755813888)&&(a="warning: "+a),G.prototype.m.call.apply(G.prototype.m,[this,a].concat(A(b)))):0};function gb(a,b){if(Wa(a)){b=JSON.stringify(b);try{window.localStorage.setItem(a.M,b)}catch(c){a.m("%s\n",c.message)}}}
function hb(a,b,c){(a=a.V[b])&&a.textContent!=c&&(a.textContent=c)}function eb(a,b,c){var d=!1;c?(c=a.I.ga,a.I.ga=(c|b)+(c/F|0|b/F|0)*F):(d=Ea(a.I.ga,0x800000000000)&&Ea(b,0x800000000000),c=a.I.ga,a.I.ga=(c&~b)+((c/F|0)&~(b/F|0))*F);d&&a.flush()}
var Ja={vc:"clear",Oa:"print"},fb=["\u2191 \u2193\t\trecall commands","@\t\trepeat last command","m?\t\tmessage commands"],db=["m\t\tdisplay all messages","m on\t\tdisplay all active messages","m off\t\tdisplay all inactive messages","m all [on|off]\tturn all messages on or off","m ... [on|off]\tturn selected messages on or off"],Na={yb:"command"},ib={Ab:13,ab:65,tb:66,wb:67,Bb:68,E:69,Cb:70,Eb:71,Fb:72,Gb:73,Hb:74,Ib:75,Jb:76,Mb:77,Pb:78,Qb:79,Sb:80,Q:81,Ub:82,Xb:83,$b:84,bc:85,cc:86,ec:87,fc:88,
hc:89,fb:90,a:97,b:98,c:99,d:100,e:101,f:102,Se:103,Te:104,Ue:105,Ve:106,k:107,We:108,Xe:109,n:110,Ye:111,p:112,q:113,r:114,s:115,t:116,cf:117,df:118,w:119,x:120,y:121,z:122},K={ub:8,Xc:9,Ic:10,Ab:13,Uc:16,xc:17,uc:18,Ce:19,cb:20,Ed:27,Wc:32,Fe:33,Ee:34,Dd:35,Zd:36,Lb:37,$c:38,eb:39,Wd:39,zc:40,Td:44,Ge:44,$d:45,Cd:46,Vd:46,Yd:47,ZERO:48,ONE:49,Zc:50,Yc:51,Hc:52,Gc:53,Vc:54,Tc:55,Ac:56,Jc:57,Fc:59,Ec:61,ab:65,tb:66,wb:67,Bb:68,E:69,Cb:70,Eb:71,Fb:72,Gb:73,Hb:74,Ib:75,Jb:76,Mb:77,Pb:78,Qb:79,Sb:80,
Q:81,Ub:82,Xb:83,$b:84,bc:85,cc:86,ec:87,fc:88,hc:89,fb:90,xb:91,Ud:91,Sd:92,Je:93,Xd:93,de:96,ue:96,Rd:96,ee:97,se:97,fe:98,re:98,ge:99,xe:99,he:100,ve:100,ie:101,oe:101,je:102,ze:102,ke:103,te:103,le:104,Be:104,me:105,ye:105,we:106,ne:107,Ae:109,pe:110,qe:111,Fd:112,Jd:113,Kd:114,Ld:115,Md:116,Nd:117,Od:118,Pd:119,Qd:120,Gd:121,Hd:122,Id:123,Kc:144,Rc:145,Dc:173,Sc:186,Bc:187,Bd:188,yc:189,De:190,Le:191,zd:192,ae:219,Ad:220,Ie:221,He:222,Cc:224,be:901,dc:1E3},jb={},kb=(jb[K.Fc]=K.Sc,jb[K.Ec]=K.Bc,
jb[K.Dc]=K.yc,jb[K.Cc]=K.xb,jb),lb={Lb:1,eb:2,ce:3},L={},mb=(L[K.ub]="\b",L[K.Xc]="\t",L[K.Ic]="\n",L[K.Ab]="\r",L[K.Wc]=" ",L[K.ZERO]="0",L[K.ONE]="1",L[K.Zc]="2",L[K.Yc]="3",L[K.Hc]="4",L[K.Gc]="5",L[K.Vc]="6",L[K.Tc]="7",L[K.Ac]="8",L[K.Jc]="9",L[K.ab]="A",L[K.tb]="B",L[K.wb]="C",L[K.Bb]="D",L[K.E]="E",L[K.Cb]="F",L[K.Eb]="G",L[K.Fb]="H",L[K.Gb]="I",L[K.Hb]="J",L[K.Ib]="K",L[K.Jb]="L",L[K.Mb]="M",L[K.Pb]="N",L[K.Qb]="O",L[K.Sb]="P",L[K.Q]="Q",L[K.Ub]="R",L[K.Xb]="S",L[K.$b]="T",L[K.bc]="U",L[K.cc]=
"V",L[K.ec]="W",L[K.fc]="X",L[K.hc]="Y",L[K.fb]="Z",L[K.Lb]="Left",L[K.eb]="Right",L),Pa=["","moz","ms","webkit"],nb={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",
darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",
fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",
lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",
navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",
seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},J={bb:void 0,Ea:"PCjs.localStorage"};D.WebIO=H;
function M(a,b,c,d){a=a===void 0?"default":a;b=b===void 0?a:b;c=c===void 0?{}:c;d=d===void 0?[]:d;H.call(this,a==b);this.M=a;this.U=b;C[this.M]||(C[this.M]={});C[this.M][this.U]&&this.m("warning: machine configuration contains multiple '%s' devices\n",this.U);C[this.M][this.U]=this;this.id=this.M==this.U?this.M:this.M+"."+this.U;ua.push(this);this.I=N(this,this.M);this.ready=!0;ob(this,c,d);this.Ma={};this.Rb=[]}w(M,H);p=M.prototype;p.gb=function(){};p.hb=function(){};
function ob(a,b,c){c=b.overrides||c;if(c.length){var d=Va();for(h in d)if(c.indexOf(h)>=0){var e=d[h],g=Da(e,10);g==void 0&&(e=="true"?g=!0:e=="false"?g=!1:(g=e,e='"'+e+'"'));b[h]=g;a.m("overriding %s property '%s' with %s\n",a.U,h,e)}}a.config=b;c=b.bindings;c=c===void 0?{}:c;if(typeof document!="undefined"){a.config.V||(a.config.V=c);(d=Array.isArray(c))?c.indexOf("container")<0&&c.push("container"):c.container||(c.container=a.U);for(var f in c){e=c[f];if(d)f=e;else if(e.match(/^[0-9]+$/)){var h=
+e;a.V[f]=[];do{e=f+h++;e=document.getElementById(e);if(!e)break;a.V[f].push(e)}while(1);continue}(h=document.getElementById(e))&&a.xa(f,h)}}b=b===void 0?{}:b;a.version=3;if(a.version){f="";var k;a.M!=a.U&&(k=N(a,a.M).version)&&k!=a.version&&(f="Machine");f||(k=b.version)&&k>a.version&&(f="Config");f&&(k=a.u("%s Device version (%3.2f) incompatible with %s version (%3.2f)",b.Oe,a.version,f,k),a.error("%s\n\nClearing your browser's cache may resolve the issue.",k))}}
function pb(a,b){var c;try{var d=C[a.M];if(d)for(c in d){var e=d[c];if(e.U!=e.M&&!b(e))return!1}return!0}catch(g){a.m("error while enumerating device '%s': %s\n",c,g.message)}return!1}p.sa=function(a,b){b=b===void 0?!1:b;if(a){var c=H.prototype.sa.call(this,a,b);if(c===void 0&&b){b=C[this.M];for(var d in b)if(c=b[d].V[a])break;c||(c=null);this.V[a]=c}}return c};
function N(a,b,c){var d=b,e=a.M,g=e.indexOf(".");g>0&&(e=e.substr(0,g),b=b.substr(g+1));b=(g=C[e])&&g[b]||null;if(!b){for(g=0;g<ua.length;g++)if(ua[g].id===d){b=ua[g];break}if(!b&&(c===void 0||c))throw Error(a.u('no "%s" device',d));}return b}function O(a,b,c){var d=null,e=C[a.M];if(e)for(var g in e)if(e[g].config["class"]==b){if(d){d=null;break}d=e[g]}if(!d&&(c===void 0||c))throw Error(a.u("no %s device",b));return d}function qb(a,b){var c=N(a,a.M);return c&&c.config&&c.config[b]||a.config[b]}
function rb(a,b){return(a=a.Ma[b])&&a.get()}function P(a){return a==a.I&&a.ready?pb(a,function(b){return P(b)}):a.ready}function sb(a,b){b=b===void 0?a.ready:b;a.ready=b;if(P(a)){for(;b=a.Rb.pop();)b();a!=a.I&&sb(a.I)}}function tb(a,b){if(P(a))return b(),!0;a.Rb.push(b);return!1}p.oc=function(){};
p.m=function(a){var b=oa.apply(1,arguments);return typeof a=="number"&&Xa(this,a)&&(this.Z===void 0&&(this.Z=O(this,"Debugger",!1)),this.Z&&this.Z.oc(a),this.I.ga&1&&(this.T===void 0&&(this.T=O(this,"CPU")),this.T))?(a=b.shift(),H.prototype.m.call(this,"%#06x: %s.%s\n",this.T.mb,this.U,this.u.apply(this,[a].concat(A(b))).trim())):H.prototype.m.call.apply(H.prototype.m,[this,a].concat(A(b)))};function ub(a,b){(a=C[a.M])&&delete a[b]}function vb(a,b,c){(a=a.Ma[b])&&a.set&&a.set(c)}D.Device=M;
function wb(a,b,c){M.call(this,a,b,c);this.ga=2097152;this.$=this.N=null;this.time=O(this,"Time");this.I=O(this,"Machine");this.ea=I(this,"drag",!1);this.X=I(this,"scroll",!1);this.da=I(this,"hexagonal",!1);this.l=I(this,"releaseDelay",0);this.o=!1;a=this.config.map;this.h=this.j=null;if(a)if(a.length)this.h=a;else{this.j={};b=Object.keys(a);for(var d=0;d<b.length;d++){var e=[],g=b[d],f=a[g];typeof f=="string"?f=[f]:f.length==void 0&&(e=f.grid,f=f.keys,typeof f=="string"&&(f=[f]));this.j[g]={keys:f,
grid:e,state:0}}}this.R=[];this.S=[];this.H=!1;this.i=this.J=null;(a=this.V[xb])&&yb(this,a,this.sa(c.focusBinding,!0),this.config.location);this.ma()}w(wb,M);function zb(a,b){a.N=b}function Ab(a,b,c){for(var d=0;d<a.R.length;d++){var e=a.R[d];e.id===b&&e.Sa(b,c)}}
function yb(a,b,c,d){d=d===void 0?[]:d;if(d.length||a.h||a.j){var e={};e.xd=d[0]||0;e.yd=d[1]||0;e.Ga=d[2]||b.clientWidth;e.Qa=d[3]||b.clientHeight;e.Ta=d[4]||1;e.Za=d[5]||1;e.md=d[6]||b.naturalWidth||e.Ga;e.od=d[7]||b.naturalHeight||e.Qa;e.sc=d[8]||0;e.tc=d[9]||0;e.ld=d[10]||0;e.nd=d[11]||0;a.h?(e.Va=a.h.length,e.Ha=a.h[0].length):(e.Ha=e.Ta,e.Va=e.Za,e.Ta=e.Za=0);e.lc=e.Ga/(e.Ha+e.Ha*e.Ta)|0;e.mc=e.Qa/(e.Va+e.Va*e.Za)|0;e.kd=e.lc*e.Ta|0;e.nc=e.mc*e.Za|0;e.Ja=e.$a=-1;Bb(a,b,e);Cb(a,b,e);a.time&&
a.l&&(a.Y=Db(a.time,"timerInputRelease",function(){e.Ja<0&&e.$a<0&&Eb(a,-1,-1)}))}if(a.h||a.j)a.time&&a.l&&(a.fa=Db(a.time,"timerKeyRelease",function(){Fb(a)})),a.v=0,a.L="",a.K=[],d=b,c&&(d=c,a.i||c.nodeName!="BUTTON"||(d=document,a.i=c,Gb(a,b),a.J=b)),Gb(a,d),a.i||(a.i=d)}function Hb(a){a.l?Ib(a.time,a.fa,a.l):Fb(a)}
function Gb(a,b){function c(e,g,f){var h=document.activeElement;a.m(5242880,"%s.onKey%s(%d): %5.2f (%s)\n",h.id||h.nodeName,e,g,Date.now()/1E3%60,f!=void 0?f?"used":"unused":"ignored")}function d(e,g){e=document.activeElement;return a.i&&e!=a.i&&e!=a.J?null:g||window.event}b.addEventListener("keydown",function(e){if(e=d(this,e)){var g=e.which||e.keyCode,f=Jb(a,g,!0,e);c("Down",g,f);f&&e.preventDefault()}});b.addEventListener("keypress",function(e){if(e=d(this,e)){var g=e.which||e.charCode,f=Jb(a,
g);c("Press",g,f);f&&e.preventDefault()}});b.addEventListener("keyup",function(e){if(e=d(this,e)){var g=e.which||e.keyCode,f=Jb(a,g,!1,e);c("Up",g);f&&e.preventDefault();b.nodeName=="TEXTAREA"&&(b.value="")}})}
function Bb(a,b,c){b.addEventListener("mousedown",function(d){if(!a.o){var e=a.H?a.J:a.i;if(e){var g=window.scrollX,f=window.scrollY;e.focus();window.scrollTo(g,f)}d.button||Q(a,b,Kb,d,c)}});b.addEventListener("mousemove",function(d){a.o||Q(a,b,Lb,d,c)});b.addEventListener("mouseup",function(d){a.o||d.button||Q(a,b,Mb,d,c)});b.addEventListener("mouseout",function(d){a.o||(c.Ja<0?Q(a,b,Lb,d,c):Q(a,b,Mb,d,c))})}
function Cb(a,b,c){b.addEventListener("touchstart",function(d){a.X&&(a.o=!0);Q(a,b,Kb,d,c)});b.addEventListener("touchmove",function(d){Q(a,b,Lb,d,c)});b.addEventListener("touchend",function(d){Q(a,b,Mb,d,c)})}
function Jb(a,b,c,d){if(c!=void 0){var e=kb[b]||b;var g=mb[b];var f=Nb[e];d=d&&d.location==lb.eb;f&Ob&&d&&(f>>=1);f&&(f&Pb&&(c=!(a.g&f)),a.g=c?a.g|f:a.g&~f,Ab(a,e,c))}else g=String.fromCharCode(b).toUpperCase(),b>=ib.ab&&b<=ib.fb?a.g&(Qb|Rb)||(a.g|=Rb,Ab(a,K.cb,!0)):b>=ib.a&&b<=ib.z&&a.g&Rb&&(a.g&=~Rb,Ab(a,K.cb,!1));if(a.h){if(c!=void 0)return!1;for(e=0;e<a.h.length;e++)for(f=a.h[e],d=0;d<f.length;d++)if(f[d].split("|").indexOf(g)>=0)return a.v?a.K.length<16&&a.K.push(b):(a.v=1,a.L=g,Eb(a,d,e),Ab(a,
g,!0),Hb(a)),!0}if(a.j){if(c==void 0)return!0;b=Object.keys(a.j);for(e=0;e<b.length;e++)if(f=b[e],a.j[f].keys.indexOf(g)>=0)return Ab(a,f,c),a.j[f].state=c?1:0,!0}return!1}function Fb(a){a.v==1?(a.v++,Ab(a,a.L,!1),a.L="",Eb(a,-1,-1),Hb(a)):(a.v=0,a.K.length&&Jb(a,a.K.shift()))}wb.prototype.ma=function(){this.g=0;this.W=this.aa=-1};
function Q(a,b,c,d,e){var g=-1,f=-1,h=!1,k=-1,n=-1;if(c<Mb){d=d||window.event;d.targetTouches&&d.targetTouches.length?(k=d.targetTouches[0].clientX,n=d.targetTouches[0].clientY,h=d.targetTouches.length>1):(k=d.clientX,n=d.clientY);var l=d.target.getBoundingClientRect();k-=l.left;n-=l.top;k=e.md/b.offsetWidth*k|0;n=e.od/b.offsetHeight*n|0;var t=k-e.xd;var m=n-e.yd;var q=l=!1;var v=k>=e.sc&&k<e.sc+e.ld&&n>=e.tc&&n<e.tc+e.nd;if(t>=0&&t<e.Ga&&m+e.nc>=0||v)if(h||a.X||d.preventDefault(),t>=0&&t<e.Ga&&m>=
0&&m<e.Qa){q=!0;d=e.Ga/e.Ha|0;var u=e.Qa/e.Va|0,x=t/d|0,y=m/u|0;!a.da||y&1||(t-=d>>1,x=t/d|0,x==e.Ha-1&&(t=-1));u=y*u+(e.nc>>1);t-=x*d+(e.kd>>1);m-=u;t>=0&&t<e.lc&&m>=0&&m<e.mc&&(g=x,f=y,l=!0)}}t=t||0;m=m||0;d=b.offsetWidth;b=b.offsetHeight;if(c==Kb||c==Mb)for(x=0;x<a.S.length;x++)y=a.S[x],c==Mb?y.Sa(y.id,!1):(u=m/(b/y.Qe|0)|0,(t/(d/y.Pe|0)|0)==y.ef&&u==y.ff&&y.Sa(y.id,!0));if(!h)if(c==Kb)e.Ja=k,e.$a=n,q?(Eb(a,g,f),l&&a.l&&Ib(a.time,a.Y,a.l,!0)):v&&a.I.ia();else if(c==Lb)e.Ja>=0&&e.$a>=0&&a.ea?Eb(a,
g,f):a.N&&a.N(g,f);else if(c==Mb){if(c=a.l)c=a.time,g=a.Y,c=c.g&&g>0&&g<=c.h.length?c.h[g-1].ha>=0:!1;c||Eb(a,-1,-1);e.Ja=e.$a=-1}else a.m("unrecognized action: %d\n",c)}function Sb(a){var b=a.H?a.J:a.i;b&&P(a.I)&&(a.m(2097152,'setFocus("%s")\n',b.id||b.nodeName),b.focus(),b.scrollIntoView())}function Eb(a,b,c){if(b!=a.W||c!=a.aa)a.W=b,a.aa=c,a.$&&a.$(b,c)}
var Kb=1,Lb=2,Mb=3,xb="surface",Qb=3,Ob=170,Rb=512,Pb=3584,R={},Nb=(R[K.Uc]=2,R[K.xc]=8,R[K.uc]=32,R[K.xb]=128,R[K.cb]=Rb,R[K.Kc]=1024,R[K.Rc]=2048,R);D.Input=wb;
function Tb(a,b,c){M.call(this,a,b,c,["color","backgroundColor"]);a=this.V[Ub];if(!a)throw Error("LED "+this.config.V[Ub]+" binding for '"+Ub+"' missing");b=document.createElement("canvas");if(!b||!b.getContext)throw a.innerHTML="LED device requires HTML5 canvas support",Error("LED device requires HTML5 canvas support");this.wa=Qa(this,Ub)+".canvas";b.setAttribute("id",this.wa);this.type=Ta(I(this,"type",Vb,Wb),Xb,Yb);this.i=Zb[this.type][0];this.v=Zb[this.type][1];this.width=I(this,"width",this.i);
this.height=I(this,"height",this.v);this.j=I(this,"cols",1);this.L=this.j+I(this,"colsExtra",0);this.aa=I(this,"rows",1);this.N=this.aa+I(this,"rowsExtra",0);this.da=this.width*this.j;this.X=this.height*this.aa;this.o=$b("black",0);this.h=ac(this.config.color)||this.o;this.oa=$b(this.h,1,.25);this.na=$b(this.h,1,2);this.l=ac(this.config.backgroundColor);this.qa=I(this,"fixed",!1);this.qa||(b.style.width="100%",b.style.height="auto");this.ja=I(this,"hexagonal",!1);this.ra=I(this,"highlight",!0);this.W=
I(this,"persistent",this.type<Yb);b.setAttribute("width",this.da.toString());b.setAttribute("height",this.X.toString());b.style.backgroundColor=this.o;a.appendChild(b);this.ea=b.getContext("2d");if(this.H=document.createElement("canvas"))this.H.width=this.Y=this.i*this.j,this.H.height=this.J=this.v*this.aa,this.g=this.H.getContext("2d");this.Na=(this.N+1)*this.L*4;this.buffer=Array(this.Na);this.Pa=this.j<this.L?(this.L-this.j)*4:0;this.R=this.S=!1;this.K=this.$=0;this.fa=-1;var d=this;this.time=
O(this,"Time");bc(this.time,function(e,g){cc(d,!1,e,g)});dc(d)}w(Tb,M);function dc(a){for(var b=a.buffer,c=0;c<b.length;c+=4){var d=a,e=b,g=c;e[g]=d.type<Yb?ec:" ";e[g+1]=d.h==d.o?null:d.h;e[g+2]=0;e[g+3]=fc}a.R=a.S=!0;cc(a,!0)}function hc(a){a.l?(a.g.fillStyle=a.l,a.g.fillRect(0,0,a.Y,a.J)):a.g.clearRect(0,0,a.Y,a.J)}
function cc(a,b,c,d){b=b===void 0?!1:b;c=c===void 0?0:c;d=d===void 0?60:d;if(a.R||b){if(a.type<Yb){d=0;if(!a.W||b)hc(a);else if(a.K){d=a.j-a.K;var e=a.i*d;a.g.drawImage(a.H,a.i*a.K,0,e,a.J,0,0,e,a.J)}for(var g=e=0;g<a.N;g++){for(var f=0;f<a.j;f++){var h=a.buffer[e],k=a.buffer[e+1]||a.o,n=a.ra&&e==a.fa;if(a.buffer[e+3]&fc||n||b){if(f>=d)a:{var l=a,t=h;h=k;var m=f;k=g;var q=n;m=m===void 0?0:m;k=k===void 0?0:k;q=q===void 0?!1:q;var v=0;if(l.ja&&!(k&1)&&(v=l.i>>1,m==l.j-1))break a;if(h&&h!=l.h){q=q?$b(h,
1,2):h;var u=$b(h,1,.25)}else q=q?l.na:l.h,u=l.oa;h=!1;t=t?q:u;q==l.o&&(t=l.l,h=!0);q=m*l.i+v;u=k*l.v;l.W&&(m=m*l.i+v,k*=l.v,l.l?(l.g.fillStyle=l.l,l.g.fillRect(m,k,l.i,l.v)):l.g.clearRect(m,k,l.i,l.v));l.g.fillStyle=t;k=ic[l.type];k.length==3?(l.g.beginPath(),l.g.arc(q+k[0],u+k[1],k[2],0,Math.PI*2),h?(l.g.globalCompositeOperation="destination-out",l.g.fill(),l.g.globalCompositeOperation="source-over"):l.g.fill()):l.g.fillRect(q+k[0],u+k[1],k[2],k[3])}a.buffer[e+3]=n?a.buffer[e+3]|fc:a.buffer[e+3]&
~fc}e+=4}e+=a.Pa}a.K=0}else{b="";for(d=0;d<a.buffer.length;d+=4)b+=a.buffer[d]||" ",a.buffer[d+3]&jc&&(b+=".");hc(a);for(g=e=d=0;d<b.length;d++){n=b[d];n=="."&&e&&e--;f=a;k=n;n=e;l=g;n=n===void 0?0:n;l=l===void 0?0:l;if(k=kc[k])for(h=0;h<k.length;h++)if(m=f,v=lc[k[h]]){t=(n===void 0?0:n)*m.i;q=(l===void 0?0:l)*m.v;m.g.fillStyle=m.h;m.g.beginPath();if(v.length==3)m.g.arc(t+v[0],q+v[1],v[2],0,Math.PI*2);else for(u=0;u<v.length;u+=2)u?m.g.lineTo(t+v[u],q+v[u+1]):m.g.moveTo(t+v[u],q+v[u+1]);m.g.closePath();
m.g.fill()}if(++e==a.j&&(e=0,++g==a.N))break}}a.ea.globalCompositeOperation=a.l&&a.h!=a.o?"source-over":"copy";a.ea.drawImage(a.H,0,0,a.Y,a.J,0,0,a.da,a.X);a.R=!1;a.fa=-1}else a.W||a.S||(!c||!a.$||c-a.$>=(1E3/d|0))&&dc(a);a.S=!1;c&&(a.$=c)}function ac(a){return(a=a||void 0)&&nb[a]||a}
function $b(a,b,c){b=b===void 0?1:b;c=c===void 0?1:c;if(a){var d=[];a=nb[a]||a;var e=a;var g=16;var f=e.match(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i);f||(g=10,f=e.match(/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,?\s*(\d+|)\)$/i));if(f){for(e=1;e<f.length;e++)d[e-1]=Number.parseInt(f[e],g);d.length=e-1;g=!0}else g=!1;if(g){a="rgba(";for(g=0;g<3;g++)f=Math.round(d[g]*c),f=f<0?0:f>255?255:f,a+=f+",";a+=(g<d.length?d[g]:b)+")"}}return a}
Tb.prototype.ta=function(a){var b=a.shift(),c=a.shift();a=a.shift();if(b==this.h&&c==this.l&&a&&a.length==this.buffer.length){this.buffer=a;for(b=0;b<=this.buffer.length-4;b+=4)this.buffer[b+1]==this.o&&(this.buffer[b+1]=null);cc(this,!0);return!0}return!1};Tb.prototype.va=function(a){this.buffer&&(a.push(this.h),a.push(this.l),a.push(this.buffer))};
var Xb=0,Vb=1,Yb=3,Wb={small:Xb,round:Vb,square:2,digit:Yb},Ub="container",ec=0,jc=1,fc=128,mc={},ic=(mc[Xb]=[4,4,4],mc[Vb]=[16,16,14],mc[2]=[2,2,28,28],mc),Zb=[[8,8],[32,32],[32,32],[96,128]],lc={A:[30,8,79,8,67,19,37,19],B:[83,10,77,52,67,46,70,22],C:[77,59,71,100,61,89,64,64],D:[28,91,58,91,69,104,15,104],E:[18,59,28,64,25,88,12,100],F:[24,10,34,21,31,47,18,52],G:[24,56,34,50,60,50,71,56,61,61,33,61],P:[80,102,8]},kc={" ":[],0:"ABCDEF".split(""),1:["B","C"],2:["A","B","D","E","G"],3:["A","B","C",
"D","G"],4:["B","C","F","G"],5:["A","C","D","F","G"],6:"ACDEFG".split(""),7:["A","B","C"],8:"ABCDEFG".split(""),9:"ABCDFG".split(""),A:"ABCEFG".split(""),B:["C","D","E","F","G"],C:["A","D","E","F"],D:["B","C","D","E","G"],E:["A","D","E","F","G"],F:["A","E","F","G"],"-":["G"],".":["P"]};D.LED=Tb;
function S(a,b,c){M.call(this,a,b,c);var d=this;this.touchType=this.config.touchType;this.X=this.config.diagnostics;this.v=this.config.monitorWidth||640;this.l=this.config.monitorHeight||480;this.i=this.V[T.Nb];if(!this.i)throw Error("unable to find binding: "+T.Nb);this.g=this.sa(T.wc)||this.i;b=this.V[T.Yb];if(!b){b=document.createElement("canvas");if(a=Qa(this,T.Yb))this.V[a]=b,b.setAttribute("id",a);b.setAttribute("class","pcjs-surface");b.setAttribute("width",this.config.monitorWidth);b.setAttribute("height",
this.config.monitorHeight);b.style.backgroundColor=this.config.monitorColor||"black";this.i.appendChild(b)}this.j=b;this.o=a=b.getContext("2d");Ya("MSIE")&&(this.i.onresize=function(f,h,k,n){return function(){h.style.height=(f.clientWidth*n/k|0)+"px"}}(this.i,b,this.config.monitorWidth,this.config.monitorHeight),this.i.onresize());(c=+(this.config.aspect||Va().aspect))&&c>=.3&&c<=3.33&&(ab(function(f,h,k){return function(){h.style.height=(f.clientWidth/k|0)+"px"}}(this.i,b,c)),window.onresize());
this.J=this.H=this.I.Ka=!1;if(c=this.V[T.Db])if(b=Oa(this.g,"requestFullscreen")){this.g.Ra=this.g[b];this.J=!0;this.H=document.fullscreenEnabled||Ya("Edge/");if(b=Oa(document,"on","fullscreenchange")){var e=Oa(document,"fullscreenElement");document.addEventListener(b,function(){nc(d,document[e]!=null)},!1)}(b=Oa(document,"on","fullscreenerror"))&&document.addEventListener(b,function(){nc(d)},!1)}else this.m("Full-screen API not available\n"),c.parentNode.removeChild(c);if(this.touchType||this.X||
this.J&&!Ya("iOS")){var g=document.createElement("textarea");if(b=Qa(this,T.Lc))this.V[b]=g,g.setAttribute("id",b);g.setAttribute("class","pcjs-overlay");Ya("iOS")&&(Ka(g),g.style.fontSize="16px");this.i.appendChild(g)}(this.input=O(this,"Input",!1))&&yb(this.input,g||this.i,this.sa(this.config.focusBinding,!0));Va();if(this.h=this.config.monitorRotate)this.h=this.h%360,this.h>0&&(this.h-=360),this.h!=-90?(this.m("unsupported monitor rotation: %d\n",this.h),this.h=0):(a.translate(0,this.l),a.rotate(this.h*
Math.PI/180),a.scale(this.l/this.v,this.v/this.l))}w(S,M);S.prototype.xa=function(a,b){var c=this;switch(a){case T.Db:b.onclick=function(){c.I.Ka=window.outerHeight-window.innerHeight<=1;c.I.Ka||c.Ra()}}M.prototype.xa.call(this,a,b)};function oc(a){a.o&&(a.o.fillStyle="black",a.o.fillRect(0,0,a.j.width,a.j.height))}
S.prototype.Ra=function(){var a=!1;if(this.g&&this.g.Ra){a="100%";if(screen&&screen.width&&screen.height){var b=screen.width/screen.height,c=this.v/this.l;b>c&&(a=Math.round(c/b*100)+"%")}this.H?(this.j.style.width=a,this.j.style.height="auto",this.j.style.display="block",this.j.style.margin="auto"):(this.g.style.width=a,this.g.style.height="auto");this.K=this.g.style.backgroundColor;this.g.style.backgroundColor="black";this.g.Ra();this.input&&(a=this.input,a.H=!0,Sb(a));a=!0}return a};
function nc(a,b){a.I.Ka=!0;b||(a.g&&(a.H?a.j.style.width=a.j.style.height="":a.g.style.width=a.g.style.height="",a.K&&(a.g.style.backgroundColor=a.K)),a.I.Ka=!1);a.input&&!b&&(a=a.input,a.H=!1,Sb(a))}S.prototype.ia=function(a){a?this.$=!1:oc(this)};S.prototype.ma=function(){oc(this)};var T={wc:"container",Yb:"surface",Nb:"monitor",Lc:"overlay",Db:"fullScreen"};D.Monitor=S;
function pc(a,b,c){M.call(this,a,b,c);this.wa=I(this,"cyclesMinimum",1E5);this.Wb=I(this,"cyclesMaximum",1E9);this.ja=Ta(I(this,"cyclesPerSecond",1E6),this.wa,this.Wb);this.ea=60;this.$=0;this.aa=1E3/this.ea;this.Zb=I(this,"updatesPerSecond",2)||2;this.cd=1E3/this.Zb;this.Tb=0;this.dd=I(this,"timeLock",!0);this.ra=this.N=0;this.qa=this.l=1;this.Pa=this.v=this.ja/1E4/100;this.na=[];this.K=[];this.h=[];this.W=[];this.Na=this.g=this.X=this.J=!1;this.L=this.j=0;a=Oa(window,"requestAnimationFrame");if(!a){a=
"setTimeout";var d=this.aa}this.ac=window[a].bind(window,this.ud.bind(this),d);this.ad=window[Oa(window,"cancelAnimationFrame")||"clearTimeout"].bind(window);this.da=this.Y=this.o=this.i=this.fa=0;qc(this)||rc(this,this.qa)}w(pc,M);function bc(a,b){a.na.push(b)}p=pc.prototype;
p.xa=function(a,b){var c=this;switch(a){case sc:b.onclick=function(){tc(c)&&(c.g?uc(c):c.start())};break;case vc:b.onclick=function(){rc(c,c.l<<1);wc(c,xc(c.v))};break;case yc:b.onclick=function(){zc(c)};break;case Bc:b.addEventListener("mousedown",function(){c.J=!0}),b.addEventListener("mouseup",function(){qc(c);c.J=!1}),b.addEventListener("mousemove",function(){c.J&&qc(c)}),b.addEventListener("change",function(){c.J=!0;qc(c);c.J=!1})}M.prototype.xa.call(this,a,b)};
function Db(a,b,c){var d=d===void 0?-1:d;var e=a.h.length+1;a.h.push({id:b,ed:c,Ua:d,ha:-1});d>=0&&Ib(a,e,d);return e}
function Cc(a,b,c,d){var e=0,g=a.v,f=g*1E6;b&&c&&(g=b/(c*10)/100,a.m(262144,"calcSpeed(%d cycles, %5.3fms): %5.3fMhz\n",b,c,g),d>a.aa&&(a.l>1&&(a.l>>=1,a.m(549755813888,"frame time (%5.3fms) exceeded maximum (%5.3fms), target multiplier now %d\n",d,a.aa,a.l)),e=d));a.N=g;a.ra=g/a.Pa;b=a.ra/a.l;a.fa=f/b/a.ea+1E-8;a.m(262144,"nCyclesDepositPerFrame(%5.3f) = nCyclesPerSecond(%d) / nDivisor(%5.3f) / nFramesPerSecond(%d)\n",a.fa,f,b,a.ea);return e}
function Dc(a,b){a.Y=a.o=b;if(!a.K.length)return a.o=0,a.Y;for(var c=0;a.o>0;){if(c<a.K.length){var d=a.K[c++];b=d.vd.call(d,b)||1}else c=b=0;a.o-=b}return a.Y-a.o}function Ec(a,b){b=b===void 0?a.Y-a.o:b;if(!a.g){if(a.i)for(var c=0;c<a.K.length;c++){var d=a.K[c];d.wd.call(d)}a.i=b}a.i-=b;a.i<1&&(a.X=!0);a.da+=b;a.Y=a.o=0;a.g||(a.da=0);return b}
function Fc(a,b){b=b===void 0?0:b;if(b){var c=b;a.i+=b}else for(c=a.i,c<1&&(c=a.i+=a.fa),c<0&&(a.m(262144,"warning: cycle count dropped below zero: %f\n",c),c=a.i=0),c|=0,b=a.h.length;b>0;b--){var d=a.h[b-1];!(d.ha<0)&&c>d.ha&&(c=d.ha)}return c}function xc(a){a>=1?a=a.toFixed(2)+"Mhz":(a=Math.round(a*1E6),a=a<=999?a+"Hz":Math.ceil(a/1E3)+"Khz");return a}function Gc(a){a.m(262144,"getSpeedCurrent(%5.3fhz)\n",a.N*1E6);return a.g&&a.N?xc(a.N):"Stopped"}
function tc(a){return a.Na?!0:(a.m("not powered\n"),!1)}function Hc(a,b){if(b>=1)for(var c=a.h.length;c>0;c--){var d=a.h[c-1];d.ha<0||(d.ha-=b,d.ha<=0&&(d.ha=-1,d.ed(),d.Ua>=0&&Ib(a,c,d.Ua)))}}p.ia=function(a){this.Na=a;this.Z===void 0&&(this.Z=O(this,"Debugger",!1))&&this.Z.gb(this,"time","dump time state",this.sd)};function zc(a,b){tc(a)&&(a.g?a.m("already running\n"):a.j?uc(a):Ic(a,b))}
p.ud=function(a){a=a===void 0?Date.now():a;this.L=0;if(this.g){if(this.$){var b=a-this.$;b<1&&(b=16.67);this.ea=1E3/b}this.$=a;a=Date.now();this.R&&(b=a-this.S-this.aa,b>this.aa&&(this.H+=b,this.m(549755813888,"browser throttling detected, compensating by %5.3fms\n",b)));this.S=a;this.H||(this.H=a);this.oa=0;try{this.X=!1;do Hc(this,Ec(this,Dc(this,Fc(this))));while(this.g&&!this.X)}catch(c){this.m("%s\n",c.message),uc(this)}this.R=Date.now();this.oa&&(this.H+=this.oa,this.S+=this.oa);this.S+=Cc(this,
this.da,this.R-this.H,this.R-this.S);this.R-this.Tb>=this.cd&&this.update();for(a=0;a<this.na.length;a++)this.na[a](this.$,this.ea);this.L=this.ac()}};function rc(a,b){if(b!==void 0){if(b<1||!a.J&&a.N>0&&a.N<a.v*.9)b=a.qa;a.l=b;b=a.Pa*a.l;a.v!=b&&(a.v=b,wc(a,xc(a.v)))}a.H=a.R=0;a.i=a.da=0;Cc(a);for(b=a.h.length;b>0;b--){var c=a.h[b-1];c.Ua>=0&&Ib(a,b,c.Ua,!0)}}function qc(a){var b=a.V[Bc];return b?(rc(a,Math.floor((b.value-b.min)/(b.max-b.min)*(a.Wb-a.wa)+a.wa)/a.ja|0),!0):!1}
function Ib(a,b,c,d){b>0&&b<=a.h.length&&(b=a.h[b-1],d||b.ha<0)&&(c=Math.ceil(a.ja*(a.dd?a.qa:a.ra)/1E3*(c===void 0?1E3:c)),a.g&&(c+=Ec(a)),b.ha=c)}p.start=function(){if(this.g||this.j)return!1;this.g=!0;this.H=this.R=this.$=0;this.update(!0);this.L=this.ac();return!0};function Ic(a,b){b=b===void 0?1:b;a.g||(b&&!a.j&&(a.j=b),a.j&&(a.j--,Hc(a,Ec(a,Dc(a,Fc(a,1)))),a.update(!1),a.j&&setTimeout(function(){Ic(a,0)},0)))}
function uc(a){return a.g?(a.g=!1,Ec(a),a.L&&(a.ad(a.L),a.L=0),a.update(!0),!0):a.j?(a.j=0,a.update(!0),!0):!1}p.update=function(a){a&&this.m(this.g?"started with %s target\n":"stopped\n",xc(this.v));hb(this,sc,this.g?"Halt":"Run");hb(this,yc,this.j?"Stop":"Step");this.J||wc(this,Gc(this));for(var b=0;b<this.W.length;b++){var c=this.W[b];c.qc.call(c,a!=void 0)}this.Tb=Date.now();this.X=!0};function wc(a,b){hb(a,Jc,b);hb(a,vc,b)}
p.sd=function(){var a=this.u("nCyclesPerSecond: %f\n",this.ja);a+=this.u("nUpdatesPerSecond: %f\n",this.Zb);a+=this.u("nTargetMultiplier: %f\n",this.l);return a+=this.u("nCyclesDepositPerFrame: %f\n",this.fa)};var sc="run",vc="setSpeed",Jc="speed",yc="step",Bc="throttle";D.Time=pc;
function Kc(a,b,c){M.call(this,a,b,c);this.type=this.config.type=="static"?Lc:Mc;this.ba=this.config.addrWidth||16;this.j=Math.pow(2,this.ba);this.v=this.j-1|0;this.blockSize=this.config.blockSize||(this.ba>16?4096:1024);this.blockSize>this.j&&(this.blockSize=this.j);this.H=this.j/this.blockSize|0;this.h=Math.log2(this.blockSize)|0;this.l=(1<<this.h)-1;this.i=this.config.dataWidth||8;this.g=Array(this.H);this.o=0;a=new U(a,b+"[NONE]",{size:this.blockSize,bus:this.U});for(b=0;b<this.j;b+=this.blockSize)Nc(this,
b,this.blockSize,V.NONE,a);Oc(this,this.type)}w(Kc,M);function Nc(a,b,c,d,e){for(var g=b>>>a.h;c>0&&g<a.g.length;){var f=g*a.blockSize,h=a.blockSize-(b-f);h>c&&(h=c);var k=a.g[g];if(b!=f||h!=a.blockSize||k&&k.type!=V.NONE)break;k=a.U+"["+E(a,b,16,a.ba)+"]";b=e?e.size==a.blockSize?e:new U(a.M,k,{type:d,ya:b,size:h,bus:a.U}):new U(a.M,k,{type:d,ya:b,size:h,bus:a.U});a.g[g]=b;b=f+a.blockSize;c-=h;g++}}
function Pc(a,b){for(var c=V.Qc,d=0,e=0;e<a.g.length;e++){var g=a.g[e];g&&g.type&c&&(b(g),d++)}return d}p=Kc.prototype;p.Re=function(a,b){this.Z&&this.Z.m(4,"bus fault (%d) at %n\n",b,a)};p.ia=function(){this.Z===void 0&&(this.Z=O(this,"Debugger",!1))};p.ma=function(){};p.kb=function(a){return a&&this.ta(a)?!0:!1};p.Ia=function(a){this.va(a)};p.ta=function(a){for(var b=0;b<this.g.length;b++){var c=this.g[b];if((this.type==Mc||c.type&V.Da)&&c.ta){var d=a.shift();if(!c.ta(d))return!1}}return!0};
p.va=function(a){for(var b=0;b<this.g.length;b++){var c=this.g[b];if((this.type==Mc||c.type&V.Da)&&c.va){var d=[];c.va(d);a.push(d)}}};p.lb=function(a){return this.g[a>>>this.h].lb(a&this.l)};p.rb=function(a,b){this.g[a>>>this.h].rb(a&this.l,b)};p.Aa=function(a,b){this.g[a>>>this.h].pa(a&this.l,b)};function Oc(a,b){var c=a.o;a.o+=b;c&&a.o||(a.pa=a.Aa)}p.Xa=function(a,b){return this.g[a>>>this.h].Xa(b)?(Oc(this,1),!0):!1};p.ob=function(a,b){return this.g[a>>>this.h].ob(b)?(Oc(this,1),!0):!1};
p.Ya=function(a,b){return this.g[a>>>this.h].Ya(b)?(Oc(this,-1),!0):!1};p.qb=function(a,b){return this.g[a>>>this.h].qb(b)?(Oc(this,-1),!0):!1};var Lc=0,Mc=1;D.Bus=Kc;
function U(a,b,c){M.call(this,a,b,c);this.ya=this.config.addr;this.size=this.config.size;this.type=this.config.type||V.NONE;this.h=(a=this.config.bus)?N(this,a):O(this,a="Bus");if(!this.h)throw Error(this.u("unable to find bus '%s'",a));this.N=this.h.i;this.l=this.L=!1;this.values=this.buffer=null;a=this.Aa;this.h.type==Lc&&(a=this.sb,this.N==8&&qb(this,"ArrayBuffer")!==!1&&(this.L=!0));switch(this.type){case V.NONE:this.pa=this.rc;break;case V.Vb:this.pa=this.rc;break;case V.Da:this.pa=a}this.o=
this.i=0;this.j=this.J=this.v=null;Qc(this,this.config.values);Rc(this)}w(U,M);function Qc(a,b){typeof b=="string"?(sb(a,!1),Ua(b,function(c,d,e,g){if(e==4)if(!g&&d){try{var f=JSON.parse(d);Qc(a,f.values)}catch(h){a.m("error (%s) parsing resource: %s\n",h.message,c)}sb(a,!0)}else a.m("error (%d) loading resource: %s\n",g,c)})):a.config.values=b}
function Rc(a,b){if(a.type>V.NONE&&(a.L?(a.buffer=new ArrayBuffer(a.size),new DataView(a.buffer,0,a.size),a.values=new Uint8Array(a.buffer,0,a.size),new Uint16Array(a.buffer,0,a.size>>1),new Int32Array(a.buffer,0,a.size>>2)):a.values=Array(a.size).fill(0),b))for(var c=0;c<b.length;c++)a.values[c]=b[c]}p=U.prototype;
p.ma=function(){if(this.config.values)a:{var a=this.h,b=this.ya,c=this.size,d=this.config.values,e=0,g=b&a.l;b>>>=a.h;c>d.length&&(c=d.length);for(;c>0&&b<a.g.length;){var f=a.g[b++];if(!f)break a;for(;c>0&&g<f.size;)f.Aa(g++,d[e++]),c--;g=0}}else this.type&V.Da&&this.values&&this.values.fill(0)};p.lb=function(a){return this.values?this.values[a]:0};p.rc=function(){};p.rb=function(a,b){this.values&&(this.values[a]=b)};p.Aa=function(a,b){this.values[a]=b};
p.sb=function(a,b){this.values[a]=b;this.l=!0;this.i?this.j=this.Aa:this.pa=this.Aa};p.Xa=function(a){return this.o?this.J==a?(this.o++,!0):!1:(this.o++,this.J=a,!0)};p.ob=function(a){if(!this.i){var b=this;this.i++;this.v=a;this.j=this.pa;this.pa=function(c,d){b.v(b.ya,c,d);b.j(c,d)};return!0}return this.v==a?(this.i++,!0):!1};p.Ya=function(a){return this.o&&this.J==a?(--this.o||(this.J=null),!0):!1};p.qb=function(a){return this.i&&this.v==a?(--this.i||(this.pa=this.j,this.j=this.v=null),!0):!1};
p.ta=function(a){if(a){var b=a.shift();if(this.U==b){this.l=a.shift();a.shift();if(a=a.shift()){var c=this.size;c=c===void 0?0:c;if(a.length!=c){b=0;c=c?Array(c):[];for(var d=0;d<a.length-1;)for(var e=a[d++],g=a[d++];e--;)c[b++]=g;a=c}Rc(this,a)}return!0}}return!1};
p.va=function(a){a.push(this.U);a.push(this.l);a.push(!1);if(this.values){var b=this.values;for(var c=0,d=0,e=[];c<b.length;){for(var g=b[c],f=c+1;f<b.length&&b[f]===g;)f++;e[d++]=f-c;e[d++]=g;c=f}b=e.length>=b.length?b:e}else b=this.values;a.push(b)};var V={NONE:1,Vb:2,Da:4,Qc:14,Me:12};D.Memory=U;function Sc(a,b,c){c.type=V.NONE;U.call(this,a,b,c);Nc(this.h,this.config.addr,this.config.size,V.Da);tb(this,this.ma.bind(this))}w(Sc,U);D.RAM=Sc;
function Tc(a,b,c){c.type=V.Vb;U.call(this,a,b,c);Nc(this.h,this.config.addr,this.config.size,this.config.type,this);tb(this,this.ma.bind(this));this.T=this.Z=void 0;if(D.LED&&this.V[Uc]){var d=this;this.H=Math.pow(2,Math.ceil(Math.log2(this.values.length)/2));this.K=this.values.length/this.H|0;this.g=new Tb(a,b+"LEDs",{"class":"LED",bindings:{container:Qa(this,Uc)},type:Vb,cols:this.H,rows:this.K,color:I(this,"colorROM","green"),backgroundColor:I(this,"backgroundColorROM","black"),persistent:!0}),
dc(this.g);this.R=new wb(a,b+"Input",{"class":"Input",location:[0,0,this.g.da,this.g.X,this.H,this.K],bindings:{surface:Qa(this,Uc)}});this.S=Ra(this)||"";zb(this.R,function(e,g){if(d.T){var f=d.S;e>=0&&g>=0&&(e=g*d.H+e,f=d.T.bf(d.ya+e,d.values[e]));hb(d,Sa,f)}})}}w(Tc,U);
Tc.prototype.ta=function(a){var b=!0,c=a.shift();if(c&&this.g){var d=c.length;this.g.buffer.length==d?(this.g.buffer=c,cc(this.g,!0)):(this.m("inconsistent saved LED state (%d), unable to load\n",d),b=!1)}a.length&&(d=(a=a.shift())&&a.length||-1,this.values.length==d?this.values=a:(this.m("inconsistent saved ROM state (%d), unable to load\n",d),b=!1));return b};Tc.prototype.ia=function(){this.T===void 0&&(this.T=O(this,"CPU"));this.Z===void 0&&(this.Z=O(this,"Debugger",!1))&&this.Z.hb&&this.Z.hb(this.config.symbols)};
Tc.prototype.va=function(a){this.g&&(a.push(this.g.buffer),a.push(this.values))};var Uc="array",Sa="cellDesc";D.ROM=Tc;function Vc(a,b,c){c["class"]="CPU";M.call(this,a,b,c);this.Z=void 0;this.i=this.mb=0;this.time=O(this,"Time");this.time.K.push(this);this.time.W.push(this);this.h=this.g=0}w(Vc,M);Vc.prototype.abort=function(a){this.i=this.mb;this.m("%s\n",a.message);uc(this.time)};function Wc(a,b){a.Z=b;return a.Ma}Vc.prototype.vd=function(a){this.h=this.g=a===void 0?0:a;return this.h-this.g};
Vc.prototype.wd=function(){this.h-=this.g;this.g=0};
function Xc(a,b,c){c["class"]="Debugger";M.call(this,a,b,c);var d=this;this.ca=this.config.defaultRadix||16;this.$=["(",")"];this.Ob("a",function(g,f,h,k,n){return E(d,n.O,d.ca,h)});this.Ob("n",function(g,f,h,k,n){return E(d,n,d.ca,h,f.indexOf("#")<0?"":void 0)});this.ja=this.K=0;this.N={};this.na=[];this.oa=[];this.T=O(this,"CPU");this.Ma=Wc(this.T,this);this.input=O(this,"Input",!1);if(a=this.T.config.busMemory||this.config.busMemory){this.g=N(this,a);if(a=this.T.config.busIO||this.config.busIO)this.j=
N(this,a,!1);this.j||(this.j=this.g)}else this.g=this.j=O(this,"Bus");this.L=this.g.ba;this.wa=Math.pow(2,this.L)-1|0;this.H=this.ea=0;this.v=[];for(var e in W)this.v[W[e]]=[];this.o=[];this.o[W.ka]=this.g;this.o[W.Fa]=this.g;this.o[W.Ba]=this.j;this.o[W.Ca]=this.j;this.l=[];this.l[W.ka]=this.hd.bind(this);this.l[W.Fa]=this.jd.bind(this);this.l[W.Ba]=this.fd.bind(this);this.l[W.Ca]=this.gd.bind(this);this.i=[];this.R=void 0;this.X=null;this.aa=0;this.time=O(this,"Time");this.time.W.push(this);this.Y=
0;this.J=[];this.W="";this.gb(this,"state","dump machine state",this.rd);this.da=Yc();this.qa=Yc();this.fa=!1;this.S=0;this.h=[];Ma(this,this.td.bind(this));(e=qb(this,"commands"))&&$a(this,e)}w(Xc,M);p=Xc.prototype;p.gb=function(a,b,c,d){this.J.push({qd:a,name:b,pd:c,Sa:d})};function Zc(a,b,c){for(var d,e=0;e<a.J.length;e++){var g=a.J[e];if(g.name==b){d=g.Sa.call(g.qd,c);break}}return d}
p.hb=function(a){if(a&&a.length)for(var b=0;b<a.length-2;b+=3){var c=$c(this,a[b]);if(c){var d=ad[a[b+1]];if(d){c={address:c,type:d,name:a[b+2]};d=this.na;var e=c,g=bd(d,e,this.jc);g<0&&d.splice(-(g+1),0,e);d=this.oa;e=bd(d,c,this.kc);e<0&&d.splice(-(e+1),0,c)}}}};function bd(a,b,c){var d=0,e=a.length,g=0;for(c===void 0&&(c=function(k,n){return k>n?1:k<n?-1:0});d<e;){var f=d+e>>1,h=void 0;h=c(b,a[f]);h>0?d=f+1:(e=f,g=!h)}return g?d:~d}p.jc=function(a,b){return a.name>b.name?1:a.name<b.name?-1:0};
p.kc=function(a,b){return a.address.O>b.address.O?1:a.address.O<b.address.O?-1:0};function cd(a,b,c){b=bd(a.oa,{address:b,type:0,name:void 0},a.kc);if(b>=0&&(a=a.oa[b],!c||a.type==c))var d=a.name;return d}function dd(a,b,c,d){d=d===void 0?a.g:d;b.O=b.O+c&d.v}function Yc(a){a=a===void 0?0:a;var b=ed.Nc;return typeof a=="number"?{O:a,nb:-1,type:b}:{O:a.O,nb:a.nb,type:a.type}}
function $c(a,b,c){if(b){var d=Yc();var e=0,g=b.charAt(e);switch(g){case "&":e++;break;case "#":e++;d.type=ed.Oc;break;case "%":e++,g=b.charAt(e),g=="%"?e++:d.type=ed.dc}g=b.indexOf(":",e);if(g>=0){var f=fd(a,b.substring(e,g),c);f==void 0?d=null:(d.nb=f,e=g+1)}d&&(b=fd(a,b.substring(e),c),b==void 0?d=null:d.O=b&a.wa)}return d}function gd(a,b,c,d){d=d===void 0?a.g:d;a.H++;var e=d.lb(b.O);c&&dd(a,b,c,d);a.H--;return e}
function hd(a,b,c){if(a.L<=32)return b&c;b=X(a,b,0,!0);c=X(a,c,0,!0);return((b/F|0)&(c/F|0))*F+((b&c)>>>0)}function id(a,b,c){if(a.L<=32)return b^c;b=X(a,b,0,!0);c=X(a,c,0,!0);return((b/F|0)^(c/F|0))*F+((b^c)>>>0)}
function jd(a,b,c,d){for(d=d===void 0?-1:d;d--&&c.length;){var e=c.pop();if(b.length<2)return!1;var g=b.pop();var f=b.pop();switch(e){case "*":f*=g;break;case "/":if(!g)return!1;f=Math.trunc(f/g);break;case "^/":if(!g)return!1;f%=g;break;case "+":f+=g;break;case "-":f-=g;break;case "<<":f<<=g;break;case ">>":f>>=g;break;case ">>>":f>>>=g;break;case "<":f=f<g?1:0;break;case "<=":f=f<=g?1:0;break;case ">":f=f>g?1:0;break;case ">=":f=f>=g?1:0;break;case "==":f=f==g?1:0;break;case "!=":f=f!=g?1:0;break;
case "&":f=hd(a,f,g);break;case "!":case "|":e=a;e.L<=32?f|=g:(f=X(e,f,0,!0),g=X(e,g,0,!0),f=(f/F|0|g/F|0)*F+((f|g)>>>0));break;case "^!":f=id(a,f,g);break;case "&&":f=f&&g?1:0;break;case "||":f=f||g?1:0;break;case ",,":f=X(a,f,18,!0)*262144+X(a,g,18,!0);break;case "_":case "^_":e=="^_"&&(g=35-(g&255));g&&(f=X(a,f,0,!0),f=g>0?f*Math.pow(2,g):Math.trunc(f/Math.pow(2,-g)));break;default:return!1}b.push(X(a,f))}return!0}
function kd(a,b,c,d,e,g){var f,h=!1,k=0,n=[],l=[],t=a.ca;for(a.ca=e;c<d;){var m=b[c++].trim();var q=c<d?b[c++]:"";if(m){var v=void 0;var u=a;var x=m,y=g;k=k===void 0?0:k;if(x!=void 0){v=rb(u,x.toUpperCase());if(v==void 0){v=void 0;var z=u,Ac=bd(z.na,{address:null,type:0,name:x},z.jc);Ac>=0&&(v=z.na[Ac].address.O);if(v==void 0)if(v=u,z=x,v.N[z]?v=v.N[z].value:(z=z.substr(0,6),v=v.N[z]&&v.N[z].value),v==void 0)v=Da(x,x.length>1||u.ca>10?u.ca:10);else if(x=u.N[x]&&u.N[x].Ze)y?y.push(x):(y=fd(u,x,y),
y!==void 0?v+=y:v=void 0)}v!=void 0&&(v=X(u,ld(u,v,k)))}u=v}else if(q=="{"){m=1;for(u=c;c<d;)if(c++,q=c<b.length?b[c++]:"",q=="{")m++;else if(q=="}"&&!--m)break;u=kd(a,b,u,c-1,a.ca,g);u!=null&&k&&(u=ld(a,u,k));m=c<d?b[c++].trim():"";q=c<d?b[c++]:""}else{if(q==" ")continue;if(q=="^B"){a.ca=2;continue}if(q=="^O"){a.ca=8;continue}if(q=="^D"){a.ca=10;continue}if(!(k&-1073741824)){if(q=="+")continue;if(q=="-"){k=k<<2|1;continue}if(q=="~"||q=="^-"){k=k<<2|2;continue}if(q=="^L"){k=k<<2|3;continue}}h=!0;
break}if(u===void 0)if(g)g.push(m),u=0;else{h=!0;break}n.push(X(a,u));if(q==" ")if(c<b.length-1&&!b[c])c++,q=b[c++];else{h=!0;break}if(!q)break;u=a.$[0]=="<"?md:nd;if(!u[q]){h=!0;break}l.length&&u[q]<=u[l[l.length-1]]&&jd(a,n,l,1);l.push(q);a.ca=q=="^_"?10:e;k=0}if(h||!jd(a,n,l)||n.length!=1)h=!0;h?g||a.m("parse error (%s)\n",m||q):f=n.pop();a.ca=t;return f}
function od(a,b,c,d){for(var e,g=a.L/d|0;(e=b.indexOf(c))>=0;){for(var f=0,h=e+1,k=g;h<b.length;){var n=b[h++];if(n==c){k=-1;break}if(!k)break;k--;n=n.charCodeAt(0);d==6&&(n-=32);n&=(1<<d)-1;f=X(a,f*Math.pow(2,d)+n,d*g,!0)}if(k>=0){a.m("parse error (%c%s%c)\n",c,b,c);return}b=b.substr(0,e)+E(a,f)+b.substr(h)}return b}
function fd(a,b,c){if(b){a.$[0]!="{"&&(b=b.split(a.$[0]).join("{").split(a.$[1]).join("}"));b=od(a,b,'"',8);if(!b)return d;b=od(a,b,"'",6);if(!b)return d;a.ca!=16&&(b=b.replace(/(^|[^A-Z0-9$%.])([0-9]+)B/,"$1$2^_").replace(/\s+/g," "));b=b.split(/({|}|\|\||&&|\||\^!|\^B|\^O|\^D|\^L|\^-|~|\^_|_|&|!=|!|==|>=|>>>|>>|>|<=|<<|<|-|\+|\^\/|\/|\*|,,| )/);var d=kd(a,b,0,b.length,a.ca,c)}return d}
function ld(a,b,c){for(;c;){var d;switch(c&3){case 1:b=-X(a,b);break;case 2:b=id(a,b,-1);break;case 3:for(d=35;d>=0&&!hd(a,b,Math.pow(2,d));)d--;b=35-d}c>>>=2}return b}function X(a,b,c,d){var e=b;c=c||a.L;if(d)if(c==32)e=b>>>0;else if(c<32)e=b&(1<<c)-1;else{if(a=Math.pow(2,c),b<0||b>=a)e=b%a,e<0&&(e+=a)}else c<=32?e=b<<32-c>>32-c:(a=Math.pow(2,c-1),b>=a?(e=b%a,(b/a|0)&1&&(e-=a)):b<-a&&(e=b%a,((-b-1)/a|0)&1?e&&(e+=a):e||(e-=a)));b!=e&&(b=e);return b}
p.ib=function(a){function b(h){for(var k=0;k<h.length;k++)if(h[k]!=void 0)return!1;return!0}if(a<-1)return pd(this,this.ib);var c="";if(a>=0){var d=this.i[a];if(d!=void 0){c=d>>8;d&=255;var e=this.o[c];if(e){var g=this.v[c],f=g[d];(c&1?e.qb(f.O,this.l[c]):e.Ya(f.O,this.l[c]))?(g[d]=void 0,this.i[a]=void 0,b(g)&&(g.length=0,b(this.i)&&(this.i.length=0)),c=this.u("%2d: %s %*a cleared\n",a,qd[c],e.ba,f),--this.ea||this.fa||(c+=rd(this,!1))):c=this.u("invalid break address: %*a\n",e.ba,f)}else c="invalid bus"}else c=
this.u("invalid break index: %d\n",a)}else c="missing break index\n";return c};function sd(a,b){if(a.X&&(b==void 0||a.X.O==b)){var c=c===void 0?W.ka:c;b=-1;var d=td(a.X,a.v[c]);if(d>=0)for(var e=0;e<a.i.length;e++){var g=a.i[e];if(g!=void 0&&c==g>>8&&d==(g&255)){b=e;break}}c=b;c>=0&&a.ib(c);a.X=null}}
p.jb=function(a,b){b=b===void 0?!1:b;if(a<-1)return pd(this,this.jb,b);if(a>=0){var c=this.i[a];if(c!=void 0){var d=c>>8;c=this.v[d][c&255];if(c!=void 0){var e=b?"enabled":"disabled",g=this.o[d];!c.disabled==!b?(c.disabled=!b,a=this.u("%2d: %s %*a %s\n",a,qd[d],g.ba,c,e)):a=this.u("%2d: %s %*a already %s\n",a,qd[d],g.ba,c,e)}else a=this.u("no break address at index: %d\n",a)}else a=this.u("invalid break index: %d\n",a)}else a="missing break index\n";return a};
function pd(a,b,c){for(var d="",e=0;e<a.i.length;e++)a.i[e]!=void 0&&(d+=b.call(a,e,c));d||(d="no break addresses found");return d}function ud(a,b,c){c=c===void 0?W.ka:c;a=a.v[c];for(c=0;c<a.length;c++){var d=a[c];if(d.O==b)return d}}function td(a,b){for(var c=0;c<b.length;c++)if(b[c].O==a.O)return c;return-1}
function vd(a,b){b=b===void 0?!1:b;for(var c="",d=0;d<a.i.length;d++){var e=a.i[d];if(e!=void 0){var g=e>>8;e=a.v[g][e&255];g=a.u("%s %*a",qd[g],a.o[g].ba,e);b?(c&&(c+=";"),c+=g,e.disabled&&(c+=";bd "+d)):c+=a.u("%2d: %s %s\n",d,g,e.disabled?"disabled":"enabled")}}c||b||(c="no break addresses found\n");return c}
function wd(a,b,c){c=c===void 0?W.ka:c;if(b){var d=a.o[c];if(d){var e=a.v[c];var g=td(b,e);if(g>=0)g=-(g+1);else{for(g=0;g<e.length&&e[g]!=void 0;g++);e[g]=b}e=g;if(e>=0)if(g=c&1?d.ob(b.O,a.l[c]):d.Xa(b.O,a.l[c])){for(g=0;g<a.i.length&&a.i[g]!=void 0;g++);a.i[g]=c<<8|e;b=a.u("%2d: %s %*a set\n",g,qd[c],d.ba,b);a.ea++||a.h.length||(b+=rd(a,!0))}else b=a.u("invalid break address: %*a\n",d.ba,b),a.v[c][e]=void 0;else b=a.u("%s %*a already set\n",qd[c],d.ba,b)}else b="invalid bus"}else b="missing break address\n";
return b}function xd(a,b){b>=0&&(a.K=b);var c="instruction break count: "+(a.K>0?a.K:"disabled")+"\n";b>0&&(a.h.length||(c+=rd(a,!0)),a.fa=!0);return c}function yd(a,b){var c;if(b){var d=bb(b);d!=void 0?a.ja=d?0xffffffffffff:0:c=a.u("unrecognized message option: %s\n",b)}c||(c=a.u("break on message: %b\n",!!a.ja));return c}p.fd=function(a,b){this.H||(a==void 0?Y(this,"break on unknown input %#0x: %#0x",b):(a=ud(this,a+b,W.Ba))&&!a.disabled&&Y(this,"break on input %*a: %#0x",this.j.ba))};
p.gd=function(a,b){this.H||(a==void 0?Y(this,"break on unknown output %#0x: %#0x",b):(a=ud(this,a+b,W.Ca))&&!a.disabled&&Y(this,"break on output %*a: %#0x",this.j.ba))};p.hd=function(a,b){this.H||(a==void 0?Y(this,"break on unknown read %#0x: %#0x",b):(a+=b,this.h.length&&a==this.T.mb&&(this.aa++,this.K>0&&(--this.K||Y(this,"break on instruction count")),this.h[this.S++]=a,this.S==this.h.length&&(this.S=0)),(b=ud(this,a,W.ka))&&!b.disabled&&(Y(this,"break on read %*a: %#0x",this.g.ba),sd(this,a))))};
p.jd=function(a,b){this.H||(a==void 0?Y(this,"break on unknown write %#0x: %#0x",b):(a=ud(this,a+b,W.Fa))&&!a.disabled&&Y(this,"break on write %*a: %#0x",this.g.ba))};function Y(a,b,c){b=a.u.apply(a,[b].concat(A(c)));a.m("%s\n",b);uc(a.time)}function zd(a,b,c){c=c===void 0?a.g:c;return E(a,b.O,a.ca,c.ba,"")}
function Ad(a,b,c){c=c===void 0?10:c;var d="";if(a.h.length){var e,g=[];c>a.h.length&&(c=a.h.length);b<0&&(b=c);var f=a.S-b;for(f<0&&(f+=a.h.length);f>=0&&f<a.h.length&&c>0;){var h=a.h[f++];if(h==void 0)break;f==a.h.length&&(f=0);e?e.O=h:e=Yc(h);for(h=0;h<1;h++)g[h]=gd(a,e,1);dd(a,e,-g.length);d+=a.pb(e,g,a.u("[%6d]",b--));c--}}return d||"no history"}
function Bd(a,b,c){var d=[],e="";for(b=typeof b=="number"?Yc(b):b;c--;){for(dd(a,b,d.length);d.length<1;)d.push(gd(a,b,1));dd(a,b,-d.length);e+=a.pb(b,d)}return e}
function Cd(a,b,c,d,e,g){var f="";g=g?a.j:a.g;c||(c=g.i);var h=c>>3;d||(d=128);var k=0,n=d+15>>4||1,l=h==4?16:a.ca;e=="y"&&(l=h,n=d,k=h*8);b||(b=a.qa);for(;n--&&d>0;){var t=e=0,m,q="",v="",u=zd(a,b,g);for(m=l;m>0&&d>0;m--){var x=gd(a,b,1,g);e|=x<<(t++<<3);t==h&&(q+=E(a,e,0,c,""),q+=h==1?m==9?"-":" ":" ",k&&(v+=E(a,e,2,c,"")),e=t=0);k||(v+=x>=32&&x<127?String.fromCharCode(x):".");d--}f&&(f+="\n");f+=u+"  "+q+" "+v}a.qa=b;return f}
p.rd=function(){var a=[];pb(this,function(b){b.Ia&&b.Ia(a);return!0});return JSON.stringify(a,null,2)};function Dd(a,b,c,d){var e=0,g="";d=d?a.j:a.g;for(var f=0;b!=void 0&&f<c.length;f++){var h=gd(a,b,0,d);if(h==void 0)break;var k=a,n=b,l=c[f],t=d;t=t===void 0?k.g:t;k.H++;t.rb(n.O,l);k.H--;g+=a.u("%*a: %#*n changed to %#*n\n",a.g.ba,b,a.g.i,h,a.g.i,c[f]);dd(a,b,1,d);e++}e||(g+=a.u("%d locations updated\n",e));a.time.update();return g}
function rd(a,b){var c="";b!=void 0&&b==!a.h.length&&Pc(a.g,function(d){b?a.g.Xa(d.ya,a.l[W.ka]):a.g.Ya(d.ya,a.l[W.ka])})&&(b?(a.S=0,a.h=Array(Ed)):a.h=[]);return c+=a.u("instruction history %s\n",a.h.length?"enabled":"disabled")}p.ta=function(a){var b=a.shift();return this.U==b?($a(this,a.shift()),this.I.ga=a.shift(),!0):!1};p.oc=function(a){Ea(this.ja,a)?Y(this,"break on message"):this.time.X=!0};
p.td=function(a){var b=a[1],c=a[2],d=[],e=[],g=!1,f="";this.R=void 0;if(c=="*")var h=-2;else{h=Da(c);h==void 0&&(h=-1);var k=$c(this,c,e);if(k===null)return}var n=0;a[3]&&(n=Da(a[3].substr(a[3][0]=="l"?1:0))||8);for(var l=3;l<a.length;l++)d.push(Da(a[l],16));if(b=="d"){l=Zc(this,c,d);if(l!=void 0)return l;b=this.W||b}if(b[0]!="s"&&e.length)return"unrecognized symbol(s): "+e;switch(b[0]){case "b":b[1]=="c"?f=this.ib(h):b[1]=="d"?f=this.jb(h):b[1]=="e"?f=this.jb(h,!0):b[1]=="i"?f=wd(this,k,W.Ba):b[1]==
"l"?f=vd(this):b[1]=="m"?f=yd(this,c):b[1]=="n"?f=xd(this,h):b[1]=="o"?f=wd(this,k,W.Ca):b[1]=="r"?f=wd(this,k,W.ka):b[1]=="w"?f=wd(this,k,W.Fa):b[1]=="?"?(f="break commands:\n",Fd.forEach(function(t){f+=t+"\n"})):b[1]&&(f=void 0);break;case "d":this.W=b;if(b[1]!="b"&&b[1])if(b[1]=="w")c=16;else if(b[1]=="d")c=32;else if(b[1]=="i"){if(!this.j){f="invalid bus";break}c=this.j.i;n=n||1;g=!0}else{if(b[1]=="h")this.W="",f=Ad(this,h,n);else if(b[1]=="?"){if(this.W="",f="dump commands:\n",Gd.forEach(function(t){f+=
t+"\n"}),this.J.length)for(f+="dump extensions:\n",b=0;b<this.J.length;b++)k=this.J[b],f+=this.u("d   %-12s%s\n",k.name,k.pd)}else this.W="",f=void 0;break}else c=8;f=Cd(this,k,c,n,b[2],g);break;case "e":if(b[1]=="o"){if(!this.j){f="invalid bus";break}g=!0}else if(b[1]){f=void 0;break}f=Dd(this,k,d,g);break;case "g":if(this.time.start()){if(k!=void 0){sd(this);f=wd(this,k);if(f.indexOf(":")!=2)break;this.X=k;f=""}break}f="already started\n";break;case "h":uc(this.time)||(f="already stopped\n");break;
case "p":a.shift();a.shift();b=a.join(" ");f+=this.u("%s = %s\n",b,E(this,fd(this,b)));break;case "r":if(b=b.substr(1).toUpperCase()){if(rb(this.T,b)==void 0){f+=this.u("unrecognized register: %s\n",b);break}k!=void 0&&vb(this.T,b,k.O)}this.da.O=this.T.i;f+=this.T.toString();break;case "s":k=bb(c);if(b[1]=="h"){if(this.ea||this.K>0)k=void 0;f=rd(this,k);k!=void 0&&(this.fa=k)}else b[1]=="p"?h>0?(rc(this.time,h),f="target speed:  "+xc(this.time.v)):f="current speed: "+Gc(this.time):b[1]=="s"&&this.ra?
(h=this.ra.indexOf(c),h>=0&&(this.style=this.ra[h]),f="style: "+this.style):b[1]=="?"?(f="set commands:\n",Hd.forEach(function(t){f+=t+"\n"})):f=void 0;break;case "t":n=Da(c,10)||1;this.R=!0;if(b[1]){if(b[1]!="r"){f=void 0;break}this.R=!1}zc(this.time,n);break;case "u":if(b[1]){f=void 0;break}n||(n=8);k||(k=this.da);f+=Bd(this,k,n);this.da=k;break;case "?":f="debugger commands:\n";Id.forEach(function(t){f+=t+"\n"});break;default:f=void 0}f==void 0&&a[0]&&(f="unrecognized command '"+a[0]+"' (try '?')\n");
return f};p.kb=function(a){return a&&this.ta(a[0])?(a.shift(),!0):!1};p.Ia=function(a){var b=[];this.va(b);a.push(b);this.Y=0};p.qc=function(a){a&&(this.time.g?this.Y&&this.input&&Sb(this.input):this.R?this.za(Bd(this,this.T.i,1)):(this.aa&&(this.T.m("%d instructions executed\n",this.aa),this.aa=0),this.T.za(this.T.toString()),this.R==void 0&&this.Y&&(a=this.sa(Ja.Oa,!0))&&a.focus()),this.Y++)};p.va=function(a){a.push(this.U);a.push(vd(this,!0));a.push(this.I.ga)};
p.pb=function(a,b,c){var d=this.u,e=zd(this,a);b=b.shift();dd(this,a,1);return d.call(this,"%s %02x       unsupported       ; %s\n",e,b,c||"")};
var Id="b?\t\tbreak commands;d?\t\tdump commands;e[o] [addr] ...\tedit memory/ports;g    [addr]\trun (to addr);h\t\thalt;p    [expr]\tparse expression;r?   [value]\tdisplay/set registers;s?\t\tset commands;t[r] [n]\tstep (n instructions);u    [addr] [n]\tunassemble (at addr)".split(";"),Fd="bc [n|*]\tclear break address;bd [n|*]\tdisable break address;be [n|*]\tenable break address;bl [n]\t\tlist break addresses;bi [addr]\tbreak on input;bo [addr]\tbreak on output;br [addr]\tbreak on read;bw [addr]\tbreak on write;bm [on|off]\tbreak on message;bn [count]\tbreak on instruction count".split(";"),Gd=
"db  [addr]\tdump bytes (8 bits);dw  [addr]\tdump words (16 bits);dd  [addr]\tdump dwords (32 bits);di  [addr]\tdump input ports;d*y [addr]\tdump values in binary;dh  [n] [l]\tdump instruction history buffer;ds\t\tdump machine state".split(";"),Hd=["sh [on|off]\tset instruction history","sp [n]\t\tset speed multiplier","ss\t\tset debugger style"],ed={dc:1,Nc:0,Oc:2,Ke:0},W={ka:0,Fa:1,Ba:2,Ca:3},Jd={},qd=(Jd[W.ka]="br",Jd[W.Fa]="bw",Jd[W.Ba]="bi",Jd[W.Ca]="bo",Jd),Z={BYTE:1,Mc:2,Pc:4,Kb:5,zb:6,bd:7},
ad={"=":Z.bd,1:Z.BYTE,2:Z.Mc,4:Z.Pc,"@":Z.Kb,";":Z.zb},Ed=1E5,nd={"||":5,"&&":6,"!":7,"|":7,"^!":8,"&":9,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,_:19,"^_":19,"{":20,"}":20},md={",,":1,"||":5,"&&":6,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,"!":15,"|":15,"^!":15,"&":15,_:19,"^_":19,"{":20,"}":20};function Kd(a,b,c){Vc.call(this,a,b,c)}w(Kd,Vc);D.CPUx86=Kd;
function Ld(a,b,c){Xc.call(this,a,b,c)}w(Ld,Xc);Ld.prototype.pb=function(a,b,c){var d=zd(this,a),e="",g=cd(this,a,Z.Kb),f=cd(this,a,Z.zb);b=b.shift();e+=E(this,b,16,8,"");dd(this,a,1);a=this.u("%#02x",b);d=this.u("%s %-7s %-7s %s",d,e,a,"");c?f&&(c+=" "+f):f&&(c=f);c&&(d=this.u("%-32s; %s",d,c));g&&(d=g+":\n"+d);return d+"\n"};D.Dbgx86=Ld;
function Md(a,b,c){S.call(this,a,b,c);this.W=this.config.bufferAddr;this.L=this.config.interruptRate;this.N=this.config.refreshRate||60;this.S=N(this,this.config.bus);this.T=O(this,"CPU");this.time=O(this,"Time");this.R=Db(this.time,this.U,this.Y.bind(this));this.time.W.push(this);Ib(this.time,this.R,1E3/Math.max(this.N,this.L))}w(Md,S);Md.prototype.qc=function(){};
Md.prototype.Y=function(a){if(!a){if(this.$&&this.aa){a=this.S;var b=this.W,c=this.aa,d=b>>>a.h;for(b=a.blockSize-(b&a.l);c>0&&d<a.g.length;){var e=a.g[d];e.l&&(e.l=!1,e.h.type==Lc&&(e.i?e.j=e.sb:e.pa=e.sb));c-=b;b=a.blockSize;d++}}Ib(this.time,this.R,1E3/Math.max(this.N,this.L))}};D.PCx86Video=Md;
function Nd(a,b,c){M.call(this,a,a);var d=this;this.i=!1;this.v=c;this.h="";this.o=this.l=!1;sb(this,!1);this.ga=0;b=b.trim();b[0]=="{"?Od(this,b):(this.h=b,Ua(this.h,function(e,g,f,h){f==4&&(!h&&g?(Od(d,g),Pd(d)):d.m("error (%d) loading configuration: %s\n",h,e))}));window.addEventListener("load",function(){d.o=!0;Pd(d)});window.addEventListener(Ya("iOS")?"pagehide":Ya("Opera")?"unload":"beforeunload",function(){Qd(d)});window.addEventListener("pageshow",function(){d.i||d.ia(!0)})}w(Nd,M);
Nd.prototype.xa=function(a,b){var c=this;switch(a){case Rd:b.onclick=function(){c.ia()};break;case Sd:b.onclick=function(){c.ma()}}M.prototype.xa.call(this,a,b)};
function Pd(a){var b=!0;if(a.l&&a.o){for(var c in a.g){var d=void 0,e=a.g[c];try{d=e["class"],D[d]?d=="Machine"?(a.m("PCjs %s v%3.2f\n%s\n",e.name,3,"Copyright \u00a9 2012-2025 Jeff Parsons <Jeff@pcjs.org>"),a.h&&a.m("Configuration: %s\n",a.h)):new D[d](a.M,c,e):a.m('unrecognized %s device "%s"\n',d,c)}catch(f){e.optional||(a.m('error initializing %s device "%s": %s\n',d,c,f.message),b=!1),ub(a,c)}}if(a.j){var g=Za(a);pb(a,function(f){return f.kb&&!f.kb(g)?(f.m('unable to restore state for device "%s"\n',
f.U),!1):!0})}sb(a,!0);tb(a,a.ia.bind(a,b))||a.m("machine %s not ready to power, waiting for device(s)\n",a.M)}}
function Od(a,b){try{a.g=JSON.parse(b);var c=a.g[a.M];if(!c){c=a.g[Ga(a.h)];if(!c)throw Error("configuration missing machine ID");a.g[a.M]=c}ob(a,c,["autoSave","autoStart"]);a.j=a.config.autoSave!==!1;a.H=a.config.autoStart!==!1;if(a.v){var d=eval("("+a.v+")"),e;for(e in d)a.config[e]=d[e]}a.l=!0}catch(g){c=g.message,(d=c.match(/position ([0-9]+)/))&&(c+=" ('"+b.substr(+d[1],40).replace(/\s+/g," ")+"...')"),a.m("machine '%s' initialization error: %s\n",a.M,c)}}
Nd.prototype.ia=function(a){a=a===void 0?!this.i:a;if(P(this)){var b=this;a&&this.m("power on\n");pb(this,function(c){c.ia&&c!=b&&(c.config["class"]!="CPU"||b.H&&P(b)?c.ia(a):c.time.update(!0));return!0});(this.i=a)||this.m("power off\n")}};Nd.prototype.ma=function(){if(P(this)){var a=this;pb(this,function(b){b.ma&&b!=a&&b.ma();return!0});this.m("reset\n")}};function Qd(a){if(a.j){var b=[];pb(a,function(c){c.Ia&&c.Ia(b);return!0});gb(a,b)}a.ia(!1)}var Rd="power",Sd="reset";
window.PCx86v3=function(a,b,c){var d=new Nd(a,b,c);window.command=function(e){return $a(d,e)};return d};D.Machine=Nd;})()

//# sourceMappingURL=pcx86v3.js.map
