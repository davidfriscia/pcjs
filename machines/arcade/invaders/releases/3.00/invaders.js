(function(){/*
 https://www.pcjs.org/machines/modules/v3/defines.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/message.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v2/format.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/stdlib.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/stdio.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/webio.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/device.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/input.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/led.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/monitor.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/time.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/bus.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/memory.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/ports.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/ram.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/rom.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/cpu.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/debugger.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/modules/v3/cpux80.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/modules/v3/dbgx80.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/arcade/invaders/modules/v3/ports.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/arcade/invaders/modules/v3/video.js (C) 2012-2026 Jeff Parsons
 https://www.pcjs.org/machines/modules/v3/machine.js (C) 2012-2026 Jeff Parsons
*/
var g,aa=typeof Object.create=="function"?Object.create:function(a){function b(){}b.prototype=a;return new b},ba=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};
function ca(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var da=ca(this),ea="Int8 Uint8 Uint8Clamped Int16 Uint16 Int32 Uint32 Float32 Float64".split(" ");da.BigInt64Array&&(ea.push("BigInt64"),ea.push("BigUint64"));
function fa(a,b){if(b)for(var c=0;c<ea.length;c++)ha(ea[c]+"Array.prototype."+a,b)}function ia(a,b){b&&ha(a,b)}function ha(a,b){var c=da;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))return;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&b!=null&&ba(c,a,{configurable:!0,writable:!0,value:b})}var ja;
if(typeof Object.setPrototypeOf=="function")ja=Object.setPrototypeOf;else{var ka;a:{var la={a:!0},ma={};try{ma.__proto__=la;ka=ma.a;break a}catch(a){}ka=!1}ja=ka?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var na=ja;
function m(a,b){a.prototype=aa(b.prototype);a.prototype.constructor=a;if(na)na(a,b);else for(var c in b)if(c!="prototype")if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.Ok=b.prototype}function oa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}
function pa(a){if(!(a instanceof Array)){var b=typeof Symbol!="undefined"&&Symbol.iterator&&a[Symbol.iterator];if(b)a=b.call(a);else if(typeof a.length=="number")a={next:oa(a)};else throw Error(String(a)+" is not an iterable or ArrayLike");for(var c=[];!(b=a.next()).done;)c.push(b.value);a=c}return a}function sa(){for(var a=Number(this),b=[],c=a;c<arguments.length;c++)b[c-a]=arguments[c];return b}
ia("String.prototype.replaceAll",function(a){return a?a:function(b,c){if(b instanceof RegExp&&!b.global)throw new TypeError("String.prototype.replaceAll called with a non-global RegExp argument.");return b instanceof RegExp?this.replace(b,c):this.replace(new RegExp(String(b).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"),"g"),c)}});
ia("Math.trunc",function(a){return a?a:function(b){b=Number(b);if(isNaN(b)||b===Infinity||b===-Infinity||b===0)return b;var c=Math.floor(Math.abs(b));return b<0?-c:c}});ia("String.prototype.repeat",function(a){return a?a:function(b){if(this==null)throw new TypeError("The 'this' value for String.prototype.repeat must not be null or undefined");var c=this;if(b<0||b>1342177279)throw new RangeError("Invalid count value");b|=0;for(var d="";b;)if(b&1&&(d+=c),b>>>=1)c+=c;return d}});
ia("Number.isNaN",function(a){return a?a:function(b){return typeof b==="number"&&isNaN(b)}});ia("Math.log2",function(a){return a?a:function(b){return Math.log(b)/Math.LN2}});
ia("Symbol",function(a){function b(h){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c(d+(h||"")+"_"+e++,h)}function c(h,f){this.g=h;ba(this,"description",{configurable:!0,writable:!0,value:f})}if(a)return a;c.prototype.toString=function(){return this.g};var d="jscomp_symbol_"+(Math.random()*1E9>>>0)+"_",e=0;return b});
ia("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");ba(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return ta(oa(this))}});return a});function ta(a){a={next:a};a[Symbol.iterator]=function(){return this};return a}function ua(a,b){a instanceof String&&(a+="");var c=0,d=!1,e={next:function(){if(!d&&c<a.length){var h=c++;return{value:b(h,a[h]),done:!1}}d=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e}
ia("Array.prototype.keys",function(a){return a?a:function(){return ua(this,function(b){return b})}});ia("Array.prototype.fill",function(a){return a?a:function(b,c,d){var e=this.length||0;c<0&&(c=Math.max(0,e+c));if(d==null||d>e)d=e;d=Number(d);d<0&&(d=Math.max(0,e+d));for(c=Number(c||0);c<d;c++)this[c]=b;return this}});fa("fill",function(a){return a?a:Array.prototype.fill});ia("Number.parseInt",function(a){return a||parseInt});
ia("Array.prototype.values",function(a){return a?a:function(){return ua(this,function(b,c){return c})}});function va(){this.Z=""}var xa,ya=new ArrayBuffer(2);(new DataView(ya)).setUint16(0,256,!0);xa=(new Uint16Array(ya))[0]===256;var za={Dk:typeof window!="undefined",node:typeof window!="undefined"?{}:global,process:typeof process!="undefined"?process:{},window:typeof window!="undefined"?window:global,document:typeof document!="undefined"?document:{},rb:{machines:{},components:[],commands:{},files:null}};
za.window.PCjs?za.rb=za.window.PCjs:za.window.PCjs=za.rb;var Aa=za.process,Ba=za.rb.machines,Ca=za.rb.components,n={};n.Defines=va;
var Da={all:0xffffffffffff,addr:1,bus:2,fault:4,memory:8,ports:16,chips:32,kbd:64,serial:128,misc:256,cpu:512,mmu:2048,"int":1024,trap:4096,video:8192,monitor:16384,screen:32768,disk:131072,file:65536,time:262144,timer:524288,event:1048576,input:2097152,key:4194304,mouse:8388608,touch:16777216,info:274877906944,warn:549755813888,error:1099511627776,halt:70368744177664,buffer:0x800000000000};function Ea(){this.g={};for(var a=0;a<23;a++)this.g["ACDFGHMNSTWYBbdfjcsoXx%"[a]]=null}
Ea.prototype.O=function(a,b){return this.g[a]?!1:(this.g[a]=b,!0)};function Fa(){var a=sa.apply(0,arguments);if(a[0]===void 0)a=new Date(Date.now());else if(typeof a[0]==="string"){var b=a[0];b.indexOf(":")<0?b+=" "+(a[1]||"00:00:00 UTC"):b.match(/^[0-9][0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9] [0-9][0-9]:[0-9][0-9]:[0-9][0-9]$/)&&(a[1]||(b+=" UTC"));a=new Date(b)}else a=a[1]===void 0?new Date(a[0]):new Date(Date.UTC.apply(Date,pa(a)));return a}
Ea.prototype.h=function(a){var b=sa.apply(1,arguments);if(!b||!b.length)return a;var c="",d=a.split(/%([-+ 0#]*)([0-9]*|\*)(\.[0-9]+|)([bwhlL]?)([A-Za-z%])/),e=0,h;for(h=0;h<d.length-6;h+=6){c+=d[h];var f=d[h+5];if(this.g[f]===void 0)c+="%"+d[h+1]+d[h+2]+d[h+3]+d[h+4]+f;else{if(e<b.length){var k=b[e];f!="%"&&e++}else k=b[b.length-1];var l=!1,q=d[h+1],p=q.indexOf("#")>=0,u=q.indexOf("0")>=0,r=d[h+2];r=="*"?(r=k,k=e<b.length?b[e++]:b[b.length-1]):r=+r||0;var t=d[h+3];t=t?+t.substr(1):-1;var x=d[h+4],
w=null,B=0,y="",z="ACDFGHMNSTWY".indexOf(f)>=0&&typeof k!="object"?Fa(k):k;switch(f){case "C":c+=isNaN(z.getTime())?void 0:this.h("%#W, %#F %#D, %#Y".replaceAll("#",p?"#":""),z);continue;case "D":k=p?z.getUTCDate():z.getDate();f="d";break;case "A":case "G":case "H":k=p?z.getUTCHours():z.getHours();f=="A"?(k=k<12?"am":"pm",f="s"):(f=="G"&&(k=k?k>12?k-12:k:12),f="d");break;case "F":case "M":k=p?z.getUTCMonth():z.getMonth();f=="F"?(k=Ha[k],f="s"):(k++,f="d");break;case "N":k=p?z.getUTCMinutes():z.getMinutes();
f="d";break;case "S":k=p?z.getUTCSeconds():z.getSeconds();f="d";break;case "T":c+=isNaN(z.getTime())?void 0:this.h("%#Y-%#02M-%#02D %#02H:%#02N:%#02S".replaceAll("#",p?"#":""),z);continue;case "W":k=Ia[p?z.getUTCDay():z.getDay()];f="s";break;case "Y":k=p?z.getUTCFullYear():z.getFullYear(),t>0&&(k%=Math.pow(10,t)),f="d"}switch(f){case "b":c+=k?"true":"false";break;case "d":k=Math.trunc(k),t>=0&&(u=!0,r<t&&(r=t),t=-1);case "f":k=+k;f=k+"";t>=0&&(f=k.toFixed(t));f.length<r&&(u?(k<0&&(r--,f=f.substr(1)),
f=("0".repeat(r)+f).slice(-r),k<0&&(f="-"+f)):f=(" ".repeat(r)+f).slice(-r));c+=f;break;case "j":c+=JSON.stringify(k,null,r||void 0);break;case "c":k=typeof k=="string"?k[0]:String.fromCharCode(k);case "s":if(k!=void 0)for(typeof k!="string"&&(k=k.toString()),t>=0&&(k=k.substr(0,t));k.length<r;)k=q.indexOf("-")>=0?k+" ":" "+k;c+=k;break;case "B":B=2,p&&(y="0b");case "o":B||(B=8),!y&&p&&(y="0o");case "X":w=Ja;case "x":f="";B||(B=16);!y&&p&&(y="0x");w||(w=Ka);typeof k=="string"&&k[0]=="-"&&(l=!0,k=
k.slice(1));k=Math.trunc(k);l&&(k=-k);k<0&&((k|0)==k?k>>>=0:Math.abs(k)<=9007199254740992&&(k+=9007199254740992));t>=0&&(u=!0,r<t&&(r=t));u&&!r&&(x=="b"?r=2:x=="h"||x=="w"?r=4:x=="l"?r=8:(r=Math.abs(k),r=r<=255?2:r<=65535?4:r<=4294967295?8:9),r+=y.length);r-=y.length;do l=16,Number.isNaN(k)||(l=k&B-1,k=Math.trunc(k/B)),u||!f||l||k?f=w[l]+f:(y&&(f=y+f,y=""),r>0&&(f=" "+f));while(--r>0||k);c+=y+f;break;case "%":c+="%";break;default:c=this.g[f]?c+this.g[f](f,q,r,t,k):c+("(unimplemented sprintf type: %"+
f+")")}}}return c+=d[h]};var Ia="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Ha="January February March April May June July August September October November December".split(" "),Ka="0123456789abcdef?",Ja="0123456789ABCDEF?";function La(){va.apply(this,arguments)}m(La,va);
function Ma(a,b){if(a){b||(b=10);var c,d=a.indexOf(",")>0;d&&(a=a.replace(/,/g,""));var e=c=a.charAt(0);c=="#"?(b=8,c=""):c=="$"&&(b=16,c="");e!=c?a=a.substr(1):(e=c=a.substr(0,2),c=="0b"&&d||c=="^B"?(b=2,c=""):c=="0o"||c=="^O"?(b=8,c=""):c=="^D"?(b=10,c=""):c=="0x"&&(b=16,c=""),e!=c&&(a=a.substr(2)));e=c=a.slice(-1);c=="Y"||c=="y"?(b=2,c=""):c=="."?(b=10,c=""):c=="H"||c=="h"?(b=16,c=""):c=="K"?c="000":c=="M"?c="000000":c=="G"&&(c="000000000");e!=c&&(a=a.slice(0,-1)+c);var h;e=0;b<=10&&(c=a.match(/(-?[0-9]+)B([0-9]*)$/))&&
(a=c[1],e=35-((c[2]||35)&255));if((b&&b!=10?b==16?a.match(/^-?[0-9a-f]+$/i)!==null:b==8?a.match(/^-?[0-7]+$/)!==null:b==2&&a.match(/^-?[01]+$/)!==null:a.match(/^[+-]?[0-9]+$/)!==null)&&!isNaN(h=parseInt(a,b))){e&&(h<0&&(h+=68719476736),h=e>0?h*Math.pow(2,e):Math.trunc(h/Math.pow(2,-e)));var f=h}}return f}function Na(a,b){if(a){var c=0;for(var d=1,e=0;e<a.length;e++){var h=a.charAt(e);c=b==-1?c|(h!="0"&&h!="1"?0:d):c|(h=="0"?d:0);d<<=1}}else c=b;return c}
function Oa(a,b,c,d,e){d=d===void 0?0:d;var h=h===void 0?0:h;var f="",k="",l=-1;c||(c=a.ja||10);d&&(l=Math.ceil(d/Math.log2(c)));if(e==void 0)switch(c){case 8:e="0o";break;case 16:e="0x";break;case 10:k=".";default:e=""}isNaN(b)||typeof b!="number"?(b=void 0,e=k=""):(b<0&&b>-1&&(b=-1),d&&(b<0&&(b+=Math.pow(2,d)),b>=Math.pow(2,d)&&(l=Math.ceil(Math.log(b)/Math.log(c)))));for(a=h||-1;l--;){a||(f=","+f,a=h);if(b==void 0){if(f="?"+f,l<0)break}else if(d=b%c,b=Math.trunc(b/c),d+=d>=0&&d<=9?48:55,f=String.fromCharCode(d)+
f,!b&&l<0)break;a--}return e+f+k}function Pa(a,b){var c=a/v|0,d=b/v|0;return(a&b)==(b|0)&&(c&d)==d}var v=4294967296;n.StdLib=La;function Qa(){La.call(this);this.format=new Ea;this.wc=this.format.O.bind(this.format);this.O=this.format.h.bind(this.format)}m(Qa,La);Qa.prototype.flush=function(){var a=Ra;Ra="";this.Ka(a)};function Sa(a){var b=a,c=a.lastIndexOf("/");c>=0&&(b=a.substr(c+1));c=b.indexOf("&");c>0&&(b=b.substr(0,c));c=b.lastIndexOf(".");c>0&&(b=b.substring(0,c));return b}
Qa.prototype.Ka=function(a,b){var c=a.length,d=a.lastIndexOf("\n");b?d>=0&&(b=Date.now(),Ta||(Ta=b),a=((b-Ta)/1E3).toFixed(3)+": "+a,c=a.length):this.Z=="node"?(Aa.Nk.write(a),a=""):(d>=0&&(console.log(Ra+a.slice(0,d)),Ra="",a=a.slice(d+1)),Ta=null);Ra+=a;return c};Qa.prototype.I=function(a){return this.Ka(this.O.apply(this,[a].concat(pa(sa.apply(1,arguments)))))};var Ra="",Ta=null;n.StdIO=Qa;
function Ua(a){Qa.call(this);this.fa={};this.ua=0;this.U=this;a&&(this.U.ua=0,this.U.Ja=[],this.U.Ba=0,this.U.gb={},this.U.fb=!1)}var Va;m(Ua,Qa);g=Ua.prototype;g.Ma=function(a,b){var c=this,d=this;this.fa[a]=b;switch(a){case Wa.Zc:b.onclick=function(){var e=c.Ea(Wa.hb,!0);e&&(e.value="")};break;case Wa.hb:Xa(b),b.addEventListener("keydown",function(e){Ya(d,e,!0)}),b.addEventListener("keypress",function(e){Ya(d,e)})}};function Za(a,b){var c=$a.$b;a.U.gb[c]||(a.U.gb[c]=[]);a.U.gb[c].push(b)}
function Xa(a){a.setAttribute("autocapitalize","off");a.setAttribute("autocomplete","off");a.setAttribute("autocorrect","off");a.setAttribute("spellcheck","false");a.value=""}g.error=function(a,b){b=this.O.apply(this,[a].concat(pa(b)));var c="%s";a=!1;typeof c=="boolean"&&(a=c,c=b.shift());if(b=this.O.apply(this,[c].concat(pa(b))))this.I("%s\n",b),a||alert(b)};g.Ea=function(a){return this.fa[a]};
function ab(a,b,c){if(a){do{for(var d=0;d<bb.length;d++){var e=bb[d];if(c){if(e+=c,b+e in a)return e}else if(e=e?e+b[0].toUpperCase():b[0],e+=b.substr(1),e in a)return e}if(b.indexOf("screen")<0)break;b=b.replace("screen","Screen")}while(1)}return null}function cb(a,b){return a.config.bindings&&a.config.bindings[b]}function db(a){if(a=a.fa[eb])var b=a.textContent;return b}function fb(a,b,c){a=+a||0;a<b&&(a=b);a>c&&(a=c);return a}
function A(a,b,c,d){a=a.config[b];a===void 0?a=c:(d&&d[a]!==void 0&&(a=d[a]),d=typeof c,typeof a!=d&&(d=="boolean"?a=!!a:typeof c=="number"&&(a=+a)));return a}
function gb(a,b){var c=0,d=null,e=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");e.onreadystatechange=function(){e.readyState!==4?b(a,d,e.readyState,c):(d=e.responseText,e.status==200||!e.status&&d.length&&(window?window.location.protocol:"file:")=="file:"||(c=e.status||-1),b(a,d,e.readyState,c))};e.open("GET",a,!0);e.send()}
function hb(){var a,b=Va;if(!b){b={};if(window){a||(a=window.location.search.slice(1));for(var c,d=/\+/g,e=/([^&=]+)=?([^&]*)/g;c=e.exec(a);)b[decodeURIComponent(c[1].replace(d," ")).trim()]=decodeURIComponent(c[2].replace(d," ")).trim()}Va=b}return b}function ib(a){if(jb.yb===void 0){var b=!1;if(window)try{window.localStorage.setItem(jb.Ya,jb.Ya),b=window.localStorage.getItem(jb.Ya)==jb.Ya,window.localStorage.removeItem(jb.Ya)}catch(c){a.I("%s\n",c.message),b=!1}jb.yb=b}return!!jb.yb}
function kb(a,b){b=b===void 0?0:b;b>1&&b%2&&b--;b=b||a.ua;return(b|1)==-1||Pa(a.U.ua,b)?!0:!1}function lb(a){if(window){var b=window.navigator.userAgent;return a=="iOS"&&(!!b.match(/(iPod|iPhone|iPad)/)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1)||a=="MSIE"&&!!b.match(/(MSIE|Trident)/)||b.indexOf(a)>=0}return!1}function mb(a){var b=null;if(ib(a)){var c;if(window)try{(c=window.localStorage.getItem(a.$))&&(b=JSON.parse(c))}catch(d){a.I("%s\n",d.message)}}return b}
function Ya(a,b,c){b=b||window.event;var d=b.which||b.keyCode;if(d){var e=a.U,h=b.target;if(c){a=!1;var f;c=h.value;var k=c.lastIndexOf("\n");d==C.Xb&&h.selectionStart<=k+1&&(a=!0);d==C.Id?(a=!0,e.Ba>0&&(f=e.Ja[--e.Ba])):d==C.cd&&(a=!0,e.Ba<e.Ja.length&&(f=e.Ja[++e.Ba]||""));a&&b.preventDefault();f!=void 0&&(h.value=c.substr(0,k+1)+f)}else d=String.fromCharCode(d),f=h.value,c=f.lastIndexOf("\n"),h.selectionStart<=c&&h.setSelectionRange(f.length,f.length),b.stopPropagation(),d=="@"&&e.Ba>0&&c+1==f.length&&
(h.value+=e.Ja[--e.Ba],d="\r"),d=="\r"&&(b.preventDefault(),f=h.value+="\n",h.blur(),h.focus(),(b=nb(a,f.slice(f.lastIndexOf("\n",f.length-2)+1,-1)||""))&&a.I("%s\n",b.replace(/\n$/,"")))}}function ob(a){window&&window.addEventListener("resize",a)}function pb(a){return a=="true"||a=="on"?!0:a=="false"||a=="off"?!1:void 0}
function qb(a,b){if(b!=void 0){var c=a.U;try{if(b=b.trim())c.Ba<c.Ja.length&&b==c.Ja[c.Ba]?c.Ba++:(c.Ja.push(b),c.Ba=c.Ja.length);var d=b.split(" "),e=d[0],h=a.U.gb[$a.$b];switch(e[0]){case "m":if(e[1]=="?"){var f="";rb.forEach(function(u){f+=u+"\n"});f&&(f="message commands:\n"+f);break}f="";var k=void 0;e=d[d.length-1].toLowerCase();var l=pb(e);l!=void 0&&d.pop();d.length<=1&&(l!=void 0&&(k=l,l=void 0),d[1]="all");d[1]=="all"&&(d=Object.keys(Da));for(h=1;h<d.length;h++){e=d[h];var q=Da[e];if(!q){f+=
"unrecognized message: "+e+"\n";break}l!=void 0&&sb(a,q,l);if(k==void 0||k==kb(a,q))f+=a.O("%8s: %b\n",e,kb(a,q))}kb(a,0x800000000000)&&(f+="all messages will be buffered until buffer is turned off\n");f||(f="no messages\n");break;case "?":f="",tb.forEach(function(u){f+=u+"\n"}),f&&(f="default commands:\n"+f);default:if(d.unshift(b),h)for(a=0;a<h.length;a++){var p=h[a](d);if(p!=void 0){f=f?f+p:p;break}}}}catch(u){f="error: "+u.message+"\n"}}return f}
function nb(a,b){b=b===void 0?"?":b;if(b){var c="";b=b.split(/(?:\n|;\s*)/);for(var d=0;d<b.length;d++)c+=qb(a,b[d])}return c}
g.Ka=function(a,b){b==void 0&&(b=kb(this,0x800000000000));if(!b){var c=this.Ea(Wa.hb,!0);if(c){b=c.selectionStart;for(var d=a.split(/([\n\r\b])/),e=0;e<d.length;e++){var h=d[e];if(h)if(h=="\b"||h=="\r")for(;b>0&&c.value.slice(b-1,b)!="\n"&&(b--,h!="\b"););else if(h=="\n"){for(h="";b<c.value.length&&(h=c.value[b],b++,h!="\n"););h!="\n"&&(c.value+="\r\n",b=c.value.length)}else c.value=c.value.slice(0,b)+h+c.value.slice(b+h.length),b+=h.length}c.focus();c.setSelectionRange(b,b);c.value.length>=8192&&
(c.value=c.value.slice(c.value.length-8192+4096));c.scrollTop=c.scrollHeight;return a.length}}return Qa.prototype.Ka.call(this,a,b)};g.I=function(a){var b=sa.apply(1,arguments),c=0;typeof a=="number"&&(c=a,a=b.shift());return kb(this,c)?(Pa(c,1099511627776)&&(a="error: "+a),Pa(c,549755813888)&&(a="warning: "+a),Qa.prototype.I.call.apply(Qa.prototype.I,[this,a].concat(pa(b)))):0};
function ub(a,b){if(ib(a)){b=JSON.stringify(b);try{window.localStorage.setItem(a.$,b)}catch(c){a.I("%s\n",c.message)}}}function vb(a,b,c){(a=a.fa[b])&&a.textContent!=c&&(a.textContent=c)}function sb(a,b,c){var d=!1;c?(c=a.U.ua,a.U.ua=(c|b)+(c/v|0|b/v|0)*v):(d=Pa(a.U.ua,0x800000000000)&&Pa(b,0x800000000000),c=a.U.ua,a.U.ua=(c&~b)+((c/v|0)&~(b/v|0))*v);d&&a.flush()}
var Wa={Zc:"clear",hb:"print"},tb=["\u2191 \u2193\t\trecall commands","@\t\trepeat last command","m?\t\tmessage commands"],rb=["m\t\tdisplay all messages","m on\t\tdisplay all active messages","m off\t\tdisplay all inactive messages","m all [on|off]\tturn all messages on or off","m ... [on|off]\tturn selected messages on or off"],$a={$b:"command"},wb={bc:13,xb:65,Wb:66,Yb:67,cc:68,E:69,dc:70,fc:71,hc:72,jc:73,kc:74,qc:75,rc:76,uc:77,xc:78,yc:79,Ac:80,Q:81,Bc:82,Dc:83,Fc:84,Gc:85,Hc:86,Jc:87,Kc:88,
Lc:89,Gb:90,a:97,b:98,c:99,d:100,e:101,f:102,Fk:103,Gk:104,Hk:105,Ik:106,k:107,Jk:108,Kk:109,n:110,Lk:111,p:112,q:113,r:114,s:115,t:116,Pk:117,Qk:118,w:119,x:120,y:121,z:122},C={Xb:8,Fd:9,pd:10,bc:13,Cd:16,ad:17,Yc:18,sk:19,zb:20,tj:27,Ed:32,vk:33,uk:34,sj:35,Oj:36,tc:37,Id:38,Cb:39,Lj:39,cd:40,Ij:44,wk:44,Pj:45,rj:46,Kj:46,Nj:47,ZERO:48,ONE:49,Hd:50,Gd:51,ld:52,kd:53,Dd:54,Bd:55,dd:56,qd:57,jd:59,hd:61,xb:65,Wb:66,Yb:67,cc:68,E:69,dc:70,fc:71,hc:72,jc:73,kc:74,qc:75,rc:76,uc:77,xc:78,yc:79,Ac:80,
Q:81,Bc:82,Dc:83,Fc:84,Gc:85,Hc:86,Jc:87,Kc:88,Lc:89,Gb:90,Zb:91,Jj:91,Hj:92,zk:93,Mj:93,Tj:96,jk:96,Gj:96,Uj:97,hk:97,Vj:98,gk:98,Wj:99,mk:99,Xj:100,kk:100,Yj:101,dk:101,Zj:102,pk:102,$j:103,ik:103,ak:104,rk:104,bk:105,nk:105,lk:106,ck:107,qk:109,ek:110,fk:111,uj:112,yj:113,zj:114,Aj:115,Bj:116,Cj:117,Dj:118,Ej:119,Fj:120,vj:121,wj:122,xj:123,rd:144,zd:145,gd:173,Ad:186,ed:187,qj:188,bd:189,tk:190,Bk:191,oj:192,Qj:219,pj:220,yk:221,xk:222,fd:224,Rj:901,Ic:1E3},xb={},yb=(xb[C.jd]=C.Ad,xb[C.hd]=C.ed,
xb[C.gd]=C.bd,xb[C.fd]=C.Zb,xb),zb={tc:1,Cb:2,Sj:3},D={},Ab=(D[C.Xb]="\b",D[C.Fd]="\t",D[C.pd]="\n",D[C.bc]="\r",D[C.Ed]=" ",D[C.ZERO]="0",D[C.ONE]="1",D[C.Hd]="2",D[C.Gd]="3",D[C.ld]="4",D[C.kd]="5",D[C.Dd]="6",D[C.Bd]="7",D[C.dd]="8",D[C.qd]="9",D[C.xb]="A",D[C.Wb]="B",D[C.Yb]="C",D[C.cc]="D",D[C.E]="E",D[C.dc]="F",D[C.fc]="G",D[C.hc]="H",D[C.jc]="I",D[C.kc]="J",D[C.qc]="K",D[C.rc]="L",D[C.uc]="M",D[C.xc]="N",D[C.yc]="O",D[C.Ac]="P",D[C.Q]="Q",D[C.Bc]="R",D[C.Dc]="S",D[C.Fc]="T",D[C.Gc]="U",D[C.Hc]=
"V",D[C.Jc]="W",D[C.Kc]="X",D[C.Lc]="Y",D[C.Gb]="Z",D[C.tc]="Left",D[C.Cb]="Right",D),bb=["","moz","ms","webkit"],Bb={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",
darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",
fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",
lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",
navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",
seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},jb={yb:void 0,Ya:"PCjs.localStorage"};n.WebIO=Ua;
function E(a,b,c,d){a=a===void 0?"default":a;b=b===void 0?a:b;c=c===void 0?{}:c;d=d===void 0?[]:d;Ua.call(this,a==b);this.$=a;this.Z=b;Ba[this.$]||(Ba[this.$]={});Ba[this.$][this.Z]&&this.I("warning: machine configuration contains multiple '%s' devices\n",this.Z);Ba[this.$][this.Z]=this;this.id=this.$==this.Z?this.$:this.$+"."+this.Z;Ca.push(this);this.U=Cb(this,this.$);this.ready=!0;Db(this,c,d);this.Ta={};this.zc=[]}m(E,Ua);g=E.prototype;g.Hb=function(){};g.Ib=function(){};
function Db(a,b,c){c=b.overrides||c;if(c.length){var d=hb();for(k in d)if(c.indexOf(k)>=0){var e=d[k],h=Ma(e,10);h==void 0&&(e=="true"?h=!0:e=="false"?h=!1:(h=e,e='"'+e+'"'));b[k]=h;a.I("overriding %s property '%s' with %s\n",a.Z,k,e)}}a.config=b;c=b.bindings;c=c===void 0?{}:c;if(typeof document!="undefined"){a.config.fa||(a.config.fa=c);(d=Array.isArray(c))?c.indexOf("container")<0&&c.push("container"):c.container||(c.container=a.Z);for(var f in c){e=c[f];if(d)f=e;else if(e.match(/^[0-9]+$/)){var k=
+e;a.fa[f]=[];do{e=f+k++;e=document.getElementById(e);if(!e)break;a.fa[f].push(e)}while(1);continue}(k=document.getElementById(e))&&a.Ma(f,k)}}b=b===void 0?{}:b;a.version=3;if(a.version){f="";var l;a.$!=a.Z&&(l=Cb(a,a.$).version)&&l!=a.version&&(f="Machine");f||(l=b.version)&&l>a.version&&(f="Config");f&&(l=a.O("%s Device version (%3.2f) incompatible with %s version (%3.2f)",b.Ek,a.version,f,l),a.error("%s\n\nClearing your browser's cache may resolve the issue.",l))}}
function F(a,b,c,d){a.Ta[b]={get:c.bind(a),set:d?d.bind(a):null}}function Eb(a,b){var c;try{var d=Ba[a.$];if(d)for(c in d){var e=d[c];if(e.Z!=e.$&&!b(e))return!1}return!0}catch(h){a.I("error while enumerating device '%s': %s\n",c,h.message)}return!1}g.Ea=function(a,b){b=b===void 0?!1:b;if(a){var c=Ua.prototype.Ea.call(this,a,b);if(c===void 0&&b){b=Ba[this.$];for(var d in b)if(c=b[d].fa[a])break;c||(c=null);this.fa[a]=c}}return c};
function Cb(a,b,c){var d=b,e=a.$,h=e.indexOf(".");h>0&&(e=e.substr(0,h),b=b.substr(h+1));b=(h=Ba[e])&&h[b]||null;if(!b){for(h=0;h<Ca.length;h++)if(Ca[h].id===d){b=Ca[h];break}if(!b&&(c===void 0||c))throw Error(a.O('no "%s" device',d));}return b}function G(a,b,c){var d=null,e=Ba[a.$];if(e)for(var h in e)if(e[h].config["class"]==b){if(d){d=null;break}d=e[h]}if(!d&&(c===void 0||c))throw Error(a.O("no %s device",b));return d}
function Fb(a,b){var c=Cb(a,a.$);return c&&c.config&&c.config[b]||a.config[b]}function Gb(a,b){return(a=a.Ta[b])&&a.get()}function Hb(a){return a==a.U&&a.ready?Eb(a,function(b){return Hb(b)}):a.ready}function Ib(a,b){b=b===void 0?a.ready:b;a.ready=b;if(Hb(a)){for(;b=a.zc.pop();)b();a!=a.U&&Ib(a.U)}}function Jb(a,b){if(Hb(a))return b(),!0;a.zc.push(b);return!1}g.Sc=function(){};
g.I=function(a){var b=sa.apply(1,arguments);return typeof a=="number"&&kb(this,a)&&(this.da===void 0&&(this.da=G(this,"Debugger",!1)),this.da&&this.da.Sc(a),this.U.ua&1&&(this.ca===void 0&&(this.ca=G(this,"CPU")),this.ca))?(a=b.shift(),Ua.prototype.I.call(this,"%#06x: %s.%s\n",this.ca.bb,this.Z,this.O.apply(this,[a].concat(pa(b))).trim())):Ua.prototype.I.call.apply(Ua.prototype.I,[this,a].concat(pa(b)))};function Kb(a,b){(a=Ba[a.$])&&delete a[b]}function Lb(a,b,c){(a=a.Ta[b])&&a.set&&a.set(c)}
n.Device=E;
function Mb(a,b,c){E.call(this,a,b,c);this.ua=2097152;this.V=this.M=null;this.time=G(this,"Time");this.U=G(this,"Machine");this.ba=A(this,"drag",!1);this.T=A(this,"scroll",!1);this.Y=A(this,"hexagonal",!1);this.l=A(this,"releaseDelay",0);this.m=!1;a=this.config.map;this.i=this.g=null;if(a)if(a.length)this.i=a;else{this.g={};b=Object.keys(a);for(var d=0;d<b.length;d++){var e=[],h=b[d],f=a[h];typeof f=="string"?f=[f]:f.length==void 0&&(e=f.grid,f=f.keys,typeof f=="string"&&(f=[f]));this.g[h]={keys:f,
grid:e,state:0}}}this.u=[];this.K=[];this.v=!1;this.j=this.H=null;(a=this.fa[Nb])&&Ob(this,a,this.Ea(c.focusBinding,!0),this.config.location);this.ta()}m(Mb,E);function Pb(a,b){a.M=b}
function Qb(a,b,c,d,e){if(b==Rb)a.u.push({id:c,Na:d});else if(b==Sb&&a.g){if(b=a.g[c])(e=b.keys)&&e.length&&a.u.push({id:c,Na:d}),(b=b.grid)&&b.length&&a.K.push({id:c,Td:b[0],Wd:b[1],kj:b[2],mj:b[3],Na:d})}else if(b==Tb){var h=a.Ea(c,!0);if(h){var f=function(k){var l=(h.getAttribute("class")||"").replace(/(-on|-off)$/,k?"-on":"-off");h.setAttribute("class",l);return k};e!=void 0&&f(e);d&&h.addEventListener("click",function(){d(c,f((h.getAttribute("class")||"").slice(-3)!="-on"))})}}}
function Ub(a,b,c){for(var d=0;d<a.u.length;d++){var e=a.u[d];e.id===b&&e.Na(b,c)}}
function Ob(a,b,c,d){d=d===void 0?[]:d;if(d.length||a.i||a.g){var e={};e.lj=d[0]||0;e.nj=d[1]||0;e.$a=d[2]||b.clientWidth;e.kb=d[3]||b.clientHeight;e.mb=d[4]||1;e.ub=d[5]||1;e.Vd=d[6]||b.naturalWidth||e.$a;e.Yd=d[7]||b.naturalHeight||e.kb;e.Vc=d[8]||0;e.Wc=d[9]||0;e.Ud=d[10]||0;e.Xd=d[11]||0;a.i?(e.ob=a.i.length,e.ab=a.i[0].length):(e.ab=e.mb,e.ob=e.ub,e.mb=e.ub=0);e.Oc=e.$a/(e.ab+e.ab*e.mb)|0;e.Pc=e.kb/(e.ob+e.ob*e.ub)|0;e.Sd=e.Oc*e.mb|0;e.Qc=e.Pc*e.ub|0;e.eb=e.wb=-1;Vb(a,b,e);Wb(a,b,e);a.time&&
a.l&&(a.W=Xb(a.time,"timerInputRelease",function(){e.eb<0&&e.wb<0&&Yb(a,-1,-1)}))}if(a.i||a.g)a.time&&a.l&&(a.ea=Xb(a.time,"timerKeyRelease",function(){Zb(a)})),a.o=0,a.L="",a.J=[],d=b,c&&(d=c,a.j||c.nodeName!="BUTTON"||(d=document,a.j=c,$b(a,b),a.H=b)),$b(a,d),a.j||(a.j=d)}function ac(a){a.l?bc(a.time,a.ea,a.l):Zb(a)}
function $b(a,b){function c(e,h,f){var k=document.activeElement;a.I(5242880,"%s.onKey%s(%d): %5.2f (%s)\n",k.id||k.nodeName,e,h,Date.now()/1E3%60,f!=void 0?f?"used":"unused":"ignored")}function d(e,h){e=document.activeElement;return a.j&&e!=a.j&&e!=a.H?null:h||window.event}b.addEventListener("keydown",function(e){if(e=d(this,e)){var h=e.which||e.keyCode,f=cc(a,h,!0,e);c("Down",h,f);f&&e.preventDefault()}});b.addEventListener("keypress",function(e){if(e=d(this,e)){var h=e.which||e.charCode,f=cc(a,
h);c("Press",h,f);f&&e.preventDefault()}});b.addEventListener("keyup",function(e){if(e=d(this,e)){var h=e.which||e.keyCode,f=cc(a,h,!1,e);c("Up",h);f&&e.preventDefault();b.nodeName=="TEXTAREA"&&(b.value="")}})}
function Vb(a,b,c){b.addEventListener("mousedown",function(d){if(!a.m){var e=a.v?a.H:a.j;if(e){var h=window.scrollX,f=window.scrollY;e.focus();window.scrollTo(h,f)}d.button||dc(a,b,ec,d,c)}});b.addEventListener("mousemove",function(d){a.m||dc(a,b,fc,d,c)});b.addEventListener("mouseup",function(d){a.m||d.button||dc(a,b,hc,d,c)});b.addEventListener("mouseout",function(d){a.m||(c.eb<0?dc(a,b,fc,d,c):dc(a,b,hc,d,c))})}
function Wb(a,b,c){b.addEventListener("touchstart",function(d){a.T&&(a.m=!0);dc(a,b,ec,d,c)});b.addEventListener("touchmove",function(d){dc(a,b,fc,d,c)});b.addEventListener("touchend",function(d){dc(a,b,hc,d,c)})}
function cc(a,b,c,d){if(c!=void 0){var e=yb[b]||b;var h=Ab[b];var f=jc[e];d=d&&d.location==zb.Cb;f&kc&&d&&(f>>=1);f&&(f&lc&&(c=!(a.h&f)),a.h=c?a.h|f:a.h&~f,Ub(a,e,c))}else h=String.fromCharCode(b).toUpperCase(),b>=wb.xb&&b<=wb.Gb?a.h&(mc|nc)||(a.h|=nc,Ub(a,C.zb,!0)):b>=wb.a&&b<=wb.z&&a.h&nc&&(a.h&=~nc,Ub(a,C.zb,!1));if(a.i){if(c!=void 0)return!1;for(e=0;e<a.i.length;e++)for(f=a.i[e],d=0;d<f.length;d++)if(f[d].split("|").indexOf(h)>=0)return a.o?a.J.length<16&&a.J.push(b):(a.o=1,a.L=h,Yb(a,d,e),Ub(a,
h,!0),ac(a)),!0}if(a.g){if(c==void 0)return!0;b=Object.keys(a.g);for(e=0;e<b.length;e++)if(f=b[e],a.g[f].keys.indexOf(h)>=0)return Ub(a,f,c),a.g[f].state=c?1:0,!0}return!1}function Zb(a){a.o==1?(a.o++,Ub(a,a.L,!1),a.L="",Yb(a,-1,-1),ac(a)):(a.o=0,a.J.length&&cc(a,a.J.shift()))}Mb.prototype.ta=function(){this.h=0;this.N=this.X=-1};
function dc(a,b,c,d,e){var h=-1,f=-1,k=!1,l=-1,q=-1;if(c<hc){d=d||window.event;d.targetTouches&&d.targetTouches.length?(l=d.targetTouches[0].clientX,q=d.targetTouches[0].clientY,k=d.targetTouches.length>1):(l=d.clientX,q=d.clientY);var p=d.target.getBoundingClientRect();l-=p.left;q-=p.top;l=e.Vd/b.offsetWidth*l|0;q=e.Yd/b.offsetHeight*q|0;var u=l-e.lj;var r=q-e.nj;var t=p=!1;var x=l>=e.Vc&&l<e.Vc+e.Ud&&q>=e.Wc&&q<e.Wc+e.Xd;if(u>=0&&u<e.$a&&r+e.Qc>=0||x)if(k||a.T||d.preventDefault(),u>=0&&u<e.$a&&
r>=0&&r<e.kb){t=!0;d=e.$a/e.ab|0;var w=e.kb/e.ob|0,B=u/d|0,y=r/w|0;!a.Y||y&1||(u-=d>>1,B=u/d|0,B==e.ab-1&&(u=-1));w=y*w+(e.Qc>>1);u-=B*d+(e.Sd>>1);r-=w;u>=0&&u<e.Oc&&r>=0&&r<e.Pc&&(h=B,f=y,p=!0)}}u=u||0;r=r||0;d=b.offsetWidth;b=b.offsetHeight;if(c==ec||c==hc)for(B=0;B<a.K.length;B++)y=a.K[B],c==hc?y.Na(y.id,!1):(w=r/(b/y.Wd|0)|0,(u/(d/y.Td|0)|0)==y.kj&&w==y.mj&&y.Na(y.id,!0));if(!k)if(c==ec)e.eb=l,e.wb=q,t?(Yb(a,h,f),p&&a.l&&bc(a.time,a.W,a.l,!0)):x&&a.U.va();else if(c==fc)e.eb>=0&&e.wb>=0&&a.ba?
Yb(a,h,f):a.M&&a.M(h,f);else if(c==hc){if(c=a.l)c=a.time,h=a.W,c=c.g&&h>0&&h<=c.h.length?c.h[h-1].ya>=0:!1;c||Yb(a,-1,-1);e.eb=e.wb=-1}else a.I("unrecognized action: %d\n",c)}function oc(a){var b=a.v?a.H:a.j;b&&Hb(a.U)&&(a.I(2097152,'setFocus("%s")\n',b.id||b.nodeName),b.focus(),b.scrollIntoView())}function Yb(a,b,c){if(b!=a.N||c!=a.X)a.N=b,a.X=c,a.V&&a.V(b,c)}
var ec=1,fc=2,hc=3,Nb="surface",Rb="keyCode",Sb="idMap",Tb="switch",mc=3,kc=170,nc=512,lc=3584,pc={},jc=(pc[C.Cd]=2,pc[C.ad]=8,pc[C.Yc]=32,pc[C.Zb]=128,pc[C.zb]=nc,pc[C.rd]=1024,pc[C.zd]=2048,pc);n.Input=Mb;
function qc(a,b,c){E.call(this,a,b,c,["color","backgroundColor"]);a=this.fa[rc];if(!a)throw Error("LED "+this.config.fa[rc]+" binding for '"+rc+"' missing");b=document.createElement("canvas");if(!b||!b.getContext)throw a.innerHTML="LED device requires HTML5 canvas support",Error("LED device requires HTML5 canvas support");this.sa=cb(this,rc)+".canvas";b.setAttribute("id",this.sa);this.type=fb(A(this,"type",sc,tc),uc,vc);this.i=wc[this.type][0];this.o=wc[this.type][1];this.width=A(this,"width",this.i);
this.height=A(this,"height",this.o);this.j=A(this,"cols",1);this.J=this.j+A(this,"colsExtra",0);this.W=A(this,"rows",1);this.M=this.W+A(this,"rowsExtra",0);this.ba=this.width*this.j;this.T=this.height*this.W;this.m=xc("black",0);this.h=yc(this.config.color)||this.m;this.la=xc(this.h,1,.25);this.ka=xc(this.h,1,2);this.l=yc(this.config.backgroundColor);this.ma=A(this,"fixed",!1);this.ma||(b.style.width="100%",b.style.height="auto");this.ia=A(this,"hexagonal",!1);this.na=A(this,"highlight",!0);this.N=
A(this,"persistent",this.type<vc);b.setAttribute("width",this.ba.toString());b.setAttribute("height",this.T.toString());b.style.backgroundColor=this.m;a.appendChild(b);this.ea=b.getContext("2d");if(this.u=document.createElement("canvas"))this.u.width=this.Y=this.i*this.j,this.u.height=this.v=this.o*this.W,this.g=this.u.getContext("2d");this.Da=(this.M+1)*this.J*4;this.buffer=Array(this.Da);this.La=this.j<this.J?(this.J-this.j)*4:0;this.K=this.L=!1;this.H=this.X=0;this.V=-1;var d=this;this.time=G(this,
"Time");zc(this.time,function(e,h){Ac(d,!1,e,h)});Bc(d)}m(qc,E);function Bc(a){for(var b=a.buffer,c=0;c<b.length;c+=4){var d=a,e=b,h=c;e[h]=d.type<vc?Cc:" ";e[h+1]=d.h==d.m?null:d.h;e[h+2]=0;e[h+3]=Dc}a.K=a.L=!0;Ac(a,!0)}function Ec(a){a.l?(a.g.fillStyle=a.l,a.g.fillRect(0,0,a.Y,a.v)):a.g.clearRect(0,0,a.Y,a.v)}
function Ac(a,b,c,d){b=b===void 0?!1:b;c=c===void 0?0:c;d=d===void 0?60:d;if(a.K||b){if(a.type<vc){d=0;if(!a.N||b)Ec(a);else if(a.H){d=a.j-a.H;var e=a.i*d;a.g.drawImage(a.u,a.i*a.H,0,e,a.v,0,0,e,a.v)}for(var h=e=0;h<a.M;h++){for(var f=0;f<a.j;f++){var k=a.buffer[e],l=a.buffer[e+1]||a.m,q=a.na&&e==a.V;if(a.buffer[e+3]&Dc||q||b){if(f>=d)a:{var p=a,u=k;k=l;var r=f;l=h;var t=q;r=r===void 0?0:r;l=l===void 0?0:l;t=t===void 0?!1:t;var x=0;if(p.ia&&!(l&1)&&(x=p.i>>1,r==p.j-1))break a;if(k&&k!=p.h){t=t?xc(k,
1,2):k;var w=xc(k,1,.25)}else t=t?p.ka:p.h,w=p.la;k=!1;u=u?t:w;t==p.m&&(u=p.l,k=!0);t=r*p.i+x;w=l*p.o;p.N&&(r=r*p.i+x,l*=p.o,p.l?(p.g.fillStyle=p.l,p.g.fillRect(r,l,p.i,p.o)):p.g.clearRect(r,l,p.i,p.o));p.g.fillStyle=u;l=Fc[p.type];l.length==3?(p.g.beginPath(),p.g.arc(t+l[0],w+l[1],l[2],0,Math.PI*2),k?(p.g.globalCompositeOperation="destination-out",p.g.fill(),p.g.globalCompositeOperation="source-over"):p.g.fill()):p.g.fillRect(t+l[0],w+l[1],l[2],l[3])}a.buffer[e+3]=q?a.buffer[e+3]|Dc:a.buffer[e+3]&
~Dc}e+=4}e+=a.La}a.H=0}else{b="";for(d=0;d<a.buffer.length;d+=4)b+=a.buffer[d]||" ",a.buffer[d+3]&Gc&&(b+=".");Ec(a);for(h=e=d=0;d<b.length;d++){q=b[d];q=="."&&e&&e--;f=a;l=q;q=e;p=h;q=q===void 0?0:q;p=p===void 0?0:p;if(l=Hc[l])for(k=0;k<l.length;k++)if(r=f,x=Ic[l[k]]){u=(q===void 0?0:q)*r.i;t=(p===void 0?0:p)*r.o;r.g.fillStyle=r.h;r.g.beginPath();if(x.length==3)r.g.arc(u+x[0],t+x[1],x[2],0,Math.PI*2);else for(w=0;w<x.length;w+=2)w?r.g.lineTo(u+x[w],t+x[w+1]):r.g.moveTo(u+x[w],t+x[w+1]);r.g.closePath();
r.g.fill()}if(++e==a.j&&(e=0,++h==a.M))break}}a.ea.globalCompositeOperation=a.l&&a.h!=a.m?"source-over":"copy";a.ea.drawImage(a.u,0,0,a.Y,a.v,0,0,a.ba,a.T);a.K=!1;a.V=-1}else a.N||a.L||(!c||!a.X||c-a.X>=(1E3/d|0))&&Bc(a);a.L=!1;c&&(a.X=c)}function yc(a){return(a=a||void 0)&&Bb[a]||a}
function xc(a,b,c){b=b===void 0?1:b;c=c===void 0?1:c;if(a){var d=[];a=Bb[a]||a;var e=a;var h=16;var f=e.match(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i);f||(h=10,f=e.match(/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,?\s*(\d+|)\)$/i));if(f){for(e=1;e<f.length;e++)d[e-1]=Number.parseInt(f[e],h);d.length=e-1;h=!0}else h=!1;if(h){a="rgba(";for(h=0;h<3;h++)f=Math.round(d[h]*c),f=f<0?0:f>255?255:f,a+=f+",";a+=(h<d.length?d[h]:b)+")"}}return a}
qc.prototype.xa=function(a){var b=a.shift(),c=a.shift();a=a.shift();if(b==this.h&&c==this.l&&a&&a.length==this.buffer.length){this.buffer=a;for(b=0;b<=this.buffer.length-4;b+=4)this.buffer[b+1]==this.m&&(this.buffer[b+1]=null);Ac(this,!0);return!0}return!1};qc.prototype.za=function(a){this.buffer&&(a.push(this.h),a.push(this.l),a.push(this.buffer))};
var uc=0,sc=1,vc=3,tc={small:uc,round:sc,square:2,digit:vc},rc="container",Cc=0,Gc=1,Dc=128,Jc={},Fc=(Jc[uc]=[4,4,4],Jc[sc]=[16,16,14],Jc[2]=[2,2,28,28],Jc),wc=[[8,8],[32,32],[32,32],[96,128]],Ic={A:[30,8,79,8,67,19,37,19],B:[83,10,77,52,67,46,70,22],C:[77,59,71,100,61,89,64,64],D:[28,91,58,91,69,104,15,104],E:[18,59,28,64,25,88,12,100],F:[24,10,34,21,31,47,18,52],G:[24,56,34,50,60,50,71,56,61,61,33,61],P:[80,102,8]},Hc={" ":[],0:"ABCDEF".split(""),1:["B","C"],2:["A","B","D","E","G"],3:["A","B","C",
"D","G"],4:["B","C","F","G"],5:["A","C","D","F","G"],6:"ACDEFG".split(""),7:["A","B","C"],8:"ABCDEFG".split(""),9:"ABCDFG".split(""),A:"ABCEFG".split(""),B:["C","D","E","F","G"],C:["A","D","E","F"],D:["B","C","D","E","G"],E:["A","D","E","F","G"],F:["A","E","F","G"],"-":["G"],".":["P"]};n.LED=qc;
function Kc(a,b,c){E.call(this,a,b,c);var d=this;this.touchType=this.config.touchType;this.Eb=this.config.diagnostics;this.V=this.config.monitorWidth||640;this.K=this.config.monitorHeight||480;this.j=this.fa[Lc.vc];if(!this.j)throw Error("unable to find binding: "+Lc.vc);this.g=this.Ea(Lc.$c)||this.j;b=this.fa[Lc.Ec];if(!b){b=document.createElement("canvas");if(a=cb(this,Lc.Ec))this.fa[a]=b,b.setAttribute("id",a);b.setAttribute("class","pcjs-surface");b.setAttribute("width",this.config.monitorWidth);
b.setAttribute("height",this.config.monitorHeight);b.style.backgroundColor=this.config.monitorColor||"black";this.j.appendChild(b)}this.l=b;this.u=a=b.getContext("2d");lb("MSIE")&&(this.j.onresize=function(f,k,l,q){return function(){k.style.height=(f.clientWidth*q/l|0)+"px"}}(this.j,b,this.config.monitorWidth,this.config.monitorHeight),this.j.onresize());(c=+(this.config.aspect||hb().aspect))&&c>=.3&&c<=3.33&&(ob(function(f,k,l){return function(){k.style.height=(f.clientWidth/l|0)+"px"}}(this.j,b,
c)),window.onresize());this.ia=this.ea=this.U.fb=!1;if(c=this.fa[Lc.ec])if(b=ab(this.g,"requestFullscreen")){this.g.lb=this.g[b];this.ia=!0;this.ea=document.fullscreenEnabled||lb("Edge/");if(b=ab(document,"on","fullscreenchange")){var e=ab(document,"fullscreenElement");document.addEventListener(b,function(){Mc(d,document[e]!=null)},!1)}(b=ab(document,"on","fullscreenerror"))&&document.addEventListener(b,function(){Mc(d)},!1)}else this.I("Full-screen API not available\n"),c.parentNode.removeChild(c);
if(this.touchType||this.Eb||this.ia&&!lb("iOS")){var h=document.createElement("textarea");if(b=cb(this,Lc.sd))this.fa[b]=h,h.setAttribute("id",b);h.setAttribute("class","pcjs-overlay");lb("iOS")&&(Xa(h),h.style.fontSize="16px");this.j.appendChild(h)}(this.input=G(this,"Input",!1))&&Ob(this.input,h||this.j,this.Ea(this.config.focusBinding,!0));h=this.config.smoothing;(b=hb().smoothing)&&(h=b=="true");this.ka=h;this.Wa=ab(a,"imageSmoothingEnabled");if(this.i=this.config.monitorRotate)this.i=this.i%
360,this.i>0&&(this.i-=360),this.i!=-90?(this.I("unsupported monitor rotation: %d\n",this.i),this.i=0):(a.translate(0,this.K),a.rotate(this.i*Math.PI/180),a.scale(this.K/this.V,this.V/this.K))}m(Kc,E);Kc.prototype.Ma=function(a,b){var c=this;switch(a){case Lc.ec:b.onclick=function(){c.U.fb=window.outerHeight-window.innerHeight<=1;c.U.fb||c.lb()}}E.prototype.Ma.call(this,a,b)};function Nc(a){a.u&&(a.u.fillStyle="black",a.u.fillRect(0,0,a.l.width,a.l.height))}
Kc.prototype.lb=function(){var a=!1;if(this.g&&this.g.lb){a="100%";if(screen&&screen.width&&screen.height){var b=screen.width/screen.height,c=this.V/this.K;b>c&&(a=Math.round(c/b*100)+"%")}this.ea?(this.l.style.width=a,this.l.style.height="auto",this.l.style.display="block",this.l.style.margin="auto"):(this.g.style.width=a,this.g.style.height="auto");this.Da=this.g.style.backgroundColor;this.g.style.backgroundColor="black";this.g.lb();this.input&&(a=this.input,a.v=!0,oc(a));a=!0}return a};
function Mc(a,b){a.U.fb=!0;b||(a.g&&(a.ea?a.l.style.width=a.l.style.height="":a.g.style.width=a.g.style.height="",a.Da&&(a.g.style.backgroundColor=a.Da)),a.U.fb=!1);a.input&&!b&&(a=a.input,a.v=!1,oc(a))}Kc.prototype.va=function(a){a?(Oc(this),Pc(this)):Nc(this)};Kc.prototype.ta=function(){Nc(this)};var Lc={$c:"container",Ec:"surface",vc:"monitor",sd:"overlay",ec:"fullScreen"};n.Monitor=Kc;
function Qc(a,b,c){E.call(this,a,b,c);this.sa=A(this,"cyclesMinimum",1E5);this.Xa=A(this,"cyclesMaximum",1E9);this.ia=fb(A(this,"cyclesPerSecond",1E6),this.sa,this.Xa);this.ba=60;this.V=0;this.X=1E3/this.ba;this.ib=A(this,"updatesPerSecond",2)||2;this.Eb=1E3/this.ib;this.Wa=0;this.Fb=A(this,"timeLock",!0);this.na=this.K=0;this.ma=this.l=1;this.La=this.o=this.ia/1E4/100;this.ka=[];this.H=[];this.h=[];this.N=[];this.Da=this.g=this.T=this.v=!1;this.J=this.j=0;a=ab(window,"requestAnimationFrame");if(!a){a=
"setTimeout";var d=this.X}this.jb=window[a].bind(window,this.dj.bind(this),d);this.Db=window[ab(window,"cancelAnimationFrame")||"clearTimeout"].bind(window);this.Y=this.W=this.m=this.i=this.ea=0;Rc(this)||Sc(this,this.ma)}m(Qc,E);function zc(a,b){a.ka.push(b)}g=Qc.prototype;
g.Ma=function(a,b){var c=this;switch(a){case Tc:b.onclick=function(){Uc(c)&&(c.g?Vc(c):c.start())};break;case Wc:b.onclick=function(){Sc(c,c.l<<1);Xc(c,Yc(c.o))};break;case Zc:b.onclick=function(){$c(c)};break;case ad:b.addEventListener("mousedown",function(){c.v=!0}),b.addEventListener("mouseup",function(){Rc(c);c.v=!1}),b.addEventListener("mousemove",function(){c.v&&Rc(c)}),b.addEventListener("change",function(){c.v=!0;Rc(c);c.v=!1})}E.prototype.Ma.call(this,a,b)};
function Xb(a,b,c){var d=d===void 0?-1:d;var e=a.h.length+1;a.h.push({id:b,Nd:c,nb:d,ya:-1});d>=0&&bc(a,e,d);return e}
function bd(a,b,c,d){var e=0,h=a.o,f=h*1E6;b&&c&&(h=b/(c*10)/100,a.I(262144,"calcSpeed(%d cycles, %5.3fms): %5.3fMhz\n",b,c,h),d>a.X&&(a.l>1&&(a.l>>=1,a.I(549755813888,"frame time (%5.3fms) exceeded maximum (%5.3fms), target multiplier now %d\n",d,a.X,a.l)),e=d));a.K=h;a.na=h/a.La;b=a.na/a.l;a.ea=f/b/a.ba+1E-8;a.I(262144,"nCyclesDepositPerFrame(%5.3f) = nCyclesPerSecond(%d) / nDivisor(%5.3f) / nFramesPerSecond(%d)\n",a.ea,f,b,a.ba);return e}
function cd(a,b){a.W=a.m=b;if(!a.H.length)return a.m=0,a.W;for(var c=0;a.m>0;){if(c<a.H.length){var d=a.H[c++];b=d.ej.call(d,b)||1}else c=b=0;a.m-=b}return a.W-a.m}function dd(a,b){b=b===void 0?a.W-a.m:b;if(!a.g){if(a.i)for(var c=0;c<a.H.length;c++){var d=a.H[c];d.fj.call(d)}a.i=b}a.i-=b;a.i<1&&(a.T=!0);a.Y+=b;a.W=a.m=0;a.g||(a.Y=0);return b}
function ed(a,b){b=b===void 0?0:b;if(b){var c=b;a.i+=b}else for(c=a.i,c<1&&(c=a.i+=a.ea),c<0&&(a.I(262144,"warning: cycle count dropped below zero: %f\n",c),c=a.i=0),c|=0,b=a.h.length;b>0;b--){var d=a.h[b-1];!(d.ya<0)&&c>d.ya&&(c=d.ya)}return c}function Yc(a){a>=1?a=a.toFixed(2)+"Mhz":(a=Math.round(a*1E6),a=a<=999?a+"Hz":Math.ceil(a/1E3)+"Khz");return a}function fd(a){a.I(262144,"getSpeedCurrent(%5.3fhz)\n",a.K*1E6);return a.g&&a.K?Yc(a.K):"Stopped"}
function Uc(a){return a.Da?!0:(a.I("not powered\n"),!1)}function gd(a,b){if(b>=1)for(var c=a.h.length;c>0;c--){var d=a.h[c-1];d.ya<0||(d.ya-=b,d.ya<=0&&(d.ya=-1,d.Nd(),d.nb>=0&&bc(a,c,d.nb)))}}g.va=function(a){this.Da=a;this.da===void 0&&(this.da=G(this,"Debugger",!1))&&this.da.Hb(this,"time","dump time state",this.be)};function $c(a,b){Uc(a)&&(a.g?a.I("already running\n"):a.j?Vc(a):hd(a,b))}
g.dj=function(a){a=a===void 0?Date.now():a;this.J=0;if(this.g){if(this.V){var b=a-this.V;b<1&&(b=16.67);this.ba=1E3/b}this.V=a;a=Date.now();this.L&&(b=a-this.M-this.X,b>this.X&&(this.u+=b,this.I(549755813888,"browser throttling detected, compensating by %5.3fms\n",b)));this.M=a;this.u||(this.u=a);this.la=0;try{this.T=!1;do gd(this,dd(this,cd(this,ed(this))));while(this.g&&!this.T)}catch(c){this.I("%s\n",c.message),Vc(this)}this.L=Date.now();this.la&&(this.u+=this.la,this.M+=this.la);this.M+=bd(this,
this.Y,this.L-this.u,this.L-this.M);this.L-this.Wa>=this.Eb&&this.update();for(a=0;a<this.ka.length;a++)this.ka[a](this.V,this.ba);this.J=this.jb()}};function Sc(a,b){if(b!==void 0){if(b<1||!a.v&&a.K>0&&a.K<a.o*.9)b=a.ma;a.l=b;b=a.La*a.l;a.o!=b&&(a.o=b,Xc(a,Yc(a.o)))}a.u=a.L=0;a.i=a.Y=0;bd(a);for(b=a.h.length;b>0;b--){var c=a.h[b-1];c.nb>=0&&bc(a,b,c.nb,!0)}}function Rc(a){var b=a.fa[ad];return b?(Sc(a,Math.floor((b.value-b.min)/(b.max-b.min)*(a.Xa-a.sa)+a.sa)/a.ia|0),!0):!1}
function bc(a,b,c,d){b>0&&b<=a.h.length&&(b=a.h[b-1],d||b.ya<0)&&(c=Math.ceil(a.ia*(a.Fb?a.ma:a.na)/1E3*(c===void 0?1E3:c)),a.g&&(c+=dd(a)),b.ya=c)}g.start=function(){if(this.g||this.j)return!1;this.g=!0;this.u=this.L=this.V=0;this.update(!0);this.J=this.jb();return!0};function hd(a,b){b=b===void 0?1:b;a.g||(b&&!a.j&&(a.j=b),a.j&&(a.j--,gd(a,dd(a,cd(a,ed(a,1)))),a.update(!1),a.j&&setTimeout(function(){hd(a,0)},0)))}
function Vc(a){return a.g?(a.g=!1,dd(a),a.J&&(a.Db(a.J),a.J=0),a.update(!0),!0):a.j?(a.j=0,a.update(!0),!0):!1}g.update=function(a){a&&this.I(this.g?"started with %s target\n":"stopped\n",Yc(this.o));vb(this,Tc,this.g?"Halt":"Run");vb(this,Zc,this.j?"Stop":"Step");this.v||Xc(this,fd(this));for(var b=0;b<this.N.length;b++){var c=this.N[b];c.Lb.call(c,a!=void 0)}this.Wa=Date.now();this.T=!0};function Xc(a,b){vb(a,id,b);vb(a,Wc,b)}
g.be=function(){var a=this.O("nCyclesPerSecond: %f\n",this.ia);a+=this.O("nUpdatesPerSecond: %f\n",this.ib);a+=this.O("nTargetMultiplier: %f\n",this.l);return a+=this.O("nCyclesDepositPerFrame: %f\n",this.ea)};var Tc="run",Wc="setSpeed",id="speed",Zc="step",ad="throttle";n.Time=Qc;
function jd(a,b,c){E.call(this,a,b,c);this.type=this.config.type=="static"?kd:ld;this.ga=this.config.addrWidth||16;this.m=Math.pow(2,this.ga);this.l=this.m-1|0;this.blockSize=this.config.blockSize||(this.ga>16?4096:1024);this.blockSize>this.m&&(this.blockSize=this.m);this.H=this.m/this.blockSize|0;this.h=Math.log2(this.blockSize)|0;this.i=(1<<this.h)-1;this.j=this.config.dataWidth||8;this.v=Math.pow(2,this.j)-1;this.o=this.config.littleEndian!==!1;this.g=Array(this.H);this.u=0;a=new md(a,b+"[NONE]",
{size:this.blockSize,bus:this.Z});for(b=0;b<this.m;b+=this.blockSize)nd(this,b,this.blockSize,H.NONE,a);od(this,this.type)}m(jd,E);function nd(a,b,c,d,e){for(var h=b>>>a.h;c>0&&h<a.g.length;){var f=h*a.blockSize,k=a.blockSize-(b-f);k>c&&(k=c);var l=a.g[h];if(b!=f||k!=a.blockSize||l&&l.type!=H.NONE)return!1;l=a.Z+"["+Oa(a,b,16,a.ga)+"]";b=e?e.size==a.blockSize?e:new md(a.$,l,{type:d,pa:b,size:k,bus:a.Z}):new md(a.$,l,{type:d,pa:b,size:k,bus:a.Z});a.g[h]=b;b=f+a.blockSize;c-=k;h++}return!0}
function pd(a,b){for(var c=H.yd,d=0,e=0;e<a.g.length;e++){var h=a.g[e];h&&h.type&c&&(b(h),d++)}return d}function qd(a,b,c){a.da&&a.da.I(4,"bus fault (%d) at %n\n",c,b)}g=jd.prototype;g.va=function(){this.da===void 0&&(this.da=G(this,"Debugger",!1))};g.ta=function(){};g.pb=function(a){return a&&this.xa(a)?!0:!1};g.Ra=function(a){this.za(a)};g.xa=function(a){for(var b=0;b<this.g.length;b++){var c=this.g[b];if((this.type==ld||c.type&H.Qa)&&c.xa){var d=a.shift();if(!c.xa(d))return!1}}return!0};
g.za=function(a){for(var b=0;b<this.g.length;b++){var c=this.g[b];if((this.type==ld||c.type&H.Qa)&&c.za){var d=[];c.za(d);a.push(d)}}};g.Mb=function(a){return this.g[a>>>this.h].Mb(a&this.i)};g.md=function(a){return this.g[a>>>this.h].qa(a&this.i)};g.Rb=function(a,b){this.g[a>>>this.h].Rb(a&this.i,b)};g.Ca=function(a,b){this.g[a>>>this.h].oa(a&this.i,b)};g.lc=function(a){return a&1?this.qa(a+1&this.l)|this.qa(a)<<this.j:this.g[a>>>this.h].ra(a&this.i)};
g.mc=function(a){return a&1?this.qa(a)|this.qa(a+1&this.l)<<this.j:this.g[a>>>this.h].ra(a&this.i)};g.Yi=function(a){return(a&this.i)==this.i?this.o?this.mc(a):this.lc(a):this.g[a>>>this.h].ra(a&this.i)};g.nc=function(a,b){a&1?(this.oa(a,b>>this.j),this.oa(a+1&this.l,b&this.v)):this.g[a>>>this.h].ha(a&this.i,b)};g.oc=function(a,b){a&1?(this.oa(a,b&this.v),this.oa(a+1&this.l,b>>this.j)):this.g[a>>>this.h].ha(a&this.i,b)};
g.gj=function(a,b){(a&this.i)==this.i?this.o?this.oc(a,b):this.nc(a,b):this.g[a>>>this.h].ha(a&this.i,b)};function od(a,b){var c=a.u;a.u+=b;c&&a.u||(a.qa=a.md,a.oa=a.Ca,a.type==ld?(a.ra=a.Yi,a.ha=a.gj):a.o?(a.ra=a.mc,a.ha=a.oc):(a.ra=a.lc,a.ha=a.nc))}g.sb=function(a,b){return this.g[a>>>this.h].sb(b)?(od(this,1),!0):!1};g.Ob=function(a,b){return this.g[a>>>this.h].Ob(b)?(od(this,1),!0):!1};g.tb=function(a,b){return this.g[a>>>this.h].tb(b)?(od(this,-1),!0):!1};
g.Qb=function(a,b){return this.g[a>>>this.h].Qb(b)?(od(this,-1),!0):!1};var kd=0,ld=1;n.Bus=jd;
function md(a,b,c){E.call(this,a,b,c);this.pa=this.config.addr;this.size=this.config.size;this.type=this.config.type||H.NONE;this.j=(a=this.config.bus)?Cb(this,a):G(this,a="Bus");if(!this.j)throw Error(this.O("unable to find bus '%s'",a));this.g=this.j.j;this.i=Math.pow(2,this.g)-1;this.L=this.na=!1;this.m=this.j.o!==!1;this.values=this.ma=this.buffer=this.ka=null;a=this.Pa;b=this.Ca;c=this.m?this.$i:this.Zi;var d=this.m?this.ij:this.hj;this.j.type==kd&&(b=this.Sb,c=this.m?this.od:this.nd,d=this.Vb,
this.g==8&&Fb(this,"ArrayBuffer")!==!1&&(this.na=!0,c=this.m==xa?this.bj:this.cj));switch(this.type){case H.NONE:this.qa=this.Oa;this.oa=this.Ga;this.ra=this.aj;this.ha=this.jj;break;case H.Cc:this.qa=a;this.oa=this.Ga;this.ra=c;this.ha=this.Ga;break;case H.Qa:this.qa=a,this.oa=b,this.ra=c,this.ha=d}this.M=this.l=0;this.ba=this.o=this.Y=this.J=this.u=this.H=null;rd(this,this.config.values);sd(this)}m(md,E);
function rd(a,b){typeof b=="string"?(Ib(a,!1),gb(b,function(c,d,e,h){if(e==4)if(!h&&d){try{var f=JSON.parse(d);rd(a,f.values)}catch(k){a.I("error (%s) parsing resource: %s\n",k.message,c)}Ib(a,!0)}else a.I("error (%d) loading resource: %s\n",h,c)})):a.config.values=b}
function sd(a,b){if(a.type>H.NONE&&(a.na?(a.buffer=new ArrayBuffer(a.size),a.ka=new DataView(a.buffer,0,a.size),a.values=new Uint8Array(a.buffer,0,a.size),a.ma=new Uint16Array(a.buffer,0,a.size>>1),new Int32Array(a.buffer,0,a.size>>2)):a.values=Array(a.size).fill(0),b))for(var c=0;c<b.length;c++)a.values[c]=b[c]}g=md.prototype;
g.ta=function(){if(this.config.values)a:{var a=this.j,b=this.pa,c=this.size,d=this.config.values,e=0,h=b&a.i;b>>>=a.h;c>d.length&&(c=d.length);for(;c>0&&b<a.g.length;){var f=a.g[b++];if(!f)break a;for(;c>0&&h<f.size;)f.Ca(h++,d[e++]),c--;h=0}}else this.type&H.Qa&&this.values&&this.values.fill(0)};g.Oa=function(){return this.i};g.aj=function(a){return this.m?this.Oa(a)|this.Oa(a+1)<<this.g:this.Oa(a+1)|this.Oa(a)<<this.g};g.Mb=function(a){return this.values?this.values[a]:0};g.Pa=function(a){return this.values[a]};
g.nd=function(a){return this.values[a+1]|this.values[a]<<this.g};g.od=function(a){return this.values[a]|this.values[a+1]<<this.g};g.bj=function(a){return this.ma[a>>>1]};g.cj=function(a){return this.ka.getUint16(a,this.m)};g.Zi=function(a){return this.Pa(a+1)|this.Pa(a)<<this.g};g.$i=function(a){return this.Pa(a)|this.Pa(a+1)<<this.g};g.Ga=function(){};g.jj=function(a,b){this.m?(this.Ga(a,b&this.i),this.Ga(a+1,b>>this.g)):(this.Ga(a,b>>this.g),this.Ga(a+1,b&this.i))};
g.Rb=function(a,b){this.values&&(this.values[a]=b)};g.Ca=function(a,b){this.values[a]=b};g.Sb=function(a,b){this.values[a]=b;this.L=!0;this.l?this.J=this.Ca:this.oa=this.Ca};g.Ab=function(a,b){this.values[a]=b>>this.g;this.values[a+1]=b&this.i};g.Bb=function(a,b){this.values[a]=b&this.i;this.values[a+1]=b>>this.g};g.Tb=function(a,b){this.ma[a>>>1]=b};g.Ub=function(a,b){this.ka.setUint16(a,b,this.m)};g.hj=function(a,b){this.Ca(a,b>>this.g);this.Ca(a+1,b&this.i)};
g.ij=function(a,b){this.Ca(a,b&this.i);this.Ca(a+1,b>>this.g)};g.Vb=function(a,b){this.buffer?this.m==xa?(this.Tb(a,b),this.l?this.o=this.Tb:this.ha=this.Tb):(this.Ub(a,b),this.l?this.o=this.Ub:this.ha=this.Ub):this.m?(this.Bb(a,b),this.l?this.o=this.Bb:this.ha=this.Bb):(this.Ab(a,b),this.l?this.o=this.Ab:this.ha=this.Ab)};
g.sb=function(a){if(!this.M){var b=this;this.M++;this.u=a;this.Y=this.qa;this.ba=this.ra;this.qa=function(c){var d=b.Y(c);b.u(b.pa,c,d);return d};this.ra=function(c){var d=b.ba(c);b.u(b.pa,c,d);b.u(b.pa,c+1,d);return d};return!0}return this.u==a?(this.M++,!0):!1};g.Ob=function(a){if(!this.l){var b=this;this.l++;this.H=a;this.J=this.oa;this.o=this.ha;this.oa=function(c,d){b.H(b.pa,c,d);b.J(c,d)};this.ha=function(c,d){b.H(b.pa,c,d);b.H(b.pa,c+1,d);b.o(c,d)};return!0}return this.H==a?(this.l++,!0):!1};
g.tb=function(a){return this.M&&this.u==a?(--this.M||(this.qa=this.Y,this.ra=this.ba,this.Y=this.ba=this.u=null),!0):!1};g.Qb=function(a){return this.l&&this.H==a?(--this.l||(this.oa=this.J,this.ha=this.o,this.J=this.o=this.H=null),!0):!1};g.xa=function(a){if(a){var b=a.shift();if(this.Z==b){this.L=a.shift();a.shift();if(a=a.shift()){var c=this.size;c=c===void 0?0:c;if(a.length!=c){b=0;c=c?Array(c):[];for(var d=0;d<a.length-1;)for(var e=a[d++],h=a[d++];e--;)c[b++]=h;a=c}sd(this,a)}return!0}}return!1};
g.za=function(a){a.push(this.Z);a.push(this.L);a.push(!1);if(this.values){var b=this.values;for(var c=0,d=0,e=[];c<b.length;){for(var h=b[c],f=c+1;f<b.length&&b[f]===h;)f++;e[d++]=f-c;e[d++]=h;c=f}b=e.length>=b.length?b:e}else b=this.values;a.push(b)};var H={NONE:1,Cc:2,Qa:4,yd:14,Ck:12};n.Memory=md;function td(a,b,c){md.call(this,a,b,c);this.T=[];this.V=[];this.h=[];this.X=[];this.config.addr!=void 0&&nd(this.j,this.config.addr,this.config.size,H.NONE,this)}m(td,md);
td.prototype.Oa=function(a){var b,c=this.pa+a;if(b=this.T[c]){var d=b(c);var e=!0}else if(b=this.h[c])d=c&1?b(c&-2)>>this.g:b(c)&this.i,e=!0;else if(c&1)if(c&=-2,b=this.h[c])d=b(c)>>this.g,e=!0;else if(b=this.T[c])d=b(c),e=!0;e||(qd(this.j,c,0),this.I(272,"readNone(%#04x): unknown port\n",c),d=md.prototype.Oa.call(this,a));return d};
td.prototype.Ga=function(a,b){var c,d=this.pa+a;if(c=this.V[d]){c(d,b);var e=!0}else if(c=this.X[d])e=this.h[d]?this.h[d](d,!0):0,d&1?c(d,e&this.i|b<<this.g):c(d,e&~this.i|b),e=!0;else if(d&1)if(d&=-2,c=this.X[d])e=this.h[d]?this.h[d](d,!0):0,c(d,e&this.i|b<<this.g),e=!0;else if(c=this.V[d])c(d,b),e=!0;e||(qd(this.j,d,1),this.I(272,"writeNone(%#04x,%#04x): unknown port\n",d,b),md.prototype.Ga.call(this,a,b))};n.Ports=td;
function ud(a,b,c){c.type=H.NONE;md.call(this,a,b,c);nd(this.j,this.config.addr,this.config.size,H.Qa);Jb(this,this.ta.bind(this))}m(ud,md);n.RAM=ud;
function vd(a,b,c){c.type=H.Cc;md.call(this,a,b,c);nd(this.j,this.config.addr,this.config.size,this.config.type,this);Jb(this,this.ta.bind(this));this.ca=this.da=void 0;if(n.LED&&this.fa[wd]){var d=this;this.v=Math.pow(2,Math.ceil(Math.log2(this.values.length)/2));this.K=this.values.length/this.v|0;this.h=new qc(a,b+"LEDs",{"class":"LED",bindings:{container:cb(this,wd)},type:sc,cols:this.v,rows:this.K,color:A(this,"colorROM","green"),backgroundColor:A(this,"backgroundColorROM","black"),persistent:!0}),
Bc(this.h);this.N=new Mb(a,b+"Input",{"class":"Input",location:[0,0,this.h.ba,this.h.T,this.v,this.K],bindings:{surface:cb(this,wd)}});this.T=db(this)||"";Pb(this.N,function(e,h){if(d.ca){var f=d.T;e>=0&&h>=0&&(e=h*d.v+e,h=d.ca,f=h.da&&xd(h.da,d.pa+e,1)||"");vb(d,eb,f)}})}}m(vd,md);
vd.prototype.xa=function(a){var b=!0,c=a.shift();if(c&&this.h){var d=c.length;this.h.buffer.length==d?(this.h.buffer=c,Ac(this.h,!0)):(this.I("inconsistent saved LED state (%d), unable to load\n",d),b=!1)}a.length&&(d=(a=a.shift())&&a.length||-1,this.values.length==d?this.values=a:(this.I("inconsistent saved ROM state (%d), unable to load\n",d),b=!1));return b};vd.prototype.va=function(){this.ca===void 0&&(this.ca=G(this,"CPU"));this.da===void 0&&(this.da=G(this,"Debugger",!1))&&this.da.Ib&&this.da.Ib(this.config.symbols)};
vd.prototype.Pa=function(a){if(this.h){var b=this.h,c=Dc;c=(c===void 0?0:c)&129;var d=((a/this.v|0)*b.J+a%this.v)*4;if(d<=b.buffer.length-4){if(b.buffer[d]!==1||(b.buffer[d+3]&129)!==c)b.buffer[d]=1,b.buffer[d+3]=b.buffer[d+3]&-130|c|Dc,b.K=!0;b.V=d;b.L=!0;b.H=0}}return this.values[a]};vd.prototype.za=function(a){this.h&&(a.push(this.h.buffer),a.push(this.values))};var wd="array",eb="cellDesc";n.ROM=vd;
function yd(a,b,c){c["class"]="CPU";E.call(this,a,b,c);this.da=void 0;this.v=this.bb=0;this.Y=this.config.addrReset||0;this.time=G(this,"Time");this.time.H.push(this);this.time.N.push(this);this.V=this.g=0}m(yd,E);yd.prototype.abort=function(a){this.v=this.bb;this.I("%s\n",a.message);Vc(this.time)};function zd(a,b){a.da=b;return a.Ta}yd.prototype.Rc=function(){};yd.prototype.ej=function(a){this.V=this.g=a===void 0?0:a;try{this.Rc()}catch(b){this.abort(b)}return this.V-this.g};
yd.prototype.fj=function(){this.V-=this.g;this.g=0};
function Ad(a,b,c){c["class"]="Debugger";E.call(this,a,b,c);var d=this;this.ja=this.config.defaultRadix||16;this.ia=1;this.V=["(",")"];this.wc("a",function(h,f,k,l,q){return Oa(d,q.aa,d.ja,k)});this.wc("n",function(h,f,k,l,q){return Oa(d,q,d.ja,k,f.indexOf("#")<0?"":void 0)});this.ka=this.H=0;this.K={};this.ma=[];this.na=[];this.ca=G(this,"CPU");this.Ta=zd(this.ca,this);this.input=G(this,"Input",!1);if(a=this.ca.config.busMemory||this.config.busMemory){this.g=Cb(this,a);if(a=this.ca.config.busIO||
this.config.busIO)this.j=Cb(this,a,!1);this.j||(this.j=this.g)}else this.g=this.j=G(this,"Bus");this.J=this.g.ga;this.Da=Math.pow(2,this.J)-1|0;this.u=this.ba=0;this.o=[];for(var e in I)this.o[I[e]]=[];this.m=[];this.m[I.Aa]=this.g;this.m[I.Za]=this.g;this.m[I.Ua]=this.j;this.m[I.Va]=this.j;this.l=[];this.l[I.Aa]=this.Qd.bind(this);this.l[I.Za]=this.Rd.bind(this);this.l[I.Ua]=this.Od.bind(this);this.l[I.Va]=this.Pd.bind(this);this.i=[];this.L=void 0;this.T=null;this.X=0;this.time=G(this,"Time");this.time.N.push(this);
this.W=0;this.v=[];this.N="";this.Hb(this,"state","dump machine state",this.ae);this.Y=Bd();this.sa=Bd();this.ea=!1;this.M=0;this.h=[];Za(this,this.ie.bind(this));(e=Fb(this,"commands"))&&nb(this,e)}m(Ad,E);g=Ad.prototype;g.Hb=function(a,b,c,d){this.v.push({$d:a,name:b,Zd:c,Na:d})};function Cd(a,b,c){for(var d,e=0;e<a.v.length;e++){var h=a.v[e];if(h.name==b){d=h.Na.call(h.$d,c);break}}return d}
g.Ib=function(a){if(a&&a.length)for(var b=0;b<a.length-2;b+=3){var c=Dd(this,a[b]);if(c){var d=Ed[a[b+1]];if(d){c={address:c,type:d,name:a[b+2]};d=this.ma;var e=c,h=Fd(d,e,this.Mc);h<0&&d.splice(-(h+1),0,e);d=this.na;e=Fd(d,c,this.Nc);e<0&&d.splice(-(e+1),0,c)}}}};function Fd(a,b,c){var d=0,e=a.length,h=0;for(c===void 0&&(c=function(l,q){return l>q?1:l<q?-1:0});d<e;){var f=d+e>>1,k=void 0;k=c(b,a[f]);k>0?d=f+1:(e=f,h=!k)}return h?d:~d}g.Mc=function(a,b){return a.name>b.name?1:a.name<b.name?-1:0};
g.Nc=function(a,b){return a.address.aa>b.address.aa?1:a.address.aa<b.address.aa?-1:0};function Gd(a,b,c){b=Fd(a.na,{address:b,type:0,name:void 0},a.Nc);if(b>=0&&(a=a.na[b],!c||a.type==c))var d=a.name;return d}function Hd(a,b,c,d){d=d===void 0?a.g:d;b.aa=b.aa+c&d.l}function Bd(a){a=a===void 0?0:a;var b=Id.vd;return typeof a=="number"?{aa:a,Nb:-1,type:b}:{aa:a.aa,Nb:a.Nb,type:a.type}}
function Dd(a,b,c){if(b){var d=Bd();var e=0,h=b.charAt(e);switch(h){case "&":e++;break;case "#":e++;d.type=Id.wd;break;case "%":e++,h=b.charAt(e),h=="%"?e++:d.type=Id.Ic}h=b.indexOf(":",e);if(h>=0){var f=Jd(a,b.substring(e,h),c);f==void 0?d=null:(d.Nb=f,e=h+1)}d&&(b=Jd(a,b.substring(e),c),b==void 0?d=null:d.aa=b&a.Da)}return d}function Kd(a,b,c,d){d=d===void 0?a.g:d;a.u++;var e=d.Mb(b.aa);c&&Hd(a,b,c,d);a.u--;return e}
function Ld(a,b,c){if(a.J<=32)return b&c;b=Md(a,b,0,!0);c=Md(a,c,0,!0);return((b/v|0)&(c/v|0))*v+((b&c)>>>0)}function Nd(a,b,c){if(a.J<=32)return b^c;b=Md(a,b,0,!0);c=Md(a,c,0,!0);return((b/v|0)^(c/v|0))*v+((b^c)>>>0)}
function Od(a,b,c,d){for(d=d===void 0?-1:d;d--&&c.length;){var e=c.pop();if(b.length<2)return!1;var h=b.pop();var f=b.pop();switch(e){case "*":f*=h;break;case "/":if(!h)return!1;f=Math.trunc(f/h);break;case "^/":if(!h)return!1;f%=h;break;case "+":f+=h;break;case "-":f-=h;break;case "<<":f<<=h;break;case ">>":f>>=h;break;case ">>>":f>>>=h;break;case "<":f=f<h?1:0;break;case "<=":f=f<=h?1:0;break;case ">":f=f>h?1:0;break;case ">=":f=f>=h?1:0;break;case "==":f=f==h?1:0;break;case "!=":f=f!=h?1:0;break;
case "&":f=Ld(a,f,h);break;case "!":case "|":e=a;e.J<=32?f|=h:(f=Md(e,f,0,!0),h=Md(e,h,0,!0),f=(f/v|0|h/v|0)*v+((f|h)>>>0));break;case "^!":f=Nd(a,f,h);break;case "&&":f=f&&h?1:0;break;case "||":f=f||h?1:0;break;case ",,":f=Md(a,f,18,!0)*262144+Md(a,h,18,!0);break;case "_":case "^_":e=="^_"&&(h=35-(h&255));h&&(f=Md(a,f,0,!0),f=h>0?f*Math.pow(2,h):Math.trunc(f/Math.pow(2,-h)));break;default:return!1}b.push(Md(a,f))}return!0}
function Pd(a,b,c,d,e,h){var f,k=!1,l=0,q=[],p=[],u=a.ja;for(a.ja=e;c<d;){var r=b[c++].trim();var t=c<d?b[c++]:"";if(r){var x=void 0;var w=a;var B=r,y=h;l=l===void 0?0:l;if(B!=void 0){x=Gb(w,B.toUpperCase());if(x==void 0){x=void 0;var z=w,Y=Fd(z.ma,{address:null,type:0,name:B},z.Mc);Y>=0&&(x=z.ma[Y].address.aa);if(x==void 0)if(x=w,z=B,x.K[z]?x=x.K[z].value:(z=z.substr(0,6),x=x.K[z]&&x.K[z].value),x==void 0)x=Ma(B,B.length>1||w.ja>10?w.ja:10);else if(B=w.K[B]&&w.K[B].Mk)y?y.push(B):(y=Jd(w,B,y),y!==
void 0?x+=y:x=void 0)}x!=void 0&&(x=Md(w,Qd(w,x,l)))}w=x}else if(t=="{"){r=1;for(w=c;c<d;)if(c++,t=c<b.length?b[c++]:"",t=="{")r++;else if(t=="}"&&!--r)break;w=Pd(a,b,w,c-1,a.ja,h);w!=null&&l&&(w=Qd(a,w,l));r=c<d?b[c++].trim():"";t=c<d?b[c++]:""}else{if(t==" ")continue;if(t=="^B"){a.ja=2;continue}if(t=="^O"){a.ja=8;continue}if(t=="^D"){a.ja=10;continue}if(!(l&-1073741824)){if(t=="+")continue;if(t=="-"){l=l<<2|1;continue}if(t=="~"||t=="^-"){l=l<<2|2;continue}if(t=="^L"){l=l<<2|3;continue}}k=!0;break}if(w===
void 0)if(h)h.push(r),w=0;else{k=!0;break}q.push(Md(a,w));if(t==" ")if(c<b.length-1&&!b[c])c++,t=b[c++];else{k=!0;break}if(!t)break;w=a.V[0]=="<"?Rd:Sd;if(!w[t]){k=!0;break}p.length&&w[t]<=w[p[p.length-1]]&&Od(a,q,p,1);p.push(t);a.ja=t=="^_"?10:e;l=0}if(k||!Od(a,q,p)||q.length!=1)k=!0;k?h||a.I("parse error (%s)\n",r||t):f=q.pop();a.ja=u;return f}
function Td(a,b,c,d){for(var e,h=a.J/d|0;(e=b.indexOf(c))>=0;){for(var f=0,k=e+1,l=h;k<b.length;){var q=b[k++];if(q==c){l=-1;break}if(!l)break;l--;q=q.charCodeAt(0);d==6&&(q-=32);q&=(1<<d)-1;f=Md(a,f*Math.pow(2,d)+q,d*h,!0)}if(l>=0){a.I("parse error (%c%s%c)\n",c,b,c);return}b=b.substr(0,e)+Oa(a,f)+b.substr(k)}return b}
function Jd(a,b,c){if(b){a.V[0]!="{"&&(b=b.split(a.V[0]).join("{").split(a.V[1]).join("}"));b=Td(a,b,'"',8);if(!b)return d;b=Td(a,b,"'",6);if(!b)return d;a.ja!=16&&(b=b.replace(/(^|[^A-Z0-9$%.])([0-9]+)B/,"$1$2^_").replace(/\s+/g," "));b=b.split(/({|}|\|\||&&|\||\^!|\^B|\^O|\^D|\^L|\^-|~|\^_|_|&|!=|!|==|>=|>>>|>>|>|<=|<<|<|-|\+|\^\/|\/|\*|,,| )/);var d=Pd(a,b,0,b.length,a.ja,c)}return d}
function Qd(a,b,c){for(;c;){var d;switch(c&3){case 1:b=-Md(a,b);break;case 2:b=Nd(a,b,-1);break;case 3:for(d=35;d>=0&&!Ld(a,b,Math.pow(2,d));)d--;b=35-d}c>>>=2}return b}function Md(a,b,c,d){var e=b;c=c||a.J;if(d)if(c==32)e=b>>>0;else if(c<32)e=b&(1<<c)-1;else{if(a=Math.pow(2,c),b<0||b>=a)e=b%a,e<0&&(e+=a)}else c<=32?e=b<<32-c>>32-c:(a=Math.pow(2,c-1),b>=a?(e=b%a,(b/a|0)&1&&(e-=a)):b<-a&&(e=b%a,((-b-1)/a|0)&1?e&&(e+=a):e||(e-=a)));b!=e&&(b=e);return b}
g.Jb=function(a){function b(k){for(var l=0;l<k.length;l++)if(k[l]!=void 0)return!1;return!0}if(a<-1)return Ud(this,this.Jb);var c="";if(a>=0){var d=this.i[a];if(d!=void 0){c=d>>8;d&=255;var e=this.m[c];if(e){var h=this.o[c],f=h[d];(c&1?e.Qb(f.aa,this.l[c]):e.tb(f.aa,this.l[c]))?(h[d]=void 0,this.i[a]=void 0,b(h)&&(h.length=0,b(this.i)&&(this.i.length=0)),c=this.O("%2d: %s %*a cleared\n",a,Vd[c],e.ga,f),--this.ba||this.ea||(c+=Wd(this,!1))):c=this.O("invalid break address: %*a\n",e.ga,f)}else c="invalid bus"}else c=
this.O("invalid break index: %d\n",a)}else c="missing break index\n";return c};function Xd(a,b){if(a.T&&(b==void 0||a.T.aa==b)){var c=c===void 0?I.Aa:c;b=-1;var d=Yd(a.T,a.o[c]);if(d>=0)for(var e=0;e<a.i.length;e++){var h=a.i[e];if(h!=void 0&&c==h>>8&&d==(h&255)){b=e;break}}c=b;c>=0&&a.Jb(c);a.T=null}}
g.Kb=function(a,b){b=b===void 0?!1:b;if(a<-1)return Ud(this,this.Kb,b);if(a>=0){var c=this.i[a];if(c!=void 0){var d=c>>8;c=this.o[d][c&255];if(c!=void 0){var e=b?"enabled":"disabled",h=this.m[d];!c.disabled==!b?(c.disabled=!b,a=this.O("%2d: %s %*a %s\n",a,Vd[d],h.ga,c,e)):a=this.O("%2d: %s %*a already %s\n",a,Vd[d],h.ga,c,e)}else a=this.O("no break address at index: %d\n",a)}else a=this.O("invalid break index: %d\n",a)}else a="missing break index\n";return a};
function Ud(a,b,c){for(var d="",e=0;e<a.i.length;e++)a.i[e]!=void 0&&(d+=b.call(a,e,c));d||(d="no break addresses found");return d}function Zd(a,b,c){c=c===void 0?I.Aa:c;a=a.o[c];for(c=0;c<a.length;c++){var d=a[c];if(d.aa==b)return d}}function Yd(a,b){for(var c=0;c<b.length;c++)if(b[c].aa==a.aa)return c;return-1}
function $d(a,b){b=b===void 0?!1:b;for(var c="",d=0;d<a.i.length;d++){var e=a.i[d];if(e!=void 0){var h=e>>8;e=a.o[h][e&255];h=a.O("%s %*a",Vd[h],a.m[h].ga,e);b?(c&&(c+=";"),c+=h,e.disabled&&(c+=";bd "+d)):c+=a.O("%2d: %s %s\n",d,h,e.disabled?"disabled":"enabled")}}c||b||(c="no break addresses found\n");return c}
function ae(a,b,c){c=c===void 0?I.Aa:c;if(b){var d=a.m[c];if(d){var e=a.o[c];var h=Yd(b,e);if(h>=0)h=-(h+1);else{for(h=0;h<e.length&&e[h]!=void 0;h++);e[h]=b}e=h;if(e>=0)if(h=c&1?d.Ob(b.aa,a.l[c]):d.sb(b.aa,a.l[c])){for(h=0;h<a.i.length&&a.i[h]!=void 0;h++);a.i[h]=c<<8|e;b=a.O("%2d: %s %*a set\n",h,Vd[c],d.ga,b);a.ba++||a.h.length||(b+=Wd(a,!0))}else b=a.O("invalid break address: %*a\n",d.ga,b),a.o[c][e]=void 0;else b=a.O("%s %*a already set\n",Vd[c],d.ga,b)}else b="invalid bus"}else b="missing break address\n";
return b}function be(a,b){b>=0&&(a.H=b);var c="instruction break count: "+(a.H>0?a.H:"disabled")+"\n";b>0&&(a.h.length||(c+=Wd(a,!0)),a.ea=!0);return c}function ce(a,b){var c;if(b){var d=pb(b);d!=void 0?a.ka=d?0xffffffffffff:0:c=a.O("unrecognized message option: %s\n",b)}c||(c=a.O("break on message: %b\n",!!a.ka));return c}g.Od=function(a,b){this.u||(a==void 0?de(this,"break on unknown input %#0x: %#0x",b):(a=Zd(this,a+b,I.Ua))&&!a.disabled&&de(this,"break on input %*a: %#0x",this.j.ga))};
g.Pd=function(a,b){this.u||(a==void 0?de(this,"break on unknown output %#0x: %#0x",b):(a=Zd(this,a+b,I.Va))&&!a.disabled&&de(this,"break on output %*a: %#0x",this.j.ga))};
g.Qd=function(a,b){this.u||(a==void 0?de(this,"break on unknown read %#0x: %#0x",b):(a+=b,this.h.length&&a==this.ca.bb&&(this.X++,this.H>0&&(--this.H||de(this,"break on instruction count")),this.h[this.M++]=a,this.M==this.h.length&&(this.M=0)),(b=Zd(this,a,I.Aa))&&!b.disabled&&(de(this,"break on read %*a: %#0x",this.g.ga),Xd(this,a))))};g.Rd=function(a,b){this.u||(a==void 0?de(this,"break on unknown write %#0x: %#0x",b):(a=Zd(this,a+b,I.Za))&&!a.disabled&&de(this,"break on write %*a: %#0x",this.g.ga))};
function de(a,b,c){b=a.O.apply(a,[b].concat(pa(c)));a.I("%s\n",b);Vc(a.time)}function ee(a,b,c){c=c===void 0?a.g:c;return Oa(a,b.aa,a.ja,c.ga,"")}
function fe(a,b,c){c=c===void 0?10:c;var d="";if(a.h.length){var e,h=[];c>a.h.length&&(c=a.h.length);b<0&&(b=c);var f=a.M-b;for(f<0&&(f+=a.h.length);f>=0&&f<a.h.length&&c>0;){var k=a.h[f++];if(k==void 0)break;f==a.h.length&&(f=0);e?e.aa=k:e=Bd(k);for(k=0;k<a.ia;k++)h[k]=Kd(a,e,1);Hd(a,e,-h.length);d+=a.Pb(e,h,a.O("[%6d]",b--));c--}}return d||"no history"}
function xd(a,b,c){var d=[],e="";for(b=typeof b=="number"?Bd(b):b;c--;){for(Hd(a,b,d.length);d.length<a.ia;)d.push(Kd(a,b,1));Hd(a,b,-d.length);e+=a.Pb(b,d)}return e}
function ge(a,b,c,d,e,h){var f="";h=h?a.j:a.g;c||(c=h.j);var k=c>>3;d||(d=128);var l=0,q=d+15>>4||1,p=k==4?16:a.ja;e=="y"&&(p=k,q=d,l=k*8);b||(b=a.sa);for(;q--&&d>0;){var u=e=0,r,t="",x="",w=ee(a,b,h);for(r=p;r>0&&d>0;r--){var B=Kd(a,b,1,h);e|=B<<(u++<<3);u==k&&(t+=Oa(a,e,0,c,""),t+=k==1?r==9?"-":" ":" ",l&&(x+=Oa(a,e,2,c,"")),e=u=0);l||(x+=B>=32&&B<127?String.fromCharCode(B):".");d--}f&&(f+="\n");f+=w+"  "+t+" "+x}a.sa=b;return f}
g.ae=function(){var a=[];Eb(this,function(b){b.Ra&&b.Ra(a);return!0});return JSON.stringify(a,null,2)};function he(a,b,c,d){var e=0,h="";d=d?a.j:a.g;for(var f=0;b!=void 0&&f<c.length;f++){var k=Kd(a,b,0,d);if(k==void 0)break;var l=a,q=b,p=c[f],u=d;u=u===void 0?l.g:u;l.u++;u.Rb(q.aa,p);l.u--;h+=a.O("%*a: %#*n changed to %#*n\n",a.g.ga,b,a.g.j,k,a.g.j,c[f]);Hd(a,b,1,d);e++}e||(h+=a.O("%d locations updated\n",e));a.time.update();return h}
function Wd(a,b){var c="";b!=void 0&&b==!a.h.length&&pd(a.g,function(d){b?a.g.sb(d.pa,a.l[I.Aa]):a.g.tb(d.pa,a.l[I.Aa])})&&(b?(a.M=0,a.h=Array(ie)):a.h=[]);return c+=a.O("instruction history %s\n",a.h.length?"enabled":"disabled")}g.xa=function(a){var b=a.shift();return this.Z==b?(nb(this,a.shift()),this.U.ua=a.shift(),!0):!1};g.Sc=function(a){Pa(this.ka,a)?de(this,"break on message"):this.time.T=!0};
g.ie=function(a){var b=a[1],c=a[2],d=[],e=[],h=!1,f="";this.L=void 0;if(c=="*")var k=-2;else{k=Ma(c);k==void 0&&(k=-1);var l=Dd(this,c,e);if(l===null)return}var q=0;a[3]&&(q=Ma(a[3].substr(a[3][0]=="l"?1:0))||8);for(var p=3;p<a.length;p++)d.push(Ma(a[p],16));if(b=="d"){p=Cd(this,c,d);if(p!=void 0)return p;b=this.N||b}if(b[0]!="s"&&e.length)return"unrecognized symbol(s): "+e;switch(b[0]){case "b":b[1]=="c"?f=this.Jb(k):b[1]=="d"?f=this.Kb(k):b[1]=="e"?f=this.Kb(k,!0):b[1]=="i"?f=ae(this,l,I.Ua):b[1]==
"l"?f=$d(this):b[1]=="m"?f=ce(this,c):b[1]=="n"?f=be(this,k):b[1]=="o"?f=ae(this,l,I.Va):b[1]=="r"?f=ae(this,l,I.Aa):b[1]=="w"?f=ae(this,l,I.Za):b[1]=="?"?(f="break commands:\n",je.forEach(function(u){f+=u+"\n"})):b[1]&&(f=void 0);break;case "d":this.N=b;if(b[1]!="b"&&b[1])if(b[1]=="w")c=16;else if(b[1]=="d")c=32;else if(b[1]=="i"){if(!this.j){f="invalid bus";break}c=this.j.j;q=q||1;h=!0}else{if(b[1]=="h")this.N="",f=fe(this,k,q);else if(b[1]=="?"){if(this.N="",f="dump commands:\n",ke.forEach(function(u){f+=
u+"\n"}),this.v.length)for(f+="dump extensions:\n",b=0;b<this.v.length;b++)l=this.v[b],f+=this.O("d   %-12s%s\n",l.name,l.Zd)}else this.N="",f=void 0;break}else c=8;f=ge(this,l,c,q,b[2],h);break;case "e":if(b[1]=="o"){if(!this.j){f="invalid bus";break}h=!0}else if(b[1]){f=void 0;break}f=he(this,l,d,h);break;case "g":if(this.time.start()){if(l!=void 0){Xd(this);f=ae(this,l);if(f.indexOf(":")!=2)break;this.T=l;f=""}break}f="already started\n";break;case "h":Vc(this.time)||(f="already stopped\n");break;
case "p":a.shift();a.shift();b=a.join(" ");f+=this.O("%s = %s\n",b,Oa(this,Jd(this,b)));break;case "r":if(b=b.substr(1).toUpperCase()){if(Gb(this.ca,b)==void 0){f+=this.O("unrecognized register: %s\n",b);break}l!=void 0&&Lb(this.ca,b,l.aa)}this.Y.aa=this.ca.v;f+=this.ca.toString();break;case "s":l=pb(c);if(b[1]=="h"){if(this.ba||this.H>0)l=void 0;f=Wd(this,l);l!=void 0&&(this.ea=l)}else b[1]=="p"?k>0?(Sc(this.time,k),f="target speed:  "+Yc(this.time.o)):f="current speed: "+fd(this.time):b[1]=="s"&&
this.la?(k=this.la.indexOf(c),k>=0&&(this.style=this.la[k]),f="style: "+this.style):b[1]=="?"?(f="set commands:\n",le.forEach(function(u){f+=u+"\n"})):f=void 0;break;case "t":q=Ma(c,10)||1;this.L=!0;if(b[1]){if(b[1]!="r"){f=void 0;break}this.L=!1}$c(this.time,q);break;case "u":if(b[1]){f=void 0;break}q||(q=8);l||(l=this.Y);f+=xd(this,l,q);this.Y=l;break;case "?":f="debugger commands:\n";me.forEach(function(u){f+=u+"\n"});break;default:f=void 0}f==void 0&&a[0]&&(f="unrecognized command '"+a[0]+"' (try '?')\n");
return f};g.pb=function(a){return a&&this.xa(a[0])?(a.shift(),!0):!1};g.Ra=function(a){var b=[];this.za(b);a.push(b);this.W=0};g.Lb=function(a){a&&(this.time.g?this.W&&this.input&&oc(this.input):this.L?this.Ka(xd(this,this.ca.v,1)):(this.X&&(this.ca.I("%d instructions executed\n",this.X),this.X=0),this.ca.Ka(this.ca.toString()),this.L==void 0&&this.W&&(a=this.Ea(Wa.hb,!0))&&a.focus()),this.W++)};g.za=function(a){a.push(this.Z);a.push($d(this,!0));a.push(this.U.ua)};
g.Pb=function(a,b,c){var d=this.O,e=ee(this,a);b=b.shift();Hd(this,a,1);return d.call(this,"%s %02x       unsupported       ; %s\n",e,b,c||"")};
var me="b?\t\tbreak commands;d?\t\tdump commands;e[o] [addr] ...\tedit memory/ports;g    [addr]\trun (to addr);h\t\thalt;p    [expr]\tparse expression;r?   [value]\tdisplay/set registers;s?\t\tset commands;t[r] [n]\tstep (n instructions);u    [addr] [n]\tunassemble (at addr)".split(";"),je="bc [n|*]\tclear break address;bd [n|*]\tdisable break address;be [n|*]\tenable break address;bl [n]\t\tlist break addresses;bi [addr]\tbreak on input;bo [addr]\tbreak on output;br [addr]\tbreak on read;bw [addr]\tbreak on write;bm [on|off]\tbreak on message;bn [count]\tbreak on instruction count".split(";"),ke=
"db  [addr]\tdump bytes (8 bits);dw  [addr]\tdump words (16 bits);dd  [addr]\tdump dwords (32 bits);di  [addr]\tdump input ports;d*y [addr]\tdump values in binary;dh  [n] [l]\tdump instruction history buffer;ds\t\tdump machine state".split(";"),le=["sh [on|off]\tset instruction history","sp [n]\t\tset speed multiplier","ss\t\tset debugger style"],Id={Ic:1,vd:0,wd:2,Ak:0},I={Aa:0,Za:1,Ua:2,Va:3},ne={},Vd=(ne[I.Aa]="br",ne[I.Za]="bw",ne[I.Ua]="bi",ne[I.Va]="bo",ne),oe={ud:"PC"},pe={BYTE:1,td:2,xd:4,
sc:5,ac:6,Jd:7},Ed={"=":pe.Jd,1:pe.BYTE,2:pe.td,4:pe.xd,"@":pe.sc,";":pe.ac},ie=1E5,Sd={"||":5,"&&":6,"!":7,"|":7,"^!":8,"&":9,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,_:19,"^_":19,"{":20,"}":20},Rd={",,":1,"||":5,"&&":6,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,"!":15,"|":15,"^!":15,"&":15,_:19,"^_":19,"{":20,"}":20};
function qe(a,b,c){yd.call(this,a,b,c);re(this);this.X=Cb(this,this.config.busIO);this.T=Cb(this,this.config.busMemory);this.input=G(this,"Input",!1)}m(qe,yd);g=qe.prototype;g.Rc=function(){if(se(this))for(;this.g>0;)this.bb=this.v,this.W[J(this)].call(this)};
function re(a){te(a);F(a,"A",function(){return a.h},function(b){return a.h=b&255});F(a,"B",function(){return a.i},function(b){return a.i=b&255});F(a,"C",function(){return a.j},function(b){return a.j=b&255});F(a,"D",function(){return a.l},function(b){return a.l=b&255});F(a,"E",function(){return a.m},function(b){return a.m=b&255});F(a,"H",function(){return a.o},function(b){return a.o=b&255});F(a,"L",function(){return a.u},function(b){return a.u=b&255});F(a,"CF",function(){return ue(a)?1:0},function(b){a.H=
b?a.H|256:a.H&255});F(a,"PF",function(){return ve(a)?1:0},function(b){b?ve(a)||(a.J^=1):ve(a)&&(a.J^=1)});F(a,"AF",function(){return we(a)?1:0},function(b){a.L=b?~a.J&16|a.L&-17:a.J&16|a.L&-17});F(a,"ZF",function(){return xe(a)?1:0},function(b){a.H=b?a.H&-256:a.H|255});F(a,"SF",function(){return ye(a)?1:0},function(b){b?ye(a)||(a.J^=192):ye(a)&&(a.J^=192)});F(a,"IF",function(){return a.K&ze?1:0},function(b){a.K=b?a.K|ze:a.K&~ze});F(a,"BC",a.Ha,a.cb);F(a,"DE",a.Fa,a.Sa);F(a,"HL",a.S,a.wa);F(a,oe.ud,
a.ce,a.R);a.W=[a.Ia,a.Yf,a.wi,a.If,a.Bf,a.kf,a.oh,a.Sh,a.Ia,a.ef,a.Vf,a.sf,a.Cf,a.lf,a.ph,a.Zh,a.Ia,a.Zf,a.xi,a.Jf,a.Df,a.mf,a.qh,a.Ph,a.Ia,a.ff,a.Wf,a.tf,a.Ef,a.nf,a.rh,a.Qh,a.Ia,a.$f,a.si,a.Kf,a.Ff,a.pf,a.sh,a.df,a.Ia,a.gf,a.Xf,a.uf,a.Gf,a.qf,a.th,a.Ne,a.Ia,a.ag,a.ui,a.Lf,a.Hf,a.rf,a.uh,a.yi,a.Ia,a.hf,a.Uf,a.vf,a.Af,a.jf,a.nh,a.Oe,a.kg,a.lg,a.mg,a.ng,a.og,a.pg,a.qg,a.jg,a.sg,a.tg,a.ug,a.vg,a.wg,a.xg,a.yg,a.rg,a.Ag,a.Bg,a.Cg,a.Dg,a.Eg,a.Fg,a.Gg,a.zg,a.Ig,a.Jg,a.Kg,a.Lg,a.Mg,a.Ng,a.Og,a.Hg,a.Qg,a.Rg,
a.Sg,a.Tg,a.Ug,a.Vg,a.Wg,a.Pg,a.Yg,a.Zg,a.$g,a.ah,a.bh,a.dh,a.eh,a.Xg,a.gh,a.hh,a.ih,a.jh,a.kh,a.mh,a.yf,a.fh,a.cg,a.dg,a.eg,a.fg,a.gg,a.hg,a.ig,a.bg,a.ue,a.ve,a.we,a.xe,a.ye,a.ze,a.Ae,a.te,a.me,a.ne,a.oe,a.pe,a.qe,a.re,a.se,a.le,a.Ai,a.Bi,a.Ci,a.Di,a.Ei,a.Fi,a.Gi,a.zi,a.ji,a.ki,a.li,a.mi,a.ni,a.oi,a.pi,a.ii,a.De,a.Ee,a.Fe,a.Ge,a.He,a.Ie,a.Je,a.Ce,a.Ki,a.Li,a.Mi,a.Ni,a.Oi,a.Pi,a.Qi,a.Ji,a.xh,a.yh,a.zh,a.Ah,a.Bh,a.Ch,a.Dh,a.wh,a.Qe,a.Re,a.Se,a.Te,a.Ue,a.Ve,a.We,a.Pe,a.Vh,a.Hh,a.Pf,a.Tc,a.Ye,a.Mh,a.Be,
a.$h,a.hi,a.Uc,a.Tf,a.Tc,a.cf,a.qb,a.ke,a.ai,a.Uh,a.Ih,a.Of,a.Fh,a.Xe,a.Nh,a.Hi,a.bi,a.Rh,a.Uc,a.Mf,a.zf,a.Le,a.qb,a.ri,a.ci,a.Yh,a.Jh,a.Sf,a.Si,a.bf,a.Oh,a.Ke,a.di,a.Xh,a.Gh,a.Rf,a.Ii,a.$e,a.qb,a.Ri,a.ei,a.Wh,a.Kh,a.Qf,a.wf,a.Ze,a.Lh,a.Eh,a.fi,a.Th,a.ti,a.Nf,a.xf,a.Me,a.qb,a.af,a.gi]}
g.xa=function(a){if(!a||!a.length)return this.I("invalid saved state\n"),!1;var b=a.shift(),c=a.shift();if(b!=this.Z||(c|0)!==3)return this.I("CPU state mismatch (%s %3.2f)\n",b,c),!1;try{this.h=a.shift(),this.i=a.shift(),this.j=a.shift(),this.l=a.shift(),this.m=a.shift(),this.o=a.shift(),this.u=a.shift(),this.R(a.shift()),this.M=a.shift()&65535,Ae(this,a.shift()),this.N=a.shift()}catch(d){return this.I("CPU state error: %s\n",d.message),!1}return!0};
g.za=function(a){a.push(this.Z);a.push(3);a.push(this.h);a.push(this.i);a.push(this.j);a.push(this.l);a.push(this.m);a.push(this.o);a.push(this.u);a.push(this.v);a.push(this.M);a.push(Be(this));a.push(this.N)};g.pb=function(a){return a&&this.xa(a[0])?(a.shift(),!0):!1};g.va=function(a){a?(this.time.start(),this.input&&oc(this.input)):Vc(this.time)};g.ta=function(){this.I("reset\n");te(this);this.time.g||this.Ka(this.toString())};g.Ra=function(a){var b=[];this.za(b);a.push(b)};g.Lb=function(){};
g.Ia=function(){this.g-=4};g.Yf=function(){this.cb(K(this));this.g-=10};g.wi=function(){Ce(this,this.Ha(),this.h);this.g-=7};g.If=function(){this.cb(this.Ha()+1);this.g-=5};g.Bf=function(){this.i=De(this,this.i);this.g-=5};g.kf=function(){this.i=Ee(this,this.i);this.g-=5};g.oh=function(){this.i=J(this);this.g-=7};g.Sh=function(){var a=this.h<<1;this.h=a&255|a>>8;Fe(this,a&256);this.g-=4};g.ef=function(){var a;this.wa(a=this.S()+this.Ha());Fe(this,a>>8&256);this.g-=10};
g.Vf=function(){this.h=L(this,this.Ha());this.g-=7};g.sf=function(){this.cb(this.Ha()-1);this.g-=5};g.Cf=function(){this.j=De(this,this.j);this.g-=5};g.lf=function(){this.j=Ee(this,this.j);this.g-=5};g.ph=function(){this.j=J(this);this.g-=7};g.Zh=function(){var a=this.h<<8&256;this.h=(a|this.h)>>1;Fe(this,a);this.g-=4};g.Zf=function(){this.Sa(K(this));this.g-=10};g.xi=function(){Ce(this,this.Fa(),this.h);this.g-=7};g.Jf=function(){this.Sa(this.Fa()+1);this.g-=5};
g.Df=function(){this.l=De(this,this.l);this.g-=5};g.mf=function(){this.l=Ee(this,this.l);this.g-=5};g.qh=function(){this.l=J(this);this.g-=7};g.Ph=function(){var a=this.h<<1;this.h=a&255|ue(this);Fe(this,a&256);this.g-=4};g.ff=function(){var a;this.wa(a=this.S()+this.Fa());Fe(this,a>>8&256);this.g-=10};g.Wf=function(){this.h=L(this,this.Fa());this.g-=7};g.tf=function(){this.Sa(this.Fa()-1);this.g-=5};g.Ef=function(){this.m=De(this,this.m);this.g-=5};
g.nf=function(){this.m=Ee(this,this.m);this.g-=5};g.rh=function(){this.m=J(this);this.g-=7};g.Qh=function(){var a=this.h<<8;this.h=(ue(this)<<8|this.h)>>1;Fe(this,a&256);this.g-=4};g.$f=function(){this.wa(K(this));this.g-=10};g.si=function(){var a=K(this);this.T.ha(a,this.S()&65535);this.g-=16};g.Kf=function(){this.wa(this.S()+1);this.g-=5};g.Ff=function(){this.o=De(this,this.o);this.g-=5};g.pf=function(){this.o=Ee(this,this.o);this.g-=5};g.sh=function(){this.o=J(this);this.g-=7};
g.df=function(){var a=0,b=ue(this);if(we(this)||(this.h&15)>9)a|=6;if(b||this.h>=154)a|=96,b=Ge;this.h=He(this,a);Fe(this,b?256:0);this.g-=4};g.gf=function(){var a;this.wa(a=this.S()+this.S());Fe(this,a>>8&256);this.g-=10};g.Xf=function(){var a=this.wa;var b=K(this);b=this.T.ra(b);a.call(this,b);this.g-=16};g.uf=function(){this.wa(this.S()-1);this.g-=5};g.Gf=function(){this.u=De(this,this.u);this.g-=5};g.qf=function(){this.u=Ee(this,this.u);this.g-=5};g.th=function(){this.u=J(this);this.g-=7};
g.Ne=function(){this.h=~this.h&255;this.g-=4};g.ag=function(){this.M=K(this)&65535;this.g-=10};g.ui=function(){Ce(this,K(this),this.h);this.g-=13};g.Lf=function(){this.M=this.M+1&65535;this.g-=5};g.Hf=function(){var a=this.S();Ce(this,a,De(this,L(this,a)));this.g-=10};g.rf=function(){var a=this.S();Ce(this,a,Ee(this,L(this,a)));this.g-=10};g.uh=function(){Ce(this,this.S(),J(this));this.g-=10};g.yi=function(){this.H|=256;this.g-=4};
g.hf=function(){var a;this.wa(a=this.S()+this.M);Fe(this,a>>8&256);this.g-=10};g.Uf=function(){this.h=L(this,K(this));this.g-=13};g.vf=function(){this.M=this.M-1&65535;this.g-=5};g.Af=function(){this.h=De(this,this.h);this.g-=5};g.jf=function(){this.h=Ee(this,this.h);this.g-=5};g.nh=function(){this.h=J(this);this.g-=7};g.Oe=function(){Fe(this,ue(this)?0:256);this.g-=4};g.kg=function(){this.g-=5};g.lg=function(){this.i=this.j;this.g-=5};g.mg=function(){this.i=this.l;this.g-=5};
g.ng=function(){this.i=this.m;this.g-=5};g.og=function(){this.i=this.o;this.g-=5};g.pg=function(){this.i=this.u;this.g-=5};g.qg=function(){this.i=L(this,this.S());this.g-=7};g.jg=function(){this.i=this.h;this.g-=5};g.sg=function(){this.j=this.i;this.g-=5};g.tg=function(){this.g-=5};g.ug=function(){this.j=this.l;this.g-=5};g.vg=function(){this.j=this.m;this.g-=5};g.wg=function(){this.j=this.o;this.g-=5};g.xg=function(){this.j=this.u;this.g-=5};g.yg=function(){this.j=L(this,this.S());this.g-=7};
g.rg=function(){this.j=this.h;this.g-=5};g.Ag=function(){this.l=this.i;this.g-=5};g.Bg=function(){this.l=this.j;this.g-=5};g.Cg=function(){this.g-=5};g.Dg=function(){this.l=this.m;this.g-=5};g.Eg=function(){this.l=this.o;this.g-=5};g.Fg=function(){this.l=this.u;this.g-=5};g.Gg=function(){this.l=L(this,this.S());this.g-=7};g.zg=function(){this.l=this.h;this.g-=5};g.Ig=function(){this.m=this.i;this.g-=5};g.Jg=function(){this.m=this.j;this.g-=5};g.Kg=function(){this.m=this.l;this.g-=5};
g.Lg=function(){this.g-=5};g.Mg=function(){this.m=this.o;this.g-=5};g.Ng=function(){this.m=this.u;this.g-=5};g.Og=function(){this.m=L(this,this.S());this.g-=7};g.Hg=function(){this.m=this.h;this.g-=5};g.Qg=function(){this.o=this.i;this.g-=5};g.Rg=function(){this.o=this.j;this.g-=5};g.Sg=function(){this.o=this.l;this.g-=5};g.Tg=function(){this.o=this.m;this.g-=5};g.Ug=function(){this.g-=5};g.Vg=function(){this.o=this.u;this.g-=5};g.Wg=function(){this.o=L(this,this.S());this.g-=7};
g.Pg=function(){this.o=this.h;this.g-=5};g.Yg=function(){this.u=this.i;this.g-=5};g.Zg=function(){this.u=this.j;this.g-=5};g.$g=function(){this.u=this.l;this.g-=5};g.ah=function(){this.u=this.m;this.g-=5};g.bh=function(){this.u=this.o;this.g-=5};g.dh=function(){this.g-=5};g.eh=function(){this.u=L(this,this.S());this.g-=7};g.Xg=function(){this.u=this.h;this.g-=5};g.gh=function(){Ce(this,this.S(),this.i);this.g-=7};g.hh=function(){Ce(this,this.S(),this.j);this.g-=7};
g.ih=function(){Ce(this,this.S(),this.l);this.g-=7};g.jh=function(){Ce(this,this.S(),this.m);this.g-=7};g.kh=function(){Ce(this,this.S(),this.o);this.g-=7};g.mh=function(){Ce(this,this.S(),this.u);this.g-=7};g.yf=function(){this.g-=7;this.N|=Ie;dd(this.time);this.K&ze&&!kb(this,70368744177664)||(this.R(this.v-1),Vc(this.time))};g.fh=function(){Ce(this,this.S(),this.h);this.g-=7};g.cg=function(){this.h=this.i;this.g-=5};g.dg=function(){this.h=this.j;this.g-=5};
g.eg=function(){this.h=this.l;this.g-=5};g.fg=function(){this.h=this.m;this.g-=5};g.gg=function(){this.h=this.o;this.g-=5};g.hg=function(){this.h=this.u;this.g-=5};g.ig=function(){this.h=L(this,this.S());this.g-=7};g.bg=function(){this.g-=5};g.ue=function(){this.h=He(this,this.i);this.g-=4};g.ve=function(){this.h=He(this,this.j);this.g-=4};g.we=function(){this.h=He(this,this.l);this.g-=4};g.xe=function(){this.h=He(this,this.m);this.g-=4};g.ye=function(){this.h=He(this,this.o);this.g-=4};
g.ze=function(){this.h=He(this,this.u);this.g-=4};g.Ae=function(){this.h=He(this,L(this,this.S()));this.g-=7};g.te=function(){this.h=He(this,this.h);this.g-=4};g.me=function(){this.h=Je(this,this.i);this.g-=4};g.ne=function(){this.h=Je(this,this.j);this.g-=4};g.oe=function(){this.h=Je(this,this.l);this.g-=4};g.pe=function(){this.h=Je(this,this.m);this.g-=4};g.qe=function(){this.h=Je(this,this.o);this.g-=4};g.re=function(){this.h=Je(this,this.u);this.g-=4};
g.se=function(){this.h=Je(this,L(this,this.S()));this.g-=7};g.le=function(){this.h=Je(this,this.h);this.g-=4};g.Ai=function(){this.h=M(this,this.i);this.g-=4};g.Bi=function(){this.h=M(this,this.j);this.g-=4};g.Ci=function(){this.h=M(this,this.l);this.g-=4};g.Di=function(){this.h=M(this,this.m);this.g-=4};g.Ei=function(){this.h=M(this,this.o);this.g-=4};g.Fi=function(){this.h=M(this,this.u);this.g-=4};g.Gi=function(){this.h=M(this,L(this,this.S()));this.g-=7};
g.zi=function(){this.h=M(this,this.h);this.g-=4};g.ji=function(){this.h=Ke(this,this.i);this.g-=4};g.ki=function(){this.h=Ke(this,this.j);this.g-=4};g.li=function(){this.h=Ke(this,this.l);this.g-=4};g.mi=function(){this.h=Ke(this,this.m);this.g-=4};g.ni=function(){this.h=Ke(this,this.o);this.g-=4};g.oi=function(){this.h=Ke(this,this.u);this.g-=4};g.pi=function(){this.h=Ke(this,L(this,this.S()));this.g-=7};g.ii=function(){this.h=Ke(this,this.h);this.g-=4};
g.De=function(){this.h=Le(this,this.i);this.g-=4};g.Ee=function(){this.h=Le(this,this.j);this.g-=4};g.Fe=function(){this.h=Le(this,this.l);this.g-=4};g.Ge=function(){this.h=Le(this,this.m);this.g-=4};g.He=function(){this.h=Le(this,this.o);this.g-=4};g.Ie=function(){this.h=Le(this,this.u);this.g-=4};g.Je=function(){this.h=Le(this,L(this,this.S()));this.g-=7};g.Ce=function(){this.h=Le(this,this.h);this.g-=4};g.Ki=function(){this.h=Me(this,this.i);this.g-=4};
g.Li=function(){this.h=Me(this,this.j);this.g-=4};g.Mi=function(){this.h=Me(this,this.l);this.g-=4};g.Ni=function(){this.h=Me(this,this.m);this.g-=4};g.Oi=function(){this.h=Me(this,this.o);this.g-=4};g.Pi=function(){this.h=Me(this,this.u);this.g-=4};g.Qi=function(){this.h=Me(this,L(this,this.S()));this.g-=7};g.Ji=function(){this.h=Me(this,this.h);this.g-=4};g.xh=function(){this.h=Ne(this,this.i);this.g-=4};g.yh=function(){this.h=Ne(this,this.j);this.g-=4};
g.zh=function(){this.h=Ne(this,this.l);this.g-=4};g.Ah=function(){this.h=Ne(this,this.m);this.g-=4};g.Bh=function(){this.h=Ne(this,this.o);this.g-=4};g.Ch=function(){this.h=Ne(this,this.u);this.g-=4};g.Dh=function(){this.h=Ne(this,L(this,this.S()));this.g-=7};g.wh=function(){this.h=Ne(this,this.h);this.g-=4};g.Qe=function(){M(this,this.i);this.g-=4};g.Re=function(){M(this,this.j);this.g-=4};g.Se=function(){M(this,this.l);this.g-=4};g.Te=function(){M(this,this.m);this.g-=4};
g.Ue=function(){M(this,this.o);this.g-=4};g.Ve=function(){M(this,this.u);this.g-=4};g.We=function(){M(this,L(this,this.S()));this.g-=7};g.Pe=function(){M(this,this.h);this.g-=4};g.Vh=function(){xe(this)||(this.R(Oe(this)),this.g-=6);this.g-=5};g.Hh=function(){this.cb(Oe(this));this.g-=10};g.Pf=function(){var a=K(this);xe(this)||this.R(a);this.g-=10};g.Tc=function(){this.R(K(this));this.g-=10};g.Ye=function(){var a=K(this);xe(this)||(N(this,this.v),this.R(a),this.g-=6);this.g-=11};
g.Mh=function(){N(this,this.Ha());this.g-=11};g.Be=function(){this.h=He(this,J(this));this.g-=7};g.$h=function(){N(this,this.v);this.R(0);this.g-=11};g.hi=function(){xe(this)&&(this.R(Oe(this)),this.g-=6);this.g-=5};g.Uc=function(){this.R(Oe(this));this.g-=10};g.Tf=function(){var a=K(this);xe(this)&&this.R(a);this.g-=10};g.cf=function(){var a=K(this);xe(this)&&(N(this,this.v),this.R(a),this.g-=6);this.g-=11};g.qb=function(){var a=K(this);N(this,this.v);this.R(a);this.g-=17};
g.ke=function(){this.h=Je(this,J(this));this.g-=7};g.ai=function(){N(this,this.v);this.R(8);this.g-=11};g.Uh=function(){ue(this)||(this.R(Oe(this)),this.g-=6);this.g-=5};g.Ih=function(){this.Sa(Oe(this));this.g-=10};g.Of=function(){var a=K(this);ue(this)||this.R(a);this.g-=10};g.Fh=function(){var a=J(this);this.X.oa(a,this.h);this.g-=10};g.Xe=function(){var a=K(this);ue(this)||(N(this,this.v),this.R(a),this.g-=6);this.g-=11};g.Nh=function(){N(this,this.Fa());this.g-=11};
g.Hi=function(){this.h=M(this,J(this));this.g-=7};g.bi=function(){N(this,this.v);this.R(16);this.g-=11};g.Rh=function(){ue(this)&&(this.R(Oe(this)),this.g-=6);this.g-=5};g.Mf=function(){var a=K(this);ue(this)&&this.R(a);this.g-=10};g.zf=function(){var a=J(this);this.h=this.X.qa(a)&255;this.g-=10};g.Le=function(){var a=K(this);ue(this)&&(N(this,this.v),this.R(a),this.g-=6);this.g-=11};g.ri=function(){this.h=Ke(this,J(this));this.g-=7};g.ci=function(){N(this,this.v);this.R(24);this.g-=11};
g.Yh=function(){ve(this)||(this.R(Oe(this)),this.g-=6);this.g-=5};g.Jh=function(){this.wa(Oe(this));this.g-=10};g.Sf=function(){var a=K(this);ve(this)||this.R(a);this.g-=10};g.Si=function(){var a=Oe(this);N(this,this.S());this.wa(a);this.g-=18};g.bf=function(){var a=K(this);ve(this)||(N(this,this.v),this.R(a),this.g-=6);this.g-=11};g.Oh=function(){N(this,this.S());this.g-=11};g.Ke=function(){this.h=Le(this,J(this));this.g-=7};g.di=function(){N(this,this.v);this.R(32);this.g-=11};
g.Xh=function(){ve(this)&&(this.R(Oe(this)),this.g-=6);this.g-=5};g.Gh=function(){this.R(this.S());this.g-=5};g.Rf=function(){var a=K(this);ve(this)&&this.R(a);this.g-=10};g.Ii=function(){var a=this.S();this.wa(this.Fa());this.Sa(a);this.g-=5};g.$e=function(){var a=K(this);ve(this)&&(N(this,this.v),this.R(a),this.g-=6);this.g-=11};g.Ri=function(){this.h=Me(this,J(this));this.g-=7};g.ei=function(){N(this,this.v);this.R(40);this.g-=11};
g.Wh=function(){ye(this)||(this.R(Oe(this)),this.g-=6);this.g-=5};g.Kh=function(){var a=Oe(this);Ae(this,a&Pe|this.K&~Pe);this.h=a>>8;this.g-=10};g.Qf=function(){var a=K(this);ye(this)||this.R(a);this.g-=10};g.wf=function(){this.K&=~ze;this.g-=4};g.Ze=function(){var a=K(this);ye(this)||(N(this,this.v),this.R(a),this.g-=6);this.g-=11};g.Lh=function(){N(this,Be(this)&Pe|this.h<<8);this.g-=11};g.Eh=function(){this.h=Ne(this,J(this));this.g-=7};g.fi=function(){N(this,this.v);this.R(48);this.g-=11};
g.Th=function(){ye(this)&&(this.R(Oe(this)),this.g-=6);this.g-=5};g.ti=function(){this.M=this.S()&65535;this.g-=5};g.Nf=function(){var a=K(this);ye(this)&&this.R(a);this.g-=10};g.xf=function(){this.K|=ze;this.g-=4;se(this)};g.Me=function(){var a=K(this);ye(this)&&(N(this,this.v),this.R(a),this.g-=6);this.g-=11};g.af=function(){M(this,J(this));this.g-=7};g.gi=function(){N(this,this.v);this.R(56);this.g-=11};
function te(a){a.h=0;a.i=0;a.j=0;a.l=0;a.m=0;a.o=0;a.u=0;a.M=0;a.R(a.Y);a.bb=a.v;Ae(a,0);a.N=Qe}g.Ha=function(){return this.i<<8|this.j};g.cb=function(a){this.i=a>>8&255;this.j=a&255};g.Fa=function(){return this.l<<8|this.m};g.Sa=function(a){this.l=a>>8&255;this.m=a&255};g.S=function(){return this.o<<8|this.u};g.wa=function(a){this.o=a>>8&255;this.u=a&255};g.ce=function(){return this.v};g.R=function(a){this.v=a&65535};function ue(a){return a.H&256?Ge:0}function Fe(a,b){a.H=a.H&255|b}
function ve(a){return Re[a.J&255]?Se:0}function we(a){return(a.J^a.L)&16?Te:0}function xe(a){return a.H&255?0:Ue}function ye(a){return a.J&128?Ve:0}function Be(a){return a.K&~We|ye(a)|xe(a)|we(a)|ve(a)|ue(a)}function Ae(a,b){a.H=a.J=a.L=0;b&Ge&&(a.H|=256);b&Se||(a.J|=1);b&Te&&(a.L|=16);b&Ue||(a.H|=255);b&Ve&&(a.J^=192);a.K=a.K&~(We|ze)|b&ze|Xe}function He(a,b){a.L=a.h^b;return a.J=(a.H=a.h+b)&255}function Je(a,b){a.L=a.h^b;return a.J=(a.H=a.h+b+(a.H&256?1:0))&255}
function Le(a,b){a.H=a.J=a.L=a.h&b;(a.h|b)&8&&(a.L^=16);return a.H}function Ee(a,b){a.L=b^255;b=a.J=b+255&255;a.H=a.H&-256|b;return b}function De(a,b){a.L=b;b=a.J=b+1&255;a.H=a.H&-256|b;return b}function Ne(a,b){return a.J=a.H=a.L=a.h|b}function M(a,b){b^=255;a.L=a.h^b;return a.J=(a.H=a.h+b+1^256)&255}function Ke(a,b){b^=255;a.L=a.h^b;return a.J=(a.H=a.h+b+(a.H&256?0:1)^256)&255}function Me(a,b){return a.J=a.H=a.L=a.h^b}function L(a,b){return a.T.qa(b)|0}function Ce(a,b,c){a.T.oa(b,c&255)}
function J(a){var b=L(a,a.v);a.R(a.v+1);return b}function K(a){var b=a.T.ra(a.v);a.R(a.v+2);return b}function Oe(a){var b=a.T.ra(a.M);a.M=a.M+2&65535;return b}function N(a,b){a.M=a.M-2&65535;a.T.ha(a.M,b&65535)}function se(a){if(a.time.g&&a.N&Ye&&a.K&ze){var b;for(b=0;b<8&&!(a.N&1<<b);b++);var c=b;c=c===void 0?-1:c;a.N&=~(c<0?255:1<<c);a.K&=~ze;a.N&=~Ie;a.W[Ze|b<<3].call(a)}return a.N&Ie?(dd(a.time),!1):!0}
g.toString=function(){return this.O("A=%02X BC=%04X DE=%04X HL=%04X SP=%04X I%d S%d Z%d A%d P%d C%d\n%s",this.h,this.Ha(),this.Fa(),this.S(),this.M,this.K&ze?1:0,ye(this)?1:0,xe(this)?1:0,we(this)?1:0,ve(this)?1:0,ue(this)?1:0,this.da&&xd(this.da,this.v,1)||"")};
var Ge=1,Xe=2,Se=4,Te=16,Ue=64,Ve=128,Pe=255,ze=512,We=Ge|Se|Te|Ue|Ve,Re=[1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,
0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1],Qe=0,Ye=255,Ie=256,Ze=199;n.CPUx80=qe;function $e(a,b,c){Ad.call(this,a,b,c);this.la=[af,bf];this.style=bf;this.ia=3}m($e,Ad);
$e.prototype.Pb=function(a,b,c){function d(wa,Ga){var ic=cf[wa];f.style==bf&&Ga&df&&(wa==ef&&(ic="HL"),ic="["+ic+"]");return ic}function e(wa){switch(wa&ff){case O:var Ga=Oa(f,h(),16,8,"");break;case gf:Ga=Oa(f,(h()|h()<<8)<<24>>24,16,16,"");break;case hf:Ga=Oa(f,h()|h()<<8,16,16,"");break;default:return"imm("+Oa(f,wa,16,16,"")+")"}f.style==bf&&wa&df?Ga="["+Ga+"]":wa&jf||(Ga=(f.style==af?"$":"0x")+Ga);return Ga}function h(){var wa=b.shift();l+=Oa(f,wa,16,8,"");Hd(f,a,1);return wa}for(var f=this,k=
ee(this,a),l="",q=Gd(this,a,pe.sc),p=Gd(this,a,pe.ac),u=h(),r=kf[u],t="",x=(this.style!=bf?lf:mf)[r[0]],w=r.length-1,B=nf,y,z=1;z<=w;z++){var Y="";y=r[z];if(y!==void 0&&!(y&P&&this.style==af)){var qa=y&of;if(qa){var ra=y&ff;ra?B=ra:y|=B;y&pf||(y|=z==1?qf:rf);qa&Q?Y=e(y):qa&jf?Y=d((y&sf)>>8,y):qa&tf&&(Y=(u>>3&7).toString());if(!Y||!Y.length){t="INVALID";break}t.length>0&&(t+=",");t+=Y||"???"}}}k=this.O("%s %-7s%s %-7s %s",k,l,y&uf?"*":" ",x,t);c?p&&(c+=" "+p):p&&(c=p);c&&(k=this.O("%-32s; %s",k,c));
q&&(k=q+":\n"+k);return k+"\n"};
var af="8080",bf="8086",lf="NONE ACI ADC ADD ADI ANA ANI CALL CC CM CNC CNZ CP CPE CPO CZ CMA CMC CMP CPI DAA DAD DCR DCX DI EI HLT IN INR INX JMP JC JM JNC JNZ JP JPE JPO JZ LDA LDAX LHLD LXI MOV MVI NOP ORA ORI OUT PCHL POP PUSH RAL RAR RET RC RM RNC RNZ RP RPE RPO RZ RLC RRC RST SBB SBI SHLD SPHL STA STAX STC SUB SUI XCHG XRA XRI XTHL".split(" "),mf="NONE ADC ADC ADD ADD AND AND CALL CALLC CALLS CALLNC CALLNZ CALLNS CALLP CALLNP CALLZ NOT CMC CMP CMP DAA ADD DEC DEC CLI STI HLT IN INC INC JMP JC JS JNC JNZ JNS JP JNP JZ MOV MOV MOV MOV MOV MOV NOP OR OR OUT JMP POP PUSH RCL RCR RET RETC RETS RETNC RETNZ RETNS RETP RETNP RETZ ROL ROR RST SBB SBB MOV MOV MOV MOV STC SUB SUB XCHG XOR XOR XCHG".split(" "),ef=
6,cf="B C D E H L M A BC DE HL SP PC PS PSW".split(" "),ff=15,of=240,sf=3840,pf=61440,nf=0,O=1,gf=2,hf=3,jf=16,Q=32,df=64,tf=128,R=1792|jf|O,S=0|jf|O,T=256|jf|O,U=512|jf|O,V=768|jf|O,W=1024|jf|O,X=1280|jf|O,Z=ef<<8|jf|O|df,vf=2048|jf|hf,wf=2304|jf|hf,xf=2560|jf|hf,yf=2816|jf|hf,zf=3584|jf|hf,rf=4096,qf=8192,P=16384,uf=32768,kf=[[45],[42,vf,Q],[71,vf|df,R|P],[29,vf],[28,S],[22,S],[44,S,Q],[63],[45,uf],[21,xf|P,vf],[40,R|P,vf|df],[23,vf],[28,T],[22,T],[44,T,Q],[64],[45,uf],[42,wf,Q],[71,wf|df,R|P],
[29,wf],[28,U],[22,U],[44,U,Q],[52],[45,uf],[21,xf|P,wf],[40,R|P,wf|df],[23,wf],[28,V],[22,V],[44,V,Q],[53],[45,uf],[42,xf,Q],[68,51|df,xf|P],[29,xf],[28,W],[22,W],[44,W,Q],[20],[45,uf],[21,xf|P,xf],[41,xf|P,51|df],[23,xf],[28,X],[22,X],[44,X,Q],[16,R|P],[45,uf],[42,yf,Q],[70,51|df,R|P],[29,yf],[28,Z],[22,Z],[44,Z,Q],[72],[45,uf],[21,xf|P,yf],[39,R|P,51|df],[23,yf],[28,R],[22,R],[44,R,Q],[17],[43,S,S],[43,S,T],[43,S,U],[43,S,V],[43,S,W],[43,S,X],[43,S,Z],[43,S,R],[43,T,S],[43,T,T],[43,T,U],[43,T,
V],[43,T,W],[43,T,X],[43,T,Z],[43,T,R],[43,U,S],[43,U,T],[43,U,U],[43,U,V],[43,U,W],[43,U,X],[43,U,Z],[43,U,R],[43,V,S],[43,V,T],[43,V,U],[43,V,V],[43,V,W],[43,V,X],[43,V,Z],[43,V,R],[43,W,S],[43,W,T],[43,W,U],[43,W,V],[43,W,W],[43,W,X],[43,W,Z],[43,W,R],[43,X,S],[43,X,T],[43,X,U],[43,X,V],[43,X,W],[43,X,X],[43,X,Z],[43,X,R],[43,Z,S],[43,Z,T],[43,Z,U],[43,Z,V],[43,Z,W],[43,Z,X],[26],[43,Z,R],[43,R,S],[43,R,T],[43,R,U],[43,R,V],[43,R,W],[43,R,X],[43,R,Z],[43,R,R],[3,R|P,S],[3,R|P,T],[3,R|P,U],[3,R|
P,V],[3,R|P,W],[3,R|P,X],[3,R|P,Z],[3,R|P,R],[2,R|P,S],[2,R|P,T],[2,R|P,U],[2,R|P,V],[2,R|P,W],[2,R|P,X],[2,R|P,Z],[2,R|P,R],[73,R|P,S],[73,R|P,T],[73,R|P,U],[73,R|P,V],[73,R|P,W],[73,R|P,X],[73,R|P,Z],[73,R|P,R],[66,R|P,S],[66,R|P,T],[66,R|P,U],[66,R|P,V],[66,R|P,W],[66,R|P,X],[66,R|P,Z],[66,R|P,R],[5,R|P,S],[5,R|P,T],[5,R|P,U],[5,R|P,V],[5,R|P,W],[5,R|P,X],[5,R|P,Z],[5,R|P,R],[76,R|P,S],[76,R|P,T],[76,R|P,U],[76,R|P,V],[76,R|P,W],[76,R|P,X],[76,R|P,Z],[76,R|P,R],[46,R|P,S],[46,R|P,T],[46,R|P,U],
[46,R|P,V],[46,R|P,W],[46,R|P,X],[46,R|P,Z],[46,R|P,R],[18,R|P,S],[18,R|P,T],[18,R|P,U],[18,R|P,V],[18,R|P,W],[18,R|P,X],[18,R|P,Z],[18,R|P,R],[58],[50,vf],[34,51],[30,51],[11,51],[51,vf],[4,R|P,Q|O],[65,tf],[62],[54],[38,51],[30,51|uf],[15,51],[7,51],[1,R|P,Q|O],[65,tf],[57],[50,wf],[33,51],[48,Q|O,R|P],[10,51],[51,wf],[74,R|P,Q|O],[65,tf],[55],[54,uf],[31,51],[27,R|P,Q|O],[8,51],[7,51|uf],[67,R|P,Q|O],[65,tf],[61],[50,xf],[37,51],[78,yf|df|P,xf|P],[14,51],[51,xf],[6,R|P,Q|O],[65,tf],[60],[49,xf],
[36,51],[75,xf|P,wf|P],[13,51],[7,51|uf],[77,R|P,Q|O],[65,tf],[59],[50,zf],[35,51],[24],[12,51],[51,zf],[47,R|P,Q|O],[65,tf],[56],[69,yf|P,xf|P],[32,51],[25],[9,51],[7,51|uf],[19,R|P,Q|O],[65,tf]];n.Dbgx80=$e;
function Af(a,b,c){td.call(this,a,b,c);a=Bf;var d=d===void 0?0:d;for(var e in a){var h=a[e];b=void 0;c=+e+d;var f=h[0],k=h[1],l=h[2],q=h[3];for(h=+e+d;h<=c;h++){b=!1;if(f){if(this.T[h])break;this.T[h]=f.bind(this)}if(k){if(this.V[h])break;this.V[h]=k.bind(this)}if(l){if(this.h[h])break;this.h[h]=l.bind(this)}if(q){if(this.X[h])break;this.X[h]=q.bind(this)}b=!0}if(!b)throw Error(this.O("handler for port %#0x already exists",h));}this.input=G(this,"Input");d=this.he.bind(this);e=Object.keys(Cf);for(a=
0;a<e.length;a++)Qb(this.input,Sb,e[a],d);this.la=this.config.switches||{};this.sa=Na(this.la["default"],255);Df(this,this.sa);this.ta()}m(Af,td);g=Af.prototype;g.xa=function(a){if(a){var b=a.shift();if(this.Z==b)return this.ea=a.shift(),this.K=a.shift(),this.ia=a.shift(),this.N=a.shift(),this.W=a.shift(),Df(this,a.shift()),!0}return!1};g.za=function(a){a.push(this.Z);a.push(this.ea);a.push(this.K);a.push(this.ia);a.push(this.N);a.push(this.W);a.push(this.v)};
g.he=function(a,b){a=Cf[a];this.K=this.K&~a|(b?a:0)};g.ta=function(){this.W=this.N=this.ia=this.K=this.ea=0};function Df(a,b){if(b!=void 0){var c=a.v==void 0?a.je.bind(a):null;a.v=b;for(var d=1;d<=8;d++)Qb(a.input,Tb,"sw"+d,c,!(b&1<<d-1))}}g.je=function(a,b){var c=+a.slice(-1)-1,d=1<<c;this.v=b?this.v&~d:this.v|d;for(var e in this.la)if(e!="default"&&(e[c]=="0"||e[c]=="1")&&Na(e)==(this.v&Na(e,-1))){var h=this.la[e];break}this.I("%s: %b (%s)\n",a,b,h)};
g.ee=function(a){var b=this.ea;this.I(2,"inStatus0(%#04x): %#04x\n",a,b);return b};g.fe=function(a){var b=this.K;this.I(16,"inStatus1(%#04x): %#04x\n",a,b);return b};g.ge=function(a){var b=this.ia|this.v&(Ef|Ff|Gf);this.I(16,"inStatus2(%#04x): %#04x\n",a,b);return b};g.de=function(a){var b=this.N>>8-this.W&255;this.I(16,"inShiftResult(%#04x): %#04x\n",a,b);return b};g.Ti=function(a,b){this.I(16,"outShiftCount(%#04x): %#04x\n",a,b);this.W=b};
g.Vi=function(a,b){this.I(16,"outSound1(%#04x): %#04x\n",a,b)};g.Ui=function(a,b){this.I(16,"outShiftData(%#04x): %#04x\n",a,b);this.N=b<<8|this.N>>8};g.Wi=function(a,b){this.I(16,"outSound2(%#04x): %#04x\n",a,b)};g.Xi=function(a,b){this.I(16,"outWatchDog(%#04x): %#04x\n",a,b)};
var Ef=3,Ff=8,Gf=128,Cf={"1p":4,"2p":2,coin:1,left:32,right:64,fire:16},Bf={0:[Af.prototype.ee],1:[Af.prototype.fe],2:[Af.prototype.ge,Af.prototype.Ti],3:[Af.prototype.de,Af.prototype.Vi],4:[null,Af.prototype.Ui],5:[null,Af.prototype.Wi],6:[null,Af.prototype.Xi]};n.InvadersPorts=Af;
function Hf(a,b,c){Kc.call(this,a,b,c);this.Y=this.config.bufferAddr;this.Fb=this.config.bufferRAM;this.Ld=this.config.bufferWidth;this.Md=this.config.bufferHeight;this.jb=this.config.cellWidth||1;this.Db=this.config.cellHeight||1;this.X=this.config.bufferBits||1;this.Kd=this.config.bufferLeft||0;if(this.h=this.config.bufferRotate)this.h=this.h%360,this.h>0&&(this.h-=360),this.h!=-90&&(this.I("unsupported buffer rotation: %d\n",this.h),this.h=0);this.W=this.config.interruptRate;this.La=this.config.refreshRate||
60;this.v=Cb(this,this.config.bus);this.m=this.Ld*this.jb;this.J=this.Md*this.Db;a=this.m;b=this.J;this.h&&(a=this.J,b=this.m);this.M=(this.m*this.X>>3)*this.J;if(this.Fb||nd(this.v,this.Y,this.M,H.Qa))this.T=this.v.j,this.la=this.u.createImageData(a,b),this.na=Math.trunc(this.T/this.X),Oc(this,Math.ceil(this.M/(this.T>>3))),this.o=document.createElement("canvas"),this.o.width=a,this.o.height=b,this.ib=this.o.getContext("2d"),this.L=1<<this.X,this.H=Array(this.L+If),this.H[0]=[0,0,0,255],this.H[1]=
[255,255,255,255],this.H[this.L+Jf]=[255,255,0,255],this.H[this.L+Kf]=[0,255,0,255],this.Wa&&(this.u[this.Wa]=this.ka==null?!1:this.ka);this.ca=G(this,"CPU");this.time=G(this,"Time");this.Xa=Xb(this.time,this.Z,this.Xc.bind(this));this.time.N.push(this);bc(this.time,this.Xa,1E3/Math.max(this.La,this.W));this.sa=0}m(Hf,Kc);Hf.prototype.Lb=function(){this.time.g||Pc(this)};function Oc(a,b){a.ba=!1;b&&(a.ma=b,a.N===void 0||a.N.length!=a.ma)&&(a.N=Array(a.ma))}
Hf.prototype.Xc=function(a){var b=!0;if(!a){this.W&&this.W==120&&(this.sa&1?(b=this.ca,b.N|=4,b.K&ze&&dd(b.time),b=!1):(a=this.ca,a.N|=2,a.K&ze&&dd(a.time)));if(b&&this.ba&&this.M){a=this.v;var c=this.Y,d=this.M,e=!0,h=c>>>a.h;for(c=a.blockSize-(c&a.i);d>0&&h<a.g.length;){var f=a.g[h];f.L?(f.L=!1,f.j.type==kd&&(f.l?(f.J=f.Sb,f.o=f.Vb):(f.oa=f.Sb,f.ha=f.Vb)),f=!0):f=!1;f&&(e=!1);d-=c;c=a.blockSize;h++}e&&(b=!1)}bc(this.time,this.Xa,1E3/Math.max(this.La,this.W));this.sa++;if(!b)return}Pc(this)};
function Pc(a){var b=a.Y,c=b+a.M,d=0,e=0,h=0,f=a.m,k=0,l=a.J,q=0,p=0,u=a.X,r=(1<<u)-1;a.Kd&&(u=-u,p=a.T+u);for(var t=a.T/a.v.j|0;b<c;){var x=a.v.qa(b);if(a.ba&&x===a.N[d])e+=a.na;else{a.N[d]=x;var w=p;w&&(x=x>>8|(x&255)<<8);e<f&&(f=e);for(var B=a.na;B--;){var y=x>>w&r,z=a,Y=a.la,qa=e++;var ra=h;ra=z.h?(Y.height-qa-1)*Y.width+ra:qa+ra*Y.width;y&&(qa>=208&&qa<236?y=z.L+Jf:qa>=28&&qa<72&&(y=z.L+Kf));z=z.H[y];ra*=z.length;Y.data[ra]=z[0];Y.data[ra+1]=z[1];Y.data[ra+2]=z[2];Y.data[ra+3]=z[3];w+=u}e>k&&
(k=e);h<l&&(l=h);h>=q&&(q=h+1)}b+=t;d++;if(e>=a.m&&(e=0,h++,h>a.J))break}a.ba=!0;f<a.m&&(b=k-f,q-=l,a.h&&(c=f,d=b,f=l,b=q,l=a.m-(c+d),q=d),a.ib.putImageData(a.la,0,0,f,l,b,q),a.u.drawImage(a.o,0,0,a.o.width,a.o.height,0,0,a.V,a.K))}var Jf=0,Kf=1,If=2;n.InvadersVideo=Hf;
function Lf(a,b,c){E.call(this,a,a);var d=this;this.i=!1;this.o=c;this.h="";this.m=this.l=!1;Ib(this,!1);this.ua=0;b=b.trim();b[0]=="{"?Mf(this,b):(this.h=b,gb(this.h,function(e,h,f,k){f==4&&(!k&&h?(Mf(d,h),Nf(d)):d.I("error (%d) loading configuration: %s\n",k,e))}));window.addEventListener("load",function(){d.m=!0;Nf(d)});window.addEventListener(lb("iOS")?"pagehide":lb("Opera")?"unload":"beforeunload",function(){Of(d)});window.addEventListener("pageshow",function(){d.i||d.va(!0)})}m(Lf,E);
Lf.prototype.Ma=function(a,b){var c=this;switch(a){case Pf:b.onclick=function(){c.va()};break;case Qf:b.onclick=function(){c.ta()}}E.prototype.Ma.call(this,a,b)};
function Nf(a){var b=!0;if(a.l&&a.m){for(var c in a.g){var d=void 0,e=a.g[c];try{d=e["class"],n[d]?d=="Machine"?(a.I("PCjs %s v%3.2f\n%s\n",e.name,3,"Copyright \u00a9 2012-2026 Jeff Parsons <Jeff@pcjs.org>"),a.h&&a.I("Configuration: %s\n",a.h)):new n[d](a.$,c,e):a.I('unrecognized %s device "%s"\n',d,c)}catch(f){e.optional||(a.I('error initializing %s device "%s": %s\n',d,c,f.message),b=!1),Kb(a,c)}}if(a.j){var h=mb(a);Eb(a,function(f){return f.pb&&!f.pb(h)?(f.I('unable to restore state for device "%s"\n',
f.Z),!1):!0})}Ib(a,!0);Jb(a,a.va.bind(a,b))||a.I("machine %s not ready to power, waiting for device(s)\n",a.$)}}
function Mf(a,b){try{a.g=JSON.parse(b);var c=a.g[a.$];if(!c){c=a.g[Sa(a.h)];if(!c)throw Error("configuration missing machine ID");a.g[a.$]=c}Db(a,c,["autoSave","autoStart"]);a.j=a.config.autoSave!==!1;a.u=a.config.autoStart!==!1;if(a.o){var d=eval("("+a.o+")"),e;for(e in d)a.config[e]=d[e]}a.l=!0}catch(h){c=h.message,(d=c.match(/position ([0-9]+)/))&&(c+=" ('"+b.substr(+d[1],40).replace(/\s+/g," ")+"...')"),a.I("machine '%s' initialization error: %s\n",a.$,c)}}
Lf.prototype.va=function(a){a=a===void 0?!this.i:a;if(Hb(this)){var b=this;a&&this.I("power on\n");Eb(this,function(c){c.va&&c!=b&&(c.config["class"]!="CPU"||b.u&&Hb(b)?c.va(a):c.time.update(!0));return!0});(this.i=a)||this.I("power off\n")}};Lf.prototype.ta=function(){if(Hb(this)){var a=this;Eb(this,function(b){b.ta&&b!=a&&b.ta();return!0});this.I("reset\n")}};function Of(a){if(a.j){var b=[];Eb(a,function(c){c.Ra&&c.Ra(b);return!0});ub(a,b)}a.va(!1)}var Pf="power",Qf="reset";
window.Invaders=function(a,b,c){var d=new Lf(a,b,c);window.command=function(e){return nb(d,e)};return d};n.Machine=Lf;})()

//# sourceMappingURL=invaders.js.map
